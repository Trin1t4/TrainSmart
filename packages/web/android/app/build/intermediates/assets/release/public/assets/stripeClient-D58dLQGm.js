var f="clover",I="https://js.stripe.com",S="".concat(I,"/").concat(f,"/stripe.js"),m=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,v=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var w=function(r){return m.test(r)||v.test(r)},E=function(){for(var r=document.querySelectorAll('script[src^="'.concat(I,'"]')),e=0;e<r.length;e++){var n=r[e];if(w(n.src))return n}return null},h=function(r){var e="",n=document.createElement("script");n.src="".concat(S).concat(e);var t=document.head||document.body;if(!t)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return t.appendChild(n),n},s=null,c=null,u=null,b=function(r){return function(e){r(new Error("Failed to load Stripe.js",{cause:e}))}},y=function(r,e){return function(){window.Stripe?r(window.Stripe):e(new Error("Stripe.js not available"))}},j=function(r){return s!==null?s:(s=new Promise(function(e,n){if(typeof window>"u"||typeof document>"u"){e(null);return}if(window.Stripe){e(window.Stripe);return}try{var t=E();if(!(t&&r)){if(!t)t=h(r);else if(t&&u!==null&&c!==null){var i;t.removeEventListener("load",u),t.removeEventListener("error",c),(i=t.parentNode)===null||i===void 0||i.removeChild(t),t=h(r)}}u=y(e,n),c=b(n),t.addEventListener("load",u),t.addEventListener("error",c)}catch(d){n(d);return}}),s.catch(function(e){return s=null,Promise.reject(e)}))},a,J=function(){return a||(a=j(null).catch(function(r){return a=null,Promise.reject(r)}),a)};Promise.resolve().then(function(){return J()}).catch(function(o){console.warn(o)});async function R(o,r,e,n,t){try{const l=await fetch("https://mhcdxqhhlrujbjxtgnmz.supabase.co/functions/v1/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oY2R4cWhobHJ1amJqeHRnbm16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3NTQyMDcsImV4cCI6MjA3NTMzMDIwN30.cXofEBb8KYsMy3VhK8exIBGeSxOU986QEr59a5M5l2U"},body:JSON.stringify({tier:o,userId:r,userEmail:e,successUrl:n||`${window.location.origin}/payment-success`,cancelUrl:t||`${window.location.origin}/dashboard`})});if(!l.ok)return{error:(await l.json()).error||"Failed to create checkout session"};const p=await l.json();return{sessionId:p.sessionId,url:p.url}}catch(i){return console.error("[STRIPE] Error creating checkout session:",i),{error:"Network error. Please try again."}}}async function L(o,r,e){const n=await R(o,r,e);if("error"in n)throw new Error(n.error);window.location.href=n.url}async function U(o){try{const n=await fetch(`https://mhcdxqhhlrujbjxtgnmz.supabase.co/functions/v1/get-subscription-status?userId=${o}`,{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oY2R4cWhobHJ1amJqeHRnbm16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk3NTQyMDcsImV4cCI6MjA3NTMzMDIwN30.cXofEBb8KYsMy3VhK8exIBGeSxOU986QEr59a5M5l2U"}});return n.ok?await n.json():null}catch(r){return console.error("[STRIPE] Error getting subscription status:",r),null}}export{U as g,L as r};
