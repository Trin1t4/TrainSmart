const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pose-BltDzaxB.js","assets/vendor-react-DLKD8xKB.js"])))=>i.map(i=>d[i]);
import{j as e,r as L,aj as Vr,Z as Wt,ak as Kr,D as Jt,c as et,a5 as Ut,h as Yr,V as Ne,F as uc,A as ea,K as Zs,X as ke,k as qt,a as We,al as mc,G as Gn,ab as Zr,am as pc,an as Ei,ao as Un,o as hc,ap as wt,a3 as $r,b as De,T as gt,J as Fe,aq as qr,g as wr,ar as Vn,O as os,as as gc,e as ts,C as nt,at as fc,au as xc,P as Xr,av as bc,R as vc,ai as yc,aw as Ii,ax as Ti,q as wc,p as Nc,_ as Ai,ay as Mi,w as Sc,W as Kn,az as jc,M as Nr,aA as _c,m as Pc,aB as Li,S as Yn,aC as Rc,N as kc,aD as Di,aE as Cc,aF as Sr,aG as Ec,aH as Ic,a6 as Tc}from"./vendor-ui-B5xs3EUI.js";import{R as ta,a as m,i as Zn,d as Ac,u as Mc}from"./vendor-react-DLKD8xKB.js";import{e as Xn,H as Qr,V as Qn,f as Jn,i as eo,j as to,k as ao,t as Jr,l as Lc,m as Dc,n as zc,A as Oc,o as as,p as ss,q as rr,r as zi,v as ir,w as Bc,x as aa,y as Fc,z as rs,B as $c,D as qc,E as Hc,F as Wc,G as Gc,d as Uc,_ as Vc,s as ne,I as so,u as ia,J as re,K as Za,M as Kc,N as Yc,O as jr,P as Oi,Q as Bi,R as Zc,S as Xc,T as Qc,U as Jc,W as ed,X as td,Y as ad,Z as sd,$ as rd,a0 as id,a1 as nd,a2 as od,a3 as Na,a4 as Je,a5 as ld,a6 as cd,a7 as dd,a8 as ud,a9 as md,aa as pd}from"./index-CsHuaFST.js";import{C as Dt,a as zt,b as Ot,d as hd,c as Bt}from"./card-BbERCm1Z.js";import{L as gd}from"./LanguageSwitcher-DxrfGrQV.js";import{d as fd,g as xd,e as bd}from"./running.types-BGK2IKGQ.js";import{g as ro}from"./exercise-data-MflI25vK.js";import{u as Xs,a as na,P as St,c as Gt,d as vd,b as yd,e as wd,f as Nd,g as Sd,h as jd,i as io,S as Fi,B as Ya,R as _d}from"./RunningSessionView-CfP4biXO.js";import{_ as $t,a as no,b as Pd}from"./vendor-supabase-DF1H9KNm.js";import{c as jt}from"./utils-BykweIWy.js";import{c as Rd}from"./videoCorrectionService-hah9IU7_.js";import{RecoveryScreening as kd}from"./RecoveryScreening-DyKZYQ4j.js";import{r as ei,u as Cd,a as Ed,b as Id,D as oo,c as ti,d as Td,e as Xa,s as Ad,f as Md,g as $i,h as Ld,i as Dd,j as lo,Z as co,L as is,C as zd,k as Od,l as Ht,m as qi,n as ai,o as Bd,p as si,q as ri,t as uo,v as mo,w as Fd,x as $d,y as Hi,z as qd,A as po,B as Wi,E as Hd,R as Wd,S as Gd,F as Ud,G as Vd,H as Kd,I as Yd,J as ho,K as Zd,M as Xd,N as Qd,O as Jd,P as eu,Q as tu,T as au,U as Gi,V as Ui,W as Vi,X as Ma,Y as su,_ as ru,$ as Sa,a0 as iu,a1 as nu,a2 as ou,a3 as go,a4 as _r,a5 as lu,a6 as fo,a7 as xo,a8 as ii,a9 as ni,aa as oi,ab as Qs,ac as li,ad as cu,ae as du,af as Js,ag as uu}from"./LineChart-BlBDR0Gt.js";import{c as bo}from"./clsx-B-dksMZM.js";import{r as mu}from"./stripeClient-D58dLQGm.js";const ci={knee_flexion:{avoid:["pistol","sissy squat"],substitutions:{squat:["Box Squat (alto)","Leg Press (ROM limitato)","Wall Sit"],"leg curl":["Hip Thrust","Glute Bridge","Cable Pull Through"],lunge:["Step Up (basso)","Split Squat (parziale)","Glute Bridge"],bulgarian:["Step Up (basso)","Hip Thrust","Glute Bridge"],pistol:["Box Squat","Leg Press","Glute Bridge"]},correctives:["Quad Stretch","Foam Roll Quad","Terminal Knee Extension","Wall Sit Isometric"]},knee_extension:{avoid:["leg extension","sissy squat"],substitutions:{"leg extension":["Wall Sit Isometric","Spanish Squat","Step Down Eccentric"],squat:["Box Squat","Goblet Squat","Leg Press"],lunge:["Reverse Lunge","Step Up","Hip Thrust"],jump:["Box Step Up","Sled Push","Glute Bridge"]},correctives:["VMO Activation","Terminal Knee Extension (leggero)","Patellar Mobilization","Hamstring Stretch"]},knee_load:{avoid:["jump","pistol","sprint"],substitutions:{squat:["Leg Press","Leg Extension + Leg Curl","Belt Squat"],lunge:["Leg Press","Step Up (basso)","Glute Bridge"],jump:["Box Step Up","Sled Push","Bike/Ellittica"],deadlift:["Romanian DL","Hip Thrust","Cable Pull Through"],running:["Bike","Ellittica","Rowing (leggero)"]},correctives:["Knee Circles","Wall Sit","Step Down Eccentric","Glute Activation"]},knee:{avoid:["pistol","jump","sissy squat"],substitutions:{squat:["Leg Press","Belt Squat","Hip Thrust"],lunge:["Leg Press","Hip Thrust","Glute Bridge"],"leg extension":["Wall Sit Isometric","Spanish Squat","Glute Bridge"],"leg curl":["Romanian Deadlift","Hip Thrust","Glute Bridge"],jump:["Sled Push","Bike","Glute Bridge"],pistol:["Leg Press","Hip Thrust","Glute Bridge"],bulgarian:["Leg Press","Hip Thrust","Glute Bridge"]},correctives:["Knee Circles","VMO Activation","Wall Sit","Quad/Hamstring Stretch"]},hip_flexion:{avoid:["sit-up","v-up","leg raise"],substitutions:{squat:["Box Squat (alto)","Leg Press (ROM limitato)","Belt Squat"],lunge:["Step Up","Hip Thrust","Glute Bridge"],"sit-up":["Plank","Dead Bug","Bird Dog"],"leg raise":["Plank","Dead Bug","Pallof Press"],deadlift:["Romanian DL (parziale)","Hip Thrust","Cable Pull Through"],rowing:["Lat Pulldown","Cable Row (in piedi)","Face Pull"]},correctives:["Hip Flexor Stretch","Couch Stretch","Pigeon Pose","Psoas Release"]},hip_extension:{avoid:["good morning","back extension"],substitutions:{"hip thrust":["Glute Bridge (isometrico)","Clamshell","Cable Kickback (leggero)"],"glute bridge":["Clamshell","Side Lying Hip Abduction","Isometric Bridge"],deadlift:["Leg Curl","Leg Press","Squat"],romanian:["Leg Curl","Seated Leg Curl","Lying Leg Curl"],"back extension":["Bird Dog","Plank","Dead Bug"],lunge:["Squat","Leg Press","Step Up"]},correctives:["Glute Stretch","Piriformis Stretch","Hip Circles","Cat-Cow"]},hip_abduction:{avoid:["sumo squat","side lunge"],substitutions:{"sumo squat":["Squat standard","Leg Press","Goblet Squat"],"sumo deadlift":["Conventional Deadlift","Romanian DL","Trap Bar DL"],"side lunge":["Forward Lunge","Reverse Lunge","Step Up"],"hip abduction":["Clamshell (leggero)","Glute Bridge","Monster Walk (leggero)"],"cable abduction":["Glute Bridge","Hip Thrust","Clamshell"]},correctives:["Adductor Stretch","Frog Stretch","Butterfly Stretch","Foam Roll Adductors"]},hip_rotation:{avoid:["pigeon pose"],substitutions:{squat:["Box Squat","Leg Press","Goblet Squat (piedi paralleli)"],lunge:["Split Squat (dritto)","Step Up","Leg Press"],deadlift:["Trap Bar DL","Romanian DL","Leg Press"],"hip circle":["Hip Flexor Stretch","Glute Bridge","Clamshell"]},correctives:["Piriformis Stretch","90/90 Stretch","Supine Twist (leggero)","Glute Foam Roll"]},hip:{avoid:["pistol","sumo squat","good morning"],substitutions:{squat:["Leg Press","Belt Squat","Goblet Squat"],lunge:["Leg Press","Step Up (basso)","Glute Bridge"],deadlift:["Leg Press","Leg Curl","Romanian DL (leggero)"],"hip thrust":["Glute Bridge (isometrico)","Clamshell","Leg Press"],pistol:["Leg Press","Box Squat","Glute Bridge"]},correctives:["Hip Circles","Hip Flexor Stretch","Piriformis Stretch","90/90 Mobility"]},lower_back_flexion:{avoid:["good morning","jefferson curl","sit-up"],substitutions:{deadlift:["Trap Bar DL","Rack Pull","Hip Thrust"],romanian:["Hip Thrust","Cable Pull Through","Glute Bridge"],"barbell row":["Chest Supported Row","Machine Row","Cable Row"],"sit-up":["Plank","Dead Bug","Pallof Press"],crunch:["Plank","Bird Dog","Dead Bug"]},correctives:["Cat-Cow (focus estensione)","McKenzie Press Up","Prone Cobra","Bird Dog"]},lower_back_extension:{avoid:["back extension","superman","cobra"],substitutions:{"back extension":["Plank","Dead Bug","Bird Dog"],superman:["Bird Dog","Dead Bug","Plank"],"overhead press":["Landmine Press","Seated Press (supportato)","Cable Press"],"hip thrust":["Glute Bridge","Clamshell","Banded Hip Thrust"]},correctives:["Cat-Cow (focus flessione)","Knee to Chest","Child's Pose","Pelvic Tilt"]},lower_back_load:{avoid:["good morning"],substitutions:{squat:["Leg Press","Belt Squat","Hack Squat"],deadlift:["Leg Curl + Hip Thrust","Romanian DL (leggero)","Cable Pull Through"],"barbell row":["Chest Supported Row","Machine Row","Seated Cable Row"],"overhead press":["Seated Press (supportato)","Machine Press","Landmine Press"],lunge:["Leg Press","Split Squat (supportato)","Step Up"]},correctives:["Dead Bug","Bird Dog","Pallof Press","Cat-Cow","Glute Bridge"]},lower_back_rotation:{avoid:["russian twist","wood chop"],substitutions:{"russian twist":["Pallof Press","Plank","Dead Bug"],"wood chop":["Pallof Press","Anti-Rotation Press","Plank"],"cable rotation":["Pallof Press","Plank with Shoulder Tap","Bird Dog"],"oblique crunch":["Side Plank","Pallof Press","Dead Bug"]},correctives:["Cat-Cow","Supine Twist (controllato)","Open Book","Thread the Needle"]},lower_back:{avoid:["good_morning"],substitutions:{squat:["Leg Press","Belt Squat","Leg Extension + Leg Curl"],deadlift:["Leg Curl","Hip Thrust","Glute Bridge"],romanian:["Leg Curl","Hip Thrust","Glute Bridge"],stacco:["Leg Curl","Hip Thrust","Glute Bridge"],"barbell row":["Chest Supported Row","Machine Row","Cable Row"],"good morning":["Glute Bridge","Bird Dog","Hip Thrust"]},correctives:["Cat-Cow","Bird Dog","Dead Bug","Pelvic Tilt","Glute Bridge","Side Plank"]},ankle_dorsiflexion:{avoid:["deep squat","pistol"],substitutions:{squat:["Box Squat (talloni rialzati)","Leg Press","Hack Squat"],lunge:["Reverse Lunge","Step Up","Split Squat (tallone rialzato)"],pistol:["Leg Press","Box Squat","Belt Squat"],"calf stretch":["Foam Roll Calf","Self Massage","Seated Calf Stretch"]},correctives:["Ankle Circles","Calf Foam Roll","Banded Ankle Distraction","Wall Ankle Mobilization"]},ankle_plantarflexion:{avoid:["box jump","sprint"],substitutions:{"calf raise":["Seated Calf Raise (leggero)","Tibialis Raise","Ankle Isometric"],jump:["Step Up","Sled Push","Bike"],sprint:["Bike","Ellittica","Walking"],running:["Bike","Ellittica","Pool Running"]},correctives:["Ankle Circles","Achilles Stretch (delicato)","Eccentric Calf Lower","Tibialis Raise"]},ankle_stability:{avoid:["pistol","single leg"],substitutions:{"single leg squat":["Squat bilaterale","Leg Press","Smith Machine Squat"],pistol:["Leg Press","Squat","Belt Squat"],lunge:["Squat","Leg Press","Step Up (con supporto)"],"step up":["Leg Press","Squat","Hack Squat"],"single leg deadlift":["Romanian DL (bilaterale)","Leg Curl","Hip Thrust"]},correctives:["Ankle Alphabet","Balance Board (seduto)","Banded Ankle Eversion/Inversion","Single Leg Balance (supportato)"]},ankle:{avoid:["jump","sprint","pistol"],substitutions:{squat:["Leg Press","Belt Squat","Hack Squat"],lunge:["Leg Press","Step Up (basso)","Split Squat (supportato)"],"calf raise":["Seated Calf Raise","Tibialis Raise","Ankle Isometric"],jump:["Sled Push","Bike","Ellittica"],pistol:["Leg Press","Belt Squat","Hack Squat"],sprint:["Bike","Ellittica","Rowing"]},correctives:["Ankle Circles","Calf Stretch","Ankle Mobilization","Tibialis Raise"]},shoulder_overhead:{avoid:["hspu","handstand"],substitutions:{"shoulder press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"overhead press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"military press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"arnold press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"pike push":["Incline Push-up","Push-up Standard","Chest Press Machine"],hspu:["Incline Push-up","Push-up Standard","Chest Press Machine"],handstand:["Incline Push-up","Push-up Standard","Chest Press Machine"],snatch:["Kettlebell Swing","Hip Hinge","Deadlift"],thruster:["Front Squat","Goblet Squat","Leg Press"]},correctives:["Band Pull-Aparts","Face Pulls","YTW","Wall Slides"]},shoulder_push:{avoid:[],substitutions:{"bench press":["Floor Press","Svend Press","Cable Fly"],"chest press":["Floor Press","Svend Press","Cable Fly"],"push-up":["Wall Push-up","Eccentric Push-up","Isometric Hold"],dips:["Tricep Pushdown","Close Grip Floor Press","Diamond Push-up"],fly:["Cable Fly (ROM ridotto)","Pec Deck (ROM ridotto)","Svend Press"],"incline press":["Floor Press","Low Incline Press","Cable Fly"]},correctives:["Pec Minor Stretch","Doorway Stretch","Band Pull-Aparts","Thoracic Extension"]},shoulder_rotation:{avoid:["cuban rotation","scarecrow"],substitutions:{"external rotation":["Isometric External Rotation","Band Pull-Aparts","Face Pull"],"internal rotation":["Isometric Internal Rotation","Band Pull-Aparts","Face Pull"],"cuban rotation":["Face Pull","Band Pull-Aparts","YTW"],scarecrow:["Face Pull","Band Pull-Aparts","YTW"],"arm circle":["Shoulder Shrugs","Band Pull-Aparts","Face Pull"]},correctives:["Sleeper Stretch","Cross Body Stretch","Pendulum Circles","Isometric Rotations"]},shoulder:{avoid:["hspu","handstand"],substitutions:{"shoulder press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"overhead press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"military press":["Lateral Raise Machine","Cable Lateral Raise","Face Pull"],"pike push":["Incline Push-up","Push-up Standard","Chest Press Machine"],hspu:["Incline Push-up","Push-up Standard","Chest Press Machine"],handstand:["Incline Push-up","Push-up Standard","Chest Press Machine"],"bench press":["Floor Press","Svend Press","Cable Fly"],"push-up":["Wall Push-up","Eccentric Push-up","Isometric Hold"],dips:["Tricep Pushdown","Close Grip Floor Press","Diamond Push-up"],"external rotation":["Isometric Hold","Band Pull-Aparts","Face Pull"],"internal rotation":["Isometric Hold","Band Pull-Aparts","Face Pull"]},correctives:["Band Pull-Aparts","Face Pulls","YTW","Wall Slides","Pendulum Circles"]},wrist:{avoid:["hspu","planche","push_up_standard"],substitutions:{hspu:["Pike su Pugni","Parallettes Pike","Dips"],handstand:["Handstand su Pugni","Parallettes","Dips"],planche:["Parallettes Lean","Dips","Ring Push-up"],"push-up":["Knuckle Push-up","Parallettes Push-up","Dips"],"push up":["Knuckle Push-up","Parallettes Push-up","Dips"]},correctives:["Wrist Circles","Wrist Flexion/Extension","Finger Flexion","Forearm Stretch"]},elbow_pull:{avoid:[],substitutions:{"pull-up":["Lat Pulldown (presa larga)","Straight Arm Pulldown","Machine Row"],"chin-up":["Lat Pulldown (presa larga)","Straight Arm Pulldown","Machine Row"],"bicep curl":["Hammer Curl (leggero)","Band Curl Leggero","Isometric Hold"],curl:["Hammer Curl (leggero)","Band Curl Leggero","Isometric Hold"],"barbell row":["Machine Row","Chest Supported Row","Cable Row (presa neutra)"],"dumbbell row":["Machine Row","Chest Supported Row","Cable Row (presa neutra)"]},correctives:["Wrist Extensor Stretch","Eccentric Wrist Extension","Forearm Pronation/Supination"]},elbow_push:{avoid:[],substitutions:{"french press":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"skull crusher":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"tricep extension":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"overhead extension":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],dips:["Tricep Pushdown (cable)","Close Grip Bench Press","Push-up"],"close grip bench":["Tricep Pushdown (cable)","Push-up","Cable Chest Press"]},correctives:["Wrist Flexor Stretch","Eccentric Wrist Flexion","Forearm Supination"]},elbow:{avoid:[],substitutions:{"pull-up":["Lat Pulldown (presa larga)","Straight Arm Pulldown","Machine Row"],"chin-up":["Lat Pulldown (presa larga)","Straight Arm Pulldown","Machine Row"],"bicep curl":["Hammer Curl (leggero)","Band Curl Leggero","Isometric Hold"],curl:["Hammer Curl (leggero)","Band Curl Leggero","Isometric Hold"],"barbell row":["Machine Row","Chest Supported Row","Cable Row (presa neutra)"],"dumbbell row":["Machine Row","Chest Supported Row","Cable Row (presa neutra)"],"french press":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"skull crusher":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"tricep extension":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],"overhead extension":["Tricep Pushdown (cable)","Tricep Kickback","Diamond Push-up (leggero)"],dips:["Tricep Pushdown (cable)","Close Grip Bench Press","Push-up"]},correctives:["Wrist Flexor Stretch","Wrist Extensor Stretch","Forearm Pronation/Supination"]},neck:{avoid:["overhead","hspu","shrug"],substitutions:{overhead:["Landmine Press","Floor Press","Push-up"],"military press":["Landmine Press","Floor Press","Push-up"],shrug:["Face Pull","Band Pull-Apart","Reverse Fly"],"pull-up":["Lat Pulldown","Inverted Row","Seated Row"]},correctives:["Neck Stretches","Chin Tucks","Upper Trap Release","Levator Scapulae Stretch"]}};function pu(t,a,r,s){const i=s==="gym"||s==="home_gym";return t==="mild"?{sets:a,reps:Math.max(3,Math.floor(r*.85)),loadReduction:i?.85:1,needsReplacement:!1,needsEasierVariant:!1,note:"âš ï¸ Dolore lieve - Deload applicato, monitora durante esecuzione"}:t==="moderate"?{sets:3,reps:12,loadReduction:i?.5:1,needsReplacement:!0,needsEasierVariant:!0,note:"âš ï¸ Adattamento dolore: volume leggero invece di forza"}:t==="severe"?{sets:2,reps:15,loadReduction:i?.4:1,needsReplacement:!0,needsEasierVariant:!0,note:"ðŸ›‘ Dolore elevato: esercizio sostituito, lavoro di recupero"}:{sets:a,reps:r,loadReduction:1,note:""}}function hu(t,a,r){const s=ci[a];if(!s)return!1;const i=t.toLowerCase();return!!((s.avoid||[]).some(l=>i.includes(l))||Object.keys(s.substitutions||{}).some(n=>i.includes(n.toLowerCase())))}function Ki(t,a,r){var u;const s=((u=ci[a])==null?void 0:u.substitutions)||{},i=t.toLowerCase();let o=null;for(const d of Object.keys(s))if(i.includes(d.toLowerCase())){o=d;break}if(!o)return console.warn(`Warning: Nessuna sostituzione trovata per: ${t}`),t;const l=s[o];let n=0;r==="moderate"?n=Math.min(1,l.length-1):r==="severe"&&(n=l.length-1);const c=l[n];return console.log(`Sostituzione (${r}): ${t} -> ${c}`),c}function gu(t){var a;return((a=ci[t])==null?void 0:a.correctives)||[]}const Pr={pistol:"Leg Press","pistol assistito":"Leg Press","pistol squat":"Leg Press","pistol squat assistito":"Leg Press",squat:"Leg Press","squat completo":"Leg Press","goblet squat":"Leg Press","box squat":"Leg Press",affondi:"Leg Press","bulgarian split squat":"Leg Press","nordic curl":"Leg Curl Machine","romanian deadlift":"Leg Curl Machine + Back Extension","glute bridge":"Hip Thrust Machine","push-up":"Chest Press Machine","push up":"Chest Press Machine","archer push-up":"Chest Press Machine","push-up standard":"Chest Press Machine","bench press":"Chest Press Machine","pike push-up":"Shoulder Press Machine","pike push up":"Shoulder Press Machine","elevated pike push-up":"Shoulder Press Machine",hspu:"Shoulder Press Machine","handstand push-up":"Shoulder Press Machine","military press":"Shoulder Press Machine","pull-up":"Lat Pulldown Machine","pull up":"Lat Pulldown Machine","assisted pull-up":"Lat Pulldown Machine","inverted row":"Seated Row Machine",plank:"Plank","l-sit":"Ab Crunch Machine","dragon flag":"Ab Crunch Machine"};function nr(t){const a=t.toLowerCase();if(Pr[a])return Pr[a];for(const[r,s]of Object.entries(Pr))if(a.includes(r))return s;return t}const di={lower_push:ao,lower_pull:to,horizontal_push:eo,vertical_push:Jn,vertical_pull:Qn,horizontal_pull:Qr,core:Xn};function fu(t,a){const r=di[a];if(!r)return!1;const s=t.toLowerCase();return r.some(l=>(l.equipment==="bodyweight"||l.equipment==="both")&&l.name.toLowerCase()===s)?!0:["squat a corpo libero","squat","air squat","bodyweight squat","split squat","affondi","affondi statici","affondi indietro","squat bulgaro","bulgarian split squat","pistol squat","squat a pistola","shrimp squat","squat gamberetto","skater squat","squat del pattinatore","push-up","piegamenti","push-up standard","standard push-up","push-up diamante","diamond push-up","push-up arciere","archer push-up","push-up deficit","deficit push-up","push-up inclinati","incline push-up","push-up al muro","wall push-up","push-up sulle ginocchia","knee push-up","pike push-up","pike push-up elevato","elevated pike push-up","trazioni","pull-up","chin-up","trazioni presa neutra","neutral grip pull-up","trazioni negative","negative pull-up","trazioni con elastico","rematore inverso","inverted row","australian pull-up","rematore inverso facilitato","rematore inverso presa larga","rematore inverso piedi elevati","superman row","prone y raise","floor pull","floor pull con asciugamano","plank","plank laterale","side plank","hollow body hold","dead bug","bird dog","l-sit","dragon flag","ponte glutei","glute bridge","hip thrust","nordic curl","slider leg curl","leg curl scorrevole"].some(l=>s.includes(l)||l.includes(s))}const Yi={"leg press":"Squat a Corpo Libero","leg curl machine":"Nordic Curl","leg curl (machine)":"Nordic Curl","hip thrust machine":"Ponte Glutei","chest press machine":"Piegamenti","shoulder press machine":"Pike Push-up","lat pulldown machine":"Trazioni alla Sbarra","lat pulldown (machine)":"Trazioni alla Sbarra","assisted pull-up":"Trazioni Negative","seated cable row":"Superman Row","seated row machine":"Superman Row","ab crunch machine":"Plank","cable crunch":"Plank","back squat":"Squat a Corpo Libero","front squat":"Squat a Corpo Libero","goblet squat":"Squat a Corpo Libero","conventional deadlift":"Hip Hinge a Corpo Libero","romanian deadlift (rdl)":"Hip Hinge a Corpo Libero","sumo deadlift":"Hip Hinge a Corpo Libero","trap bar deadlift":"Hip Hinge a Corpo Libero","flat barbell bench press":"Piegamenti","incline bench press":"Piegamenti Declinati","decline bench press":"Piegamenti","dumbbell bench press":"Piegamenti","military press (barbell)":"Pike Push-up","dumbbell shoulder press":"Pike Push-up","arnold press":"Pike Push-up","push press":"Pike Push-up","barbell row":"Superman Row","dumbbell row":"Superman Row","t-bar row":"Superman Row","tricep pushdown":"Piegamenti Diamante","skull crushers":"Piegamenti Diamante","barbell curl":"Chin-up (Supinato)","hammer curl":"Trazioni Presa Neutra","seated calf raise":"Calf Raise in Piedi","pallof press":"Plank Laterale",pressa:"Squat a Corpo Libero","leg curl":"Nordic Curl","chest press":"Piegamenti","lat machine":"Trazioni alla Sbarra","lat pulldown":"Trazioni alla Sbarra","pulley basso":"Superman Row",pulley:"Superman Row","crunch ai cavi":"Plank","squat con bilanciere":"Squat a Corpo Libero","squat frontale":"Squat a Corpo Libero","stacco da terra":"Hip Hinge a Corpo Libero","stacco rumeno":"Hip Hinge a Corpo Libero","stacco sumo":"Hip Hinge a Corpo Libero","stacco con trap bar":"Hip Hinge a Corpo Libero","panca piana":"Piegamenti","panca piana con bilanciere":"Piegamenti","panca inclinata":"Piegamenti Declinati","panca declinata":"Piegamenti","panca con manubri":"Piegamenti","lento avanti":"Pike Push-up","shoulder press":"Pike Push-up","shoulder press con manubri":"Pike Push-up","rematore con bilanciere":"Superman Row","rematore con manubrio":"Superman Row",rematore:"Superman Row","pushdown ai cavi":"Piegamenti Diamante","french press":"Piegamenti Diamante","curl con bilanciere":"Chin-up (Supinato)","curl a martello":"Trazioni Presa Neutra","calf raise seduto":"Calf Raise in Piedi"},vo=["standard pull-up","pull-up","wide grip pull-up","chin-up","chin-up (supinated)","neutral grip pull-up","negative pull-up","hanging leg raise","trazioni alla sbarra","trazioni","trazioni presa larga","chin-up","chin-up (supinato)","trazioni presa neutra","trazioni negative","alzate gambe alla sbarra"],Ms={"standard pull-up":"Floor Pull (asciugamano)","pull-up":"Floor Pull (asciugamano)","wide grip pull-up":"Floor Pull (asciugamano)","chin-up":"Floor Pull (asciugamano)","chin-up (supinated)":"Floor Pull (asciugamano)","neutral grip pull-up":"Floor Pull (asciugamano)","negative pull-up":"Prone Y-raise","hanging leg raise":"Alzate Gambe a Terra","trazioni alla sbarra":"Floor Pull (asciugamano)",trazioni:"Floor Pull (asciugamano)","trazioni presa larga":"Floor Pull (asciugamano)","chin-up (supinato)":"Floor Pull (asciugamano)","trazioni presa neutra":"Floor Pull (asciugamano)","trazioni negative":"Prone Y-raise","alzate gambe alla sbarra":"Alzate Gambe a Terra","lat pulldown":"Floor Pull (asciugamano)","lat pulldown machine":"Floor Pull (asciugamano)","lat pulldown (machine)":"Floor Pull (asciugamano)"},Zi=["inverted row","inverted row (tavolo)","inverted row alta","inverted row 45Â°","inverted row 30Â°","inverted row orizzontale","inverted row singolo braccio","inverted row facilitato","rematore inverso","rematore inverso (tavolo)","rematore inverso facilitato","rematore inverso presa larga","rematore inverso piedi elevati","australian pull-up","australian pull-up (tavolo)","bodyweight row (tavolo)"],Ls={"inverted row":"Floor Pull (asciugamano)","inverted row (tavolo)":"Floor Pull (asciugamano)","inverted row alta":"Floor Pull (asciugamano)","inverted row 45Â°":"Floor Pull Facilitato","inverted row 30Â°":"Floor Pull Facilitato","inverted row orizzontale":"Floor Pull (asciugamano)","inverted row singolo braccio":"Floor Pull Singolo Braccio","inverted row facilitato":"Floor Pull Facilitato","rematore inverso":"Floor Pull (asciugamano)","rematore inverso (tavolo)":"Floor Pull (asciugamano)","rematore inverso facilitato":"Floor Pull Facilitato","rematore inverso presa larga":"Floor Pull (asciugamano)","rematore inverso piedi elevati":"Floor Pull (asciugamano)","australian pull-up":"Floor Pull (asciugamano)","australian pull-up (tavolo)":"Floor Pull (asciugamano)","bodyweight row (tavolo)":"Superman Row"},xu={lower_push:[{minRatio:2,exercise:"Pistol Squat",notes:"Elite - 2x+ bodyweight squat"},{minRatio:1.5,exercise:"Pistol Squat (Assisted)",notes:"Molto avanzato - 1.5x+ BW"},{minRatio:1.2,exercise:"Shrimp Squat",notes:"Avanzato - 1.2x+ BW"},{minRatio:1,exercise:"Skater Squat",notes:"Intermedio-avanzato - 1x BW"},{minRatio:.75,exercise:"Bulgarian Split Squat",notes:"Intermedio - 0.75x BW"},{minRatio:.5,exercise:"Split Squat",notes:"Intermedio base - 0.5x BW"},{minRatio:0,exercise:"Bodyweight Squat",notes:"Principiante"}],lower_pull:[{minRatio:2.5,exercise:"Nordic Hamstring Curl",notes:"Elite - 2.5x+ BW deadlift"},{minRatio:2,exercise:"Nordic Curl (Eccentric Only)",notes:"Molto avanzato - 2x+ BW"},{minRatio:1.5,exercise:"Slider Leg Curl (Single Leg)",notes:"Avanzato - 1.5x+ BW"},{minRatio:1.2,exercise:"Slider Leg Curl",notes:"Intermedio-avanzato - 1.2x BW"},{minRatio:1,exercise:"Single Leg RDL (Bodyweight)",notes:"Intermedio - 1x BW"},{minRatio:.75,exercise:"Hip Thrust (Single Leg)",notes:"Intermedio - 0.75x BW"},{minRatio:.5,exercise:"Hip Thrust (Elevated)",notes:"Base - 0.5x BW"},{minRatio:0,exercise:"Glute Bridge",notes:"Principiante"}],horizontal_push:[{minRatio:1.5,exercise:"One-Arm Push-up",notes:"Elite - 1.5x+ BW bench"},{minRatio:1.3,exercise:"One-Arm Push-up (Assisted)",notes:"Molto avanzato - 1.3x+ BW"},{minRatio:1.1,exercise:"Archer Push-up",notes:"Avanzato - 1.1x+ BW"},{minRatio:.9,exercise:"Pseudo Planche Push-up",notes:"Avanzato - 0.9x BW"},{minRatio:.75,exercise:"Diamond Push-up",notes:"Intermedio-avanzato - 0.75x BW"},{minRatio:.6,exercise:"Deficit Push-up",notes:"Intermedio - 0.6x BW"},{minRatio:.5,exercise:"Standard Push-up",notes:"Intermedio - 0.5x BW"},{minRatio:.3,exercise:"Knee Push-up",notes:"Base - 0.3x BW"},{minRatio:.15,exercise:"Incline Push-up",notes:"Principiante avanzato - 0.15x BW"},{minRatio:0,exercise:"Wall Push-up",notes:"Principiante"}],vertical_push:[{minRatio:1,exercise:"Freestanding Handstand Push-up",notes:"Elite mondiale - 1x+ BW OHP"},{minRatio:.85,exercise:"Wall Handstand Push-up",notes:"Elite - 0.85x+ BW OHP"},{minRatio:.7,exercise:"Wall Handstand Push-up (Eccentric)",notes:"Molto avanzato - 0.7x+ BW"},{minRatio:.6,exercise:"Elevated Pike Push-up (High)",notes:"Avanzato - 0.6x+ BW"},{minRatio:.5,exercise:"Elevated Pike Push-up",notes:"Intermedio-avanzato - 0.5x BW"},{minRatio:.4,exercise:"Pike Push-up",notes:"Intermedio - 0.4x BW"},{minRatio:.25,exercise:"Pike Push-up (Knee)",notes:"Base - 0.25x BW"},{minRatio:0,exercise:"Wall Shoulder Tap",notes:"Principiante"}],vertical_pull:[{minRatio:1.2,exercise:"Floor Pull Singolo Braccio",notes:"Elite - unilaterale con asciugamano"},{minRatio:1,exercise:"Floor Pull (asciugamano)",notes:"Avanzato - trazioni scivolate a terra"},{minRatio:.8,exercise:"Inverted Row (tavolo)",notes:"Avanzato - sotto un tavolo robusto"},{minRatio:.6,exercise:"Floor Pull Facilitato",notes:"Intermedio - ginocchia piegate"},{minRatio:.4,exercise:"Prone Y-T-W Raises",notes:"Intermedio - a terra prono SENZA ATTREZZI"},{minRatio:.2,exercise:"Superman Pull",notes:"Base - tirata prona SENZA ATTREZZI"},{minRatio:0,exercise:"Prone Y Raise",notes:"Principiante - a terra prono ZERO ATTREZZI"}],horizontal_pull:[{minRatio:1.2,exercise:"Inverted Row Singolo Braccio",notes:"Elite - unilaterale sotto tavolo"},{minRatio:1,exercise:"Rematore Inverso Piedi Elevati",notes:"Avanzato - piedi elevati su sedia"},{minRatio:.85,exercise:"Rematore Inverso",notes:"Avanzato - gambe tese sotto tavolo"},{minRatio:.7,exercise:"Superman Row",notes:"Intermedio-avanzato - a terra SENZA ATTREZZI"},{minRatio:.5,exercise:"Prone Y-T-W Raises",notes:"Intermedio - a terra SENZA ATTREZZI"},{minRatio:.3,exercise:"Superman Pull",notes:"Base - tirata prona SENZA ATTREZZI"},{minRatio:0,exercise:"Prone Y Raise",notes:"Principiante - a terra prono ZERO ATTREZZI"}]};function bu(t){const a=t.toLowerCase();return a.includes("bilanciere")||a.includes("barbell")?a.includes("squat")?70:a.includes("deadlift")||a.includes("stacco")?80:a.includes("bench")||a.includes("panca")?60:a.includes("press")||a.includes("military")?40:a.includes("row")||a.includes("rematore")?50:60:a.includes("back squat")||a==="squat"?70:a.includes("front squat")?60:a.includes("leg press")?100:a.includes("deadlift")||a.includes("stacco")?80:a.includes("rdl")||a.includes("romanian")||a.includes("bench")||a.includes("panca piana")?60:a.includes("incline")?50:a.includes("shoulder press")||a.includes("lento avanti")?40:a.includes("lat pulldown")||a.includes("lat machine")?50:a.includes("cable row")||a.includes("pulley")?45:a.includes("dumbbell")||a.includes("manubr")?30:a.includes("press")||a.includes("curl")||a.includes("row")?35:20}function vu(t){return t*(36/27)}function ja(t,a,r=75,s,i,o){const l=t.toLowerCase();let n,c;if(s&&s>0){n=vu(s);const h=i?` (test: ${new Date(i).toLocaleDateString("it-IT")})`:"";c=`TEST REALE: ${s}kg x10RM â†’ ${n.toFixed(0)}kg 1RM${h}`}else n=bu(t),c=`stimato ${n}kg 1RM (nessun test recente)`;const u=n/r;console.log(`ðŸ‹ï¸ "${t}": ${c} / ${r}kg BW = ${u.toFixed(2)}x BW`);const d=h=>{if(!o)return!0;const x=h.toLowerCase();o.noEquipment;const g=o.pullupBar===!0,y=o.sturdyTable===!0,v=o.loopBands===!0;return["inverted row","inverted","rematore inverso","australian","body row","table row","bodyweight row","row sotto"].some(D=>x.includes(D))&&!y?(console.log(`ðŸš« ${h} richiede tavolo robusto ma non disponibile`),!1):["pull-up","pullup","pull up","chin-up","chinup","chin up","trazioni","trazione","hanging","appeso","alla sbarra"].some(D=>x.includes(D))&&!g?(console.log(`ðŸš« ${h} richiede sbarra ma non disponibile`),!1):["band","elastico","elastic","resistance band","loop band"].some(D=>x.includes(D))&&!v?(console.log(`ðŸš« ${h} richiede elastici ma non disponibili`),!1):!0},p=xu[a];if(p&&p.length>0){for(const x of p)if(u>=x.minRatio&&d(x.exercise))return console.log(`ðŸŽ¯ Relative strength match: ${u.toFixed(2)}x BW â†’ ${x.exercise} (${x.notes})`),x.exercise;for(let x=p.length-1;x>=0;x--)if(d(p[x].exercise))return console.log(`ðŸŽ¯ Fallback to easiest available: ${p[x].exercise}`),p[x].exercise;const h=p[p.length-1];return console.log(`ðŸŽ¯ Fallback to easiest (no filter): ${h.exercise}`),h.exercise}const f=di[a];if(f){const h=f.filter(x=>x.equipment==="bodyweight"||x.equipment==="both").sort((x,g)=>g.difficulty-x.difficulty);if(h.length>0){if(u>=1&&h[0])return console.log(`ðŸŽ¯ High ratio (${u.toFixed(2)}x BW) â†’ hardest BW: ${h[0].name}`),h[0].name;const x=Math.floor(h.length/2);return console.log(`ðŸŽ¯ Medium ratio â†’ mid BW: ${h[x].name}`),h[x].name}}return Yi[l]?Yi[l]:t}function yu(t,a){t.toLowerCase();const r=nr(t);if(r!==t)return r;const s=di[a];if(s){const i=s.find(o=>o.equipment==="gym"||o.equipment==="both");if(i)return i.name}return t}function wu(t){const a=t.toLowerCase();return{pullupBar:vo.includes(a),barbell:a.includes("barbell")||a.includes("deadlift"),dumbbell:a.includes("dumbbell")||a.includes("goblet"),bench:a.includes("bench")||a.includes("chest dips")}}function Nu(t,a){const{location:r,homeType:s,equipment:i,userBodyweight:o,realLoads:l,testDates:n}=a;if(t.pattern==="corrective")return t;let c=t.name,u=!1;const d=o||75,p=l==null?void 0:l[t.pattern],f=n==null?void 0:n[t.pattern];if(r==="gym")c=yu(t.name,t.pattern),u=c!==t.name;else if(r==="home")if(s==="bodyweight"||!i){const h=t.name.toLowerCase(),x={pullupBar:(i==null?void 0:i.pullupBar)===!0,sturdyTable:(i==null?void 0:i.sturdyTable)===!0,loopBands:(i==null?void 0:i.bands)===!0||(i==null?void 0:i.loopBands)===!0,noEquipment:(i==null?void 0:i.noEquipment)===!0},g=(i==null?void 0:i.pullupBar)===!0,y=(i==null?void 0:i.sturdyTable)===!0,v=(i==null?void 0:i.noEquipment)===!0;if((t.pattern==="vertical_pull"||t.pattern==="horizontal_pull")&&(v||!(g||y)))console.log(`ðŸš« ${t.name} (${t.pattern}) - utente senza attrezzi per tirate â†’ Floor Pull`),t.pattern==="vertical_pull"?c="Floor Pull (asciugamano)":c="Superman Row",u=!0;else{const N=vo.some(T=>h.includes(T)||T.includes(h));Zi.some(T=>h.includes(T)||T.includes(h))&&!y?(console.log(`ðŸš« ${t.name} richiede tavolo ma non disponibile â†’ sostituzione`),Ls[h]?(c=Ls[h],u=!0):(c=ja(t.name,t.pattern,d,p,f,x),u=c!==t.name)):N&&!g?(console.log(`ðŸš« ${t.name} richiede sbarra ma non disponibile â†’ sostituzione`),Ms[h]?(c=Ms[h],u=!0):(c=ja(t.name,t.pattern,d,p,f,x),u=c!==t.name)):fu(t.name,t.pattern)?console.log(`âœ… ${t.name} Ã¨ giÃ  bodyweight, mantenuto`):(console.log(`ðŸ”„ ${t.name} richiede conversione a bodyweight`),c=ja(t.name,t.pattern,d,p,f,x),u=c!==t.name)}}else{const h=wu(t.name),x=t.name.toLowerCase(),g={pullupBar:i.pullupBar===!0,sturdyTable:(i==null?void 0:i.sturdyTable)===!0,loopBands:i.bands===!0||(i==null?void 0:i.loopBands)===!0,noEquipment:(i==null?void 0:i.noEquipment)===!0},y=i.pullupBar===!0,v=(i==null?void 0:i.sturdyTable)===!0,S=(i==null?void 0:i.noEquipment)===!0;(t.pattern==="vertical_pull"||t.pattern==="horizontal_pull")&&(S||!(y||v))?(console.log(`ðŸš« ${t.name} (${t.pattern}) - utente senza attrezzi per tirate â†’ Floor Pull`),t.pattern==="vertical_pull"?c="Floor Pull (asciugamano)":c="Superman Row",u=!0):(Zi.some(T=>x.includes(T)||T.includes(x))&&!v&&(console.log(`ðŸš« ${t.name} richiede tavolo ma non disponibile â†’ sostituzione`),Ls[x]?(c=Ls[x],u=!0):(c=ja(t.name,t.pattern,d,p,f,g),u=c!==t.name)),h.pullupBar&&!y&&Ms[x]&&(c=Ms[x],u=!0),h.barbell&&!i.barbell&&(i.dumbbellMaxKg>0?c=t.name.replace(/barbell/i,"Dumbbell"):c=ja(t.name,t.pattern,d,p,f,g),u=c!==t.name),h.bench&&!i.bench&&(c=ja(t.name,t.pattern,d,p,f,g),u=c!==t.name))}return{...t,name:c,wasReplaced:u||t.wasReplaced}}function yo(t,a){return t.map(r=>Nu(r,a))}const wo={lower_push:ao,lower_pull:to,horizontal_push:eo,vertical_push:Jn,vertical_pull:Qn,horizontal_pull:Qr,core:Xn},Xi={lower_push_bodyweight:["Box Squat","Assisted Squat","Bodyweight Squat","Split Squat","Bulgarian Split Squat","Pistol Squat (Assisted)","Pistol Squat"],lower_push_gym:["Leg Press","Goblet Squat","Smith Machine Squat","Back Squat","Front Squat","Bulgarian Split Squat (Weighted)","Zercher Squat"],lower_pull_bodyweight:["Glute Bridge","Single Leg Glute Bridge","Hip Hinge","Single Leg Hip Hinge","Nordic Curl (Eccentric)","Nordic Curl"],lower_pull_gym:["Leg Curl (Machine)","Cable Pull Through","Dumbbell RDL","Romanian Deadlift","Conventional Deadlift","Sumo Deadlift"],horizontal_push_bodyweight:["Wall Push-up","Incline Push-up","Knee Push-up","Standard Push-up","Close Grip Push-up","Diamond Push-up","Archer Push-up","One-Arm Push-up (Assisted)"],horizontal_push_gym:["Machine Chest Press","Dumbbell Bench Press","Flat Barbell Bench Press","Incline Bench Press","Decline Bench Press","Close Grip Bench Press"],vertical_push_bodyweight:["Wall Shoulder Tap","Pike Push-up (Knee)","Pike Push-up","Elevated Pike Push-up","Wall Handstand Hold","Wall Handstand Push-up (Eccentric)","Wall Handstand Push-up"],vertical_push_gym:["Machine Shoulder Press","Dumbbell Shoulder Press (Seated)","Dumbbell Shoulder Press (Standing)","Arnold Press","Military Press","Push Press"],vertical_pull_bodyweight:["Scapular Pull-up","Dead Hang","Negative Pull-up","Band-Assisted Pull-up","Chin-up","Neutral Grip Pull-up","Standard Pull-up","Wide Grip Pull-up","Muscle-up (Progression)"],vertical_pull_gym:["Lat Pulldown (Light)","Lat Pulldown","Wide Grip Lat Pulldown","Assisted Pull-up Machine","Neutral Grip Pull-up","Standard Pull-up","Weighted Pull-up"],horizontal_pull_bodyweight:["Band Row","Inverted Row (High Bar)","Inverted Row","Inverted Row (Feet Elevated)","Archer Row","One-Arm Inverted Row"],horizontal_pull_gym:["Machine Row","Seated Cable Row","Dumbbell Row","Chest Supported Row","Barbell Row","T-Bar Row","Pendlay Row"],core_bodyweight:["Dead Bug","Bird Dog","Plank (Knee)","Plank","Side Plank (Knee)","Side Plank","Lying Leg Raise","Hanging Knee Raise","Hanging Leg Raise","L-Sit"]};function No(t,a){return Xi[t+(a==="home"?"_bodyweight":"_gym")]||Xi[t+"_bodyweight"]||[]}function So(t,a){const r=t.toLowerCase();return a.findIndex(s=>s.toLowerCase()===r||r.includes(s.toLowerCase())||s.toLowerCase().includes(r))}function Su(t,a,r){const s=No(a,r);if(s.length===0){const l=wo[a];if(l){const n=l.find(c=>c.name.toLowerCase()===t.toLowerCase());if(n){const c=r==="home"?"bodyweight":"gym",u=l.filter(d=>d.difficulty<n.difficulty&&(d.equipment===c||d.equipment==="both")).sort((d,p)=>p.difficulty-d.difficulty);if(u.length>0){const d=u[0];return{name:d.name,difficulty:d.difficulty,notes:`Downgrade da ${t} (diff: ${n.difficulty} -> ${d.difficulty})`}}}}return null}const i=So(t,s);if(i<=0)return null;const o=s[i-1];return{name:o,difficulty:i-1,notes:`Progressione ridotta: ${t} -> ${o}`}}function jo(t,a,r){const s=No(a,r);if(s.length===0){const l=wo[a];if(l){const n=l.find(c=>c.name.toLowerCase()===t.toLowerCase());if(n){const c=r==="home"?"bodyweight":"gym",u=l.filter(d=>d.difficulty>n.difficulty&&(d.equipment===c||d.equipment==="both")).sort((d,p)=>d.difficulty-p.difficulty);if(u.length>0){const d=u[0];return{name:d.name,difficulty:d.difficulty,notes:`Upgrade da ${t} (diff: ${n.difficulty} -> ${d.difficulty})`}}}}return null}const i=So(t,s);if(i===-1||i>=s.length-1)return null;const o=s[i+1];return{name:o,difficulty:i+1,notes:`Progressione aumentata: ${t} -> ${o}`}}const ju=new Set(["push-up","pushup","pike push-up","pike pushup","diamond push-up","archer push-up","one arm push-up","handstand push-up","hspu","dips","parallel dips","ring dips","pull-up","pullup","chin-up","chinup","muscle-up","muscleup","inverted row","australian pull-up","body row","negative pull-up","band assisted pull-up","pistol squat","shrimp squat","bulgarian split squat","bodyweight squat","jump squat","box jump","step up","lunge","walking lunge","nordic curl","glute bridge","single leg glute bridge","sissy squat","natural leg curl","plank","side plank","hollow body","l-sit","v-sit","dragon flag","front lever","back lever","hanging leg raise","toes to bar","dead bug","mountain climber","burpee"]),_u=new Set(["squat","back squat","front squat","goblet squat","deadlift","conventional deadlift","sumo deadlift","romanian deadlift","rdl","bench press","incline bench","decline bench","floor press","overhead press","military press","push press","barbell row","pendlay row","t-bar row","lat pulldown","cable row","seated row","bicep curl","hammer curl","preacher curl","tricep extension","skull crusher","tricep pushdown","lateral raise","front raise","rear delt fly","leg press","leg extension","leg curl","calf raise","chest fly","cable crossover","pec deck"]);function Pu(t){const a=t.toLowerCase().trim();if(a.includes("weighted")||a.includes("zavorrat"))return"hybrid";const r=["pistol","shrimp","bulgarian","bodyweight","push-up","pushup","pull-up","pullup","chin-up","chinup","dips","plank","l-sit","hollow","nordic","inverted","muscle-up","muscleup","handstand","pike","hspu","dead bug","bird dog","dragon flag"];for(const s of r)if(a.includes(s))return"bodyweight";for(const s of _u)if(a===s||a.includes(s)||s.includes(a))return"weighted";for(const s of ju)if(a===s||a.includes(s)||s.includes(a))return"bodyweight";return"bodyweight"}function _o(t){return Pu(t)==="bodyweight"}const Po={beginner:3,intermediate:2,advanced:1},Ru={beginner:{heavy:{strength:3,hypertrophy:4,toning:4,fat_loss:4,endurance:4,sport_performance:3,wellness:4,motor_recovery:4,prenatal:4,postnatal:4,disability:4,default:4},moderate:{strength:3,hypertrophy:4,toning:4,fat_loss:4,endurance:4,sport_performance:3,wellness:4,motor_recovery:4,prenatal:4,postnatal:4,disability:4,default:4},volume:{strength:4,hypertrophy:4,toning:4,fat_loss:4,endurance:4,sport_performance:4,wellness:4,motor_recovery:4,prenatal:4,postnatal:4,disability:4,default:4}},intermediate:{heavy:{strength:2,hypertrophy:2,toning:3,fat_loss:3,endurance:3,sport_performance:2,wellness:3,motor_recovery:4,prenatal:4,postnatal:3,disability:4,default:2},moderate:{strength:2,hypertrophy:3,toning:3,fat_loss:3,endurance:3,sport_performance:2,wellness:3,motor_recovery:4,prenatal:4,postnatal:3,disability:4,default:3},volume:{strength:3,hypertrophy:3,toning:4,fat_loss:4,endurance:4,sport_performance:3,wellness:4,motor_recovery:4,prenatal:4,postnatal:4,disability:4,default:3}},advanced:{heavy:{strength:1,hypertrophy:1,toning:2,fat_loss:2,endurance:3,sport_performance:1,wellness:3,motor_recovery:3,prenatal:4,postnatal:3,disability:3,default:1},moderate:{strength:2,hypertrophy:2,toning:3,fat_loss:3,endurance:3,sport_performance:2,wellness:3,motor_recovery:4,prenatal:4,postnatal:3,disability:4,default:2},volume:{strength:3,hypertrophy:3,toning:3,fat_loss:4,endurance:4,sport_performance:3,wellness:4,motor_recovery:4,prenatal:4,postnatal:4,disability:4,default:3}}},ku={beginner:{strength:4,hypertrophy:4,toning:3,fat_loss:3,endurance:3,sport_performance:4,wellness:3,motor_recovery:2,prenatal:2,postnatal:3,disability:2,default:3},intermediate:{strength:5,hypertrophy:5,toning:4,fat_loss:4,endurance:4,sport_performance:5,wellness:3,motor_recovery:3,prenatal:2,postnatal:3,disability:2,default:4},advanced:{strength:6,hypertrophy:6,toning:4,fat_loss:4,endurance:4,sport_performance:6,wellness:4,motor_recovery:3,prenatal:3,postnatal:4,disability:3,default:5}};function Cu(t){const{level:a,goal:r,quizScore:s,practicalScore:i,discrepancyType:o,userAge:l,hasMedicalConditions:n}=t,c=Jr(r),u=Lc(r),d=[],p=[];let f="heavy",h=u.allowHeavyDays;if(a==="beginner"&&(f=u.maxIntensityBeginner,h=!1,p.push("Beginner: heavy days disabilitati per sicurezza")),u.category==="special"&&(f="volume",h=!1,p.push(`Goal ${c}: intensitÃ  limitata a volume`)),s!==void 0&&i!==void 0){const v=Math.abs(s-i);v>40||o==="major"?(f="volume",h=!1,d.push(`Discrepanza screening ${v}%: limitato a volume per sicurezza`)):(v>25||o==="minor")&&(f==="heavy"&&(f="moderate"),h=!1,d.push(`Discrepanza screening ${v}%: limitato a moderate`)),s<40?(f="volume",h=!1,d.push(`Quiz score ${s}/100: conoscenza teorica insufficiente`)):s<60&&(f==="heavy"&&(f="moderate"),d.push(`Quiz score ${s}/100: limita a moderate`))}l&&l>60&&(f==="heavy"&&(f="moderate"),d.push(`EtÃ  ${l}: cautela extra raccomandata`)),n&&(f="volume",h=!1,p.push("Condizioni mediche segnalate: limitato a volume"));const x=Po[a],g=ku[a],y=g[c]||g.default;return console.log(`[SafetyCaps] Context: level=${a}, goal=${c}`),console.log(`[SafetyCaps] Result: maxIntensity=${f}, allowHeavy=${h}, minRIR=${x}, maxSets=${y}`),d.length>0&&console.warn("[SafetyCaps] Warnings:",d),p.length>0&&console.warn("[SafetyCaps] Restrictions:",p),{maxAllowedIntensity:f,allowHeavyDays:h,minRIR:x,maxSets:y,warnings:d,restrictions:p}}function Eu(t,a){const r=["volume","moderate","heavy"],s=r.indexOf(t),i=r.indexOf(a);return s>i?(console.log(`[SafetyCap] Capped ${t} â†’ ${a}`),a):t}function Iu(t,a,r){const s=Jr(a),o=Ru[r][t],l=o[s]??o.default,n=Po[r],c=Math.max(l,n);return c!==l&&console.log(`[SafetyCaps] RIR adjusted: ${l} â†’ ${c} (min for ${r})`),c}const Ro=["superman","prone","floor pull","cobra","back extension","hyperextension","reverse hyper","prone y","prone i","prone t","prone w","seal row","lying leg curl","lying hamstring"],ko=["crunch","sit-up","situp","sit up","dead bug","leg raise","lying leg raise","bicycle crunch","v-up","v up","hollow","panca piana","bench press","floor press","dumbbell press","glute bridge","hip thrust"],Co=["jump","jumping","box jump","burpee","burpees","plyometric","plyo","bound","hop","skip","tuck jump","star jump","squat jump","lunge jump","broad jump","depth jump","drop jump"],Tu=["pistol","single leg squat","bulgarian split","walking lunge","step up"],Ds={Superman:"Bird Dog",superman:"Bird Dog","Prone Y-raise":"Standing Band Y-raise","prone y-raise":"Standing Band Y-raise","Prone Y Raise":"Standing Band Y-raise","Floor Pull":"Seated Cable Row","floor pull":"Seated Cable Row","Floor Pull (asciugamano)":"Seated Band Row","Back Extension":"Standing Hip Hinge","back extension":"Standing Hip Hinge",Cobra:"Cat-Cow (solo fase cow)",cobra:"Cat-Cow",Crunch:"Pallof Press",crunch:"Pallof Press","Sit-up":"Pallof Press","sit-up":"Pallof Press","Dead Bug":"Pallof Press Kneeling","dead bug":"Pallof Press Kneeling","Leg Raise":"Standing Knee Raise","leg raise":"Standing Knee Raise","Lying Leg Raise":"Standing Knee Raise","Bicycle Crunch":"Standing Oblique Crunch","bicycle crunch":"Standing Oblique Crunch","V-up":"Seated Knee Tuck","v-up":"Seated Knee Tuck","Hollow Hold":"Side Plank (modificato)","hollow hold":"Side Plank (modificato)","Panca Piana":"Incline Dumbbell Press 45Â°","panca piana":"Incline Dumbbell Press 45Â°","Bench Press":"Incline Dumbbell Press 45Â°","bench press":"Incline Dumbbell Press 45Â°","Floor Press":"Incline Push-up","floor press":"Incline Push-up","Glute Bridge":"Standing Kickback","glute bridge":"Standing Kickback","Hip Thrust":"Standing Hip Extension con banda","hip thrust":"Standing Hip Extension con banda","Jump Squat":"Goblet Squat","jump squat":"Goblet Squat","Squat Jump":"Goblet Squat","squat jump":"Goblet Squat","Box Jump":"Step Up (altezza bassa)","box jump":"Step Up (altezza bassa)",Burpees:"Squat to Press",burpees:"Squat to Press",Burpee:"Squat to Press",burpee:"Squat to Press","Jump Lunge":"Alternating Lunge","jump lunge":"Alternating Lunge","Tuck Jump":"Bodyweight Squat","tuck jump":"Bodyweight Squat","Star Jump":"Lateral Step Out","star jump":"Lateral Step Out","Broad Jump":"Walking Lunge","broad jump":"Walking Lunge","Back Squat":"Goblet Squat","back squat":"Goblet Squat","Front Squat":"Goblet Squat","front squat":"Goblet Squat",Deadlift:"Sumo Deadlift (leggero)",deadlift:"Sumo Deadlift (leggero)",Stacco:"Sumo Deadlift (leggero)",stacco:"Sumo Deadlift (leggero)","Romanian Deadlift":"Single Leg RDL (supportato)","romanian deadlift":"Single Leg RDL (supportato)","Stacco Rumeno":"Single Leg RDL (supportato)","stacco rumeno":"Single Leg RDL (supportato)","Good Morning":"Seated Good Morning (leggero)","good morning":"Seated Good Morning (leggero)","Barbell Row":"Seated Cable Row","barbell row":"Seated Cable Row","Pistol Squat":"Assisted Squat","pistol squat":"Assisted Squat","Bulgarian Split Squat":"Split Squat (supportato)","bulgarian split squat":"Split Squat (supportato)",Plank:"Wall Plank o Incline Plank",plank:"Wall Plank o Incline Plank","Ab Wheel":"Wall Press","ab wheel":"Wall Press",Rollout:"Wall Press",rollout:"Wall Press","L-Sit":"Seated Knee Raise","l-sit":"Seated Knee Raise"},Qi={core:"Pallof Press Kneeling",lower_push:"Goblet Squat",lower_pull:"Standing Hip Extension",horizontal_push:"Incline Push-up",horizontal_pull:"Seated Band Row",vertical_push:"Seated Dumbbell Press",vertical_pull:"Lat Pulldown"};function Nt(t){return t?["prenatal","pregnancy","pre_partum","pre-partum","prepartum","gravidanza","postnatal","post_partum","post-partum","postpartum"].includes(t.toLowerCase()):!1}function Au(t,a=2){const r=t.toLowerCase();for(const s of Co)if(r.includes(s.toLowerCase()))return!1;if(a>=2){for(const s of Ro)if(r.includes(s.toLowerCase()))return!1;for(const s of ko)if(r.includes(s.toLowerCase()))return!1;for(const s of Tu)if(r.includes(s.toLowerCase()))return!1}return!0}function Mu(t,a){if(Ds[t])return Ds[t];const r=t.toLowerCase();for(const[s,i]of Object.entries(Ds))if(s.toLowerCase()===r)return i;for(const[s,i]of Object.entries(Ds))if(r.includes(s.toLowerCase()))return i;return a&&Qi[a]?Qi[a]:"Wall Push-up"}function or(t,a,r,s=2){if(!Nt(r))return{name:t,wasReplaced:!1};if(Au(t,s))return{name:t,wasReplaced:!1};const i=Mu(t,a);let o="Esercizio adattato per gravidanza";const l=t.toLowerCase();return Ro.some(n=>l.includes(n))?o="Sostituito: posizione prona non sicura in gravidanza":ko.some(n=>l.includes(n))?o="Sostituito: posizione supina limitata dal 2 trimestre":Co.some(n=>l.includes(n))&&(o="Sostituito: esercizio ad impatto non sicuro"),console.log(`[PREGNANCY SAFETY] ${t} -> ${i} (${o})`),{name:i,wasReplaced:!0,reason:o}}const Lu={1:{maxIntensity:"moderate",maxRIR:3,maxFrequency:4,avoidProne:!1,avoidSupine:!1,notes:"Primo trimestre: possibile nausea e fatica. Ascolta il corpo."},2:{maxIntensity:"volume",maxRIR:4,maxFrequency:3,avoidProne:!0,avoidSupine:!0,notes:"Secondo trimestre: evitare posizioni prone e supine prolungate."},3:{maxIntensity:"volume",maxRIR:4,maxFrequency:3,avoidProne:!0,avoidSupine:!0,notes:"Terzo trimestre: focus su mobilita e preparazione al parto. ROM ridotto normale."}};function ui(t,a,r=2){if(!Nt(a))return t;const s=Lu[r].maxIntensity;return t==="heavy"?"moderate":t==="moderate"&&s==="volume"?"volume":t}const Du=["plank","plank laterale","side plank","plank con oscillazione","plank rocking","copenhagen plank","reverse plank","hollow body hold","hollow body","hollow hold","l-sit","l-sit raccolto","l-sit completo","l-sit a una gamba","dead hang","hang","appeso","active hang","wall sit","isometric squat","squat isometrico","pallof hold","bird dog hold","front lever","back lever","tuck lever","advanced tuck"];function zu(t){const a=t.toLowerCase();return Du.some(r=>a.includes(r))}function Ou(t,a="intermediate"){const r={beginner:{min:15,max:25},intermediate:{min:20,max:35},advanced:{min:30,max:45}},s=r[a]||r.intermediate,i=t*3;return`${Math.max(s.min,Math.min(s.max,i))}s`}const zs={"Shrimp Squat":"Squat Gamberetto","Skater Squat":"Squat del Pattinatore","Pistol Squat":"Squat a Pistola","Pistol Squat (Assisted)":"Squat a Pistola (Assistito)","Bulgarian Split Squat":"Squat Bulgaro","Split Squat":"Affondi Statici","Jump Squat":"Squat con Salto","Bodyweight Squat":"Squat a Corpo Libero","Air Squat":"Squat a Corpo Libero","Box Squat":"Squat al Box","Back Squat":"Squat con Bilanciere","Front Squat":"Squat Frontale","Goblet Squat":"Goblet Squat","Leg Press":"Pressa","Hack Squat":"Hack Squat","Smith Machine Squat":"Squat al Multipower","Leg Extension":"Leg Extension","Nordic Curl":"Nordic Curl","Nordic Hamstring Curl":"Nordic Curl","Nordic Curl (Eccentric Only)":"Nordic Curl (Solo Eccentrica)","Slider Leg Curl":"Leg Curl Scorrevole","Slider Leg Curl (Single Leg)":"Leg Curl Scorrevole Singolo","Sliding Leg Curl":"Leg Curl Scorrevole","Single Leg RDL":"Stacco Rumeno Monopodalico","Single Leg RDL (Bodyweight)":"Stacco Rumeno Monopodalico","Single Leg Glute Bridge":"Ponte Glutei Monopodalico","Glute Bridge":"Ponte Glutei","Hip Thrust":"Hip Thrust","Hip Thrust (Single Leg)":"Hip Thrust Monopodalico","Hip Thrust (Elevated)":"Hip Thrust Elevato","Conventional Deadlift":"Stacco da Terra",Deadlift:"Stacco da Terra","Romanian Deadlift (RDL)":"Romanian Deadlift","Romanian Deadlift":"Romanian Deadlift","Sumo Deadlift":"Stacco Sumo","Trap Bar Deadlift":"Stacco Trap Bar","Leg Curl (Machine)":"Leg Curl","Leg Curl":"Leg Curl","Bodyweight Hip Hinge":"Good Morning Bodyweight","Good Morning":"Good Morning","Standard Push-up":"Push-up Standard","Push-up":"Push-up","Diamond Push-up":"Push-up Diamante","Archer Push-up":"Push-up Arciere","One Arm Push-up":"Push-up a Un Braccio","Wide Push-up":"Push-up Larghi","Close Grip Push-up":"Push-up Stretti","Decline Push-up":"Push-up Declinati","Incline Push-up":"Push-up Inclinati","Deficit Push-up":"Push-up Deficit","Pseudo Planche Push-up":"Pseudo Planche Push-up","Ring Push-up":"Push-up agli Anelli","Typewriter Push-up":"Push-up Typewriter","Flat Barbell Bench Press":"Panca Piana","Barbell Bench Press":"Panca Piana","Bench Press":"Panca Piana","Incline Bench Press":"Panca Inclinata","Decline Bench Press":"Panca Declinata","Dumbbell Bench Press":"Panca con Manubri","Incline Dumbbell Press":"Panca Inclinata Manubri","Chest Press (Machine)":"Chest Press","Chest Press":"Chest Press","Cable Fly":"Croci ai Cavi",Dips:"Dips","Chest Dips":"Dips per Petto","Inverted Row":"Rematore Inverso","Inverted Row (tavolo)":"Rematore Inverso (tavolo)","Australian Pull-up":"Rematore Inverso","TRX Row":"TRX Row","Ring Row":"Row agli Anelli","Floor Pull":"Floor Pull","Floor Pull Facilitato":"Floor Pull Facilitato","Barbell Row":"Rematore con Bilanciere","Bent Over Row":"Rematore con Bilanciere","Dumbbell Row":"Rematore con Manubrio","One Arm Dumbbell Row":"Rematore con Manubrio","Cable Row":"Pulley Basso","Seated Cable Row":"Pulley Basso","T-Bar Row":"Rematore T-Bar","Machine Row":"Pulley Basso","Pike Push-up":"Pike Push-up","Elevated Pike Push-up":"Pike Push-up Elevato","Wall Handstand Push-up":"HSPU al Muro","Handstand Push-up":"Handstand Push-up","Wall Walk":"Camminata al Muro","Overhead Press":"Military Press","Barbell Overhead Press":"Military Press","Standing Barbell Press":"Military Press","Military Press":"Military Press","Dumbbell Shoulder Press":"Shoulder Press con Manubri","Seated Dumbbell Press":"Shoulder Press con Manubri","Arnold Press":"Arnold Press","Machine Shoulder Press":"Shoulder Press Macchina","Pull-up":"Trazioni","Chin-up":"Chin-up","Wide Grip Pull-up":"Trazioni Presa Larga","Close Grip Chin-up":"Trazioni Presa Stretta","Neutral Grip Pull-up":"Trazioni Presa Neutra","Assisted Pull-up":"Trazioni Assistite","Band Assisted Pull-up":"Trazioni con Elastico","Negative Pull-up":"Trazioni Negative","Archer Pull-up":"Trazioni Arciere","Lat Pulldown":"Lat Machine","Lat Pulldown Wide":"Lat Machine Presa Larga","Lat Pulldown Close":"Lat Machine Presa Stretta","Cable Pulldown":"Lat Machine",Plank:"Plank","Side Plank":"Plank Laterale","Hollow Body Hold":"Hollow Body Hold","L-sit":"L-sit","Tuck L-sit":"L-sit Raccolto","Dead Bug":"Dead Bug","Bird Dog":"Bird Dog","Dragon Flag":"Dragon Flag","Mountain Climber":"Mountain Climber","Pallof Press":"Pallof Press","Ab Wheel Rollout":"Ab Wheel","Ab Wheel":"Ab Wheel","Hanging Leg Raise":"Leg Raise alla Sbarra","Cable Crunch":"Crunch ai Cavi","Russian Twist":"Russian Twist","Bicycle Crunch":"Crunch Bicicletta","Reverse Crunch":"Crunch Inverso","Bicep Curl":"Curl con Manubri","Dumbbell Curl":"Curl con Manubri","Barbell Curl":"Curl con Bilanciere","Hammer Curl":"Hammer Curl","Tricep Extension":"French Press","Tricep Pushdown":"Tricep Pushdown","Skull Crusher":"French Press","Lateral Raise":"Alzate Laterali","Front Raise":"Alzate Frontali","Face Pull":"Face Pull","Calf Raise":"Calf Raise","Seated Calf Raise":"Calf Raise Seduto","Walking Lunge":"Affondi Camminati",Lunge:"Affondi","Reverse Lunge":"Affondi Indietro","Cable Crossover":"Croci ai Cavi","Band Pull Apart":"Band Pull Apart","Chest Fly":"Croci con Manubri","Reverse Fly":"Alzate Posteriori","Squat Jump":"Squat con Salto","Squat con Pausa":"Squat con Pausa","Hip Hinge a Corpo Libero":"Hip Hinge a Corpo Libero","Hip Thrust Rialzato":"Hip Thrust Rialzato","Nordic Curl (Solo Eccentrica)":"Nordic Curl (Solo Eccentrica)","Piegamenti Diamante":"Push-up Diamante","Alzate Gambe alla Sbarra":"Alzate Gambe alla Sbarra","Connection Breath":"Respiro Connesso","Diaphragmatic Breathing":"Respirazione Diaframmatica","Pelvic Floor Activation":"Attivazione Pavimento Pelvico","Deep Squat Hold":"Tenuta Squat Profondo","Happy Baby Stretch":"Allungamento Happy Baby","Pelvic Tilts":"Inclinazioni Pelviche","Bird Dog (Modified)":"Bird Dog (Modificato)","Dead Bug Heel Slides":"Dead Bug con Scivolamenti","Toe Taps":"Toe Taps","Supine Marching":"Marcia Supina","Dead Bug Progression":"Progressione Dead Bug","Pallof Press (Kneeling)":"Pallof Press (in Ginocchio)","Side Plank (Modified)":"Plank Laterale (Modificato)","Bear Hold":"Tenuta dell'Orso","Wall Sit with Breathing":"Muro con Respirazione","Seated Knee Lifts":"Alzate Ginocchia Seduto","Half Kneeling Chop":"Chop in Ginocchio","Wall Push-up":"Push-up al Muro","Seated Row (Band)":"Remata con Elastico","Standing Leg Curl":"Leg Curl in Piedi","Side Lying Leg Lift":"Alzate Gambe Laterali","Modified Squat":"Squat Modificato","Standing Hip Circles":"Cerchi dell'Anca","Shoulder Blade Squeeze":"Attivazione Scapolare","Standing March":"Marcia in Piedi","Dumbbell Squat":"Squat con Manubri","Dumbbell Deadlift":"Stacco con Manubri","Dumbbell RDL":"Stacco Rumeno con Manubri","Cable Pull Through":"Pull Through ai Cavi","Dumbbell Sumo Deadlift":"Stacco Sumo con Manubri","Wide Stance Leg Press":"Pressa Gambe Larghe","Sumo Squat":"Squat Sumo","Floor Press":"Floor Press","Floor Press con Manubri":"Floor Press con Manubri","Panca Inclinata con Manubri":"Panca Inclinata con Manubri","Landmine Press":"Landmine Press","Incline Chest Press (Macchina)":"Chest Press Inclinato","Low Cable Fly":"Croci ai Cavi (dal basso)","High Cable Fly":"Croci ai Cavi (dall'alto)","Decline Dumbbell Press":"Panca Declinata Manubri","Shoulder Press (Macchina)":"Shoulder Press Macchina","Close Grip Bench Press":"Panca Presa Stretta","Tricep Dips":"Dip Tricipiti","Narrow Push-up":"Push-up Stretti","Single Arm Dumbbell Press":"Panca Unilaterale","Dumbbell Push Press":"Push Press con Manubri","Lateral Raise + Press":"Alzate Laterali + Press","Cable Lateral Raise":"Alzate Laterali ai Cavi","Pike Push-up (elevato)":"Pike Push-up Elevato","Dumbbell Shoulder Press (pesante)":"Shoulder Press Pesante","Handstand Hold":"Verticale in Tenuta","Wide Grip Lat Pulldown":"Lat Machine Presa Larga","Standard Pull-up":"Trazioni","Straight Arm Pulldown":"Pulldown Braccia Tese","Supinated Lat Pulldown":"Lat Machine Presa Supina","Cable Curl + Pulldown":"Curl + Pulldown ai Cavi","Neutral Grip Lat Pulldown":"Lat Machine Presa Neutra","Seated Cable Row (presa alta)":"Pulley Presa Alta","Cable Pullover":"Pullover ai Cavi","Band Pull-up":"Trazioni con Elastico","Chest Supported Row":"Rematore su Panca","Band Row":"Rematore con Elastico","Landmine Row":"Rematore Landmine","Ab Wheel (in ginocchio)":"Ab Wheel (in Ginocchio)","Suitcase Carry":"Trasporto Laterale","Copenhagen Plank":"Copenhagen Plank","Captain Chair Leg Raise":"Alzate Gambe alla Captain Chair","Lying Leg Raise":"Alzate Gambe a Terra","Barbell Rollout":"Rollout con Bilanciere","Stability Ball Rollout":"Rollout con Palla","Machine Crunch":"Crunch alla Macchina","Weighted Crunch":"Crunch con Peso","Hanging Knee Raise":"Ginocchia al Petto alla Sbarra","Cable Rotation":"Rotazione ai Cavi","Curl con Bilanciere":"Curl con Bilanciere","Curl a Martello":"Curl a Martello","Dip Tricipiti":"Dip Tricipiti","Pushdown ai Cavi":"Pushdown ai Cavi","Calf Raise in Piedi":"Calf Raise in Piedi","One-Arm Push-up":"Push-up a Un Braccio","One-Arm Push-up (Assisted)":"Push-up a Un Braccio (Assistito)","Knee Push-up":"Push-up sulle Ginocchia","Freestanding Handstand Push-up":"Verticale Push-up Libero","Wall Handstand Push-up (Eccentric)":"HSPU al Muro (Solo Eccentrica)","Elevated Pike Push-up (High)":"Pike Push-up Alto","Pike Push-up (Knee)":"Pike Push-up sulle Ginocchia","Wall Shoulder Tap":"Shoulder Tap al Muro","Floor Pull Singolo Braccio":"Floor Pull a Un Braccio","Floor Pull (asciugamano)":"Floor Pull con Asciugamano","Inverted Row Facilitato":"Rematore Inverso Facilitato","Scapular Pull (a terra)":"Retrazione Scapolare a Terra","Inverted Row Singolo Braccio":"Rematore Inverso a Un Braccio","Inverted Row Piedi Elevati":"Rematore Inverso Piedi Elevati","Prone Y-raise":"Y-raise Prono","Alzate Gambe a Terra":"Alzate Gambe a Terra","Prone Y-T-W Raises":"Y-T-W Raises Prono","Prone Y Raise":"Y Raise Prono","Superman Pull":"Superman Pull","Superman Row":"Superman Row","Hip Thrust Bodyweight":"Hip Thrust a Corpo Libero","Nordic Curl (Parziale)":"Nordic Curl (Parziale)","Nordic Curl (Assistito)":"Nordic Curl (Assistito)","Nordic Curl (Completo)":"Nordic Curl (Completo)","Archer Row":"Archer Row","Pike Push-up Inclinato":"Pike Push-up Inclinato","Pike Push-up su Ginocchia":"Pike Push-up su Ginocchia","HSPU al Muro (ROM parziale)":"HSPU al Muro (ROM Parziale)","HSPU al Muro (Solo Eccentrica)":"HSPU al Muro (Solo Eccentrica)","Trazioni Assistite":"Trazioni Assistite","Inverted Row Piedi Elevati":"Rematore Inverso Piedi Elevati","Ponte Glutei Monopodalico":"Ponte Glutei Monopodalico"};function La(t){if(zs[t])return zs[t];const a=Object.keys(zs).find(r=>r.toLowerCase()===t.toLowerCase());return a?zs[a]:t}const Bu={lower_push:["squat","leg press","pressa","affondi","lunge","hack","extension"],lower_pull:["deadlift","stacco","rdl","romanian","leg curl","nordic","glute","hip thrust","ponte"],horizontal_push:["bench","panca","push-up","piegamenti","dip","floor press"],vertical_push:["overhead","military","shoulder","pike","handstand","lento avanti"],horizontal_pull:["row","rematore","seated row","cable row","bent over","trx row"],vertical_pull:["pull-up","chin-up","lat","pulldown","trazioni"],core:["plank","crunch","leg raise","hollow","ab","dead bug","pallof"]};function Fu(t){const a=t.toLowerCase();for(const[r,s]of Object.entries(Bu))if(s.some(i=>a.includes(i)))return r;return null}function $u(t,a){return t.map(r=>{if(r.weight)return r;if(_o(r.name)){const u=(typeof r.reps=="number"?r.reps:10)*4;return console.log(`  ðŸ‹ï¸ ${r.name}: bodyweight (TUT: ~${u}s per set)`),{...r,notes:r.notes?`${r.notes} | TUT: ${u}s/set`:`TUT: ${u}s/set`}}let s=r.pattern;if((!s||s==="corrective")&&(s=Fu(r.name)||void 0),!s)return r;const i=a[s];if(!(i!=null&&i.weight10RM)||i.weight10RM<=0)return r;let o=.7;if(r.intensity){const c=r.intensity.match(/(\d+)/);c&&(o=parseInt(c[1])/100)}const l=Math.round(i.weight10RM*o/2.5)*2.5;if(l<5)return r;let n=`Peso: ${l}kg (da 10RM: ${i.weight10RM}kg)`;return i.isEstimated&&(n+=` [STIMATO da ${i.estimatedFrom||"altro pattern"}]`),console.log(`  ðŸ’ª ${r.name}: ${l}kg (${s} 10RM: ${i.weight10RM}kg @ ${Math.round(o*100)}%)`),{...r,weight:`${l}kg`,notes:r.notes?`${r.notes} | ${n}`:n}})}const qu={lower_push:["heavy","moderate","volume"],lower_pull:["moderate","heavy","moderate"],horizontal_push:["heavy","moderate","volume"],vertical_push:["moderate","heavy","moderate"],vertical_pull:["moderate","volume","heavy"],horizontal_pull:["volume","moderate","heavy"],core:["volume","volume","volume"],corrective:["volume","volume","volume"]};function Ee(t,a,r,s="forza",i=3){if(t==="core"||t==="corrective")return"volume";const o=qu[t]||["moderate","moderate","moderate"],l=r%o.length;let n=o[l];if(i===2){const c=s.toLowerCase();["forza","strength"].includes(c)?n==="volume"&&(n="moderate"):["fat_loss","tonificazione","dimagrimento"].includes(c)&&n==="heavy"&&(n="moderate")}if(i>=4){const c=[...o,"moderate"];n=c[r%c.length]}return n}function Ye(t){const a={heavy:0,moderate:1,volume:2};return[...t].sort((r,s)=>{const i=r.dayType||"moderate",o=s.dayType||"moderate",l=(a[i]??1)-(a[o]??1);if(l!==0)return l;const n=["lower_push","lower_pull","horizontal_push","vertical_push"],c=n.includes(r.pattern),u=n.includes(s.pattern);return c&&!u?-1:!c&&u?1:0})}const Ji={lower_push:"lower",lower_pull:"lower",horizontal_push:"upper",vertical_push:"upper",vertical_pull:"upper",horizontal_pull:"upper",core:"core",corrective:"core"};function Hu(t){const a=t.pattern;if(a&&Ji[a])return Ji[a];const r=t.name.toLowerCase();return r.includes("squat")||r.includes("deadlift")||r.includes("stacco")||r.includes("leg")||r.includes("lunge")||r.includes("affondo")||r.includes("hip thrust")||r.includes("glute")||r.includes("calf")||r.includes("polpacci")?"lower":r.includes("plank")||r.includes("crunch")||r.includes("dead bug")||r.includes("bird dog")||r.includes("ab ")||r.includes("core")?"core":"upper"}function Eo(t){const a=typeof t=="number"?t:parseInt(String(t).split("-")[0]||"10");return a<=5?"strength":a<=12?"hypertrophy":"endurance"}function Wu(t,a=10,r=!1){const s=Eo(a),i=t==="upper"?"parte alta":"parte bassa";return r?s==="strength"?{sets:2,reps:5,percentage:0,note:`Riscaldamento ${i}: 2x5 variante facile`}:{sets:1,reps:6,percentage:0,note:`Attivazione ${i}: 1x6 controllato`}:s==="strength"?{sets:4,reps:4,percentage:60,ramp:[{reps:8,percentage:40},{reps:5,percentage:55},{reps:3,percentage:70},{reps:1,percentage:85}],note:`Rampa forza ${i}: 8@40%, 5@55%, 3@70%, 1@85%`}:s==="hypertrophy"?{sets:2,reps:6,percentage:60,note:`Riscaldamento ${i}`}:{sets:1,reps:8,percentage:50,note:`Attivazione ${i}`}}const Gu=["motor_recovery","prenatal","postnatal","disability"];function Uu(t,a){if(a&&Gu.includes(a))return console.log(`âš ï¸ Warmup automatico disabilitato per goal: ${a} (richiede valutazione specifica)`),t;const r=new Set;return t.map(s=>{const i=Hu(s);if(i==="core"||r.has(i))return s;r.add(i);const o=_o(s.name),l=Wu(i,s.reps,o),n=Eo(s.reps);return console.log(o?`ðŸ”¥ Warmup bodyweight ${i}: ${s.name} (${l.note})`:n==="strength"?`ðŸ”¥ Warmup FORZA ${i}: ${s.name} (rampa: 8@40%, 5@55%, 3@70%, 1@85%)`:n==="hypertrophy"?`ðŸ”¥ Warmup ${i}: ${s.name} (2x6 @ 60%)`:`ðŸ”¥ Warmup leggero ${i}: ${s.name} (1x8 @ 50%)`),{...s,warmup:l}})}const Vu=[["horizontal_push","horizontal_pull"],["vertical_push","vertical_pull"],["horizontal_push","vertical_pull"],["horizontal_push","core"],["vertical_push","core"],["horizontal_pull","core"],["vertical_pull","core"],["lower_push","horizontal_pull"],["lower_push","vertical_pull"],["lower_pull","horizontal_push"]];function Ku(t,a){const r=t.pattern,s=a.pattern;return r==="corrective"||s==="corrective"?!1:Vu.some(([i,o])=>r===i&&s===o||r===o&&s===i)}function Yu(t,a){const r=Math.min(typeof t.sets=="number"?t.sets:3,typeof a.sets=="number"?a.sets:3),s=sa(t.rest||"60s"),i=sa(a.rest||"60s"),o=(r-1)*s+(r-1)*i;return Math.round(o/60)}function Zu(t,a){const r=[...t];let s=0,i=0;const o=new Set;console.log(`
ðŸ’ª Applicazione superset per risparmiare ~${a} min`);const l=[];for(let n=0;n<r.length;n++)for(let c=n+1;c<r.length;c++)if(Ku(r[n],r[c])){const u=Yu(r[n],r[c]);l.push({i:n,j:c,timeSaved:u})}l.sort((n,c)=>c.timeSaved-n.timeSaved);for(const n of l){if(s>=a)break;if(o.has(n.i)||o.has(n.j))continue;const c=r[n.i],u=r[n.j],d=sa(c.rest||"60s"),p=sa(u.rest||"60s"),f=Math.round((d+p)/2),h=f>=60?`${Math.round(f/60)}min`:`${f}s`,x={pairedWith:u.name,pairedExerciseIndex:n.j,restAfterSuperset:h,timeSaved:n.timeSaved},g={pairedWith:c.name,pairedExerciseIndex:n.i,restAfterSuperset:h,timeSaved:n.timeSaved};r[n.i]={...c,superset:x},r[n.j]={...u,superset:g},o.add(n.i),o.add(n.j),s+=n.timeSaved,i++,console.log(`   ðŸ”— Superset: ${c.name} + ${u.name} (risparmio: ${n.timeSaved} min)`)}return console.log(`   âœ… Totale risparmiato: ${s} min con ${i} superset`),{exercises:r,totalTimeSaved:s,supersetsApplied:i}}function en(t){let i=0;const o=new Set;for(let n=0;n<t.length;n++){const c=t[n];if(c.superset&&o.has(n))continue;if(c.warmup)if(c.warmup.ramp){let f=0;for(const h of c.warmup.ramp){const x=h.reps*3;f+=x+45+20}i+=f+30}else{const f=c.warmup.sets,x=c.warmup.reps*3,g=f*x+(f-1)*45;i+=g+30}const u=typeof c.sets=="number"?c.sets:3,d=typeof c.reps=="number"?c.reps:10,p=Math.max(20,Math.min(d*3.5,60));if(c.superset){const f=c.superset.pairedExerciseIndex,h=t[f];if(h){typeof h.sets=="number"&&h.sets;const x=typeof h.reps=="number"?h.reps:10,g=Math.max(20,Math.min(x*3.5,60)),y=sa(c.superset.restAfterSuperset),v=u*(p+g+y);i+=v+30,o.add(f)}}else{const f=sa(c.rest||"60s"),h=u*p+(u-1)*f;i+=h+30}}return 5+Math.ceil(i/60)+3}function mi(t,a,r,s){const i=Jr(t);let o="none";return s==="intuitive_mover"&&(o="minor"),s==="theory_practice_gap"&&(o="major"),Cu({level:a,goal:i,quizScore:r,discrepancyType:o}).maxAllowedIntensity}function pi(t,a){return Eu(t,a)}function Xu(t){if(!t||t.length<=1)return"";const a={forza:"Forza",ipertrofia:"Ipertrofia",massa:"Massa",tonificazione:"Tonificazione",dimagrimento:"Dimagrimento",resistenza:"Resistenza",benessere:"Benessere",motor_recovery:"Recupero",gravidanza:"Gravidanza",disabilita:"DisabilitÃ ",prestazioni_sportive:"Sport"};if(t.length===2){const o=a[t[0]]||t[0],l=a[t[1]]||t[1];return`Distribuzione: ${o} (70%) + ${l} (30%)`}const r=a[t[0]]||t[0],s=a[t[1]]||t[1],i=a[t[2]]||t[2];return`Distribuzione: ${r} (40%) + ${s} (30%) + ${i} (30%)`}function Ja(t){let i=0;for(const n of t){const c=typeof n.sets=="number"?n.sets:3;let u,d=!1;if(typeof n.reps=="number")u=n.reps;else if(typeof n.reps=="string"){const x=n.reps.match(/(\d+)(?:-(\d+))?s/);if(x){d=!0;const g=parseInt(x[1]),y=x[2]?parseInt(x[2]):g;u=Math.round((g+y)/2)}else u=10}else u=10;if(n.warmup){if(n.warmup.ramp){let x=0;for(const g of n.warmup.ramp){const y=g.reps*3;x+=y+45+20}i+=x}else{const x=n.warmup.sets,y=n.warmup.reps*3,v=x*y+(x-1)*45;i+=v}i+=30}let p;d?p=u:p=Math.max(20,Math.min(u*3.5,60));const f=sa(n.rest||"60s"),h=c*p+(c-1)*f;i+=h+30}return 5+Math.ceil(i/60)+3}function sa(t){if(!t)return 60;if(t.includes("min")){const r=t.match(/(\d+)/);return r?parseInt(r[1])*60:120}const a=t.match(/(\d+)/);return a?parseInt(a[1]):60}function Io(t,a){return t*(36/(37-a))}function Qu(t,a){return a>=37?t*.5:t*((37-a)/36)}function To(t,a,r){if(!t||t<=0)return 0;const s=Io(t,10),i=a+r,o=Qu(s,i);return Math.round(o*2)/2}function Ao(t,a,r="intermediate"){return Iu(t,a,r)}function Mo(t){return t<=0?"Corpo libero":t%1===0?`${t}kg`:`${t.toFixed(1)}kg`}const Ju={glutei:["lower_push","lower_pull"],addome:["core"],petto:["horizontal_push"],dorso:["horizontal_pull","vertical_pull"],spalle:["vertical_push"],gambe:["lower_push","lower_pull"],braccia:["horizontal_push","horizontal_pull"],polpacci:[]},em={glutei:[{name:"Hip Thrust",sets:3,reps:"12-15"},{name:"Glute Bridge",sets:3,reps:"15-20"}],addome:[{name:"Plank",sets:3,reps:"30-60s"},{name:"Dead Bug",sets:3,reps:"12-15"}],petto:[{name:"Chest Fly",sets:3,reps:"12-15"},{name:"Cable Crossover",sets:3,reps:"12-15"}],dorso:[{name:"Face Pull",sets:3,reps:"15-20"},{name:"Band Pull Apart",sets:3,reps:"20-25"}],spalle:[{name:"Lateral Raise",sets:3,reps:"12-15"},{name:"Front Raise",sets:3,reps:"12-15"}],gambe:[{name:"Bulgarian Split Squat",sets:3,reps:"10-12"},{name:"Walking Lunge",sets:3,reps:"12-15"}],braccia:[{name:"Bicep Curl",sets:3,reps:"12-15"},{name:"Tricep Extension",sets:3,reps:"12-15"}],polpacci:[{name:"Calf Raise",sets:4,reps:"15-20"},{name:"Seated Calf Raise",sets:3,reps:"20-25"}]};function hi(t,a,r){if(!a||a==="")return;console.log(`Applicando focus muscolare: ${a} su ${t.dayName}`);const s=Ju[a]||[],i=em[a]||[];t.exercises.forEach(l=>{if(s.includes(l.pattern)){const n=l.sets;l.sets=Math.min(l.sets+1,5),console.log(`   Up ${l.name}: ${n} -> ${l.sets} sets (focus boost)`);const c=`Focus ${a}: volume aumentato`;l.notes=l.notes?`${l.notes} | ${c}`:c}}),i.slice(0,2).forEach(l=>{const n={pattern:"accessory",name:l.name,sets:l.sets,reps:l.reps,rest:"60s",intensity:"60-70%",notes:`Isolamento ${a} (focus muscolare)`};t.exercises.push(n),console.log(`   + Aggiunto: ${l.name} (${l.sets}x${l.reps})`)}),t.exercises.sort((l,n)=>{const c=s.includes(l.pattern),u=s.includes(n.pattern);return c&&!u?-1:!c&&u?1:0}),console.log(`   Done Focus ${a} applicato: ${t.exercises.length} esercizi totali`)}function tm(t){const{baselines:a,level:r,goal:s,location:i,trainingType:o,painAreas:l}=t,n=[{dayNumber:1,dayName:"Giorno 1 - Full Body A (Focus Squat)",focus:"Gambe Dominanti + Panca + Tirate Verticali",exercises:[]},{dayNumber:2,dayName:"Giorno 2 - Full Body B (Focus Stacco)",focus:"Stacco Dominante + Spalle + Panca Variante",exercises:[]},{dayNumber:3,dayName:"Giorno 3 - Full Body C (Bilanciato)",focus:"Squat Variante + Tirate Variante + Panca",exercises:[]}];n[0].exercises=Ye([ce("lower_push",a.lower_push,0,t,Ee("lower_push",0,0,s,3)),ce("lower_pull",a.lower_pull,0,t,Ee("lower_pull",1,0,s,3)),ce("horizontal_push",a.horizontal_push,0,t,Ee("horizontal_push",2,0,s,3)),es(0,t,Ee("horizontal_pull",3,0,s,3),a.vertical_pull),ce("vertical_push",a.vertical_push,0,t,Ee("vertical_push",4,0,s,3)),ce("vertical_pull",a.vertical_pull,0,t,Ee("vertical_pull",5,0,s,3)),ce("core",a.core,0,t,Ee("core",6,0,s,3))]),n[1].exercises=Ye([ce("lower_push",a.lower_push,1,t,Ee("lower_push",0,1,s,3)),ce("lower_pull",a.lower_pull,1,t,Ee("lower_pull",1,1,s,3)),ce("horizontal_push",a.horizontal_push,1,t,Ee("horizontal_push",2,1,s,3)),es(1,t,Ee("horizontal_pull",3,1,s,3),a.vertical_pull),ce("vertical_push",a.vertical_push,1,t,Ee("vertical_push",4,1,s,3)),ce("vertical_pull",a.vertical_pull,1,t,Ee("vertical_pull",5,1,s,3)),ce("core",a.core,1,t,Ee("core",6,1,s,3))]),n[2].exercises=Ye([ce("lower_push",a.lower_push,2,t,Ee("lower_push",0,2,s,3)),ce("lower_pull",a.lower_pull,2,t,Ee("lower_pull",1,2,s,3)),ce("horizontal_push",a.horizontal_push,2,t,Ee("horizontal_push",2,2,s,3)),es(2,t,Ee("horizontal_pull",3,2,s,3),a.vertical_pull),ce("vertical_push",a.vertical_push,2,t,Ee("vertical_push",4,2,s,3)),ce("vertical_pull",a.vertical_pull,2,t,Ee("vertical_pull",5,2,s,3)),ce("core",a.core,2,t,Ee("core",6,2,s,3))]);const c=gi(l,s);return n.forEach(u=>u.exercises.push(...c)),n.forEach(u=>{u.exercises=u.exercises.filter(d=>d&&d.name&&d.pattern)}),t.muscularFocus&&n.forEach(u=>hi(u,t.muscularFocus)),{splitName:"Full Body 3x Settimana",description:"Allenamento total body con varianti diverse ogni sessione. Ottimale per frequenza 3x/settimana.",days:n}}function am(t){const{baselines:a,level:r,goal:s,location:i,trainingType:o,painAreas:l}=t,n=[{dayNumber:1,dayName:"Giorno 1 - Upper A",focus:"Panca + Tirate + Spalle + Core",exercises:[]},{dayNumber:2,dayName:"Giorno 2 - Gambe A",focus:"Squat + Stacco + Core",exercises:[]},{dayNumber:3,dayName:"Giorno 3 - Upper B",focus:"Spalle + Panca Variante + Tirate Variante",exercises:[]},{dayNumber:4,dayName:"Giorno 4 - Gambe B",focus:"Stacco Variante + Squat Variante + Core",exercises:[]}];n[0].exercises=Ye([ce("horizontal_push",a.horizontal_push,0,t,"heavy"),ce("vertical_pull",a.vertical_pull,0,t,"moderate"),ce("vertical_push",a.vertical_push,0,t,"volume"),ce("core",a.core,0,t,"volume")]),n[1].exercises=Ye([ce("lower_push",a.lower_push,0,t,"heavy"),ce("lower_pull",a.lower_pull,0,t,"moderate"),ce("core",a.core,1,t,"volume")]),n[2].exercises=Ye([ce("vertical_push",a.vertical_push,1,t,"heavy"),ce("horizontal_push",a.horizontal_push,1,t,"moderate"),ce("vertical_pull",a.vertical_pull,1,t,"volume"),ce("core",a.core,2,t,"volume")]),n[3].exercises=Ye([ce("lower_pull",a.lower_pull,1,t,"heavy"),ce("lower_push",a.lower_push,1,t,"moderate"),ce("core",a.core,3,t,"volume")]);const c=gi(l,s);return n.forEach(u=>u.exercises.push(...c)),n.forEach(u=>{u.exercises=u.exercises.filter(d=>d&&d.name&&d.pattern)}),t.muscularFocus&&n.forEach(u=>hi(u,t.muscularFocus)),{splitName:"Upper/Lower 4x Settimana",description:"Split Upper/Lower classico. Maggior volume per gruppo muscolare, ideale per ipertrofia e forza.",days:n}}function sm(t){const{baselines:a,level:r,goal:s,location:i,trainingType:o,painAreas:l}=t,n=[{dayNumber:1,dayName:"Giorno 1 - Push A",focus:"Panca + Spalle + Tricipiti + Core",exercises:[]},{dayNumber:2,dayName:"Giorno 2 - Pull A",focus:"Tirate + Rematore + Bicipiti + Core",exercises:[]},{dayNumber:3,dayName:"Giorno 3 - Gambe A",focus:"Squat + Stacco + Polpacci + Core",exercises:[]},{dayNumber:4,dayName:"Giorno 4 - Push B",focus:"Spalle + Panca Variante + Tricipiti",exercises:[]},{dayNumber:5,dayName:"Giorno 5 - Pull B",focus:"Rematore + Tirate Variante + Bicipiti",exercises:[]},{dayNumber:6,dayName:"Giorno 6 - Gambe B",focus:"Stacco Variante + Squat Variante + Polpacci",exercises:[]}];n[0].exercises=Ye([ce("horizontal_push",a.horizontal_push,0,t,"heavy"),ce("vertical_push",a.vertical_push,0,t,"moderate"),_a("triceps",0,t,"volume"),ce("core",a.core,0,t,"volume")]),n[1].exercises=Ye([ce("vertical_pull",a.vertical_pull,0,t,"heavy"),es(0,t,"moderate",a.vertical_pull),_a("biceps",0,t,"volume"),ce("core",a.core,1,t,"volume")]),n[2].exercises=Ye([ce("lower_push",a.lower_push,0,t,"heavy"),ce("lower_pull",a.lower_pull,0,t,"moderate"),_a("calves",0,t,"volume"),ce("core",a.core,2,t,"volume")]),n[3].exercises=Ye([ce("vertical_push",a.vertical_push,1,t,"heavy"),ce("horizontal_push",a.horizontal_push,1,t,"moderate"),_a("triceps",1,t,"volume")]),n[4].exercises=Ye([es(1,t,"heavy",a.vertical_pull),ce("vertical_pull",a.vertical_pull,1,t,"moderate"),_a("biceps",1,t,"volume")]),n[5].exercises=Ye([ce("lower_pull",a.lower_pull,1,t,"heavy"),ce("lower_push",a.lower_push,1,t,"moderate"),_a("calves",1,t,"volume")]);const c=gi(l,s);return n.forEach(u=>u.exercises.push(...c)),n.forEach(u=>{u.exercises=u.exercises.filter(d=>d&&d.name&&d.pattern)}),t.muscularFocus&&n.forEach(u=>hi(u,t.muscularFocus)),{splitName:"Push/Pull/Gambe 6x Settimana",description:"Split PPL avanzato con massimo volume e frequenza. Ogni gruppo muscolare allenato 2x/settimana.",days:n}}function ce(t,a,r,s,i="moderate"){const{level:o,goal:l,location:n,trainingType:c,painAreas:u,quizScore:d,discrepancyType:p}=s;let f=i;Nt(l)&&(f=ui(i,l),f!==i&&console.log(`[PREGNANCY] Intensity cap applied: ${i} -> ${f}`));const h=mi(l,o,d,p),x=pi(f,h);if(!a)return{pattern:t,name:`${t} (No Baseline)`,sets:3,reps:10,rest:"90s",intensity:"70%",dayType:x,notes:"Esercizio non testato nello screening"};const g=a.reps,y=n==="gym"?"gym":"bodyweight",v=La(a.variantName);let S,P="",N=!1;if(y==="bodyweight"){const X=Dc(t,a.difficulty,g,r)||v;if(x==="heavy"){const ee=jo(X,t,"home");ee?(S=ee.name,N=!0,P=`DUP Heavy: ${X} â†’ ${ee.name}`,console.log(`â¬†ï¸ DUP Bodyweight Heavy: ${X} â†’ ${ee.name}`)):(S=X,P="DUP Heavy: Variante max - Focus intensitÃ ",console.log(`âš ï¸ DUP Bodyweight Heavy: ${X} giÃ  al max`))}else x==="volume"?(S=X,P="DUP Volume: Accumulo sulla variante base",console.log(`ðŸ“Š DUP Bodyweight Volume: ${X} (base)`)):(S=X,P="DUP Moderate: Consolidamento tecnico",console.log(`âš–ï¸ DUP Bodyweight Moderate: ${X} (base)`))}else S=r===0?v:zc(t,v,r,y);const I=Do(g,l,o,n,x);let T=I.sets,M=I.reps;N&&typeof M=="number"&&(M=Math.max(5,Math.round(M*.6)),console.log(`ðŸ“‰ Reps ridotte per upgrade: ${I.reps} â†’ ${M}`));let D="",E=!1;for(const X of u){const ee=X.area,pe=X.severity;if(hu(S,ee)){console.log(`âš ï¸ Dolore ${ee} (${pe}): ${S}`);const ie=pu(pe,T,M,n);if(T=ie.sets,M=ie.reps,D=ie.note,ie.needsReplacement){const ye=Ki(S,ee,pe);console.log(`  ðŸ”„ Sostituzione (${pe}): ${S} â†’ ${ye}`),S=ye,E=!0,D=`${D} | Sostituito con ${ye}`}else if(ie.needsEasierVariant){const ye=Ki(S,ee,pe);console.log(`  ðŸ“‰ Variante ridotta (${pe}): ${S} â†’ ${ye}`),S=ye,E=!0,D=`${D} | Variante ridotta: ${ye}`}else console.log(`  ðŸ“Š Deload (${pe}): ${T}x${M}, carico -${Math.round((1-ie.loadReduction)*100)}%`);break}}let U="";if(n==="gym"&&c==="machines"){const X=S;S=nr(S),S!==X&&(U=`Macchina: ${X} -> ${S}`)}let W="";if(Nt(l)){const X=or(S,t,l);X.wasReplaced&&(S=X.name,W=X.reason||"Adattato per gravidanza",E=!0,console.log(`[PREGNANCY] Exercise replaced: ${S} -> ${X.name}`))}let C="",G="";if(a.weight10RM&&a.weight10RM>0&&n==="gym"){const X=Ao(x,l,o),ee=typeof M=="number"?M:8,pe=ee+X,ie=To(a.weight10RM,ee,X);C=Mo(ie),G=`RIR ${X}`;const ye=Io(a.weight10RM,10);console.log(`Weight: ${S}: ${C} (${ee} reps @ RIR ${X} = ${pe}RM) [${o}]`),console.log(`   -> 10RM: ${a.weight10RM}kg -> 1RM stimato: ${Math.round(ye)}kg`)}const H=La(S),Y=zu(H)||t==="core",oe=Y&&typeof M=="number"?Ou(M,o):M;return{pattern:t,name:H,sets:T,reps:oe,rest:I.rest,intensity:I.intensity,dayType:x,weight:C||void 0,baseline:{variantId:a.variantId,difficulty:a.difficulty,maxReps:g},wasReplaced:E,notes:[W,I.notes,P,Y?"Isometrico: mantieni la posizione":`Baseline: ${g} reps @ diff. ${a.difficulty}/10`,C?`Carico: ${C} (${G})`:"",D,U].filter(Boolean).join(" | ")}}function es(t,a,r="moderate",s){const{level:i,goal:o,location:l,trainingType:n,quizScore:c,discrepancyType:u}=a;let d=r;Nt(o)&&(d=ui(r,o));const p=mi(o,i,c,u),f=pi(d,p),h=l==="gym"?"gym":"bodyweight",x=Qr.filter(T=>T.equipment===h||T.equipment==="both");let y=x[t%x.length].name;const v=(s==null?void 0:s.reps)||12,S=Do(v,o,i,l,f);l==="gym"&&n==="machines"&&(y=nr(y));let P="",N="";if(s!=null&&s.weight10RM&&s.weight10RM>0&&l==="gym"){const T=Ao(f,o,i),M=typeof S.reps=="number"?S.reps:8,D=To(s.weight10RM,M,T);P=Mo(D),N=`RIR ${T}`,console.log(`Weight: ${y}: ${P} (${M} reps @ RIR ${T}) [${i}] - stimato da vertical pull`)}let I="";if(Nt(o)){const T=or(y,"horizontal_pull",o);T.wasReplaced&&(y=T.name,I=T.reason||"Adattato per gravidanza")}return{pattern:"horizontal_pull",name:La(y),sets:S.sets,reps:S.reps,rest:S.rest,intensity:S.intensity,dayType:f,weight:P||void 0,baseline:s?{variantId:"estimated_from_vertical_pull",difficulty:s.difficulty||5,maxReps:v}:void 0,notes:[I,"Row pattern - complementare al vertical pull",P?`Carico: ${P} (${N}) - stimato`:"",s?`Baseline: ${v} reps (stimato da lat pulldown)`:""].filter(Boolean).join(" | ")}}function _a(t,a,r,s="moderate"){const{level:i,goal:o,location:l,trainingType:n,quizScore:c,discrepancyType:u}=r;let d=s;Nt(o)&&(d=ui(s,o));const p=mi(o,i,c,u),f=pi(d,p),h=l==="gym"?"gym":"bodyweight",x=Oc[t].filter(N=>N.equipment===h||N.equipment==="both");if(x.length===0)return{pattern:"core",name:`${t} exercise`,sets:3,reps:12,rest:"60s",intensity:"70%",dayType:f,notes:`Accessorio ${t}`};let y=x[a%x.length].name;const v=i==="advanced"?4:3,S=t==="calves"?15:12;l==="gym"&&n==="machines"&&(y=nr(y));let P="";if(Nt(o)){const N=or(y,"accessory",o);N.wasReplaced&&(y=N.name,P=N.reason||"Adattato per gravidanza")}return{pattern:"core",name:La(y),sets:v,reps:S,rest:"60s",intensity:"70%",dayType:f,notes:[P,`Accessorio ${t}`].filter(Boolean).join(" | ")}}function gi(t,a){const r=[];for(const s of t){const i=s.area,o=gu(i);for(const l of o){let n=l,c="";if(a&&Nt(a)){const u=or(l,"corrective",a);u.wasReplaced&&(n=u.name,c=u.reason||"Adattato per gravidanza")}r.push({pattern:"corrective",name:La(n),sets:2,reps:"10-15",rest:"30s",intensity:"Low",notes:[c,`Correttivo per ${i} - Focus sulla qualitÃ `].filter(Boolean).join(" | ")})}}return r}function rm(t,a,r){let s=[...t],i=Ja(s),o=!1;if(i<=a)return{exercises:s};console.log(`âš ï¸ Workout troppo lungo: ${i}min > ${a}min target`),console.log(`ðŸŽ¯ Goal: ${r||"non specificato"}`);const l=i-a;console.log(`
ðŸ”— STEP 0: Provo superset per risparmiare ${l} min`);const n=Zu(s,l);if(n.totalTimeSaved>0&&(s=n.exercises,i=en(s),o=!0,console.log(`   Durata dopo superset: ${i}min`),i<=a))return{exercises:s,usedSupersets:!0,warning:`â±ï¸ WORKOUT OTTIMIZZATO: Ho creato ${n.supersetsApplied} superset per entrare nei ${a} minuti. Il volume Ã¨ invariato - stesso numero di serie ed esercizi, solo organizzazione piÃ¹ efficiente.`};const c=["squat","deadlift","bench","row","pullup","dip","press"];function u(h){var S,P;if(!r)return!0;const x=typeof h.reps=="number"?h.reps:parseInt(String(h.reps).split("-")[0]||"10"),g=((S=h.rest)==null?void 0:S.toLowerCase())||"",y=((P=h.intensity)==null?void 0:P.toLowerCase())||"";let v=60;if(g.includes("min")){const N=g.match(/(\d+)/);N&&(v=parseInt(N[1])*60)}else{const N=g.match(/(\d+)/);N&&(v=parseInt(N[1]))}return r==="forza"||r==="strength"?x<=6||v>=120||y.includes("85")||y.includes("90"):r==="massa"||r==="ipertrofia"||r==="hypertrophy"?x>=8&&x<=15&&v>=60&&v<=120:r==="tonificazione"||r==="dimagrimento"||r==="resistenza"||r==="endurance"?x>=12||v<=60:!0}function d(h){const x=c.some(y=>{var v;return(v=h.pattern)==null?void 0:v.toLowerCase().includes(y)}),g=u(h);return x&&g?0:x&&!g?1:!x&&g?2:3}const p=h=>o?en(h):Ja(h);for(console.log(`
ðŸ” STEP 1: Rimozione esercizi NON allineati con goal`);i>a&&s.length>3;){let h=-1,x=-1;for(let g=s.length-1;g>=0;g--){const y=d(s[g]);y>x&&(x=y,h=g)}if(h!==-1&&x===3)console.log(`   âœ‚ï¸ Rimosso (non-goal): ${s[h].name}`),s.splice(h,1),i=p(s);else break}if(i<=a)return console.log(`   âœ… Target raggiunto: ${i}min`),{exercises:s,warning:`âš ï¸ WORKOUT ADATTATO: Con ${a} minuti disponibili, gli esercizi non allineati con l'obiettivo "${r}" sono stati rimossi.`};if(console.log(`
ðŸ”§ STEP 2: Riduzione sets esercizi NON goal-aligned`),s=s.map(h=>d(h)>=1&&typeof h.sets=="number"&&h.sets>2?(console.log(`   ðŸ“‰ Ridotto: ${h.name} (${h.sets} â†’ ${h.sets-1} sets)`),{...h,sets:h.sets-1}):h),i=p(s),i<=a)return console.log(`   âœ… Target raggiunto: ${i}min`),{exercises:s,usedSupersets:o,warning:`âš ï¸ WORKOUT ADATTATO: Con ${a} minuti disponibili, alcuni esercizi/serie non allineati con l'obiettivo "${r}" sono stati ridotti.${o?" Superset applicati per ottimizzare il tempo.":""}`};for(console.log(`
âœ‚ï¸ STEP 3: Rimozione esercizi accessori goal-aligned`);i>a&&s.length>2;){let h=-1;for(let x=s.length-1;x>=0;x--)if(!c.some(y=>{var v;return(v=s[x].pattern)==null?void 0:v.toLowerCase().includes(y)})){h=x;break}if(h!==-1)console.log(`   âœ‚ï¸ Rimosso (accessorio): ${s[h].name}`),s.splice(h,1),i=p(s);else break}if(i<=a)return console.log(`   âœ… Target raggiunto: ${i}min`),{exercises:s,usedSupersets:o,warning:`âš ï¸ WORKOUT ADATTATO: Con ${a} minuti disponibili, alcuni esercizi accessori sono stati rimossi. Focus mantenuto su "${r}".${o?" Superset applicati.":""}`};console.log(`
âš ï¸ STEP 4: Riduzione sets esercizi GOAL PRINCIPALI (ultimo resort)`),s=s.map(h=>typeof h.sets=="number"&&h.sets>2?(console.log(`   ðŸ“‰ Ridotto (goal exercise): ${h.name} (${h.sets} â†’ ${h.sets-1} sets)`),{...h,sets:h.sets-1}):h),i=p(s),console.log(`   âœ… Durata finale: ${i}min`);const f=`âš ï¸ WORKOUT FORTEMENTE ADATTATO: Con ${a} minuti disponibili, anche gli esercizi principali per "${r}" sono stati ridotti.${o?" Nonostante i superset applicati,":""} L'efficacia del programma sarÃ  significativamente inferiore. RACCOMANDAZIONE: aumenta il tempo disponibile (almeno ${Math.ceil(Ja(t)*.8)} minuti) o riduci la frequenza settimanale.`;return{exercises:s,usedSupersets:o,warning:f}}function im(t){const{frequency:a,goals:r,location:s,baselines:i,userBodyweight:o,equipment:l,trainingType:n}=t;console.log(`Generazione split settimanale per ${a}x/settimana`),r&&r.length>1&&(console.log(`Multi-goal detected: ${r.join(", ")}`),console.log(`Volume distribution: ${r.length===2?"70-30":"40-30-30"}`));let c;a<=3?c=tm(t):a===4?c=am(t):c=sm(t);const u=Xu(r||[]);if(u&&(c.description=`${c.description}

${u}`),s==="home"||s==="home_gym"){console.log(`
ðŸ  Adattamento esercizi per ${s.toUpperCase()} (${n})`),console.log(`  ðŸ“¦ Equipment: pullupBar=${l==null?void 0:l.pullupBar}, sturdyTable=${l==null?void 0:l.sturdyTable}`);const p={},f={};i&&Object.entries(i).forEach(([g,y])=>{y&&(y.weight10RM&&(p[g]=y.weight10RM),y.testDate&&(f[g]=y.testDate))});const h=n==="bodyweight"?"bodyweight":"with_equipment",x=l?{barbell:l.barbell||!1,dumbbellMaxKg:l.dumbbellMaxKg||0,bands:l.loopBands||!1,pullupBar:l.pullupBar||!1,bench:l.bench||!1,sturdyTable:l.sturdyTable||!1,loopBands:l.loopBands||!1,noEquipment:l.noEquipment||!1}:void 0;c.days.forEach(g=>{const y=g.exercises.map(v=>v.name);g.exercises=yo(g.exercises,{location:"home",homeType:h,equipment:x,realLoads:p,testDates:f,userBodyweight:o}),g.exercises.forEach((v,S)=>{v.name!==y[S]&&console.log(`  ðŸ“ ${y[S]} â†’ ${v.name}`)}),g.exercises=g.exercises.map(v=>({...v,name:La(v.name)}))})}if(console.log(`
ðŸ”¥ Applicazione riscaldamento specifico per zona`),c.days.forEach(p=>{p.exercises=Uu(p.exercises,t.goal)}),c.days.forEach(p=>{const f=Ja(p.exercises);p.estimatedDuration=f,console.log(`Time: ${p.dayName}: ~${f} min (warmup incluso)`)}),t.sessionDuration){console.log(`
â±ï¸ Adattamento al tempo disponibile: ${t.sessionDuration} minuti`);let p;c.days.forEach(f=>{if(f.estimatedDuration&&f.estimatedDuration>t.sessionDuration){console.log(`
${f.dayName}: ${f.estimatedDuration}min > ${t.sessionDuration}min`);const h=rm(f.exercises,t.sessionDuration,t.goal);f.exercises=h.exercises,f.estimatedDuration=Ja(h.exercises),h.warning&&!p&&(p=h.warning),console.log(`âœ… ${f.dayName} adattato: nuova durata ${f.estimatedDuration}min`)}}),p&&(c.description=`${c.description}

${p}`)}const d=Math.round(c.days.reduce((p,f)=>p+(f.estimatedDuration||0),0)/c.days.length);return c.averageDuration=d,console.log(`Average workout duration: ~${d} min`),i&&(console.log(`
ðŸ’ª Calcolo pesi da patternBaselines...`),c.days.forEach(p=>{p.exercises=$u(p.exercises,i)})),c}const F={walkRun:(t,a,r)=>{const s=[];for(let i=0;i<r;i++)s.push({type:"easy",duration:a,hrZone:"zone2",notes:"Corsa leggera"}),i<r-1&&s.push({type:"walk",duration:t,hrZone:"zone1",notes:"Cammina recupero"});return s},continuousZ2:t=>[{type:"zone2",duration:t,hrZone:"zone2",pace:"conversational",notes:"Mantieni ritmo parlabile"}],tempo:(t,a,r)=>[{type:"easy",duration:t,hrZone:"zone2",notes:"Riscaldamento"},{type:"tempo",duration:a,hrZone:"zone3",notes:"Ritmo sostenuto ma controllato"},{type:"easy",duration:r,hrZone:"zone1",notes:"Defaticamento"}],intervals:(t,a,r,s,i)=>{const o=[{type:"easy",duration:t,hrZone:"zone2",notes:"Riscaldamento"}];for(let l=0;l<s;l++)o.push({type:"interval",duration:a,hrZone:"zone4",notes:`Intervallo ${l+1}/${s}`}),l<s-1&&o.push({type:"walk",duration:r,hrZone:"zone1",notes:"Recupero"});return o.push({type:"easy",duration:i,hrZone:"zone1",notes:"Defaticamento"}),o}};function Lo(){return`run_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function $(t,a,r,s,i,o){const l=r.reduce((n,c)=>n+c.duration,0);return{id:Lo(),name:t,type:a,totalDuration:l,mainSet:r,targetHRZone:s,rpe:i,notes:o}}function nm(){return[{weekNumber:1,theme:"Introduzione al Movimento",totalVolume:45,isDeloadWeek:!1,progressIndicators:["Completare tutte le sessioni","Nessun dolore articolare"],sessions:[$("Walk/Run A","intervals",F.walkRun(2,1,5),"zone2",3,"Cammina 2min, corri 1min x5"),$("Walk/Run B","intervals",F.walkRun(2,1,5),"zone2",3,"Cammina 2min, corri 1min x5"),$("Walk/Run C","intervals",F.walkRun(2,1,6),"zone2",4,"Cammina 2min, corri 1min x6")]},{weekNumber:2,theme:"Aumenta la Corsa",totalVolume:50,isDeloadWeek:!1,progressIndicators:["Recupero piÃ¹ veloce tra intervalli","Respirazione piÃ¹ facile"],sessions:[$("Walk/Run A","intervals",F.walkRun(2,1.5,5),"zone2",4,"Cammina 2min, corri 1.5min x5"),$("Walk/Run B","intervals",F.walkRun(2,1.5,6),"zone2",4,"Cammina 2min, corri 1.5min x6"),$("Walk/Run C","intervals",F.walkRun(1.5,2,5),"zone2",4,"Cammina 1.5min, corri 2min x5")]},{weekNumber:3,theme:"Intervalli PiÃ¹ Lunghi",totalVolume:55,isDeloadWeek:!1,progressIndicators:["FC piÃ¹ bassa a paritÃ  di sforzo","Meno affanno"],sessions:[$("Walk/Run A","intervals",F.walkRun(1.5,2,6),"zone2",4,"Cammina 1.5min, corri 2min x6"),$("Walk/Run B","intervals",F.walkRun(1,2.5,5),"zone2",5,"Cammina 1min, corri 2.5min x5"),$("Walk/Run C","intervals",F.walkRun(1,3,5),"zone2",5,"Cammina 1min, corri 3min x5")]},{weekNumber:4,theme:"Settimana di Scarico",totalVolume:45,isDeloadWeek:!0,progressIndicators:["Recupero completo","Energie ritrovate"],sessions:[$("Recovery Run","intervals",F.walkRun(1.5,2,5),"zone2",3,"Sessione leggera"),$("Easy Walk/Run","intervals",F.walkRun(1,2,5),"zone2",3,"Mantieni intensitÃ  bassa")]},{weekNumber:5,theme:"Corsa Continua",totalVolume:50,isDeloadWeek:!1,progressIndicators:["Prima corsa continua di 5min","Test della conversazione superato"],sessions:[$("Walk/Run A","intervals",F.walkRun(1,3,5),"zone2",5,"Cammina 1min, corri 3min x5"),$("Continuous 5min","continuous",F.continuousZ2(5),"zone2",5,"Prima corsa continua!"),$("Walk/Run B","intervals",F.walkRun(1,4,4),"zone2",5,"Cammina 1min, corri 4min x4")]},{weekNumber:6,theme:"Aumenta la Durata",totalVolume:55,isDeloadWeek:!1,progressIndicators:["Corsa continua di 8-10min","Ritmo piÃ¹ stabile"],sessions:[$("Continuous 8min","continuous",F.continuousZ2(8),"zone2",5,"Corsa continua 8min"),$("Walk/Run","intervals",F.walkRun(1,5,4),"zone2",5,"Cammina 1min, corri 5min x4"),$("Continuous 10min","continuous",F.continuousZ2(10),"zone2",6,"Corsa continua 10min")]},{weekNumber:7,theme:"Costruisci Resistenza",totalVolume:60,isDeloadWeek:!1,progressIndicators:["Corsa continua di 15min","FC stabile durante la corsa"],sessions:[$("Continuous 12min","continuous",F.continuousZ2(12),"zone2",5,"Corsa continua 12min"),$("Continuous 10min","continuous",F.continuousZ2(10),"zone2",5,"Sessione di recupero attivo"),$("Continuous 15min","continuous",F.continuousZ2(15),"zone2",6,"Nuovo record!")]},{weekNumber:8,theme:"Traguardo: 20 Minuti!",totalVolume:65,isDeloadWeek:!1,progressIndicators:["20min corsa continua","Base aerobica costruita"],sessions:[$("Continuous 15min","continuous",F.continuousZ2(15),"zone2",5,"Preparazione finale"),$("Easy Run 12min","continuous",F.continuousZ2(12),"zone2",4,"Recupero prima del test"),$("TEST: 20min","continuous",F.continuousZ2(20),"zone2",6,"Obiettivo raggiunto! ðŸŽ‰")]}]}function om(){return[{weekNumber:1,theme:"Costruzione Volume",totalVolume:60,isDeloadWeek:!1,progressIndicators:["Completare 3 sessioni","FC in zona 2"],sessions:[$("Easy Run 20min","continuous",F.continuousZ2(20),"zone2",5,"Corsa facile"),$("Easy Run 20min","continuous",F.continuousZ2(20),"zone2",5,"Mantieni il ritmo"),$("Easy Run 22min","continuous",F.continuousZ2(22),"zone2",5,"Piccolo incremento")]},{weekNumber:2,theme:"Aumenta Gradualmente",totalVolume:70,isDeloadWeek:!1,progressIndicators:["Drift FC < 10%","Respirazione controllata"],sessions:[$("Easy Run 22min","continuous",F.continuousZ2(22),"zone2",5,"Corsa facile"),$("Easy Run 25min","continuous",F.continuousZ2(25),"zone2",5,"Nuovo traguardo"),$("Easy Run 23min","continuous",F.continuousZ2(23),"zone2",5,"Sessione di consolidamento")]},{weekNumber:3,theme:"Raggiungi i 30 Minuti",totalVolume:80,isDeloadWeek:!1,progressIndicators:["30min continui","RPE stabile a 5-6"],sessions:[$("Easy Run 25min","continuous",F.continuousZ2(25),"zone2",5,"Corsa base"),$("Easy Run 25min","continuous",F.continuousZ2(25),"zone2",5,"Corsa facile"),$("Long Run 30min","long_run",F.continuousZ2(30),"zone2",6,"Primo lungo!")]},{weekNumber:4,theme:"Settimana di Recupero",totalVolume:55,isDeloadWeek:!0,progressIndicators:["Recupero completo","FC a riposo stabile"],sessions:[$("Recovery Run 20min","continuous",F.continuousZ2(20),"zone2",4,"Molto facile"),$("Easy Run 18min","continuous",F.continuousZ2(18),"zone2",3,"Mantieni bassa intensitÃ ")]},{weekNumber:5,theme:"Oltre i 30 Minuti",totalVolume:90,isDeloadWeek:!1,progressIndicators:["35min completati","Miglioramento ritmo"],sessions:[$("Easy Run 28min","continuous",F.continuousZ2(28),"zone2",5,"Corsa base"),$("Easy Run 25min","continuous",F.continuousZ2(25),"zone2",5,"Recupero attivo"),$("Long Run 35min","long_run",F.continuousZ2(35),"zone2",6,"Nuovo lungo")]},{weekNumber:6,theme:"Costruisci Resistenza",totalVolume:100,isDeloadWeek:!1,progressIndicators:["40min completati","Drift FC migliorato"],sessions:[$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",5,"Corsa standard"),$("Easy Run 28min","continuous",F.continuousZ2(28),"zone2",5,"Mantieni zona 2"),$("Long Run 40min","long_run",F.continuousZ2(40),"zone2",6,"Verso i 40min")]},{weekNumber:7,theme:"Preparazione Finale",totalVolume:105,isDeloadWeek:!1,progressIndicators:["Adattamento quasi completo","Pronto per 45min"],sessions:[$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",5,"Corsa base"),$("Easy Run 32min","continuous",F.continuousZ2(32),"zone2",5,"Leggero incremento"),$("Long Run 43min","long_run",F.continuousZ2(43),"zone2",6,"Quasi al traguardo")]},{weekNumber:8,theme:"Obiettivo: 45 Minuti!",totalVolume:100,isDeloadWeek:!1,progressIndicators:["45min corsa continua","Base aerobica solida"],sessions:[$("Easy Run 28min","continuous",F.continuousZ2(28),"zone2",5,"Preparazione"),$("Recovery Run 20min","continuous",F.continuousZ2(20),"zone2",4,"Pre-test facile"),$("TEST: 45min","long_run",F.continuousZ2(45),"zone2",6,"Obiettivo raggiunto! ðŸŽ‰")]}]}function lm(){return[{weekNumber:1,theme:"Introduzione VarietÃ ",totalVolume:100,isDeloadWeek:!1,progressIndicators:["Prima sessione tempo","Adattamento alle variazioni"],sessions:[$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Base aerobica"),$("Tempo Intro","tempo",F.tempo(10,10,10),"zone3",6,"Primo tempo run"),$("Long Run 45min","long_run",F.continuousZ2(45),"zone2",5,"Lungo settimanale")]},{weekNumber:2,theme:"Sviluppo Tempo",totalVolume:110,isDeloadWeek:!1,progressIndicators:["Tempo run piÃ¹ lungo","Ritmo soglia migliorato"],sessions:[$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Recupero attivo"),$("Tempo Run","tempo",F.tempo(10,15,10),"zone3",7,"15min a ritmo soglia"),$("Long Run 50min","long_run",F.continuousZ2(50),"zone2",6,"Incremento lungo")]},{weekNumber:3,theme:"Aggiungi Intervalli",totalVolume:115,isDeloadWeek:!1,progressIndicators:["Prima sessione intervalli","Recupero tra ripetute"],sessions:[$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",5,"Corsa facile"),$("Intervals 6x2min","intervals",F.intervals(10,2,2,6,8),"zone4",7,"6 ripetute da 2min"),$("Long Run 50min","long_run",F.continuousZ2(50),"zone2",6,"Lungo stabile")]},{weekNumber:4,theme:"Settimana di Scarico",totalVolume:70,isDeloadWeek:!0,progressIndicators:["Recupero completo","Adattamento consolidato"],sessions:[$("Recovery Run 25min","continuous",F.continuousZ2(25),"zone2",4,"Molto facile"),$("Easy Run 25min","continuous",F.continuousZ2(25),"zone2",4,"Bassa intensitÃ ")]},{weekNumber:5,theme:"Costruzione IntensitÃ ",totalVolume:120,isDeloadWeek:!1,progressIndicators:["Tempo run 20min","Lungo 55min"],sessions:[$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Base"),$("Tempo Run 20min","tempo",F.tempo(10,20,10),"zone3",7,"Progressione tempo"),$("Long Run 55min","long_run",F.continuousZ2(55),"zone2",6,"Nuovo lungo")]},{weekNumber:6,theme:"Mix Ottimale",totalVolume:125,isDeloadWeek:!1,progressIndicators:["Gestione 3 tipi di sessione","CapacitÃ  aerobica migliorata"],sessions:[$("Intervals 8x2min","intervals",F.intervals(10,2,1.5,8,8),"zone4",7,"8 ripetute"),$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Recupero attivo"),$("Long Run 55min","long_run",F.continuousZ2(55),"zone2",6,"Lungo consolidamento")]},{weekNumber:7,theme:"Picco Volume",totalVolume:130,isDeloadWeek:!1,progressIndicators:["Lungo 60min","Pronto per obiettivo"],sessions:[$("Tempo Run 25min","tempo",F.tempo(10,25,10),"zone3",7,"Tempo lungo"),$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",5,"Facile"),$("Long Run 60min","long_run",F.continuousZ2(60),"zone2",6,"Obiettivo raggiunto!")]},{weekNumber:8,theme:"Consolidamento",totalVolume:110,isDeloadWeek:!1,progressIndicators:["60min mantenuto","Base aerobica eccellente"],sessions:[$("Intervals 6x3min","intervals",F.intervals(10,3,2,6,8),"zone4",7,"Intervalli lunghi"),$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",5,"Recupero"),$("Long Run 60min","long_run",F.continuousZ2(60),"zone2",6,"Lungo consolidato ðŸŽ‰")]}]}function cm(){return[{weekNumber:1,theme:"Base Solida",totalVolume:150,isDeloadWeek:!1,progressIndicators:["4 sessioni completate","Volume settimanale alto"],sessions:[$("Easy Run 40min","continuous",F.continuousZ2(40),"zone2",5,"Corsa base"),$("Tempo Run 30min","tempo",F.tempo(10,30,10),"zone3",7,"Tempo classico"),$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Recupero attivo"),$("Long Run 70min","long_run",F.continuousZ2(70),"zone2",6,"Lungo settimanale")]},{weekNumber:2,theme:"Sviluppo VO2max",totalVolume:155,isDeloadWeek:!1,progressIndicators:["Intervalli al 90% FCmax","Recupero efficiente"],sessions:[$("Intervals 10x2min","intervals",F.intervals(15,2,1.5,10,10),"zone4",8,"10 ripetute intense"),$("Easy Run 40min","continuous",F.continuousZ2(40),"zone2",5,"Recupero"),$("Tempo Run 25min","tempo",F.tempo(10,25,10),"zone3",7,"Soglia"),$("Long Run 75min","long_run",F.continuousZ2(75),"zone2",6,"Lungo incremento")]},{weekNumber:3,theme:"Picco IntensitÃ ",totalVolume:160,isDeloadWeek:!1,progressIndicators:["Gestione carichi alti","Adattamento neuromuscolare"],sessions:[$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Corsa leggera"),$("Intervals 8x3min","intervals",F.intervals(10,3,2,8,10),"zone4",8,"Intervalli lunghi"),$("Tempo Run 30min","tempo",F.tempo(10,30,10),"zone3",7,"Tempo sostenuto"),$("Long Run 80min","long_run",F.continuousZ2(80),"zone2",6,"Nuovo lungo record")]},{weekNumber:4,theme:"Recupero Attivo",totalVolume:100,isDeloadWeek:!0,progressIndicators:["Supercompensazione","Preparazione blocco 2"],sessions:[$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",4,"Molto facile"),$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",4,"Recupero"),$("Easy Run 30min","continuous",F.continuousZ2(30),"zone2",4,"Attivazione")]},{weekNumber:5,theme:"Costruzione 2",totalVolume:165,isDeloadWeek:!1,progressIndicators:["Volume record","Efficienza migliorata"],sessions:[$("Tempo Run 35min","tempo",F.tempo(10,35,10),"zone3",7,"Tempo lungo"),$("Easy Run 40min","continuous",F.continuousZ2(40),"zone2",5,"Base"),$("Intervals 6x4min","intervals",F.intervals(10,4,2,6,10),"zone4",8,"Ripetute lunghe"),$("Long Run 85min","long_run",F.continuousZ2(85),"zone2",6,"Lungo progressivo")]},{weekNumber:6,theme:"QualitÃ  Massima",totalVolume:170,isDeloadWeek:!1,progressIndicators:["Sessioni qualitative","Soglia migliorata"],sessions:[$("Intervals 12x2min","intervals",F.intervals(15,2,1,12,10),"zone4",8,"Alta frequenza"),$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Recupero attivo"),$("Tempo Run 40min","tempo",F.tempo(10,40,10),"zone3",7,"Tempo record"),$("Long Run 85min","long_run",F.continuousZ2(85),"zone2",6,"Lungo stabile")]},{weekNumber:7,theme:"Picco Finale",totalVolume:175,isDeloadWeek:!1,progressIndicators:["Volume massimo","Lungo 90min"],sessions:[$("Tempo Run 35min","tempo",F.tempo(10,35,10),"zone3",7,"Soglia"),$("Intervals 8x3min","intervals",F.intervals(10,3,1.5,8,10),"zone4",8,"VO2max"),$("Easy Run 40min","continuous",F.continuousZ2(40),"zone2",5,"Recupero"),$("Long Run 90min","long_run",F.continuousZ2(90),"zone2",6,"Lungo record! ðŸŽ‰")]},{weekNumber:8,theme:"Consolidamento Elite",totalVolume:160,isDeloadWeek:!1,progressIndicators:["Mantenimento livello","Base aerobica eccellente"],sessions:[$("Easy Run 35min","continuous",F.continuousZ2(35),"zone2",5,"Base"),$("Tempo + Intervals","fartlek",[...F.tempo(10,20,5),{type:"interval",duration:3,hrZone:"zone4",notes:"Surge"},{type:"easy",duration:2,hrZone:"zone2",notes:"Recupero"},{type:"interval",duration:3,hrZone:"zone4",notes:"Surge"},{type:"easy",duration:10,hrZone:"zone1",notes:"Defaticamento"}],"zone3",7,"Sessione mista"),$("Easy Run 40min","continuous",F.continuousZ2(40),"zone2",5,"Recupero"),$("Long Run 85min","long_run",F.continuousZ2(85),"zone2",6,"Lungo mantenimento")]}]}function dm(t,a){const r=a?bd(a):180,s=xd(r),o={sedentary:{name:"Da Zero a Corridore",goal:"Costruire base aerobica - Correre 20 minuti continui",description:"Programma graduale per chi parte da zero. In 8 settimane passerai dalla camminata a 20 minuti di corsa continua.",prerequisites:["Essere in salute generale","Scarpe da corsa adatte","Nessun dolore articolare acuto"]},beginner:{name:"Costruisci la Base",goal:"Rafforzare base aerobica - Correre 45 minuti continui",description:"Per chi giÃ  corre 15-20 minuti. Raggiungerai i 45 minuti continui con focus sulla zona 2.",prerequisites:["Saper correre 15-20min senza fermarsi","FC a riposo conosciuta","Nessun infortunio in corso"]},intermediate:{name:"VarietÃ  e Volume",goal:"Sviluppare resistenza e velocitÃ  - 60min + lavori di qualitÃ ",description:"Programma con tempo runs e intervalli. Porterai il lungo a 60min aggiungendo varietÃ .",prerequisites:["Saper correre 45min continui","Conoscere la propria FCmax","Esperienza con ritmi variati"]},advanced:{name:"Performance Running",goal:"Massimizzare capacitÃ  aerobica - Volume alto + intensitÃ  mirata",description:"Programma avanzato con 4 sessioni settimanali. Focus su VO2max, soglia e lunghi fino a 90min.",prerequisites:["Correre regolarmente 4+ volte a settimana","Lungo giÃ  oltre 60min","Esperienza con intervalli"]}}[t];let l,n;switch(t){case"sedentary":l=nm(),n=3;break;case"beginner":l=om(),n=3;break;case"intermediate":l=lm(),n=3;break;case"advanced":l=cm(),n=4;break}return{id:Lo(),name:o.name,level:t,durationWeeks:8,sessionsPerWeek:n,goal:o.goal,description:o.description,prerequisites:o.prerequisites,weeks:l,metricsToTrack:["FC Media sessione","FC a riposo (mattino)","Drift cardiaco","RPE percepito","QualitÃ  sonno","Ritmo a paritÃ  di FC"],successCriteria:["FC a riposo diminuita di 3-5 bpm","Drift cardiaco < 5% nel lungo","Ritmo migliorato del 10% a paritÃ  di FC","RPE stabile o diminuito",`Zona 2 HR range: ${s.min}-${s.max} bpm`]}}function um(t,a,r=1,s){if(console.log("[RUNNING] integrateRunningIntoSplit called:",{strengthDays:t.days.length,enabled:a.enabled,goal:a.goal,integration:a.integration,sessionsPerWeek:a.sessionsPerWeek,capacity:a.capacity,weekNumber:r,userAge:s}),!a.enabled)return console.log("[RUNNING] âŒ Not enabled, returning original split"),t;const i=fd(a.capacity),o=dm(i,s),l=Math.min(r-1,o.weeks.length-1),c=o.weeks[l].sessions.slice(0,a.sessionsPerWeek),u=[...t.days],d=[],p=a.integration;switch(p){case"separate_days":{const g=u.map(P=>P.dayNumber),v=[1,2,3,4,5,6,7].filter(P=>!g.includes(P));let S=0;for(const P of v){if(S>=c.length)break;const N=c[S];d.push({dayNumber:P,dayName:Pa(P),focus:`Running: ${N.name}`,type:"running",exercises:[],runningSession:N,estimatedDuration:N.totalDuration}),S++}break}case"post_workout":{let g=0;for(const y of u){if(g>=c.length)break;const v=c[g],S={...v,name:`Post-Workout: ${v.name}`,totalDuration:Math.min(v.totalDuration,20),notes:"Sessione breve post-allenamento"};d.push({...y,type:"mixed",runningSession:S,estimatedDuration:(y.estimatedDuration||45)+S.totalDuration}),g++}for(let y=d.length;y<u.length;y++)d.push({...u[y],type:"strength"});break}case"hybrid_alternate":{let g=0,y=0,v=1;const S=u.length+c.length;for(let P=0;P<S&&v<=7;P++){if(P%2===0&&g<u.length){const N=u[g];d.push({...N,dayNumber:v,dayName:Pa(v),type:"strength"}),g++}else if(y<c.length){const N=c[y];d.push({dayNumber:v,dayName:Pa(v),focus:`Running: ${N.name}`,type:"running",exercises:[],runningSession:N,estimatedDuration:N.totalDuration}),y++}else if(g<u.length){const N=u[g];d.push({...N,dayNumber:v,dayName:Pa(v),type:"strength"}),g++}v++}break}case"running_only":{for(let g=0;g<c.length&&g<6;g++){const y=c[g];d.push({dayNumber:g+1,dayName:Pa(g+1),focus:y.name,type:"running",exercises:[],runningSession:y,estimatedDuration:y.totalDuration})}break}default:{console.warn(`[RUNNING] âš ï¸ Integration value '${p}' not recognized, defaulting to 'separate_days'`);const g=u.map(P=>P.dayNumber),v=[1,2,3,4,5,6,7].filter(P=>!g.includes(P));let S=0;for(const P of v){if(S>=c.length)break;const N=c[S];d.push({dayNumber:P,dayName:Pa(P),focus:`Running: ${N.name}`,type:"running",exercises:[],runningSession:N,estimatedDuration:N.totalDuration}),S++}break}}if(d.sort((g,y)=>g.dayNumber-y.dayNumber),p!=="running_only"&&p!=="post_workout"){for(const g of u)d.some(y=>y.dayNumber===g.dayNumber)||d.push({...g,type:"strength"});d.sort((g,y)=>g.dayNumber-y.dayNumber)}const f=d.filter(g=>g.type==="running").length,h=d.filter(g=>g.type==="strength").length,x=d.filter(g=>g.type==="mixed").length;return console.log("[RUNNING] âœ… Integrazione completata:",{totalDays:d.length,runningDays:f,strengthDays:h,mixedDays:x,integration:p}),{splitName:`${t.splitName} + Running`,description:`${t.description} | ${c.length} sessioni running/settimana`,days:d}}function Pa(t){return["LunedÃ¬","MartedÃ¬","MercoledÃ¬","GiovedÃ¬","VenerdÃ¬","Sabato","Domenica"][t-1]||`Giorno ${t}`}const mm={beginner:4,intermediate:5,advanced:6},pm=2,tn=20,an=["forza","strength","prestazioni_sportive","sport_performance"],hm=[["forza","resistenza"],["forza","dimagrimento"],["massa","dimagrimento"],["ipertrofia","resistenza"]],gm=["gravidanza","disabilita","motor_recovery","recupero_motorio"],fm=2,xm=4;function bm(t){const a=[],r=[],s=[];let i=!1,o=!1;const l=vm(t.location,t.trainingType,t.equipment);a.push(...l.errors),r.push(...l.warnings),s.push(...l.corrections);const n=ym(t.frequency,t.level,t.goal);a.push(...n.errors),r.push(...n.warnings),s.push(...n.corrections);const c=wm(t.baselines);a.push(...c.errors),r.push(...c.warnings),s.push(...c.corrections),c.shouldBlock&&(i=!0);const u=Nm(t.painAreas);a.push(...u.errors),r.push(...u.warnings),u.shouldBlock&&(i=!0),u.suggestRest&&(o=!0);const d=Sm(t.goal,t.goals,t.level);if(r.push(...d.warnings),t.sessionDuration){const f=jm(t.sessionDuration,t.goal);a.push(...f.errors),r.push(...f.warnings)}return a.filter(f=>f.severity==="critical").length>0&&(i=!0),{isValid:a.length===0,errors:a,warnings:r,corrections:s,shouldBlock:i,suggestRest:o}}function vm(t,a,r){const s=[],i=[],o=[];return t==="home"&&a==="machines"&&(s.push({code:"INVALID_LOCATION_TRAINING",field:"trainingType",message:"Non puoi usare macchine a casa. VerrÃ  usato bodyweight.",severity:"high"}),o.push({field:"trainingType",originalValue:"machines",correctedValue:"bodyweight",reason:"Macchine non disponibili a casa"})),a==="equipment"&&t!=="gym"&&(r&&Object.values(r).some(n=>n===!0)||(i.push({code:"NO_EQUIPMENT_DECLARED",field:"equipment",message:"Hai selezionato allenamento con attrezzi ma non hai specificato quali hai.",suggestion:"Verifica l'attrezzatura disponibile o passa a bodyweight"}),o.push({field:"trainingType",originalValue:"equipment",correctedValue:"bodyweight",reason:"Nessun equipment specificato"}))),{errors:s,warnings:i,corrections:o}}function ym(t,a,r){const s=[],i=[],o=[],l=mm[a]||5;return t>l&&(i.push({code:"FREQUENCY_TOO_HIGH",field:"frequency",message:`${t}x/settimana Ã¨ troppo per livello ${a}. Massimo consigliato: ${l}x.`,suggestion:`Ridotto a ${l}x per garantire recupero adeguato`}),o.push({field:"frequency",originalValue:t,correctedValue:l,reason:`Frequenza massima per ${a}`})),t<pm&&i.push({code:"FREQUENCY_TOO_LOW",field:"frequency",message:`${t}x/settimana potrebbe non essere sufficiente per vedere progressi significativi.`,suggestion:"Considera almeno 2-3 sessioni settimanali per risultati ottimali"}),t>=7&&(s.push({code:"NO_REST_DAYS",field:"frequency",message:"Allenamento 7 giorni su 7 non permette recupero. Massimo 6x/settimana.",severity:"high"}),o.push({field:"frequency",originalValue:t,correctedValue:6,reason:"Almeno 1 giorno di riposo necessario"})),r==="gravidanza"&&t>3&&(i.push({code:"PREGNANCY_FREQUENCY",field:"frequency",message:"Durante la gravidanza, 3x/settimana Ã¨ il massimo consigliato.",suggestion:"Frequenza ridotta a 3x per sicurezza"}),o.push({field:"frequency",originalValue:t,correctedValue:3,reason:"Limite sicurezza gravidanza"})),{errors:s,warnings:i,corrections:o}}function wm(t){const a=[],r=[],s=[];let i=!1;const o=["lower_push","lower_pull","horizontal_push","vertical_push","vertical_pull","core"];let l=0;return o.forEach(n=>{const c=t[n];if(!c){l++;return}c.reps<=0&&(r.push({code:"INVALID_BASELINE_REPS",field:`baselines.${n}`,message:`Baseline ${n} ha reps ${c.reps}. VerrÃ  usato default.`,suggestion:"Rifai lo screening per questo pattern"}),s.push({field:`baselines.${n}.reps`,originalValue:c.reps,correctedValue:10,reason:"Default per reps invalide"})),c.reps>50&&(r.push({code:"EXTREME_BASELINE_REPS",field:`baselines.${n}`,message:`Baseline ${n} ha ${c.reps} reps - valore estremo.`,suggestion:"Limitato a 50 reps per calcoli realistici"}),s.push({field:`baselines.${n}.reps`,originalValue:c.reps,correctedValue:50,reason:"Limite massimo reps"})),c.weight10RM&&c.weight10RM<0&&(r.push({code:"NEGATIVE_WEIGHT",field:`baselines.${n}`,message:`Peso negativo per ${n}. Convertito a bodyweight.`,suggestion:"Verificare input peso"}),s.push({field:`baselines.${n}.weight10RM`,originalValue:c.weight10RM,correctedValue:0,reason:"Peso non puÃ² essere negativo"}))}),l===o.length?(a.push({code:"NO_BASELINES",field:"baselines",message:"Nessun baseline disponibile. Completa lo screening prima di generare il programma.",severity:"critical"}),i=!0):l>=4&&r.push({code:"FEW_BASELINES",field:"baselines",message:`Solo ${o.length-l} pattern hanno baseline. Programma sarÃ  limitato.`,suggestion:"Completa lo screening per tutti i pattern"}),{errors:a,warnings:r,corrections:s,shouldBlock:i}}function Nm(t){const a=[],r=[];let s=!1,i=!1;if(!t||t.length===0)return{errors:a,warnings:r,shouldBlock:s,suggestRest:i};const o=t.filter(c=>c.severity==="severe").length,l=t.length;return o>fm&&(a.push({code:"TOO_MANY_SEVERE_PAIN",field:"painAreas",message:`Hai ${o} zone con dolore severo. Consigliamo di consultare un medico prima di allenarti.`,severity:"critical"}),s=!0,i=!0),l>xm&&r.push({code:"MANY_PAIN_AREAS",field:"painAreas",message:`Hai ${l} zone doloranti. Il programma sarÃ  molto limitato.`,suggestion:"Considera un periodo di recupero attivo o consulto fisioterapico"}),[["left_knee","right_knee"],["left_shoulder","right_shoulder"],["left_hip","right_hip"],["left_ankle","right_ankle"]].forEach(([c,u])=>{const d=t.find(f=>f.area===c&&f.severity==="severe"),p=t.find(f=>f.area===u&&f.severity==="severe");if(d&&p){const f=c.replace("left_","").replace("right_","");r.push({code:"BILATERAL_SEVERE_PAIN",field:"painAreas",message:`Dolore severo bilaterale a ${f}. Molti esercizi saranno esclusi.`,suggestion:"Consulta un fisioterapista prima di continuare"})}}),{errors:a,warnings:r,shouldBlock:s,suggestRest:i}}function Sm(t,a,r){const s=[];if(gm.includes(t)&&r==="advanced"&&s.push({code:"LEVEL_OVERRIDE",field:"level",message:`Per goal "${t}", i parametri di sicurezza hanno prioritÃ  sul livello advanced.`,suggestion:"IntensitÃ  e volume saranno adattati per sicurezza"}),a&&a.length>1){const i=[];hm.forEach(([o,l])=>{a.includes(o)&&a.includes(l)&&i.push(`${o} + ${l}`)}),i.length>0&&s.push({code:"CONFLICTING_GOALS",field:"goals",message:`Goal potenzialmente conflittuali: ${i.join(", ")}.`,suggestion:"La progressione sarÃ  piÃ¹ lenta. Considera di prioritizzare un solo obiettivo."}),a.length===3&&s.push({code:"TOO_MANY_GOALS",field:"goals",message:"Con 3 obiettivi (40-30-30), la progressione per ciascuno sarÃ  significativamente ridotta.",suggestion:"Considera di concentrarti su 1-2 obiettivi per risultati piÃ¹ rapidi"})}return{warnings:s}}function jm(t,a,r){const s=[],i=[];t<tn&&s.push({code:"SESSION_TOO_SHORT",field:"sessionDuration",message:`${t} minuti non sono sufficienti per un workout efficace. Minimo ${tn} minuti.`,severity:"high"}),an.includes(a)&&t<45&&i.push({code:"STRENGTH_TIME_CONFLICT",field:"sessionDuration",message:`Per goal "${a}" servono rest lunghi (3-5 min). Con ${t} min potrai fare pochi esercizi.`,suggestion:"Considera almeno 45 minuti o cambia goal"});const o=an.includes(a)?12:8,n=Math.floor((t-8)/o);return n<3&&i.push({code:"FEW_EXERCISES_POSSIBLE",field:"sessionDuration",message:`Con ${t} minuti potrai fare solo ${n} esercizi. Workout minimale.`,suggestion:"Aumenta la durata o riduci la frequenza per sessioni piÃ¹ complete"}),{errors:s,warnings:i}}function _m(t,a){const r=[];let s=1,i=1,o=!1;const l=[],n=[];let c,u;const d=a.actualLocation!==void 0&&a.actualLocation!==t.location;if(d&&(r.push(`Location cambiata: ${t.location} â†’ ${a.actualLocation}`),t.location==="gym"&&a.actualLocation==="home"&&n.push({original:"Barbell Squat",replacement:"Squat Bodyweight",reason:"Gym â†’ Home"},{original:"Bench Press",replacement:"Push-up",reason:"Gym â†’ Home"},{original:"Lat Pulldown",replacement:"Inverted Row",reason:"Gym â†’ Home"},{original:"Leg Press",replacement:"Lunge",reason:"Gym â†’ Home"},{original:"Cable Row",replacement:"Towel Row",reason:"Gym â†’ Home"})),a.emergingPainAreas&&a.emergingPainAreas.length>0&&a.emergingPainAreas.forEach(p=>{r.push(`Nuovo dolore rilevato: ${p.area} (${p.severity})`);const f=Pm(p.area);p.severity==="severe"?l.push({area:p.area,action:"exclude",affectedPatterns:f}):(l.push({area:p.area,action:"deload",affectedPatterns:f}),s*=.8)}),a.screeningResults){const{recommendations:p,screening:f,warnings:h}=a.screeningResults;i*=p.intensityMultiplier,p.shouldReduceVolume&&(s*=1-p.volumeReduction),f.sleep<=3&&(r.push("Sonno critico: considera riposo attivo"),s*=.7,i*=.8),f.stress>=9&&(r.push("Stress molto alto: workout ridotto"),s*=.7),f.sleep<=3&&f.stress>=8&&(o=!0,r.push("ATTENZIONE: Sonno basso + stress alto. Consigliato giorno di riposo.")),p.shouldFocusOnRecovery&&r.push("Focus su recupero: prioritÃ  a mobilitÃ  e stretching"),r.push(...h)}if(a.detrainingFactor&&a.detrainingFactor<1){u=a.detrainingFactor;const p=Math.round((1-a.detrainingFactor)*100);r.push(`Detraining rilevato: carichi ridotti del ${p}% per riadattamento`),i*=a.detrainingFactor}if(a.previousSessionFeedback){const{averageRPE:p,completionRate:f}=a.previousSessionFeedback;p>=9.5?(r.push("Sessione precedente troppo intensa (RPE â‰¥9.5). Carichi ridotti."),i*=.9):p>=9&&(r.push("RPE alto nella sessione precedente. Leggera riduzione intensitÃ ."),i*=.95),p<=6&&f>=1&&r.push("Sessione precedente troppo facile. Considera aumentare i carichi."),f<.7&&(r.push("Non hai completato il workout precedente. Volume ridotto."),s*=.85)}if(a.availableTime&&t.sessionDuration&&a.availableTime<t.sessionDuration){c={originalDuration:t.sessionDuration,availableDuration:a.availableTime,exercisesRemoved:[],setsReduced:0};const p=Math.round((1-a.availableTime/t.sessionDuration)*100);r.push(`Tempo ridotto: ${t.sessionDuration}min â†’ ${a.availableTime}min (-${p}%)`)}return a.availableEquipment&&r.push(`Equipment disponibile: ${a.availableEquipment.join(", ")}`),{locationChanged:d,newLocation:a.actualLocation,painAdaptations:l,volumeMultiplier:s,intensityMultiplier:i,exerciseReplacements:n,timeCompression:c,detrainingAdjustment:u,warnings:r,shouldSuggestRest:o}}function Pm(t){return{lower_back:["lower_push","lower_pull","core"],upper_back:["horizontal_pull","vertical_pull"],neck:["vertical_push","core"],left_shoulder:["horizontal_push","vertical_push","vertical_pull"],right_shoulder:["horizontal_push","vertical_push","vertical_pull"],left_knee:["lower_push","lower_pull"],right_knee:["lower_push","lower_pull"],left_hip:["lower_push","lower_pull"],right_hip:["lower_push","lower_pull"],left_wrist:["horizontal_push","vertical_pull"],right_wrist:["horizontal_push","vertical_pull"],left_ankle:["lower_push"],right_ankle:["lower_push"],left_elbow:["horizontal_push","vertical_push"],right_elbow:["horizontal_push","vertical_push"]}[t]||[]}function Rm(t,a){const r={...t};return a.forEach(s=>{const i=s.field.split(".");let o=r;for(let n=0;n<i.length-1;n++)o[i[n]]===void 0&&(o[i[n]]={}),o=o[i[n]];const l=i[i.length-1];o[l]=s.correctedValue}),r}function km(){const t={reps:10,weight10RM:0,difficulty:5,variantId:"default",variantName:"Default"};return{lower_push:{...t,variantName:"Squat Bodyweight"},lower_pull:{...t,variantName:"Glute Bridge"},horizontal_push:{...t,variantName:"Push-up"},vertical_push:{...t,variantName:"Pike Push-up"},vertical_pull:{...t,variantName:"Inverted Row"},core:{...t,variantName:"Plank",reps:30}}}function Cm(t){const a=[];return t.errors.length>0&&(a.push("âŒ ERRORI:"),t.errors.forEach(r=>a.push(`   â€¢ ${r.message}`))),t.warnings.length>0&&(a.push("âš ï¸ AVVISI:"),t.warnings.forEach(r=>{a.push(`   â€¢ ${r.message}`),r.suggestion&&a.push(`     â†’ ${r.suggestion}`)})),t.corrections.length>0&&(a.push("ðŸ”§ CORREZIONI AUTOMATICHE:"),t.corrections.forEach(r=>a.push(`   â€¢ ${r.field}: ${r.originalValue} â†’ ${r.correctedValue} (${r.reason})`))),t.shouldBlock&&(a.push(""),a.push("ðŸ›‘ PROGRAMMA NON GENERABILE - Risolvi gli errori sopra")),t.suggestRest&&(a.push(""),a.push("ðŸ’¤ CONSIGLIO: Considera un giorno di riposo o recupero attivo")),a.join(`
`)}function sn(t){const a=["corpo libero","bodyweight","push-up","pull-up","trazioni","dips","plank","hollow body","superman","handstand","pike push-up","diamond push-up","archer push-up","nordic curl","pistol squat","jump","burpee","mountain climber","flutter kick","bicycle crunch","leg raise","australian pull-up","inverted row","floor pull","dead hang","scapular","floor slide","bird dog","l-sit","assistito","squat bulgaro","affondi","glute bridge","wall sit","calf raises","chin-up","negative","isometric","hold","ytw","mobility","stretch"],r=t.toLowerCase();return a.some(s=>r.includes(s))}function Do(t,a,r,s="gym",i="moderate"){return s==="gym"||s==="home_gym"?Em(t,a,r,i):Im(t,a,r,i)}function Em(t,a,r,s){const i=Math.max(4,Math.floor(t*.75));let o=4,l=i,n="90s",c="75%",u="";return a==="forza"||a==="strength"?s==="heavy"?(o=r==="beginner"?4:r==="intermediate"?5:6,l=Math.max(3,Math.min(i,5)),n="3-5min",c="85-90%",u="Forza Massimale - Carico pesante, recupero completo"):s==="volume"?(o=r==="beginner"?4:5,l=Math.max(6,Math.min(i,10)),n="2-3min",c="75-80%",u="Forza-Resistenza - Accumulo volume a carichi medi-alti"):(o=r==="beginner"?4:5,l=Math.max(5,Math.min(i,8)),n="2-3min",c="78-82%",u="Forza Dinamica - VelocitÃ  e tecnica"):a==="massa"||a==="massa muscolare"||a==="muscle_gain"||a==="ipertrofia"?s==="heavy"?(o=r==="beginner"?3:r==="intermediate"?4:5,l=i<=6?6:8,n="90-120s",c="80-85%",u="Pesante - Tensione meccanica"):s==="volume"?(o=r==="beginner"?4:r==="intermediate"?5:6,l=Math.max(10,Math.min(i,15)),n="60-75s",c="65-70%",u="Volume - Stress metabolico"):(o=r==="beginner"?3:r==="intermediate"?4:5,l=Math.max(8,Math.min(i,12)),n="75-90s",c="70-80%",u="Moderato - Ipertrofia classica"):a==="fat_loss"||a==="tonificazione"||a==="dimagrimento"||a==="definizione"?s==="heavy"?(o=r==="beginner"?3:4,l=Math.max(8,Math.min(i,10)),n="75-90s",c="75-80%",u="Pesante - Preservazione massa"):s==="volume"?(o=r==="beginner"?4:5,l=Math.max(12,Math.min(i,15)),n="45-60s",c="60-70%",u="Volume - Consumo calorico"):(o=r==="beginner"?3:4,l=Math.max(10,Math.min(i,12)),n="60-75s",c="70-75%",u="Moderato - Definizione"):a==="endurance"||a==="resistenza"?s==="heavy"?(o=r==="beginner"?3:4,l=Math.max(12,Math.min(i,15)),n="60s",c="65-70%",u="Pesante - Forza resistente"):s==="volume"?(o=r==="beginner"?3:r==="intermediate"?4:5,l=Math.max(15,Math.min(i,20)),n="30-45s",c="55-65%",u="Volume - CapacitÃ  aerobica"):(o=r==="beginner"?3:4,l=Math.max(12,Math.min(i,18)),n="45-60s",c="60-70%",u="Moderato - Endurance muscolare"):a==="general_fitness"||a==="benessere"?s==="heavy"?(o=r==="beginner"?3:4,l=Math.max(6,Math.min(i,10)),n="90s",c="75-80%",u="Pesante - Forza generale"):s==="volume"?(o=r==="beginner"?3:4,l=Math.max(10,Math.min(i,15)),n="60-75s",c="65-75%",u="Volume - Fitness generale"):(o=r==="beginner"?3:4,l=Math.max(8,Math.min(i,12)),n="75-90s",c="70-78%",u="Moderato - Bilanciato"):a==="sport_performance"||a==="prestazioni_sportive"?s==="heavy"?(o=4,l=Math.max(4,Math.min(i,6)),n="2-3min",c="82-88%",u="Potenza - EsplosivitÃ "):s==="volume"?(o=4,l=Math.max(8,Math.min(i,12)),n="60-90s",c="65-75%",u="CapacitÃ  di lavoro"):(o=4,l=Math.max(6,Math.min(i,10)),n="90-120s",c="70-80%",u="Allenamento sport-specifico"):a==="motor_recovery"||a==="recupero_motorio"?(o=3,l=Math.max(8,Math.min(i,12)),n="90-120s",c="60-70%",u="Recupero motorio - Focus tecnica"):a==="pregnancy"||a==="gravidanza"?(o=3,l=Math.max(10,Math.min(i,15)),n="90-120s",c="50-65%",u="Gravidanza - IntensitÃ  controllata"):a==="disability"||a==="disabilita"?(o=3,l=Math.max(8,Math.min(i,12)),n="120s",c="60-70%",u="Adattamenti specifici"):(o=4,l=Math.max(8,Math.min(i,12)),n="75-90s",c="70%",u="Programma generale"),{sets:o,reps:l,rest:n,intensity:c,notes:u}}function Im(t,a,r,s){const i=r==="beginner"?3:r==="intermediate"?4:5;let o=i,l=t,n="90s",c="RPE 7",u="";const d={heavy:.7,moderate:1,volume:1.35},p={heavy:0,moderate:0,volume:1},f=Math.round(t*d[s]),h=i+p[s],x=(a||"").toLowerCase();if(x==="forza"||x==="strength")switch(s){case"heavy":o=h,l=Math.max(3,Math.min(f,6)),n="2-3min",c="RPE 8-9",u="Heavy Day - Variante impegnativa, max effort";break;case"volume":o=h,l=Math.max(10,Math.min(f,15)),n="60-90s",c="RPE 6-7",u="Volume Day - Variante accessibile, accumulo";break;case"moderate":default:o=h,l=Math.max(6,Math.min(f,10)),n="90s",c="RPE 7-8",u="Moderate Day - Consolidamento tecnico"}else if(x==="massa"||x==="ipertrofia"||x==="muscle_gain"||x==="hypertrophy"||x==="massa muscolare")switch(s){case"heavy":o=h,l=Math.max(6,Math.min(f,10)),n="90-120s",c="RPE 8-9",u="Heavy Day - Tensione meccanica, tempo 3-1-2";break;case"volume":o=h,l=Math.max(12,Math.min(f,20)),n="45-60s",c="RPE 7",u="Volume Day - Stress metabolico, pump";break;case"moderate":default:o=h,l=Math.max(8,Math.min(f,15)),n="75s",c="RPE 7-8",u="Moderate Day - Ipertrofia classica"}else if(x==="fat_loss"||x==="dimagrimento"||x==="tonificazione"||x==="definizione")switch(s){case"heavy":o=h,l=Math.max(8,Math.min(f,12)),n="60-75s",c="RPE 8",u="Heavy Day - Preserva forza";break;case"volume":o=h,l=Math.max(15,Math.min(f,25)),n="30-45s",c="RPE 6-7",u="Volume Day - Alta densitÃ , circuit style";break;case"moderate":default:o=h,l=Math.max(12,Math.min(f,18)),n="45-60s",c="RPE 7",u="Moderate Day - Definizione"}else if(x==="endurance"||x==="resistenza")switch(s){case"heavy":o=h,l=Math.max(12,Math.min(f,18)),n="45s",c="RPE 7-8",u="Heavy Day - Forza resistente";break;case"volume":o=h,l=Math.max(20,Math.min(f,35)),n="20-30s",c="RPE 6",u="Volume Day - Endurance pura";break;case"moderate":default:o=h,l=Math.max(15,Math.min(f,25)),n="30-45s",c="RPE 6-7",u="Moderate Day - CapacitÃ  di lavoro"}else switch(s){case"heavy":o=h,l=Math.max(6,Math.min(f,10)),n="90s",c="RPE 7-8",u="Heavy Day - Forza generale";break;case"volume":o=h,l=Math.max(12,Math.min(f,18)),n="60s",c="RPE 6",u="Volume Day - Fitness generale";break;case"moderate":default:o=h,l=Math.max(8,Math.min(f,15)),n="75s",c="RPE 6-7",u="Moderate Day - Bilanciato"}return console.log(`ðŸ“Š [BW Volume] ${s}: baseline ${t} Ã— ${d[s]} = ${f} â†’ clamped to ${l} | ${o} sets`),{sets:o,reps:l,rest:n,intensity:c,notes:u}}function Tm(t,a){var u;console.log("[PROGRAM] GENERAZIONE PROGRAMMA CON SPLIT INTELLIGENTE");const r=bm({level:t.level,goal:t.goal,goals:t.goals,location:t.location,trainingType:t.trainingType,frequency:t.frequency,baselines:t.baselines,painAreas:t.painAreas,sessionDuration:t.sessionDuration,equipment:t.equipment});if((r.errors.length>0||r.warnings.length>0)&&console.log("[VALIDATION]",Cm(r)),r.shouldBlock)return console.error("[PROGRAM] BLOCCATO - Errori critici nella validazione"),{error:!0,blocked:!0,validation:r,message:"Impossibile generare il programma. Risolvi gli errori.",errors:r.errors,warnings:r.warnings};let s=t;r.corrections.length>0&&(s=Rm(t,r.corrections),console.log("[VALIDATION] Correzioni applicate:",r.corrections.length)),(!s.baselines||Object.keys(s.baselines).length===0)&&(console.log("[VALIDATION] Generazione baseline di default"),s.baselines=km());let i=null;if(a){if(i=_m({location:s.location,trainingType:s.trainingType,painAreas:s.painAreas,sessionDuration:s.sessionDuration,goal:s.goal,level:s.level},a),console.log("[RUNTIME] Adaptation:",i),i.shouldSuggestRest)return console.warn("[RUNTIME] SUGGERITO GIORNO DI RIPOSO"),{error:!1,suggestRest:!0,runtimeAdaptation:i,message:"Le tue condizioni attuali suggeriscono un giorno di riposo o recupero attivo.",warnings:i.warnings};if(i.locationChanged&&i.newLocation&&(s.location=i.newLocation,i.newLocation==="home"&&(s.trainingType="bodyweight")),i.painAdaptations.length>0){const d=i.painAdaptations.map(p=>({area:p.area,severity:p.action==="exclude"?"severe":"moderate"}));s.painAreas=[...s.painAreas,...d]}i.timeCompression&&a.availableTime&&(s.sessionDuration=a.availableTime)}if(console.log("Location:",s.location),console.log("Training Type:",s.trainingType),console.log("Frequenza:",s.frequency),s.goals&&s.goals.length>1&&(console.log("Multi-goal:",s.goals.join(" + ")),console.log("Distribuzione volume:",s.goals.length===2?"70-30":"40-30-30")),s.muscularFocus){const d=Array.isArray(s.muscularFocus)?s.muscularFocus.map(f=>f.toUpperCase()).join(", "):s.muscularFocus.toUpperCase(),p=Array.isArray(s.muscularFocus)?s.muscularFocus.length:1;console.log(`Focus Muscolare (${p}x):`,d)}s.sport&&(console.log(`Sport-Specific: ${s.sport.toUpperCase()}`),s.sportRole&&console.log(`Ruolo: ${s.sportRole}`)),s.discrepancyType&&(console.log(`[SCREENING] Discrepancy: ${s.discrepancyType}`),console.log(`   Quiz: ${s.quizScore}% | Practical: ${s.practicalScore}%`));const o=im({level:s.level,goal:s.goal,goals:s.goals,location:s.location,trainingType:s.trainingType,frequency:s.frequency,baselines:s.baselines,painAreas:s.painAreas,muscularFocus:s.muscularFocus,sessionDuration:s.sessionDuration,userBodyweight:s.userBodyweight,equipment:s.equipment,quizScore:s.quizScore,practicalScore:s.practicalScore,discrepancyType:s.discrepancyType});console.log(`Split generato: ${o.splitName}`),console.log(`Giorni di allenamento: ${o.days.length}`);let l=o;if((u=s.runningPrefs)!=null&&u.enabled){console.log("[RUNNING] Integrazione sessioni running nel programma"),console.log(`[RUNNING] Integrazione: ${s.runningPrefs.integration}`),console.log(`[RUNNING] Sessioni/settimana: ${s.runningPrefs.sessionsPerWeek}`),l=um(o,s.runningPrefs,1,s.userAge);const d=l.days.filter(p=>p.type==="running"||p.runningSession).length;console.log(`[RUNNING] Giorni con running: ${d}`)}if(i){const{volumeMultiplier:d,intensityMultiplier:p}=i;(d<1||p<1)&&(console.log(`[RUNTIME] Applying multipliers: volume=${d}, intensity=${p}`),l.days.forEach(f=>{f.exercises&&f.exercises.forEach(h=>{if(d<1&&typeof h.sets=="number"&&(h.sets=Math.max(2,Math.round(h.sets*d))),p<1){const x=Math.round((1-p)*100);h.notes=h.notes?`${h.notes} | âš ï¸ IntensitÃ  -${x}%`:`âš ï¸ IntensitÃ  ridotta del ${x}%`}})}))}s.legsGoalType&&s.gender==="F"&&(console.log(`[LEGS] Applying legs goal type: ${s.legsGoalType}`),s.legsGoalType==="slimming"?(console.log("[LEGS] Applying PHA protocol for leg slimming"),l.days.forEach(d=>{if(!d.exercises||d.type==="running")return;const p=d.exercises.filter(y=>["horizontal_push","horizontal_pull","vertical_push","vertical_pull"].includes(y.pattern)),f=d.exercises.filter(y=>["lower_push","lower_pull"].includes(y.pattern)),h=d.exercises.filter(y=>!["horizontal_push","horizontal_pull","vertical_push","vertical_pull","lower_push","lower_pull"].includes(y.pattern)),x=[],g=Math.max(p.length,f.length);for(let y=0;y<g;y++)p[y]&&x.push(p[y]),f[y]&&x.push(f[y]);x.push(...h),x.forEach(y=>{y.reps="15-20",y.rest="30-45s",y.notes=y.notes?`${y.notes} | ðŸ’§ PHA - Circolazione`:"ðŸ’§ PHA - Focus circolazione e drenaggio"}),d.exercises=x,d.name=`${d.name} (PHA)`,d.description=d.description?`${d.description} - Protocollo PHA per migliorare circolazione e drenaggio gambe`:"Protocollo PHA per migliorare circolazione e drenaggio gambe"})):s.legsGoalType==="rebalance"&&(console.log("[LEGS] Applying rebalance protocol for body proportions"),l.days.forEach(d=>{!d.exercises||d.type==="running"||(d.exercises.forEach(p=>{["horizontal_push","horizontal_pull","vertical_push","vertical_pull"].includes(p.pattern)&&(typeof p.sets=="number"&&(p.sets=Math.min(p.sets+1,5)),(p.pattern==="vertical_push"||p.pattern==="horizontal_pull")&&(p.notes=p.notes?`${p.notes} | âš–ï¸ Focus proporzioni - PrioritÃ `:"âš–ï¸ Focus proporzioni - Esercizio prioritario")),["lower_push","lower_pull"].includes(p.pattern)&&(typeof p.sets=="number"&&(p.sets=Math.max(p.sets-1,2)),p.notes=p.notes?`${p.notes} | ðŸ”„ Mantenimento`:"ðŸ”„ Mantenimento - Volume ridotto per riproporzione")}),d.name=`${d.name} (Riproporzione)`,d.description=d.description?`${d.description} - Focus upper body per bilanciare le proporzioni corporee`:"Focus upper body per bilanciare le proporzioni corporee")})));const n=[];l.days.forEach(d=>{d.exercises&&n.push(...d.exercises)});const c={name:`Programma ${s.level.toUpperCase()} - ${s.goal}`,split:l.splitName,exercises:n,level:s.level,goal:s.goal,frequency:s.frequency,notes:`${l.description}

Programma personalizzato basato sulle TUE baseline. Ogni giorno ha esercizi diversi per stimoli ottimali.`,weeklySplit:l};return r.warnings.length>0&&(c.validationWarnings=r.warnings),r.corrections.length>0&&(c.corrections=r.corrections),i&&i.warnings.length>0&&(c.runtimeWarnings=i.warnings,c.runtimeAdaptation={locationChanged:i.locationChanged,volumeMultiplier:i.volumeMultiplier,intensityMultiplier:i.intensityMultiplier,exerciseReplacements:i.exerciseReplacements}),c}function Am(t){return t<=3?"mild":"severe"}function Mm(t){if(!Array.isArray(t))return console.warn("[VALIDATOR] painAreas non Ã¨ array, ritorno array vuoto"),[];const a=["wrist","neck","elbow","elbow_pull","elbow_push","shoulder","shoulder_overhead","shoulder_push","shoulder_rotation","knee","knee_flexion","knee_extension","knee_load","hip","hip_flexion","hip_extension","hip_abduction","hip_rotation","lower_back","lower_back_flexion","lower_back_extension","lower_back_load","lower_back_rotation","ankle","ankle_dorsiflexion","ankle_plantarflexion","ankle_stability"],r=["mild","moderate","severe"],s=t.map((i,o)=>{if(typeof i=="object"&&i.area){const l=i.area.toLowerCase();let n;return typeof i.severity=="number"?(n=Am(i.severity),console.log(`[VALIDATOR] Convertito severity ${i.severity} -> ${n} per ${l}`)):n=i.severity||"mild",a.includes(l)?r.includes(n)?{area:l,severity:n}:(console.warn(`[VALIDATOR] Severity non valida per ${l}: ${n}, default a 'mild'`),{area:l,severity:"mild"}):(console.warn(`[VALIDATOR] Area non valida ignorata: ${l}`),null)}if(typeof i=="string"){const l=i.toLowerCase();return a.includes(l)?(console.log(`[VALIDATOR] Convertito formato legacy string -> object: ${l}`),{area:l,severity:"mild"}):(console.warn(`[VALIDATOR] Area stringa non valida ignorata: ${l}`),null)}return console.warn(`[VALIDATOR] Formato pain entry sconosciuto ignorato (index ${o}):`,i),null}).filter(i=>i!==null);return console.log(`[VALIDATOR] Normalized ${t.length} pain entries -> ${s.length} valid`),s}const Os={exerciseName:"Squat (Back/Front/Goblet)",cues:[{category:"setup",text:"Piedi larghezza spalle, punte leggermente extra-ruotate (10-30Â°)",priority:"important"},{category:"setup",text:"Respiro profondo, brace addominale (360Â° core tension)",priority:"critical"},{category:"execution",text:"Scendi con controllo, ginocchia tracking in linea con punte piedi",priority:"critical"},{category:"execution",text:"Ginocchia POSSONO superare punte (normale per morfologia e squat profondo)",priority:"important"},{category:"execution",text:"ProfonditÃ : almeno parallelo (coscia parallela), full ROM se mobilitÃ  lo permette",priority:"important"},{category:"execution",text:"Peso su MID-FOOT (tripod: tallone + base alluce + mignolo), NON solo talloni",priority:"critical"},{category:"execution",text:"Petto in alto, colonna neutra (no iper-estensione, no flessione)",priority:"critical"},{category:"execution",text:"Risalita: spingi pavimento con TUTTO il piede, estendi anche e ginocchia contemporaneamente",priority:"critical"},{category:"breathing",text:"Valsalva: inspira e trattieni in discesa, espira in alto (o top 1/3 risalita)",priority:"critical"},{category:"common_errors",text:"âŒ Butt wink eccessivo (bacino retroverso in basso) â†’ limita profonditÃ  se accade",priority:"important"},{category:"common_errors",text:"âŒ Knee valgus (ginocchia che collassano in dentro) â†’ attiva glutei, spingi ginocchia fuori",priority:"critical"},{category:"common_errors",text:"âŒ Morning good (anche salgono prima di ginocchia) â†’ mantieni petto alto",priority:"important"},{category:"safety",text:"âš ï¸ Se dolore ginocchio/schiena: verifica mobilitÃ  caviglia, anche, thoracic spine",priority:"critical"}],keyPoints:["Ginocchia oltre punte = OK se controllato","Peso su mid-foot (tripod), non solo talloni","ProfonditÃ  individuale (dipende da mobilitÃ )",'Brace core (360Â° tension), non solo "schiena dritta"']},Rr={exerciseName:"Deadlift (Conventional/Sumo/RDL)",cues:[{category:"setup",text:"Bilanciere sopra mid-foot (non punte piedi), tibie quasi verticali",priority:"critical"},{category:"setup",text:"Grip appena fuori gambe (conv) o larghezza spalle (sumo)",priority:"important"},{category:"setup",text:"Scapole sopra bilanciere (non retratte), colonna neutra",priority:"critical"},{category:"setup",text:'Brace addominale massimo (Valsalva), lats engaged ("piegare bilanciere")',priority:"critical"},{category:"execution",text:"Tira slack dalla barra, crea tensione totale corpo PRIMA di sollevare",priority:"critical"},{category:"execution",text:"Spingi pavimento con piedi (leg press), estendi anche e ginocchia insieme",priority:"critical"},{category:"execution",text:"Barra sale in linea verticale vicino a gambe (no swing in avanti)",priority:"critical"},{category:"execution",text:"Lockout: anche estese, NO iper-estensione lombare",priority:"important"},{category:"execution",text:"Discesa: hip hinge controllato, barra vicina a gambe",priority:"important"},{category:"breathing",text:"Valsalva: respiro massimo, brace, trattieni durante tutta rep",priority:"critical"},{category:"common_errors",text:"âŒ Schiena arrotondata (flessione lombare) â†’ ridurre carico, lavorare su setup",priority:"critical"},{category:"common_errors",text:'âŒ Anche salgono prima di spalle â†’ "chest up", cue "leg press il pavimento"',priority:"critical"},{category:"common_errors",text:"âŒ Barra lontana da corpo â†’ lats non attivi, piÃ¹ stress lombare",priority:"important"},{category:"safety",text:"âš ï¸ Se dolore lombare: check setup, ridurre ROM (deficit/blocks), lavorare su hinge pattern",priority:"critical"}],keyPoints:["Slack out della barra prima di tirare = fondamentale","Lats engaged (protezione lombare)","Lockout = anche estese, NO over-extension","Barra sempre vicina al corpo"]},rn={exerciseName:"Romanian Deadlift (RDL)",cues:[{category:"setup",text:"Partenza in alto (lockout), non da pavimento",priority:"important"},{category:"execution",text:"Hip hinge dominante: anche indietro, ginocchia minimal bend (10-20Â°)",priority:"critical"},{category:"execution",text:"Stretch hamstrings: scendi finchÃ© senti tensione posteriori coscia (NON finchÃ© tocchi pavimento)",priority:"critical"},{category:"execution",text:"Colonna neutra durante tutta ROM, NO arrotondamento lombare",priority:"critical"},{category:"execution",text:"Barra vicina a gambe (sfiora tibie/cosce), scapole neutrali",priority:"important"},{category:"execution",text:"Risalita: contrazione glutei e hamstrings, spingi anche in avanti",priority:"critical"},{category:"common_errors",text:"âŒ Troppa flessione ginocchia â†’ diventa squat, perde focus hamstrings",priority:"important"},{category:"common_errors",text:"âŒ Arrotondare schiena per toccare pavimento â†’ ROM individuale (stretch hamstrings)",priority:"critical"},{category:"safety",text:"âš ï¸ ROM dipende da mobilitÃ  hamstrings (tight hamstrings = ROM ridotto OK)",priority:"important"}],keyPoints:["ROM individuale (stop quando hamstrings stretched)","Hip hinge, non squat","Focus eccentrico controllato (glutei/hamstrings)"]},kr={exerciseName:"Bench Press (Barbell/Dumbbell)",cues:[{category:"setup",text:"Scapole retratte e depresse (shoulder blades together e down)",priority:"critical"},{category:"setup",text:"Arch lombare naturale (estensione thoracic, non solo lower back)",priority:"important"},{category:"setup",text:"Piedi piantati a terra (leg drive), 5 punti contatto (testa, scapole, glutei, piedi)",priority:"important"},{category:"setup",text:"Grip: avambracci verticali al bottom (tipicamente larghezza spalle + 5-10cm)",priority:"important"},{category:"execution",text:"Unrack: barra sopra spalle, NO sopra faccia",priority:"important"},{category:"execution",text:"Discesa: barra verso mid-chest/lower chest (non collo), gomiti 45-75Â° (non flared 90Â°)",priority:"critical"},{category:"execution",text:"Touch chest controllato (no bounce), mantieni scapole retratte",priority:"important"},{category:"execution",text:"Spinta: leg drive, barra sale leggermente indietro verso rack position",priority:"important"},{category:"execution",text:"Lockout: gomiti estesi ma non iper-estesi, scapole ancora retratte",priority:"important"},{category:"breathing",text:"Inspira in alto, trattieni in discesa, espira in risalita (o top)",priority:"important"},{category:"common_errors",text:"âŒ Gomiti flared 90Â° â†’ stress spalle, usa 45-75Â° (dipende da grip)",priority:"critical"},{category:"common_errors",text:"âŒ Scapole non retratte â†’ impingement spalla, instabilitÃ ",priority:"critical"},{category:"common_errors",text:"âŒ Bounce sulla chest â†’ controllo, no rimbalzo",priority:"important"},{category:"safety",text:"âš ï¸ Dolore spalla: check retraction scapole, ridurre ROM (board press), ridurre grip width",priority:"critical"}],keyPoints:["Scapular retraction = protezione spalla","Gomiti 45-75Â° (non 90Â° flared)","Leg drive (stabilitÃ , piÃ¹ forza)","Barra a mid/lower chest, non collo"]},Lm={exerciseName:"Push-up",cues:[{category:"setup",text:"Mani larghezza spalle +5-10cm, dita leggermente extra-ruotate",priority:"important"},{category:"setup",text:"Corpo in linea retta (plank position): testa-spalle-anche-caviglie",priority:"critical"},{category:"setup",text:"Core braced (glutei contratti, addome tight)",priority:"critical"},{category:"execution",text:"Scendi con controllo: gomiti 45-75Â° (non flared), scapole protratte in alto",priority:"critical"},{category:"execution",text:"Full ROM: petto a ~2cm da pavimento (o touch), corpo in linea",priority:"important"},{category:"execution",text:"Spingi: protrazione scapolare (shoulder blades apart in alto)",priority:"important"},{category:"common_errors",text:"âŒ Anche che scendono (sagging) â†’ core debole, ridurre difficoltÃ  (incline)",priority:"critical"},{category:"common_errors",text:"âŒ Anche troppo alte (pike) â†’ perdita tensione petto",priority:"important"},{category:"common_errors",text:"âŒ Testa in avanti â†’ mantieni cervicale neutra",priority:"important"},{category:"safety",text:"âš ï¸ Progressione: Wall â†’ Incline â†’ Standard â†’ Decline â†’ Weighted",priority:"important"}],keyPoints:["Corpo in linea (no sagging)","Scapular protraction in alto (serratus activation)","Gomiti 45-75Â°, non flared","Core braced sempre"]},Cr={exerciseName:"Overhead Press (Barbell/Dumbbell)",cues:[{category:"setup",text:"Piedi larghezza anche, core braced (glutei contratti)",priority:"important"},{category:"setup",text:"Barra su clavicole/upper chest, gomiti davanti barra",priority:"important"},{category:"setup",text:"Grip: avambracci verticali visti frontalmente",priority:"important"},{category:"execution",text:"Spinta verticale: barra sale vicina a faccia, testa leggermente indietro",priority:"critical"},{category:"execution",text:"Quando barra passa fronte, porta testa in avanti sotto barra",priority:"critical"},{category:"execution",text:"Lockout: barra sopra mid-foot (non davanti), scapole elevate (shrug leggero)",priority:"critical"},{category:"execution",text:"Discesa: testa indietro, barra vicina a faccia, gomiti davanti",priority:"important"},{category:"execution",text:"NO iper-estensione lombare (lean back eccessivo)",priority:"critical"},{category:"breathing",text:"Valsalva: inspira in basso, trattieni, espira in alto",priority:"important"},{category:"common_errors",text:"âŒ Lower back arching (compenso mobilitÃ  thoracic) â†’ core debole",priority:"critical"},{category:"common_errors",text:"âŒ Barra troppo avanti â†’ inefficiente, stress spalle",priority:"important"},{category:"common_errors",text:"âŒ Gomiti dietro barra â†’ perdita forza, stress polsi",priority:"important"},{category:"safety",text:"âš ï¸ Richiede mobilitÃ  thoracic spine e spalle. Se limitate: seated, landmine press",priority:"important"}],keyPoints:["Traiettoria verticale (bar path dritto)","Core bracing (no lower back arch)","Scapular elevation al lockout","Testa si muove (back poi forward)"]},Dm={exerciseName:"Barbell Row (Bent-Over)",cues:[{category:"setup",text:"Hip hinge: busto 45-75Â° (dipende da mobilitÃ ), colonna neutra",priority:"critical"},{category:"setup",text:"Ginocchia minimal bend, peso su mid-foot",priority:"important"},{category:"setup",text:"Grip: overhand (pronated) o underhand (supinated), larghezza spalle",priority:"important"},{category:"execution",text:"Tira barra verso lower chest/upper abs, gomiti vicino a corpo (non flared)",priority:"critical"},{category:"execution",text:"Retrazione scapolare: shoulder blades together (squeeze), mantieni 1sec",priority:"critical"},{category:"execution",text:"Discesa controllata, protrai scapole (stretch lat)",priority:"important"},{category:"execution",text:"Colonna neutra SEMPRE (no extension/flexion)",priority:"critical"},{category:"common_errors",text:"âŒ Usare momentum (body english) â†’ ridurre carico, controllo",priority:"important"},{category:"common_errors",text:"âŒ Tirare verso petto alto (bicep dominant) â†’ focus mid/lower chest",priority:"important"},{category:"common_errors",text:"âŒ Perdere neutralitÃ  colonna â†’ ridurre angolo busto (piÃ¹ verticale)",priority:"critical"},{category:"safety",text:"âš ï¸ Se difficile mantenere posizione: Chest-supported row, Seal row",priority:"important"}],keyPoints:["Retrazione scapolare (mid-back activation)","Colonna neutra (isometric hold)","Tira verso lower chest/abs","Controllo, no momentum"]},nn={exerciseName:"Pull-up / Chin-up",cues:[{category:"setup",text:"Dead hang: braccia completamente estese, scapole protratte (deprimi in setup)",priority:"important"},{category:"setup",text:"Grip: pronated (pull-up) o supinated (chin-up), larghezza spalle +5-10cm",priority:"important"},{category:"execution",text:"Inizia movimento: deprimi scapole (shoulder blades down), poi tira",priority:"critical"},{category:"execution",text:'Tira gomiti verso fianchi (pensa "gomiti giÃ¹"), petto verso barra',priority:"critical"},{category:"execution",text:"Top: mento sopra barra (o chest to bar), scapole retratte",priority:"important"},{category:"execution",text:"Discesa controllata (eccentric), torna a dead hang completo",priority:"important"},{category:"common_errors",text:"âŒ Kipping (momentum gambe) â†’ se non strict, usa band/assisted",priority:"important"},{category:"common_errors",text:"âŒ Partial ROM (non dead hang) â†’ Full ROM per sviluppo ottimale",priority:"important"},{category:"common_errors",text:"âŒ Spalle shrugged â†’ depressione scapolare attiva",priority:"critical"},{category:"safety",text:"âš ï¸ Progressione: Scapular pulls â†’ Negatives â†’ Band assisted â†’ Full pull-up",priority:"important"}],keyPoints:["Scapular depression (lats activation)","Full ROM (dead hang a dead hang)","Controlled eccentric (forza, ipertrofia)","No kipping se obiettivo forza/massa"]},on={exerciseName:"Plank (Front/Side)",cues:[{category:"setup",text:"Gomiti sotto spalle, avambracci paralleli",priority:"important"},{category:"setup",text:"Corpo in linea retta: testa-spalle-anche-caviglie",priority:"critical"},{category:"execution",text:"Posterior pelvic tilt leggero (glutei contratti)",priority:"critical"},{category:"execution",text:"Brace addominale 360Â° (respira shallow, mantieni tensione)",priority:"critical"},{category:"execution",text:"Scapole protratte (serratus engaged), non retratte",priority:"important"},{category:"execution",text:"Quadricipiti contratti (gambe attive)",priority:"important"},{category:"common_errors",text:"âŒ Anche che scendono (anterior pelvic tilt) â†’ perde anti-extension",priority:"critical"},{category:"common_errors",text:"âŒ Anche troppo alte â†’ riduce difficoltÃ , perde tensione",priority:"important"},{category:"common_errors",text:"âŒ Trattenere respiro â†’ respiri shallow ma continui",priority:"important"},{category:"safety",text:"âš ï¸ Se dolore lombare: PPT (posterior tilt) piÃ¹ accentuato, ridurre durata",priority:"critical"}],keyPoints:["Anti-extension (resist gravity)","Posterior pelvic tilt (glutei)","Total body tension (gambe, glutei, core, scapole)","Respiro controllato, no apnea"]},zm={exerciseName:"Hip Thrust (Barbell/Dumbbell)",cues:[{category:"setup",text:"Scapole su bench (mid-scapola), piedi larghezza anche",priority:"important"},{category:"setup",text:"Piedi flat, distanza: tibie verticali al top (ginocchia 90Â°)",priority:"critical"},{category:"setup",text:"Barra sopra anche (pad per comfort), chin tucked (mento verso petto)",priority:"important"},{category:"execution",text:"Spingi talloni, estendi anche fino a linea retta (spalle-anche-ginocchia)",priority:"critical"},{category:"execution",text:"Lockout: glutei contratti MASSIMO (squeeze 1-2sec), NO iper-estensione lombare",priority:"critical"},{category:"execution",text:"Posterior pelvic tilt al top (bacino retroverso, abs tight)",priority:"critical"},{category:"execution",text:"Discesa controllata, stretch glutei in basso",priority:"important"},{category:"breathing",text:"Espira al top (lockout), inspira in discesa",priority:"important"},{category:"common_errors",text:"âŒ Iper-estensione lombare â†’ PPT al top, squeeze glutei non lower back",priority:"critical"},{category:"common_errors",text:"âŒ Piedi troppo vicini/lontani â†’ tibie verticali al top",priority:"important"},{category:"common_errors",text:"âŒ Spingere su punte piedi â†’ peso su talloni/mid-foot",priority:"important"},{category:"safety",text:"âš ï¸ Se dolore lombare: check PPT, ridurre ROM, focus glute squeeze",priority:"critical"}],keyPoints:["Glute-dominant (non lower back)","Posterior pelvic tilt al top","Tibie verticali (optimal glute activation)","Pause al top (1-2sec squeeze)"]},Er={Squat:Os,"Back Squat":Os,"Front Squat":Os,"Goblet Squat":Os,Deadlift:Rr,"Conventional Deadlift":Rr,"Sumo Deadlift":Rr,"Romanian Deadlift":rn,RDL:rn,"Hip Thrust":zm,"Bench Press":kr,"Barbell Bench Press":kr,"Dumbbell Bench Press":kr,"Push-up":Lm,"Overhead Press":Cr,"Military Press":Cr,"Dumbbell Shoulder Press":Cr,"Barbell Row":Dm,"Pull-up":nn,"Chin-up":nn,Plank:on,"Front Plank":on};function zo(t){if(Er[t])return Er[t];for(const[a,r]of Object.entries(Er))if(t.toLowerCase().includes(a.toLowerCase()))return r;return null}function Om(t){const a=zo(t);return a?a.cues.filter(r=>r.priority==="critical"):[]}const Bm=["gravidanza","pregnancy","pre_partum","prepartum","post_partum","postpartum","motor_recovery","recupero_motorio","disability","disabilita"];function Ra(t){if(!t)return!1;const a=t.toLowerCase().trim();return Bm.some(r=>a.includes(r)||r.includes(a))}const Fm=[{code:"SPINE_FLEXION",severity:"HIGH",description:"Perdita di neutralitÃ  lombare (butt wink)",correction:"Fermati prima del punto dove perdi la curva. Lavora su mobilitÃ  anca e caviglia.",check:t=>t.spineNeutral===!1},{code:"KNEE_VALGUS",severity:"HIGH",description:"Ginocchia che collassano verso l'interno",correction:"Spingi le ginocchia fuori attivamente, in linea con le punte dei piedi. Rinforza glutei con band work.",check:t=>{const a=t.angles.kneeValgus||0;return Math.abs(a)>10}},{code:"HEEL_RISE",severity:"MEDIUM",description:"Talloni che si alzano dal pavimento",correction:"Migliora mobilitÃ  caviglia o usa scarpe con tacco. Peso sui talloni/mesopiede.",check:t=>t.heelContact===!1},{code:"KNEE_CAVE_SEVERE",severity:"HIGH",description:"Cedimento severo delle ginocchia nella risalita",correction:"Riduci il carico. Attiva i glutei spingendo le ginocchia fuori prima di iniziare la risalita.",check:t=>{const a=t.angles.kneeValgus||0;return t.phase==="CONCENTRIC"&&Math.abs(a)>15}},{code:"EXCESSIVE_FORWARD_LEAN",severity:"MEDIUM",description:"Inclinazione del torso eccessiva",correction:"Petto alto, core attivo. Se persiste con torso lungo, potrebbe essere il peso troppo pesante.",check:(t,a)=>{const r=t.angles.torso||0,s=(a==null?void 0:a.type)==="LONG_FEMUR"?65:55;return r>s}}],$m=[{code:"BAR_PATH_FORWARD",description:"Bilanciere si sposta in avanti durante il movimento",correction:"Mantieni il peso sui talloni/mesopiede. Il bilanciere deve rimanere sopra il mesopiede.",check:(t,a)=>{const r=t.filter(o=>o.barPath).map(o=>o.barPath.forwardDeviation||0);if(r.length===0)return!1;const s=Math.max(...r),i=(a==null?void 0:a.type)==="LONG_FEMUR"?8:5;return s>i}},{code:"HIPS_RISE_FIRST",description:"Le anche salgono prima delle spalle (good morning squat)",correction:'Guida con il petto. Pensa a "spingere la schiena contro il bilanciere" mentre sali.',check:t=>{const a=t.filter(i=>i.phase==="CONCENTRIC");if(a.length<3)return!1;const r=a[0].angles.torso||0;return(a[Math.floor(a.length/2)].angles.torso||0)>r+10}},{code:"INSUFFICIENT_DEPTH",description:"ProfonditÃ  insufficiente - anca non sotto il ginocchio",correction:"Scendi fino a quando la piega dell'anca Ã¨ sotto il ginocchio. Lavora su mobilitÃ  se necessario.",check:t=>{const a=t.find(s=>s.phase==="BOTTOM");return a?(a.angles.hip||180)>100:!1}},{code:"ASYMMETRIC_STANCE",description:"Posizione asimmetrica - un lato lavora piÃ¹ dell'altro",correction:"Verifica che i piedi siano equidistanti. Possibile squilibrio muscolare da correggere.",check:t=>!1},{code:"NO_PAUSE_BOTTOM",description:"Rimbalzo eccessivo nel bottom - perdita di controllo",correction:"Controlla la discesa, breve pausa nel bottom per mantenere tensione.",check:t=>{const a=t.filter(s=>s.phase==="BOTTOM");return a.length===0?!1:a.reduce((s,i)=>s+(i.velocity||0),0)/a.length>.5}}];function qm(t,a,r,s,i){const o=as(t,"left"),l=as(t,"right"),n=(o+l)/2,c=ss(t,"left"),u=ss(t,"right"),d=(c+u)/2,p=rr(t),f=zi(t,"left"),h=zi(t,"right"),x=(f+h)/2,g=ir(t),y=Bc(t),v=aa(t.left_shoulder,t.right_shoulder),S=aa(t.left_hip,t.right_hip),P=[],N={frameNumber:a,timestamp:r,phase:s,angles:{knee:n,hip:d,torso:p,kneeValgus:x},barPath:{x:v.x,y:v.y,deviationFromVertical:Math.abs(v.x-S.x)*100},spineNeutral:g,heelContact:y,issues:P};for(const I of Fm)I.check(N,i)&&P.push({type:"SAFETY",code:I.code,severity:I.severity,timestamp:r,frameNumber:a,description:I.description,correction:I.correction});return N}function Hm(t){const a=t.filter(o=>o.phase==="CONCENTRIC"||o.phase==="MID_RANGE");if(a.length<3)return{detected:!1};let r=null,s=1/0;for(const o of a)o.velocity!==void 0&&o.velocity<s&&o.velocity>0&&(s=o.velocity,r=o);if(!r)return{detected:!1};const i=r.angles.knee||180;return i<100?{detected:!0,position:"BOTTOM",angleAtSticking:i,diagnosis:{muscular:["Quadricipiti deboli in allungamento","Glutei non attivati nel bottom"],technical:["Perdita di tensione nel bottom","Rimbalzo assente o eccessivo"]},recommendations:{accessories:["Pause squat (3s nel bottom)","Pin squat dal bottom","Belt squat"],cues:["Mantieni tensione nel bottom","Spingi il pavimento via da te","Gomiti sotto la barra"]}}:i>=100&&i<140?{detected:!0,position:"MID_RANGE",angleAtSticking:i,diagnosis:{muscular:["Glutei deboli nel mid-range","Estensori anca carenti"],technical:["Good morning squat","Perdita verticalitÃ  barra","Ginocchia che cedono"]},recommendations:{accessories:["Hip thrust","Good morning","Squat con catene/bande","Box squat"],cues:["Guida con il petto","Stringi i glutei uscendo dalla buca","Spingi le ginocchia fuori"]}}:{detected:!0,position:"LOCKOUT",angleAtSticking:i,diagnosis:{muscular:["Quadricipiti deboli in accorciamento"],technical:["Perdita di velocitÃ  nella parte finale"]},recommendations:{accessories:["1.5 rep squat","Leg press","Leg extension"],cues:["Accelera attraverso il movimento","Spingi fino al lockout completo"]}}}function Wm(t){const a=[],r=t.find(n=>n.phase==="BOTTOM");r&&(r.angles.hip||180)<90&&a.push("Ottima profonditÃ  raggiunta"),t.filter(n=>n.spineNeutral===!1).length===0&&a.push("Spine neutrale mantenuta durante tutto il movimento"),t.filter(n=>n.heelContact===!1).length===0&&a.push("Peso ben distribuito sul piede"),t.filter(n=>Math.abs(n.angles.kneeValgus||0)>8).length===0&&a.push("Ginocchia stabili e allineate");const l=t.filter(n=>n.phase==="ECCENTRIC");return l.length>0&&l.reduce((c,u)=>c+(u.velocity||0),0)/l.length<.3&&a.push("Buon controllo nella fase eccentrica"),a}function Gm(t,a){const r=[],s=[],i=[];for(const o of t)switch(o.code){case"KNEE_VALGUS":case"KNEE_CAVE_SEVERE":r.push("Usa una banda elastica sopra le ginocchia per feedback tattile"),s.push("Clamshell 2x15 per lato","Lateral band walk 2x20");break;case"SPINE_FLEXION":r.push("Riduci la profonditÃ  fino a mantenere la curva lombare"),i.push("90/90 hip stretch","Goblet squat hold 3x30s");break;case"HEEL_RISE":r.push("Prova con rialzo sotto i talloni o scarpe da squat"),i.push("Ankle dorsiflexion stretch","Calf foam rolling");break;case"HIPS_RISE_FIRST":r.push('Pensa "petto alto" mentre sali'),s.push("Front squat (obbliga posizione verticale)","Tempo squat 3-1-1");break;case"EXCESSIVE_FORWARD_LEAN":r.push("Core attivo, respira nel diaframma prima di ogni rep"),s.push("Front squat","Goblet squat");break;case"DEPTH_ASYMMETRY":r.push("Concentrati su scendere uniformemente su entrambi i lati"),s.push("Bulgarian split squat 3x8 per lato","Single leg press"),i.push("Pigeon stretch lato debole");break;case"KNEE_ANGLE_ASYMMETRY":r.push("Spingi le ginocchia fuori in modo simmetrico"),s.push("Single leg extension","Step-up 3x10 per lato");break;case"TORSO_ROTATION":r.push("Mantieni il petto rivolto in avanti, non ruotare"),s.push("Pallof press 3x12","Dead bug 3x10","Bird-dog 3x10"),i.push("Rotazione toracica su foam roller");break;case"WEIGHT_SHIFT_LATERAL":r.push("Allenati davanti a uno specchio per feedback visivo"),r.push("Distribuisci il peso equamente sui due piedi"),s.push("Goblet squat con pausa nel bottom","Box squat");break;case"SCAPULAR_PROTRACTION":r.push('Retrai le scapole prima di ogni rep - "petto fuori"'),s.push("Face pull 3x15","Band pull-apart 3x20");break;case"SHOULDERS_ELEVATED":r.push('Abbassa le spalle - "spalle lontane dalle orecchie"'),s.push("Shrug eccentrico","Upper trap stretch");break;case"SHOULDER_ASYMMETRY":r.push("Verifica che il bilanciere sia centrato sulla schiena"),s.push("Single arm row","Face pull unilaterale");break}return(a==null?void 0:a.type)==="LONG_FEMUR"&&(r.push("Con femori lunghi, una maggiore inclinazione del torso Ã¨ normale"),s.push("Box squat per trovare la profonditÃ  ottimale")),{immediate:[...new Set(r)],accessories:[...new Set(s)],mobility:[...new Set(i)]}}function Um(t,a){const r=[];for(const d of t)r.push(...d.issues);for(const d of $m)d.check(t,a)&&r.push({type:"EFFICIENCY",code:d.code,severity:d.severity||"MEDIUM",description:d.description,correction:d.correction});const s=Vm(r),o=Km(s).slice(0,2),l=Wm(t),n=Hm(t),c=Gm(o,a);n.detected&&n.recommendations&&(c.accessories.push(...n.recommendations.accessories),c.immediate.push(...n.recommendations.cues));const u=Ym(o,l);return{issues:o,strengths:l,stickingPoint:n,recommendations:{immediate:[...new Set(c.immediate)].slice(0,3),accessories:[...new Set(c.accessories)].slice(0,4),mobility:[...new Set(c.mobility)].slice(0,2)},overallScore:u}}function Vm(t){const a=new Set;return t.filter(r=>a.has(r.code)?!1:(a.add(r.code),!0))}function Km(t){const a={SAFETY:0,EFFICIENCY:1,OPTIMIZATION:2},r={HIGH:0,MEDIUM:1,LOW:2};return t.sort((s,i)=>{const o=a[s.type]-a[i.type];return o!==0?o:r[s.severity]-r[i.severity]})}function Ym(t,a){let r=10;for(const s of t)s.type==="SAFETY"?r-=s.severity==="HIGH"?2:s.severity==="MEDIUM"?1.5:1:s.type==="EFFICIENCY"?r-=s.severity==="HIGH"?1.5:s.severity==="MEDIUM"?1:.5:r-=.5;return r+=Math.min(a.length*.3,1),Math.max(1,Math.min(10,Math.round(r*10)/10))}const Zm=[{code:"LOWER_BACK_ROUND",severity:"HIGH",description:"Schiena che si arrotonda (perdita lordosi lombare)",correction:'Setup con petto alto, "mostra il logo della maglietta". Se persiste, riduci il carico.',check:t=>(t.angles.lumbar||0)>15||t.spineNeutral===!1},{code:"BAR_DRIFT_FORWARD",severity:"MEDIUM",description:"Bilanciere si allontana dal corpo",correction:"Trascina il bilanciere sulle tibie e cosce. Deve restare attaccato al corpo.",check:t=>{const a=t.barPath;return a?a.deviationFromVertical>5:!1}},{code:"SHOULDERS_BEHIND_BAR",severity:"HIGH",description:"Spalle dietro la barra nel setup - inefficiente e pericoloso",correction:"Nel setup, le spalle devono essere sopra o leggermente davanti alla barra.",check:t=>{if(t.phase!=="SETUP")return!1;const a=t.angles.torso||0,r=t.angles.knee||180;return a<30&&r<130}},{code:"HYPEREXTENSION_LOCKOUT",severity:"MEDIUM",description:"Iperestensione lombare in chiusura",correction:'Chiudi stringendo i glutei, non spingendo le anche avanti. "Tall posture".',check:t=>t.phase!=="LOCKOUT"?!1:(t.angles.hip||180)>185},{code:"NECK_HYPEREXTENSION",severity:"LOW",description:"Collo iperesteso (guardare troppo in alto)",correction:"Sguardo a 3-4 metri davanti a te, collo neutro in linea con la spine.",check:t=>(t.angles.neck||0)>30}],Xm=[{code:"HIPS_TOO_LOW",description:'Setup con anche troppo basse - stai "squattando" lo stacco',correction:'Le anche devono essere piÃ¹ alte delle ginocchia nel setup. Pensa "hip hinge", non squat.',check:(t,a)=>{const r=t.find(o=>o.phase==="SETUP");if(!r)return!1;const s=r.angles.hip||180,i=a!=null&&a.armToTorso&&a.armToTorso>1.1?70:60;return s<i}},{code:"HIPS_TOO_HIGH",description:"Setup con anche troppo alte - stiff leg deadlift involontario",correction:"Abbassa le anche fino a sentire tensione nei femorali. Le ginocchia devono essere flesse.",check:t=>{const a=t.find(s=>s.phase==="SETUP");return a?(a.angles.knee||180)>160:!1}},{code:"HIPS_RISE_FIRST",description:"Le anche salgono prima delle spalle - perdita di leverage",correction:"Mantieni l'angolo del torso costante all'inizio. Spalle e anche salgono insieme.",check:t=>{const a=t.filter(i=>i.phase==="CONCENTRIC"&&(i.angles.knee||180)>130);if(a.length<2)return!1;const r=a[0].angles.torso||0;return(a[Math.min(1,a.length-1)].angles.torso||0)>r+10}},{code:"ARMS_BENT",severity:"MEDIUM",description:"Braccia flesse durante il pull - bicipiti a rischio",correction:'Braccia sempre dritte come ganci. Pensa "braccia di corda".',check:t=>t.some(a=>(a.angles.elbow||180)<160)},{code:"INCOMPLETE_LOCKOUT",description:"Lockout incompleto - anche e ginocchia non estese",correction:"Estendi completamente anche e ginocchia. Stringi i glutei in cima.",check:t=>{const a=t.find(i=>i.phase==="LOCKOUT");if(!a)return!1;const r=a.angles.knee||180,s=a.angles.hip||180;return r<170||s<175}},{code:"BAR_AROUND_KNEES",description:"Bilanciere che gira intorno alle ginocchia invece di salire dritto",correction:'Le ginocchia devono togliersi di mezzo. "Spingi il pavimento" invece di "tirare la barra".',check:t=>{const a=t.filter(i=>i.barPath).map(i=>i.barPath);if(a.length<5)return!1;const r=a.map(i=>i.x);return Math.max(...r)-Math.min(...r)>.08}}];function Qm(t,a,r,s,i,o){const l=as(t,"left"),n=as(t,"right"),c=(l+n)/2,u=ss(t,"left"),d=ss(t,"right"),p=(u+d)/2,f=rr(t),h=Fc(t.left_shoulder,t.left_elbow,t.left_wrist),x=ir(t),g=aa(t.left_wrist,t.right_wrist),y=aa(t.left_shoulder,t.right_shoulder),v=[],S={frameNumber:a,timestamp:r,phase:s,angles:{knee:c,hip:p,torso:f,elbow:h},barPath:{x:g.x,y:g.y,deviationFromVertical:Math.abs(g.x-y.x)*100},spineNeutral:x,issues:v};for(const P of Zm)P.check(S,o)&&v.push({type:"SAFETY",code:P.code,severity:P.severity,timestamp:r,frameNumber:a,description:P.description,correction:P.correction});return S}function Jm(t,a){const r=t.filter(n=>n.phase==="CONCENTRIC"||n.phase==="MID_RANGE");if(r.length<3)return{detected:!1};let s=null,i=1/0;for(const n of r)n.velocity!==void 0&&n.velocity<i&&n.velocity>0&&(i=n.velocity,s=n);if(!s)return{detected:!1};const o=s.angles.knee||180,l=s.angles.hip||180;return o<140?{detected:!0,position:"BOTTOM",angleAtSticking:o,diagnosis:{muscular:["Quadricipiti deboli","Deficit nel drive iniziale"],technical:["Setup non ottimale","Anche troppo basse","Barra troppo lontana"]},recommendations:{accessories:['Deficit deadlift (2-4")',"Pause deadlift al ginocchio","Front squat"],cues:["Spingi il pavimento via","Petto alto dal primo centimetro","Braccia dritte"]}}:o>=140&&l<150?{detected:!0,position:"MID_RANGE",angleAtSticking:l,diagnosis:{muscular:["Glutei deboli","Estensori anca carenti","Femorali deboli"],technical:["Barra che si allontana","Ginocchia nel percorso","Torso che cede"]},recommendations:{accessories:["Block pull (sotto ginocchio)","Romanian deadlift","Hip thrust","Good morning"],cues:["Stringi i glutei passando le ginocchia","Tieni la barra attaccata","Spingi le anche avanti"]}}:{detected:!0,position:"LOCKOUT",angleAtSticking:l,diagnosis:{muscular:["Glutei deboli in accorciamento","Erettori spinali affaticati"],technical:["Perdita di posizione","Iperestensione per compensare"]},recommendations:{accessories:["Block pull (sopra ginocchio)","Barbell hip thrust","Rack pull"],cues:["Stringi i glutei come a schiacciare una noce",'Non iperestendere, solo "tall posture"']}}}function ep(t){const a=[];t.filter(n=>n.spineNeutral===!1).length===0&&a.push("Spine neutrale mantenuta durante tutto il movimento"),t.filter(n=>n.barPath&&n.barPath.deviationFromVertical>5).length===0&&a.push("Ottimo percorso barra - verticale e vicino al corpo");const i=t.find(n=>n.phase==="LOCKOUT");if(i){const n=i.angles.hip||0,c=i.angles.knee||0;n>=175&&c>=170&&a.push("Lockout completo e controllato")}t.filter(n=>(n.angles.elbow||180)<165).length===0&&a.push("Braccia dritte durante tutto il pull");const l=t.find(n=>n.phase==="SETUP");if(l){const n=l.angles.torso||0;n>=40&&n<=60&&a.push("Setup con buon angolo del torso")}return a}function tp(t,a,r){const s=[],i=[],o=[];for(const l of t)switch(l.code){case"LOWER_BACK_ROUND":s.push("Riduci il carico e focalizzati sul setup"),s.push('"Petto fuori, mostra il logo della maglietta"'),i.push("Good morning leggero 3x12","Back extension 3x15"),o.push("Cat-cow stretch","Jefferson curl leggero");break;case"BAR_DRIFT_FORWARD":s.push("Inizia con la barra a contatto con le tibie"),s.push('Tira "verso di te" mentre sollevi'),i.push("Paused deadlift (pausa al ginocchio)");break;case"HIPS_TOO_LOW":s.push("Solleva le anche fino a sentire tensione nei femorali"),s.push("Non Ã¨ uno squat, Ã¨ un hip hinge");break;case"HIPS_RISE_FIRST":s.push("Mantieni il petto alto dal primo centimetro"),s.push("Spalle e anche salgono insieme"),i.push('Paused deadlift (pausa a 2" dal pavimento)');break;case"ARMS_BENT":s.push("Pensa alle braccia come corde - solo ganci"),s.push("Rilassa le braccia prima di tirare");break;case"HYPEREXTENSION_LOCKOUT":s.push("In cima: glutei stretti, non spingere le anche avanti"),s.push('Pensa "tall posture", non "lean back"');break;case"HIP_SHIFT":s.push("Attiva i glutei simmetricamente prima di iniziare il pull"),s.push("Concentrati su spingere il pavimento con entrambi i piedi"),i.push("Single leg RDL 3x8 per lato","Hip thrust unilaterale 3x10");break;case"TORSO_ROTATION_DEADLIFT":s.push("Mantieni le spalle allineate - salgono insieme"),s.push("Verifica che la presa sia simmetrica"),i.push("Single arm row 3x10 lato debole","Pallof press 3x12");break;case"KNEE_EXTENSION_ASYMMETRY":s.push("Le ginocchia devono estendersi insieme"),i.push("Single leg press 3x10","Leg extension unilaterale");break;case"UPPER_BACK_ROUNDING_ASYMMETRIC":s.push("Retrarre le scapole prima di tirare"),i.push("Single arm row lato debole 3x12","Face pull unilaterale");break;case"SCAPULAR_PROTRACTION_DEADLIFT":s.push('"Metti le scapole nelle tasche posteriori"'),s.push("Upper back attivo prima di staccare dal pavimento"),i.push("Barbell row 3x10","Face pull 3x15","Shrug con hold");break}return(r==null?void 0:r.type)==="LONG_ARMS"&&s.push("Con braccia lunghe puoi tenere le anche piÃ¹ alte - sfruttalo"),(r==null?void 0:r.type)==="LONG_FEMUR"&&a==="conventional"&&s.push("Con femori lunghi considera lo stile sumo"),{immediate:[...new Set(s)].slice(0,4),accessories:[...new Set(i)].slice(0,4),mobility:[...new Set(o)].slice(0,2)}}function ap(t,a,r){const s=[];for(const p of t)s.push(...p.issues);for(const p of Xm)p.check(t,r)&&s.push({type:"EFFICIENCY",code:p.code,severity:p.severity||"MEDIUM",description:p.description,correction:p.correction});const i=sp(s),l=rp(i).slice(0,2),n=ep(t),c=Jm(t),u=tp(l,a,r);c.detected&&c.recommendations&&(u.accessories.push(...c.recommendations.accessories),u.immediate.push(...c.recommendations.cues));const d=ip(l,n);return{issues:l,strengths:n,stickingPoint:c,recommendations:{immediate:[...new Set(u.immediate)].slice(0,3),accessories:[...new Set(u.accessories)].slice(0,4),mobility:[...new Set(u.mobility)].slice(0,2)},overallScore:d}}function sp(t){const a=new Set;return t.filter(r=>a.has(r.code)?!1:(a.add(r.code),!0))}function rp(t){const a={SAFETY:0,EFFICIENCY:1,OPTIMIZATION:2},r={HIGH:0,MEDIUM:1,LOW:2};return t.sort((s,i)=>{const o=a[s.type]-a[i.type];return o!==0?o:r[s.severity]-r[i.severity]})}function ip(t,a){let r=10;for(const s of t)s.type==="SAFETY"?r-=s.severity==="HIGH"?2.5:s.severity==="MEDIUM"?1.5:1:s.type==="EFFICIENCY"?r-=s.severity==="HIGH"?1.5:s.severity==="MEDIUM"?1:.5:r-=.5;return r+=Math.min(a.length*.3,1),Math.max(1,Math.min(10,Math.round(r*10)/10))}const np=[{code:"SHOULDER_IMPINGEMENT_RISK",severity:"HIGH",description:"Gomiti troppo larghi (>75Â° dal torso) - rischio impingement spalla",correction:'Tieni i gomiti a 45-75Â° rispetto al torso. Non fare la "T" con il corpo.',check:t=>(t.angles.shoulderAbduction||0)>80},{code:"ELBOW_FLARE_90",severity:"HIGH",description:"Gomiti a 90Â° dal corpo - massimo stress sulla spalla",correction:"Forma una freccia (â†‘) con il corpo, non una T. Gomiti a 45-60Â°.",check:t=>{const a=t.angles.shoulderAbduction||0;return a>85&&a<95}},{code:"WRIST_FLEXION",severity:"MEDIUM",description:"Polsi flessi all'indietro - stress articolare",correction:"Bilanciere sulla base del palmo, polso neutro. Stack verticale: polso-gomito-spalla.",check:t=>(t.angles.wrist||0)<-15},{code:"FEET_UNSTABLE",severity:"LOW",description:"Piedi non stabili - perdita di leg drive",correction:"Piedi piantati a terra, spingi come se volessi scivolare verso la testa.",check:t=>!1},{code:"SHOULDER_PROTRACTION",severity:"MEDIUM",description:"Spalle protratte (in avanti) - perdita di stabilitÃ ",correction:'Scapole retratte e depresse. "Metti le scapole nelle tasche posteriori".',check:t=>!1},{code:"BUTT_OFF_BENCH",severity:"MEDIUM",description:"Glutei che si alzano dalla panca",correction:"Mantieni i glutei sulla panca. Arco lombare sÃ¬, ma glutei giÃ¹.",check:t=>!1}],op=[{code:"BAR_PATH_TOO_STRAIGHT",description:"Traiettoria troppo verticale - inefficiente",correction:"La barra deve fare una leggera curva: giÃ¹ verso il petto basso, su verso lockout sopra le spalle.",check:t=>{const a=t.filter(i=>i.barPath).map(i=>i.barPath);if(a.length<5)return!1;const r=a.map(i=>i.x);return Math.max(...r)-Math.min(...r)<.03}},{code:"NO_LEG_DRIVE",description:"Mancanza di leg drive - potenza persa",correction:"Piedi piantati, spingi il pavimento mentre premi. La forza parte dalle gambe.",check:t=>!1},{code:"TOUCH_TOO_HIGH",description:"Barra che tocca troppo in alto (sul petto alto o collo)",correction:"La barra dovrebbe toccare sul petto basso/sterno, sotto i capezzoli.",check:t=>{const a=t.find(r=>r.phase==="BOTTOM");return!a||!a.barPath?!1:a.barPath.y<.3}},{code:"INCOMPLETE_ROM",description:"ROM incompleto - barra non tocca il petto",correction:"Scendi fino a toccare il petto (pausa minima). ROM completo = guadagni completi.",check:t=>{const a=t.find(s=>s.phase==="BOTTOM");return a?(a.angles.elbow||180)>100:!1}},{code:"UNEVEN_PRESS",description:"Pressione asimmetrica - un braccio spinge prima",correction:"Controlla allo specchio/video. Lavora con dumbbell per correggere.",check:t=>!1},{code:"NO_SCAPULAR_RETRACTION",description:"Scapole non retratte - base instabile",correction:"Prima di staccare la barra: scapole insieme e giÃ¹. Mantieni per tutto il set.",check:t=>!1}];function lp(t,a,r,s,i){const o=rs(t,"left"),l=rs(t,"right"),n=(o+l)/2;aa(t.left_shoulder,t.right_shoulder);const c=ln(t,"left"),u=ln(t,"right"),d=(c+u)/2,p=aa(t.left_wrist,t.right_wrist),f=[],h={frameNumber:a,timestamp:r,phase:s,angles:{elbow:n,shoulderAbduction:d},barPath:{x:p.x,y:p.y,deviationFromVertical:0},issues:f};for(const x of np)x.check(h,i)&&f.push({type:"SAFETY",code:x.code,severity:x.severity,timestamp:r,frameNumber:a,description:x.description,correction:x.correction});return h}function cp(t){const a=t.filter(o=>o.phase==="CONCENTRIC"||o.phase==="MID_RANGE");if(a.length<3)return{detected:!1};let r=null,s=1/0;for(const o of a)o.velocity!==void 0&&o.velocity<s&&o.velocity>0&&(s=o.velocity,r=o);if(!r)return{detected:!1};const i=r.angles.elbow||180;return i<100?{detected:!0,position:"BOTTOM",angleAtSticking:i,diagnosis:{muscular:["Pettorali deboli in allungamento","Deltoidi anteriori carenti"],technical:["Mancanza di leg drive","Touch point sbagliato","Perdita di tensione"]},recommendations:{accessories:['Spoto press (pausa 2-3")',"Dumbbell press","Floor press"],cues:["Leg drive appena stacchi dal petto",'Pensa a "piegare la barra"',"Esplosivo dal basso"]}}:i>=100&&i<150?{detected:!0,position:"MID_RANGE",angleAtSticking:i,diagnosis:{muscular:["Tricipiti deboli","Deltoidi anteriori carenti"],technical:["Gomiti che flare out","Bar path scorretto"]},recommendations:{accessories:["Close grip bench","Pin press (altezza sticking)","JM press","Dip"],cues:["Tuck i gomiti leggermente","Spingi verso il lockout, non verso l'alto"]}}:{detected:!0,position:"LOCKOUT",angleAtSticking:i,diagnosis:{muscular:["Tricipiti deboli in estensione"],technical:["Perdita di traiettoria","Gomiti che driftano"]},recommendations:{accessories:["Board press","Tricep pushdown","Skull crusher","Pin press alto"],cues:["Estendi completamente","Spingi le spalle nel pad"]}}}function dp(t){const a=[],r=t.find(l=>l.phase==="BOTTOM");r&&(r.angles.elbow||180)<95&&a.push("ROM completo - barra al petto"),t.filter(l=>{const n=l.angles.shoulderAbduction||0;return n>80||n<40}).length===0&&a.push("Ottima posizione dei gomiti (45-75Â°)");const i=t.find(l=>l.phase==="LOCKOUT");return i&&(i.angles.elbow||0)>170&&a.push("Lockout completo"),t.filter(l=>l.phase==="ECCENTRIC").length>3&&a.push("Buon controllo nella discesa"),a}function up(t,a){var o;const r=[],s=[],i=[];for(const l of t)switch(l.code){case"SHOULDER_IMPINGEMENT_RISK":case"ELBOW_FLARE_90":r.push("Tuck i gomiti: pensa a formare una freccia (â†‘), non una T"),r.push("Angolo gomiti 45-60Â° rispetto al torso"),i.push("Shoulder dislocates con banda","Sleeper stretch");break;case"WRIST_FLEXION":r.push("Barra sulla base del palmo, non sulle dita"),r.push("Polso in linea con l'avambraccio (stack verticale)"),s.push("Lavoro di grip e avambracci");break;case"BAR_PATH_TOO_STRAIGHT":r.push("Tocca il petto basso, spingi verso il lockout sopra le spalle"),r.push("Il path Ã¨ una J rovesciata");break;case"INCOMPLETE_ROM":r.push("Scendi fino a toccare il petto, pausa breve, poi spingi"),s.push("Spoto press (pausa lunga sul petto)");break;case"NO_SCAPULAR_RETRACTION":r.push("Setup: scapole insieme e in basso prima di staccare"),r.push('"Metti le scapole nelle tasche posteriori"'),s.push("Face pull","Band pull apart");break}return(a==null?void 0:a.type)==="LONG_ARMS"&&(r.push("Con braccia lunghe: ROM maggiore Ã¨ normale, non abbreviarlo"),s.push("Floor press per lavorare sulla porzione centrale")),((o=a==null?void 0:a.benchImplications)==null?void 0:o.gripWidth)==="wide"&&r.push("Considera una presa piÃ¹ larga per ridurre il ROM"),{immediate:[...new Set(r)].slice(0,4),accessories:[...new Set(s)].slice(0,4),mobility:[...new Set(i)].slice(0,2)}}function mp(t,a){const r=[];for(const d of t)r.push(...d.issues);for(const d of op)d.check(t,a)&&r.push({type:"EFFICIENCY",code:d.code,severity:"MEDIUM",description:d.description,correction:d.correction});const s=pp(r),o=hp(s).slice(0,2),l=dp(t),n=cp(t),c=up(o,a);n.detected&&n.recommendations&&(c.accessories.push(...n.recommendations.accessories),c.immediate.push(...n.recommendations.cues));const u=gp(o,l);return{issues:o,strengths:l,stickingPoint:n,recommendations:{immediate:[...new Set(c.immediate)].slice(0,3),accessories:[...new Set(c.accessories)].slice(0,4),mobility:[...new Set(c.mobility)].slice(0,2)},overallScore:u}}function ln(t,a){const r=a==="left"?t.left_shoulder:t.right_shoulder,s=a==="left"?t.left_elbow:t.right_elbow,i=a==="left"?t.left_hip:t.right_hip,o={x:r.x-i.x,y:r.y-i.y},l={x:s.x-r.x,y:s.y-r.y},n=o.x*l.x+o.y*l.y,c=o.x*l.y-o.y*l.x;let u=Math.atan2(Math.abs(c),n)*(180/Math.PI);return 90-Math.abs(u-90)}function pp(t){const a=new Set;return t.filter(r=>a.has(r.code)?!1:(a.add(r.code),!0))}function hp(t){const a={SAFETY:0,EFFICIENCY:1,OPTIMIZATION:2},r={HIGH:0,MEDIUM:1,LOW:2};return t.sort((s,i)=>{const o=a[s.type]-a[i.type];return o!==0?o:r[s.severity]-r[i.severity]})}function gp(t,a){let r=10;for(const s of t)s.type==="SAFETY"?r-=s.severity==="HIGH"?2:s.severity==="MEDIUM"?1.5:1:s.type==="EFFICIENCY"?r-=s.severity==="HIGH"?1.5:s.severity==="MEDIUM"?1:.5:r-=.5;return r+=Math.min(a.length*.3,1),Math.max(1,Math.min(10,Math.round(r*10)/10))}const fp=[{code:"LUMBAR_FLEXION",severity:"HIGH",description:"Schiena che si arrotonda durante la tirata",correction:"Riduci il carico. Mantieni il petto alto e core attivo.",check:t=>t.spineNeutral===!1},{code:"CERVICAL_EXTENSION",severity:"MEDIUM",description:"Collo iperesteso (guardi troppo in alto)",correction:"Sguardo a 2-3 metri davanti a te, collo neutro con la spine.",check:t=>(t.angles.neck||0)>30},{code:"SHOULDER_ELEVATION",severity:"MEDIUM",description:"Spalle che salgono verso le orecchie",correction:'Deprimi le scapole prima di tirare. "Spalle in tasca".',check:t=>!1}],xp=[{code:"INCOMPLETE_ROM",description:"ROM incompleto - gomito non supera il torso",correction:"Tira fino a toccare l'addome/petto basso. Stringi le scapole.",check:t=>{const a=t.find(r=>r.phase==="PEAK_CONTRACTION"||r.phase==="TOP");return a?!a.elbowBehindTorso:!1}},{code:"ARM_DOMINANT",description:"Movimento dominato dalle braccia, non dalla schiena",correction:'Inizia retraendo le scapole, POI fletti i gomiti. Pensa a "tirare con i gomiti".',check:t=>!1},{code:"MOMENTUM_EXCESSIVE",description:"Troppo slancio dal torso (cheating eccessivo)",correction:"Riduci il carico. Il torso deve restare relativamente fermo.",check:t=>{const a=t.map(s=>s.angles.torso||0);return a.length<5?!1:Math.max(...a)-Math.min(...a)>25}},{code:"ELBOW_FLARE",description:"Gomiti troppo larghi (piÃ¹ deltoide, meno dorsale)",correction:"Gomiti a 30-45Â° dal torso per enfatizzare i dorsali.",check:t=>t.some(a=>(a.angles.elbowFlare||0)>60)}],bp=[{code:"BEHIND_NECK",severity:"HIGH",description:"Tirata dietro il collo - alto rischio spalla",correction:"Tira sempre davanti, al petto. Dietro il collo stressa la cuffia dei rotatori.",check:t=>!1},{code:"SHOULDER_INTERNAL_ROTATION",severity:"MEDIUM",description:"Spalle ruotate internamente (chiuse in avanti)",correction:"Apri il petto, porta le spalle indietro prima di tirare.",check:t=>!1}],vp=[{code:"NO_SCAPULAR_DEPRESSION",description:"Scapole che non si deprimono (restano alte)",correction:"Inizia il movimento abbassando le scapole, POI tira con le braccia.",check:t=>!1},{code:"INCOMPLETE_ROM_TOP",description:"Mento non supera la barra / petto non alla barra",correction:"Tira fino a portare il petto alla barra, non solo il mento.",check:t=>{const a=t.find(r=>r.phase==="TOP");return a?a.chinAboveBar===!1:!1}},{code:"INCOMPLETE_ROM_BOTTOM",description:"Braccia non completamente estese tra le rep",correction:"Scendi fino a braccia tese per massimo stretch dei dorsali.",check:t=>{const a=t.find(r=>r.phase==="BOTTOM");return a?(a.angles.elbow||0)<170:!1}},{code:"BICEP_DOMINANT",description:"Movimento dominato dai bicipiti, dorsali sotto-attivati",correction:'Pensa a "tirare con i gomiti", non con le mani.',check:t=>!1},{code:"KIPPING_EXCESSIVE",severity:"MEDIUM",description:"Kipping eccessivo (oscillazione anche)",correction:"Per ipertrofia, controlla la discesa. Kipping solo per performance/CrossFit.",check:t=>{const a=t.map(s=>{var i;return((i=s.barPath)==null?void 0:i.y)||0});return a.length<5?!1:Math.max(...a)-Math.min(...a)>.15}}];function yp(t,a,r,s,i){const o=rs(t,"left"),l=rr(t),n=ir(t),c=t.left_shoulder,u=t.left_elbow,d=t.left_hip,p=u.x<c.x&&u.x<d.x,f=[],h={frameNumber:a,timestamp:r,phase:s,angles:{elbow:o,torso:l},spineNeutral:n,elbowBehindTorso:p,issues:f};for(const x of fp)x.check(h,i)&&f.push({type:"SAFETY",code:x.code,severity:x.severity,timestamp:r,frameNumber:a,description:x.description,correction:x.correction});return h}function wp(t,a,r,s,i){const o=rs(t,"left"),l=t.nose,n=aa(t.left_wrist,t.right_wrist),c=l.y<n.y,u=[],d={frameNumber:a,timestamp:r,phase:s,angles:{elbow:o},chinAboveBar:c,issues:u};for(const p of bp)p.check(d,i)&&u.push({type:"SAFETY",code:p.code,severity:p.severity,timestamp:r,frameNumber:a,description:p.description,correction:p.correction});return d}function Np(t){const a=t.filter(o=>o.phase==="CONCENTRIC"||o.phase==="MID_RANGE");if(a.length<3)return{detected:!1};let r=null,s=1/0;for(const o of a)o.velocity!==void 0&&o.velocity<s&&o.velocity>0&&(s=o.velocity,r=o);if(!r)return{detected:!1};const i=r.angles.elbow||180;return i>100&&i<150?{detected:!0,position:"MID_RANGE",angleAtSticking:i,diagnosis:{muscular:["Romboidi deboli","Trapezio medio carente"],technical:["Mancata attivazione scapolare","Tirare con le braccia"]},recommendations:{accessories:["Face pull","Prone Y raise","Scapular row (senza flessione gomito)"],cues:["Spremi un limone tra le scapole","Tira con i gomiti, non con le mani"]}}:i<=100?{detected:!0,position:"LOCKOUT",angleAtSticking:i,diagnosis:{muscular:["Deficit picco contrazione dorsale"],technical:["ROM abbreviato abitualmente"]},recommendations:{accessories:["Pause row (2s al petto)","Chest-supported row","Seal row"],cues:["Tocca la pancia con la barra","Pausa di 1s in cima","Squeeze scapole"]}}:{detected:!1}}function Sp(t){const a=t.filter(o=>o.phase==="CONCENTRIC"||o.phase==="MID_RANGE");if(a.length<3)return{detected:!1};let r=null,s=1/0;for(const o of a)o.velocity!==void 0&&o.velocity<s&&o.velocity>0&&(s=o.velocity,r=o);if(!r)return{detected:!1};const i=r.angles.elbow||180;return i>140?{detected:!0,position:"BOTTOM",angleAtSticking:i,diagnosis:{muscular:["Dorsali deboli in allungamento","Gran rotondo carente"],technical:["Mancata depressione scapolare"]},recommendations:{accessories:["Straight arm pulldown","Scapular pull-up","Dead hang attivo"],cues:["Parti sempre dalle scapole","Deprimi le scapole prima di tirare"]}}:i<100?{detected:!0,position:"LOCKOUT",angleAtSticking:i,diagnosis:{muscular:["Trapezio basso debole","Bicipiti limitanti"],technical:["Perdita di tensione scapolare"]},recommendations:{accessories:["Chin-up isometriche in cima","Row inverso alto","Flexed arm hang"],cues:["Porta il petto alla barra, non il mento","Gomiti verso i fianchi"]}}:{detected:!1}}function Oo(t,a){const r=[];if(a==="row"){const s=t.find(n=>n.phase==="PEAK_CONTRACTION"||n.phase==="TOP");s&&s.elbowBehindTorso&&r.push("ROM completo - gomito oltre il torso"),t.filter(n=>n.spineNeutral===!1).length===0&&r.push("Spine neutrale mantenuta");const o=t.map(n=>n.angles.torso||0);Math.max(...o)-Math.min(...o)<15&&r.push("Ottima stabilitÃ  del torso")}if(a==="pullup"){const s=t.find(o=>o.phase==="TOP");s&&s.chinAboveBar&&r.push("ROM completo - mento sopra la barra");const i=t.find(o=>o.phase==="BOTTOM");i&&(i.angles.elbow||0)>170&&r.push("Estensione completa tra le rep")}return r}function Bo(t,a,r){const s=[],i=[],o=[];for(const l of t)switch(l.code){case"LUMBAR_FLEXION":s.push("Riduci il carico, petto alto"),i.push("Bird dog","Plank");break;case"INCOMPLETE_ROM":case"INCOMPLETE_ROM_TOP":s.push("Tira fino in fondo, pausa in contrazione"),i.push("Pause row/pull-up","Isometriche in peak contraction");break;case"MOMENTUM_EXCESSIVE":case"KIPPING_EXCESSIVE":s.push("Rallenta, controlla ogni rep"),s.push("Se vuoi kipping, fai un set separato");break;case"ARM_DOMINANT":case"BICEP_DOMINANT":s.push("Inizia dalle scapole, poi le braccia"),s.push("Pensa a tirare con i gomiti"),i.push("Straight arm pulldown","Scapular pulls");break;case"NO_SCAPULAR_DEPRESSION":s.push("Parti sempre deprimendo le scapole"),i.push("Scapular pull-up","Dead hang attivo");break}return{immediate:[...new Set(s)].slice(0,4),accessories:[...new Set(i)].slice(0,4),mobility:[...new Set(o)].slice(0,2)}}function jp(t,a){const r=[];for(const d of t)r.push(...d.issues);for(const d of xp)d.check(t,a)&&r.push({type:"EFFICIENCY",code:d.code,severity:"MEDIUM",description:d.description,correction:d.correction});const s=Fo(r),o=$o(s).slice(0,2),l=Oo(t,"row"),n=Np(t),c=Bo(o);n.detected&&n.recommendations&&(c.accessories.push(...n.recommendations.accessories),c.immediate.push(...n.recommendations.cues));const u=qo(o,l);return{issues:o,strengths:l,stickingPoint:n,recommendations:{immediate:[...new Set(c.immediate)].slice(0,3),accessories:[...new Set(c.accessories)].slice(0,4),mobility:[...new Set(c.mobility)].slice(0,2)},overallScore:u}}function _p(t,a){const r=[];for(const d of t)r.push(...d.issues);for(const d of vp)d.check(t,a)&&r.push({type:"EFFICIENCY",code:d.code,severity:"MEDIUM",description:d.description,correction:d.correction});const s=Fo(r),o=$o(s).slice(0,2),l=Oo(t,"pullup"),n=Sp(t),c=Bo(o);n.detected&&n.recommendations&&(c.accessories.push(...n.recommendations.accessories),c.immediate.push(...n.recommendations.cues));const u=qo(o,l);return{issues:o,strengths:l,stickingPoint:n,recommendations:{immediate:[...new Set(c.immediate)].slice(0,3),accessories:[...new Set(c.accessories)].slice(0,4),mobility:[...new Set(c.mobility)].slice(0,2)},overallScore:u}}function Fo(t){const a=new Set;return t.filter(r=>a.has(r.code)?!1:(a.add(r.code),!0))}function $o(t){const a={SAFETY:0,EFFICIENCY:1,OPTIMIZATION:2},r={HIGH:0,MEDIUM:1,LOW:2};return t.sort((s,i)=>{const o=a[s.type]-a[i.type];return o!==0?o:r[s.severity]-r[i.severity]})}function qo(t,a){let r=10;for(const s of t)s.type==="SAFETY"?r-=s.severity==="HIGH"?2:s.severity==="MEDIUM"?1.5:1:r-=s.severity==="HIGH"?1.5:s.severity==="MEDIUM"?1:.5;return r+=Math.min(a.length*.3,1),Math.max(1,Math.min(10,Math.round(r*10)/10))}const Pp=[{code:"LUMBAR_FLEXION",severity:"HIGH",description:"Bacino che si solleva dalla seduta (butt wink)",correction:"Non scendere troppo. Fermati prima che il bacino si stacchi dal pad.",check:t=>t.spineNeutral===!1},{code:"KNEE_VALGUS",severity:"HIGH",description:"Ginocchia che collassano verso l'interno",correction:"Spingi le ginocchia in fuori, in linea con le punte dei piedi.",check:t=>Math.abs(t.angles.kneeValgus||0)>10},{code:"KNEES_LOCK_HARD",severity:"MEDIUM",description:"Ginocchia completamente bloccate in estensione",correction:"Mantieni un leggero soft lock. Non iperestendere mai le ginocchia.",check:t=>(t.angles.knee||0)>178},{code:"HEELS_LIFT",severity:"MEDIUM",description:"Talloni che si sollevano dalla pedana",correction:"Spingi attraverso tutto il piede, talloni sempre a contatto.",check:t=>t.heelContact===!1}],Rp=[{code:"INSUFFICIENT_ROM",description:"ROM insufficiente - ginocchia non flettono abbastanza",correction:"Scendi fino a 90Â° di flessione del ginocchio (o piÃ¹ se la mobilitÃ  lo permette).",check:t=>{const a=t.find(r=>r.phase==="BOTTOM");return a?(a.angles.knee||180)>110:!1}},{code:"ASYMMETRIC_PUSH",description:"Spinta asimmetrica - un lato lavora piÃ¹ dell'altro",correction:"Concentrati su una spinta uniforme. Considera leg press unilaterale.",check:t=>!1}],kp=[{code:"LUMBAR_FLEXION",severity:"HIGH",description:"Schiena che si arrotonda durante la tirata",correction:"Petto alto, core attivo. Se non riesci, riduci il peso.",check:t=>t.spineNeutral===!1},{code:"SHOULDER_PROTRACTION",severity:"MEDIUM",description:"Spalle che vanno troppo avanti nella fase eccentrica",correction:"Controlla la fase negativa. Non lasciare che il peso ti tiri in avanti.",check:t=>(t.angles.torso||0)>30},{code:"CERVICAL_EXTENSION",severity:"LOW",description:"Collo iperesteso",correction:"Sguardo dritto davanti, collo neutro.",check:t=>(t.angles.neck||0)>25}],Cp=[{code:"INCOMPLETE_ROM",description:"ROM incompleto - maniglia non arriva all'addome",correction:"Tira fino a toccare l'addome basso. Squeeze delle scapole in cima.",check:t=>{const a=t.find(r=>r.phase==="PEAK_CONTRACTION");return a?!a.elbowBehindTorso:!1}},{code:"NO_SCAPULAR_RETRACTION",description:"Manca la retrazione scapolare",correction:"Stringi le scapole insieme alla fine del movimento.",check:t=>!1},{code:"EXCESSIVE_BODY_ENGLISH",description:"Troppo movimento del torso (cheating)",correction:"Il torso resta fermo. Solo le braccia si muovono.",check:t=>{const a=t.map(s=>s.angles.torso||0);return Math.max(...a)-Math.min(...a)>20}}],Ep=[{code:"BEHIND_NECK",severity:"HIGH",description:"Tirata dietro il collo",correction:"Tira SEMPRE davanti, al petto. Dietro il collo = rischio spalla.",check:t=>!1},{code:"EXCESSIVE_LEAN_BACK",severity:"MEDIUM",description:"Inclinazione eccessiva del torso all'indietro",correction:"Leggera inclinazione ok (15-20Â°), ma non trasformarlo in un row.",check:t=>(t.angles.torso||0)>35},{code:"SHOULDER_ELEVATION",severity:"MEDIUM",description:"Spalle che salgono verso le orecchie",correction:'Deprimi le scapole. "Spalle in tasca" prima di tirare.',check:t=>!1}],Ip=[{code:"INCOMPLETE_ROM_TOP",description:"Braccia non completamente estese in alto",correction:"Estendi completamente per massimo stretch dei dorsali.",check:t=>{const a=t.find(r=>r.phase==="TOP"||r.phase==="SETUP");return a?(a.angles.elbow||0)<170:!1}},{code:"INCOMPLETE_ROM_BOTTOM",description:"Barra non arriva al petto",correction:"Tira fino al petto alto/clavicola. Squeeze in basso.",check:t=>{const a=t.find(r=>r.phase==="BOTTOM");return a?(a.angles.elbow||180)>100:!1}},{code:"ARM_DOMINANT",description:"Tiri con le braccia invece che con i dorsali",correction:"Inizia deprimendo le scapole, poi tira con i gomiti.",check:t=>!1}],Tp=[{code:"SHOULDER_PROTRACTION_EXCESSIVE",severity:"MEDIUM",description:"Spalle che vanno troppo avanti (perdita retrazione)",correction:"Mantieni le scapole retratte per tutto il movimento.",check:t=>!1},{code:"ELBOW_FLARE",severity:"MEDIUM",description:"Gomiti troppo larghi (>75Â° dal torso)",correction:"Gomiti a 45-60Â° dal corpo per proteggere le spalle.",check:t=>(t.angles.shoulderAbduction||0)>75},{code:"WRIST_FLEXION",severity:"LOW",description:"Polsi flessi",correction:"Polsi neutri, in linea con gli avambracci.",check:t=>(t.angles.wrist||0)<-15}],Ap=[{code:"INCOMPLETE_ROM",description:"ROM incompleto",correction:"Full ROM: stretch completo in basso, estensione completa in alto.",check:t=>{const a=t.find(r=>r.phase==="BOTTOM");return a?(a.angles.elbow||180)>100:!1}},{code:"UNEVEN_PUSH",description:"Spinta asimmetrica",correction:"Spingi in modo uniforme con entrambe le braccia.",check:t=>!1}],Mp=[{code:"LUMBAR_HYPEREXTENSION",severity:"HIGH",description:"Eccessiva estensione lombare",correction:"Core attivo, schiena contro il pad. Se inarchi, il peso Ã¨ troppo.",check:t=>(t.angles.lumbar||0)>25},{code:"NECK_FORWARD",severity:"MEDIUM",description:"Testa che va in avanti",correction:"Testa contro il poggiatesta, mento neutro.",check:t=>!1}],Lp=[{code:"INCOMPLETE_LOCKOUT",description:"Braccia non completamente estese in alto",correction:"Estendi completamente senza bloccare i gomiti di scatto.",check:t=>{const a=t.find(r=>r.phase==="LOCKOUT");return a?(a.angles.elbow||0)<170:!1}}],Dp=[{code:"HIP_FLEXION",severity:"MEDIUM",description:"Anche che si sollevano dalla panca",correction:"Tieni le anche premute contro il pad per tutto il movimento.",check:t=>!1},{code:"LUMBAR_HYPEREXTENSION",severity:"MEDIUM",description:"Schiena che si inarca eccessivamente",correction:"Core attivo, non inarcare per compensare.",check:t=>(t.angles.lumbar||0)>20}],zp=[{code:"KNEE_HYPEREXTENSION",severity:"HIGH",description:"Ginocchia iperestese in cima",correction:"Fermati appena prima del lockout completo.",check:t=>(t.angles.knee||0)>178},{code:"MOMENTUM_EXCESSIVE",severity:"MEDIUM",description:"Troppo slancio - movimento non controllato",correction:"Movimento lento e controllato, 2-3 secondi per fase.",check:t=>!1}];function Op(t,a,r,s,i,o){const l=as(t,"left"),n=ss(t,"left"),c=rs(t,"left"),u=rr(t),d=ir(t),p=[],f={frameNumber:a,timestamp:r,phase:s,angles:{knee:l,hip:n,elbow:c,torso:u},spineNeutral:d,issues:p};let h=[];switch(i){case"leg_press":h=Pp;break;case"cable_row":h=kp;break;case"lat_pulldown":h=Ep;break;case"chest_press":h=Tp;break;case"shoulder_press":h=Mp;break;case"leg_curl":h=Dp;break;case"leg_extension":h=zp;break}for(const x of h)x.check(f,o)&&p.push({type:"SAFETY",code:x.code,severity:x.severity,timestamp:r,frameNumber:a,description:x.description,correction:x.correction});return f}function Bp(t,a,r){const s=[];for(const p of t)s.push(...p.issues);let i=[];switch(a){case"leg_press":i=Rp;break;case"cable_row":i=Cp;break;case"lat_pulldown":i=Ip;break;case"chest_press":i=Ap;break;case"shoulder_press":i=Lp;break}for(const p of i)p.check(t,r)&&s.push({type:"EFFICIENCY",code:p.code,severity:"MEDIUM",description:p.description,correction:p.correction});const o=qp(s),n=Hp(o).slice(0,2),c=Fp(t,a),u=$p(n),d=Wp(n,c);return{issues:n,strengths:c,stickingPoint:{detected:!1},recommendations:u,overallScore:d}}function Fp(t,a){const r=[],s=t.find(l=>l.phase==="BOTTOM");t.find(l=>l.phase==="TOP"||l.phase==="LOCKOUT"),a==="leg_press"&&s&&(s.angles.knee||180)<100&&r.push("Buona profonditÃ  nel leg press"),t.filter(l=>l.spineNeutral===!1).length===0&&r.push("Postura della schiena corretta");const o=t.map(l=>l.velocity||0).filter(l=>l>0);return o.length>0&&o.reduce((n,c)=>n+c,0)/o.length<.3&&r.push("Buon controllo del movimento"),r}function $p(t,a){const r=[],s=[],i=[];for(const o of t)switch(o.code){case"LUMBAR_FLEXION":r.push("Riduci il ROM o il carico"),i.push("Hip flexor stretch","Glute bridge");break;case"KNEE_VALGUS":r.push("Piedi leggermente piÃ¹ larghi"),s.push("Clamshell","Lateral band walk");break;case"INCOMPLETE_ROM":r.push("Full ROM con peso controllabile");break;case"EXCESSIVE_BODY_ENGLISH":case"MOMENTUM_EXCESSIVE":r.push("Riduci il peso, controlla ogni rep");break;case"ELBOW_FLARE":r.push("Gomiti piÃ¹ vicini al corpo");break}return{immediate:[...new Set(r)].slice(0,2),accessories:[...new Set(s)].slice(0,2),mobility:[...new Set(i)].slice(0,2)}}function qp(t){const a=new Set;return t.filter(r=>a.has(r.code)?!1:(a.add(r.code),!0))}function Hp(t){const a={SAFETY:0,EFFICIENCY:1,OPTIMIZATION:2},r={HIGH:0,MEDIUM:1,LOW:2};return t.sort((s,i)=>{const o=a[s.type]-a[i.type];return o!==0?o:r[s.severity]-r[i.severity]})}function Wp(t,a){let r=10;for(const s of t)s.type==="SAFETY"?r-=s.severity==="HIGH"?2:s.severity==="MEDIUM"?1.5:1:r-=s.severity==="HIGH"?1.5:s.severity==="MEDIUM"?1:.5;return r+=Math.min(a.length*.3,1),Math.max(1,Math.min(10,Math.round(r*10)/10))}function Gp(t,a){if(t.length===0)return{exercise:a.exercise,duration:0,framesAnalyzed:0,overallScore:0,issues:[],strengths:[],recommendations:{immediate:[],accessories:[],mobility:[]}};const r=$c(t[0]);if(!r.valid)return{exercise:a.exercise,duration:0,framesAnalyzed:0,overallScore:0,issues:[{type:"SAFETY",code:"INVALID_CAMERA_ANGLE",severity:"HIGH",description:r.message||"Inquadratura non valida",correction:"Posiziona la camera a 45Â° dietro e di lato (posteriore-laterale)"}],strengths:[],recommendations:{immediate:["Correggi la posizione della camera"],accessories:[],mobility:[]}};const s=qc(t[0]),i=Hc(s),o=a.fps||30,l=Up(t,a.exercise,o,i),n=Vp(l,a.exercise,i,a.style);return{exercise:a.exercise,duration:t.length/o,framesAnalyzed:t.length,estimatedProportions:s,morphotype:i,...n}}function Up(t,a,r,s,i){const o=[];let l=null;for(let n=0;n<t.length;n++){const c=n/r,u=t[n],d=Kp(u,l,a,n,t.length);let p;switch(a){case"BACK_SQUAT":case"FRONT_SQUAT":p=qm(u,n,c,d,s);break;case"DEADLIFT_CONVENTIONAL":case"DEADLIFT_SUMO":p=Qm(u,n,c,d,a==="DEADLIFT_SUMO"?"sumo":"conventional",s);break;case"BENCH_PRESS":p=lp(u,n,c,d,s);break;case"BARBELL_ROW":case"DUMBBELL_ROW":p=yp(u,n,c,d,s);break;case"PULL_UP":case"CHIN_UP":case"LAT_PULLDOWN":p=wp(u,n,c,d,s);break;case"LEG_PRESS":case"LEG_EXTENSION":case"LEG_CURL":case"CABLE_ROW":case"CHEST_PRESS":case"SHOULDER_PRESS_MACHINE":const f=a.toLowerCase().replace("_machine","");p=Op(u,n,c,d,f,s);break;case"PUSH_UP":case"DIP":case"LUNGE_FORWARD":case"BULGARIAN_SPLIT_SQUAT":case"ROMANIAN_DEADLIFT":case"HIP_THRUST":case"PISTOL_SQUAT":case"SKATER_SQUAT":case"ARCHER_PUSH_UP":case"INVERTED_ROW":p=Wc(u,n,c,d,a,s);break;default:p={frameNumber:n,timestamp:c,phase:d,angles:{},issues:[]}}l&&n>0&&(p.velocity=Yp(l,u,1/r)),o.push(p),l=u}return o}function Vp(t,a,r,s){switch(a){case"BACK_SQUAT":case"FRONT_SQUAT":return Um(t,r);case"DEADLIFT_CONVENTIONAL":case"DEADLIFT_SUMO":return ap(t,s,r);case"BENCH_PRESS":return mp(t,r);case"BARBELL_ROW":case"DUMBBELL_ROW":return jp(t,r);case"PULL_UP":case"CHIN_UP":case"LAT_PULLDOWN":return _p(t,r);case"LEG_PRESS":case"LEG_EXTENSION":case"LEG_CURL":case"CABLE_ROW":case"CHEST_PRESS":case"SHOULDER_PRESS_MACHINE":const i=a.toLowerCase().replace("_machine","");return Bp(t,i,r);case"PUSH_UP":case"DIP":case"LUNGE_FORWARD":case"BULGARIAN_SPLIT_SQUAT":case"ROMANIAN_DEADLIFT":case"HIP_THRUST":case"PISTOL_SQUAT":case"SKATER_SQUAT":case"ARCHER_PUSH_UP":case"INVERTED_ROW":return Gc(t,a,r);default:return{issues:[],strengths:[],stickingPoint:{detected:!1},recommendations:{immediate:[],accessories:[],mobility:[]},overallScore:7}}}function Kp(t,a,r,s,i){const o=s/i;return o<.1?"SETUP":o<.4?"ECCENTRIC":o<.5?"BOTTOM":o<.9?"CONCENTRIC":"LOCKOUT"}function Yp(t,a,r){const s={x:(t.left_hip.x+t.right_hip.x)/2,y:(t.left_hip.y+t.right_hip.y)/2},i={x:(a.left_hip.x+a.right_hip.x)/2,y:(a.left_hip.y+a.right_hip.y)/2};return Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))/r}const fi=[{id:"standard",name:"Standard",tempo:"2-0-1-0",eccentric:2,pause_bottom:0,concentric:1,pause_top:0,tut_per_rep:3,difficulty_increase:0,description_it:"Tempo normale controllato",description_en:"Normal controlled tempo"},{id:"slow_eccentric",name:"Eccentrica Lenta",tempo:"4-0-1-0",eccentric:4,pause_bottom:0,concentric:1,pause_top:0,tut_per_rep:5,difficulty_increase:.15,description_it:"4 secondi in discesa",description_en:"4 seconds down"},{id:"slow_both",name:"Tempo Lento",tempo:"3-0-2-0",eccentric:3,pause_bottom:0,concentric:2,pause_top:0,tut_per_rep:5,difficulty_increase:.2,description_it:"3 secondi giÃ¹, 2 secondi su",description_en:"3 seconds down, 2 seconds up"},{id:"pause_bottom",name:"Pausa Isometrica",tempo:"2-2-1-0",eccentric:2,pause_bottom:2,concentric:1,pause_top:0,tut_per_rep:5,difficulty_increase:.25,description_it:"2 secondi pausa nel punto piÃ¹ basso",description_en:"2 second pause at bottom"},{id:"slow_eccentric_pause",name:"Eccentrica + Pausa",tempo:"4-1-1-0",eccentric:4,pause_bottom:1,concentric:1,pause_top:0,tut_per_rep:6,difficulty_increase:.3,description_it:"4 secondi giÃ¹, 1 secondo pausa",description_en:"4 seconds down, 1 second pause"},{id:"super_slow",name:"Super Lento",tempo:"4-2-3-0",eccentric:4,pause_bottom:2,concentric:3,pause_top:0,tut_per_rep:9,difficulty_increase:.4,description_it:"4 secondi giÃ¹, 2 pausa, 3 su",description_en:"4 seconds down, 2 pause, 3 up"}];function cn(){return fi.find(t=>t.id==="slow_both")}function Ho(){return fi.find(t=>t.id==="standard")}function Wo(t){return fi.find(a=>a.id===t)||null}function Zp(t){const a=t.split("-").map(Number);if(a.length!==4)return t;const[r,s,i,o]=a,l=[];return r>0&&l.push(`${r}s giÃ¹`),s>0&&l.push(`${s}s pausa`),i>0&&l.push(`${i}s su`),o>0&&l.push(`${o}s pausa top`),l.join(" â†’ ")}function Xp(t){return!t||t==="standard"}function Qp(t){const a=t.actualRIR-t.targetRIR,r=Ho();if(a>=-1)return{needsDowngrade:!1,severity:"none",tempo:r,reason:"",userMessage:""};const s=a<=-2?"critical":"warning";if(t.exerciseType==="weighted"){const i=Math.min(15,Math.abs(a)*5),o=Math.round((t.currentWeight||0)*(1-i/100)*2)/2;return{needsDowngrade:!0,severity:s,newWeight:o,weightReductionPercent:i,tempo:r,reason:`RIR ${t.actualRIR} vs target ${t.targetRIR}`,userMessage:s==="critical"?`ðŸ›‘ Carico troppo alto! Ridotto a ${o}kg.`:`âš ï¸ Carico ridotto a ${o}kg per rispettare RIR ${t.targetRIR}.`}}else{const i=Su(t.exerciseName,t.exercisePattern,t.location);if(!i){const l=Math.max(5,t.targetReps-2);return{needsDowngrade:!0,severity:s,newReps:l,tempo:r,reason:`RIR ${t.actualRIR}, nessuna variante piÃ¹ facile`,userMessage:`âš ï¸ Riduciamo a ${l} reps per rispettare RIR ${t.targetRIR}.`}}const o=t.targetReps+2;return{needsDowngrade:!0,severity:s,newVariant:i.name,newReps:o,tempo:r,reason:`RIR ${t.actualRIR} vs target ${t.targetRIR}`,userMessage:s==="critical"?`ðŸ›‘ Troppo difficile! Prossima sessione: ${i.name} Ã— ${o}.`:`âš ï¸ Proviamo ${i.name} Ã— ${o} per rispettare RIR ${t.targetRIR}.`}}}function Jp(t){const a=t.actualRIR-t.targetRIR,r=Ho();if(a<2)return{canUpgrade:!1,upgradeType:"none",reason:"RIR nel range",userMessage:""};const s=t.activeModification;if(!((s==null?void 0:s.tempo_modifier_id)&&s.tempo_modifier_id!=="standard")){const o=cn();return{canUpgrade:!0,upgradeType:"add_tut",newTempo:o,newReps:t.targetReps,reason:`RIR ${t.actualRIR} > target ${t.targetRIR}`,userMessage:`ðŸ’ª Troppo facile! Aggiungiamo tempo ${o.tempo} per aumentare la sfida.`}}if(t.exerciseType==="weighted"){const o=(s==null?void 0:s.current_weight)||t.currentWeight||0,l=(s==null?void 0:s.original_weight)||o;if(o<l)return{canUpgrade:!0,upgradeType:"increase_weight",newWeight:l,newTempo:r,newReps:t.targetReps,reason:`RIR ${t.actualRIR} con TUT`,userMessage:`ðŸŽ‰ Ottimo! Torniamo a ${l}kg senza tempo modificato.`};const n=Math.round(o*1.05*2)/2;return{canUpgrade:!0,upgradeType:"increase_weight",newWeight:n,newTempo:r,newReps:t.targetReps,reason:`RIR ${t.actualRIR} con TUT`,userMessage:`ðŸ“ˆ Aumentiamo a ${n}kg senza tempo modificato.`}}else{if(s!=null&&s.original_variant&&s.current_variant!==s.original_variant)return{canUpgrade:!0,upgradeType:"upgrade_variant",newVariant:s.original_variant,newTempo:r,newReps:s.original_reps||t.targetReps,reason:`RIR ${t.actualRIR} con TUT su variante facile`,userMessage:`ðŸŽ‰ Torniamo a ${s.original_variant} Ã— ${s.original_reps||t.targetReps}!`};const o=jo(t.exerciseName,t.exercisePattern,t.location);return o?{canUpgrade:!0,upgradeType:"upgrade_variant",newVariant:o.name,newTempo:r,newReps:Math.max(t.targetReps-2,5),reason:`RIR ${t.actualRIR} con TUT`,userMessage:`ðŸš€ Proviamo ${o.name}! Senza tempo modificato.`}:{canUpgrade:!0,upgradeType:"add_tut",newTempo:Wo((s==null?void 0:s.tempo_modifier_id)||"slow_both")||cn(),newReps:t.targetReps+2,reason:"Nessuna variante piÃ¹ difficile",userMessage:`ðŸ“ˆ Aumentiamo a ${t.targetReps+2} reps con tempo modificato.`}}}function eh(t){return t==="warning"?"Ricorda: lasciare reps in riserva protegge le articolazioni e permette progressioni piÃ¹ durature.":"Importante: allenarsi sempre al limite aumenta il rischio di infortuni e rallenta il recupero."}function Hr(t){return t<=0?"none":t<=3?"mild":t<=6?"moderate":"significant"}function dn(t,a){const r=Hr(t.intensity);if(r==="none")return{level:"none",message:"No discomfort reported. Proceed normally.",messageIt:"Nessun fastidio segnalato. Procedi normalmente.",options:[{id:"continue_normal",label:"Continue",labelIt:"Continua",description:"Proceed with programmed workout",descriptionIt:"Procedi con l'allenamento programmato",recommended:!0}],showTolerableReminder:!1,suggestProfessional:!1,canContinue:!0};if(r==="mild")return{level:"mild",message:`Mild discomfort noted (${t.intensity}/10). This level is generally acceptable during training. Proceed as you feel comfortable.`,messageIt:`Fastidio lieve registrato (${t.intensity}/10). Questo livello Ã¨ generalmente accettabile durante l'allenamento. Procedi come ti senti.`,options:[{id:"continue_normal",label:"Continue normally",labelIt:"Continua normalmente",description:"Proceed with programmed workout",descriptionIt:"Procedi con l'allenamento programmato",recommended:!0},{id:"continue_adapted",label:"Reduce load slightly",labelIt:"Riduci leggermente il carico",description:"10% load reduction for extra comfort",descriptionIt:"Riduzione del 10% per maggiore comfort",recommended:!1,loadReduction:10}],showTolerableReminder:!0,suggestProfessional:!1,canContinue:!0,educationalNote:"Mild discomfort (1-3/10) that doesn't worsen during exercise is normal and generally safe to work through.",educationalNoteIt:"Un fastidio lieve (1-3/10) che non peggiora durante l'esercizio Ã¨ normale e generalmente sicuro da gestire."};if(r==="moderate"){const s=[{id:"continue_adapted",label:"Continue with adaptation",labelIt:"Continua con adattamento",description:"20% load reduction for this exercise",descriptionIt:"Riduzione del 20% del carico per questo esercizio",recommended:!0,loadReduction:20},{id:"continue_normal",label:"Proceed as programmed",labelIt:"Procedi come programmato",description:"If you feel you can manage it",descriptionIt:"Se senti di poterlo gestire",recommended:!1}];return a!=null&&a.alternativeAvailable&&s.splice(1,0,{id:"change_exercise",label:"Change exercise",labelIt:"Cambia esercizio",description:`Try ${a.alternativeAvailable} instead`,descriptionIt:`Prova ${a.alternativeAvailable} invece`,recommended:!1,alternativeExercise:a.alternativeAvailable}),s.push({id:"skip_exercise",label:"Skip this exercise",labelIt:"Salta questo esercizio",description:"Move to the next exercise",descriptionIt:"Passa al prossimo esercizio",recommended:!1}),{level:"moderate",message:`Moderate discomfort (${t.intensity}/10). You have options for how to proceed.`,messageIt:`Fastidio moderato (${t.intensity}/10). Hai diverse opzioni per procedere.`,options:s,showTolerableReminder:!0,suggestProfessional:!1,canContinue:!0,educationalNote:"With moderate discomfort, adapting the load often allows you to continue training effectively while respecting your body's signals.",educationalNoteIt:"Con fastidio moderato, adattare il carico spesso permette di continuare ad allenarti efficacemente rispettando i segnali del corpo."}}return{level:"significant",message:`Significant discomfort (${t.intensity}/10). We recommend consulting a physiotherapist or sports doctor before continuing with exercises involving this area.`,messageIt:`Fastidio importante (${t.intensity}/10). Ti consigliamo di consultare un fisioterapista o medico sportivo prima di continuare con esercizi che coinvolgono questa zona.`,options:[{id:"skip_exercise",label:"Skip exercises for this area",labelIt:"Salta gli esercizi per questa zona",description:"Continue with other exercises",descriptionIt:"Continua con gli altri esercizi",recommended:!0},{id:"end_session",label:"End session",labelIt:"Termina sessione",description:"Rest today, consult a professional",descriptionIt:"Riposa oggi, consulta un professionista",recommended:!1}],showTolerableReminder:!1,suggestProfessional:!0,canContinue:!1,educationalNote:"With significant discomfort, professional evaluation is recommended. This is not an emergency, but training through significant pain can delay recovery.",educationalNoteIt:"Con fastidio importante, Ã¨ consigliata una valutazione professionale. Non Ã¨ un'emergenza, ma allenarsi con dolore significativo puÃ² ritardare il recupero."}}const Go={neck:"collo",shoulder:"spalla",left_shoulder:"spalla sinistra",right_shoulder:"spalla destra",elbow:"gomito",left_elbow:"gomito sinistro",right_elbow:"gomito destro",wrist:"polso",left_wrist:"polso sinistro",right_wrist:"polso destro",upper_back:"parte alta della schiena",thoracic_spine:"dorsale",lower_back:"bassa schiena",lumbar:"zona lombare",hip:"anca",left_hip:"anca sinistra",right_hip:"anca destra",knee:"ginocchio",left_knee:"ginocchio sinistro",right_knee:"ginocchio destro",ankle:"caviglia",left_ankle:"caviglia sinistra",right_ankle:"caviglia destra",foot:"piede",chest:"petto",abdomen:"addome"},un={TOLERABLE_MAX:4,SUGGEST_REDUCTION:4,SUGGEST_SUBSTITUTION:5,PROFESSIONAL_ADVICE:7,BLOCK_AREA:7,SESSIONS_FOR_PROGRESSION:3,SUSPENSIONS_FOR_SCREENING:2},Bs={MILD:{load:0,volume:0,reps:0,rest:0},MODERATE_LOW:{load:10,volume:0,reps:0,rest:0},MODERATE_HIGH:{load:20,volume:15,reps:0,rest:25},SIGNIFICANT:{load:100,volume:100,reps:100,rest:0}},th={it:"TrainSmart fornisce suggerimenti basati sulle tue segnalazioni, ma non sostituisce il parere di un professionista sanitario. In caso di dolore persistente o intenso, consulta un medico o fisioterapista.",en:"TrainSmart provides suggestions based on your reports, but does not replace professional medical advice. For persistent or severe pain, consult a doctor or physiotherapist."},ah=th;function Uo(t){return t<=3?Bs.MILD:t===4?Bs.MODERATE_LOW:t<=6?Bs.MODERATE_HIGH:Bs.SIGNIFICANT}function sh(t,a,r="gym"){const s=Uo(a);if(s.load===0&&s.volume===0)return{...t};const i=t.weight||0,o=Math.round(i*(1-s.load/100)),l=t.sets,n=Math.max(1,Math.round(l*(1-s.volume/100))),c=t.restSeconds,u=Math.round(c*(1+s.rest/100));let d="",p="";return s.load>0&&s.load<100&&(d=`Load reduced by ${s.load}%`,p=`Carico ridotto del ${s.load}%`),s.volume>0&&s.volume<100&&(d+=d?`, volume reduced by ${s.volume}%`:`Volume reduced by ${s.volume}%`,p+=p?`, volume ridotto del ${s.volume}%`:`Volume ridotto del ${s.volume}%`),s.rest>0&&(d+=d?`, rest increased by ${s.rest}%`:`Rest increased by ${s.rest}%`,p+=p?`, riposo aumentato del ${s.rest}%`:`Riposo aumentato del ${s.rest}%`),{sets:n,reps:t.reps,weight:o>0?o:void 0,restSeconds:u,adaptationNote:d,adaptationNoteIt:p,originalParams:t}}const mn={"Bench Press":{primaryMuscles:["chest","triceps","front_delt"],movementPattern:"horizontal_push",involvedAreas:["shoulder","chest","elbow","wrist"],alternatives:["Incline Dumbbell Press","Push-ups","Cable Fly","Machine Chest Press"],reducedROMOption:"Floor Press"},"Overhead Press":{primaryMuscles:["shoulders","triceps"],movementPattern:"vertical_push",involvedAreas:["shoulder","elbow","wrist","lower_back"],alternatives:["Landmine Press","Arnold Press","Lateral Raises","Front Raises"],reducedROMOption:"Partial Range Overhead Press"},"Push-ups":{primaryMuscles:["chest","triceps","front_delt"],movementPattern:"horizontal_push",involvedAreas:["shoulder","chest","elbow","wrist"],alternatives:["Wall Push-ups","Incline Push-ups","Knee Push-ups","Bench Press"]},Dips:{primaryMuscles:["chest","triceps"],movementPattern:"vertical_push",involvedAreas:["shoulder","chest","elbow"],alternatives:["Close-grip Bench Press","Tricep Pushdown","Diamond Push-ups"]},"Pull-ups":{primaryMuscles:["lats","biceps","rear_delt"],movementPattern:"vertical_pull",involvedAreas:["shoulder","elbow","wrist"],alternatives:["Lat Pulldown","Assisted Pull-ups","Inverted Rows","Cable Pullover"],reducedROMOption:"Partial Pull-ups"},"Barbell Row":{primaryMuscles:["lats","rhomboids","biceps"],movementPattern:"horizontal_pull",involvedAreas:["shoulder","elbow","wrist","lower_back"],alternatives:["Cable Row","Dumbbell Row","Machine Row","Chest-Supported Row"]},"Lat Pulldown":{primaryMuscles:["lats","biceps"],movementPattern:"vertical_pull",involvedAreas:["shoulder","elbow"],alternatives:["Assisted Pull-ups","Cable Pullover","Straight-arm Pulldown"]},Squat:{primaryMuscles:["quads","glutes","hamstrings"],movementPattern:"squat",involvedAreas:["knee","hip","lower_back","ankle"],alternatives:["Leg Press","Goblet Squat","Box Squat","Bulgarian Split Squat"],reducedROMOption:"Half Squat"},Deadlift:{primaryMuscles:["hamstrings","glutes","erectors"],movementPattern:"hip_hinge",involvedAreas:["lower_back","hip","knee"],alternatives:["Romanian Deadlift","Hip Thrust","Cable Pull-through","Trap Bar Deadlift"],reducedROMOption:"Block Pull"},"Leg Press":{primaryMuscles:["quads","glutes"],movementPattern:"squat",involvedAreas:["knee","hip"],alternatives:["Hack Squat","Goblet Squat","Leg Extension + Leg Curl"]},Lunges:{primaryMuscles:["quads","glutes"],movementPattern:"lunge",involvedAreas:["knee","hip","ankle"],alternatives:["Split Squat","Step-ups","Reverse Lunges","Leg Press"]},"Romanian Deadlift":{primaryMuscles:["hamstrings","glutes"],movementPattern:"hip_hinge",involvedAreas:["lower_back","hip"],alternatives:["Lying Leg Curl","Good Mornings","Cable Pull-through","Nordic Curl"]},"Leg Extension":{primaryMuscles:["quads"],movementPattern:"knee_extension",involvedAreas:["knee"],alternatives:["Sissy Squat","Terminal Knee Extension","Wall Sit"]},"Leg Curl":{primaryMuscles:["hamstrings"],movementPattern:"knee_flexion",involvedAreas:["knee"],alternatives:["Nordic Curl","Glute-Ham Raise","Stability Ball Leg Curl"]},Plank:{primaryMuscles:["core"],movementPattern:"anti_extension",involvedAreas:["lower_back","shoulder","wrist"],alternatives:["Dead Bug","Bird Dog","Side Plank","Pallof Press"]},Crunches:{primaryMuscles:["abs"],movementPattern:"spinal_flexion",involvedAreas:["neck","lower_back"],alternatives:["Dead Bug","Reverse Crunch","Cable Crunch","Hollow Body Hold"]},"Lateral Raises":{primaryMuscles:["side_delt"],movementPattern:"shoulder_abduction",involvedAreas:["shoulder"],alternatives:["Cable Lateral Raise","Machine Lateral Raise","Upright Row"],reducedROMOption:"Partial Lateral Raises"},"Face Pulls":{primaryMuscles:["rear_delt","rhomboids"],movementPattern:"external_rotation",involvedAreas:["shoulder","elbow"],alternatives:["Rear Delt Fly","Band Pull-apart","Reverse Pec Deck"]},"Bicep Curl":{primaryMuscles:["biceps"],movementPattern:"elbow_flexion",involvedAreas:["elbow","wrist"],alternatives:["Hammer Curl","Cable Curl","Preacher Curl","Concentration Curl"]},"Tricep Extension":{primaryMuscles:["triceps"],movementPattern:"elbow_extension",involvedAreas:["elbow","shoulder"],alternatives:["Tricep Pushdown","Close-grip Bench Press","Skull Crushers"]}},rh={shoulder:["Chest-Supported Row","Cable Fly","Machine Chest Press","Leg exercises"],elbow:["Machine exercises","Cable exercises with neutral grip","Leg exercises"],wrist:["Dumbbell exercises","EZ-bar exercises","Machines","Leg exercises"],upper_back:["Machine Row","Chest-Supported Row","Cable exercises"],lower_back:["Machine exercises","Seated exercises","Chest-Supported Row","Leg Press","Leg Extension","Leg Curl"],hip:["Leg Extension","Leg Curl","Calf Raises","Upper body exercises"],knee:["Hip Thrust","Glute Bridge","Romanian Deadlift","Upper body exercises"],ankle:["Seated exercises","Machine exercises","Upper body exercises"],neck:["Most exercises with proper positioning","Machine exercises"],chest:["Back exercises","Leg exercises","Core exercises"]};function ih(t,a,r,s){const i=nh(t),o=mn[i];if(!o)return{found:!1,rationale:`No substitution data available for "${t}". Consider a general alternative for the same muscle group.`,rationaleIt:`Nessun dato di sostituzione disponibile per "${t}". Considera un'alternativa generale per lo stesso gruppo muscolare.`};if(!o.involvedAreas.includes(a))return{found:!1,rationale:`"${t}" doesn't primarily involve the ${a}. It may be safe to continue with monitoring.`,rationaleIt:`"${t}" non coinvolge principalmente ${a}. Potrebbe essere sicuro continuare monitorando.`};if(r>=4&&r<=6&&o.reducedROMOption)return{found:!0,substitute:o.reducedROMOption,matchScore:.9,rationale:`Reduced range of motion version available that may reduce stress on ${a}.`,rationaleIt:`Versione a range di movimento ridotto disponibile che potrebbe ridurre lo stress su ${a}.`,modifications:{reducedROM:!0,description:`Perform ${o.reducedROMOption} to reduce joint stress`,percentage:50}};const l=o.alternatives.filter(c=>{const u=mn[c];return u?!u.involvedAreas.includes(a):!0});if(l.length>0){let c=l;return{found:!0,substitute:c[0],matchScore:.85,rationale:`"${c[0]}" targets similar muscles without stressing the ${a}.`,rationaleIt:`"${c[0]}" allena muscoli simili senza stressare ${a}.`}}const n=rh[a];return n&&n.length>0?{found:!0,substitute:n[0],matchScore:.6,rationale:`No direct alternative found. "${n[0]}" is generally safe for ${a} issues.`,rationaleIt:`Nessuna alternativa diretta trovata. "${n[0]}" Ã¨ generalmente sicuro per problemi a ${a}.`}:{found:!1,rationale:`Unable to find a safe alternative. Consider skipping exercises for ${a} today.`,rationaleIt:`Impossibile trovare un'alternativa sicura. Considera di saltare gli esercizi per ${a} oggi.`}}function nh(t){return t.trim().split(/\s+/).map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join(" ")}const pn={vertical_pull:{source:"horizontal_push",ratio:.8,difficultyAdjust:-2},horizontal_pull:{source:"vertical_pull",ratio:.85,difficultyAdjust:0},horizontal_pull_fallback:{source:"horizontal_push",ratio:.7,difficultyAdjust:-1},vertical_push:{source:"horizontal_push",ratio:.65,difficultyAdjust:-2},lower_pull:{source:"lower_push",ratio:1.1,difficultyAdjust:0}},oh={vertical_push:[{id:"wall_shoulder_tap",name:"Wall Shoulder Tap",difficulty:1},{id:"incline_pike",name:"Pike Push-up Inclinato",difficulty:2},{id:"pike_knee",name:"Pike Push-up su Ginocchia",difficulty:3},{id:"pike_pushup",name:"Pike Push-up",difficulty:5},{id:"pike_elevated",name:"Pike Push-up Elevato",difficulty:6},{id:"pike_elevated_high",name:"Pike Push-up Alto",difficulty:7},{id:"wall_hspu_eccentric",name:"HSPU al Muro (Solo Eccentrica)",difficulty:8},{id:"wall_hspu",name:"HSPU al Muro",difficulty:9},{id:"hspu",name:"Handstand Push-up",difficulty:10}],vertical_pull:[{id:"prone_y_raise",name:"Prone Y Raise",difficulty:1},{id:"superman_pull",name:"Superman Pull",difficulty:2},{id:"floor_pull_easy",name:"Floor Pull Facilitato",difficulty:3},{id:"inverted_row_high",name:"Inverted Row (alto)",difficulty:4},{id:"inverted_row_table",name:"Inverted Row (tavolo)",difficulty:5},{id:"negative_pullup",name:"Trazioni Negative",difficulty:6},{id:"assisted_pullup",name:"Trazioni Assistite",difficulty:6},{id:"pullup",name:"Pull-up",difficulty:7},{id:"pullup_wide",name:"Pull-up Larghe",difficulty:8},{id:"weighted_pullup",name:"Pull-up Zavorrate",difficulty:9}],horizontal_pull:[{id:"prone_ytw",name:"Prone Y-T-W Raises",difficulty:2},{id:"superman_row",name:"Superman Row",difficulty:3},{id:"inverted_row_high",name:"Inverted Row (alto)",difficulty:4},{id:"inverted_row",name:"Inverted Row",difficulty:5},{id:"inverted_row_feet",name:"Inverted Row Piedi Elevati",difficulty:6},{id:"archer_row",name:"Archer Row",difficulty:7},{id:"one_arm_row",name:"One Arm Inverted Row",difficulty:8}],lower_pull:[{id:"glute_bridge",name:"Glute Bridge",difficulty:2},{id:"hip_thrust_bw",name:"Hip Thrust Bodyweight",difficulty:3},{id:"single_leg_bridge",name:"Single Leg Glute Bridge",difficulty:4},{id:"slider_leg_curl",name:"Slider Leg Curl",difficulty:5},{id:"nordic_eccentric",name:"Nordic Curl (Solo Eccentrica)",difficulty:6},{id:"nordic_assisted",name:"Nordic Curl Assistito",difficulty:7},{id:"nordic_partial",name:"Nordic Curl Parziale",difficulty:8},{id:"nordic_curl",name:"Nordic Curl",difficulty:9}]};function lh(t){return t>=15?.5:t>=12?.25:t>=10?0:t>=8?-.5:t>=6?-1:-1.5}function ch(t,a){return a>=7?Math.min(t,8):a>=5?Math.min(t,12):a>=3?Math.min(t+2,15):Math.min(t+4,20)}function dh(t,a){const r=t/a;return r>=1.5?9:r>=1.2?8:r>=1?7:r>=.8?6:r>=.6?5:r>=.4?4:r>=.2?3:2}function uh(t,a){const r=oh[t];if(!r||r.length===0)return console.warn(`[findVariantForDifficulty] Pattern non trovato: ${t}`),{id:"default",name:"Esercizio Base"};let s=r[0];for(const i of r)i.difficulty<=a&&i.difficulty>s.difficulty&&(s=i);return console.log(`[findVariantForDifficulty] ${t} diff=${a} â†’ ${s.name} (diff=${s.difficulty})`),{id:s.id,name:s.name}}const mh={lower_push:{ratio:.8,variantName:"Back Squat",difficulty:5},lower_pull:{ratio:.9,variantName:"Romanian Deadlift",difficulty:5},horizontal_push:{ratio:.5,variantName:"Bench Press",difficulty:5},horizontal_pull:{ratio:.4,variantName:"Barbell Row",difficulty:5},vertical_push:{ratio:.35,variantName:"Military Press",difficulty:5},vertical_pull:{ratio:.5,variantName:"Lat Pulldown",difficulty:5},core:{ratio:.3,variantName:"Cable Crunch",difficulty:3}};function ph(t,a=75,r="beginner"){const s={...t},i=r==="advanced"?1.3:r==="intermediate"?1.15:1;if(!Object.values(t).some(n=>n&&(n.weight10RM||n.reps&&n.difficulty))){console.log(`[BaselineInference] Nessun test trovato â†’ stima basata su peso corporeo ${a}kg (${r})`);for(const[n,c]of Object.entries(mh)){const u=n,d=Math.round(a*c.ratio*i);s[u]={variantId:n,variantName:c.variantName,difficulty:c.difficulty,reps:10,weight10RM:d,testDate:new Date().toISOString(),isEstimated:!0,estimatedFrom:"bodyweight"},console.log(`[BaselineInference] ${n}: ${d}kg - STIMATO DA PESO CORPOREO`)}return s}const l=["vertical_pull","horizontal_pull","vertical_push","lower_pull"];for(const n of l){const c=s[n];if(c!=null&&c.variantId&&!(c!=null&&c.isEstimated))continue;let u=pn[n];if(!u)continue;let d=t[u.source];if(!d&&n==="horizontal_pull"&&(u=pn.horizontal_pull_fallback,d=t[u.source]),!d)continue;let p,f;const h=d.weight10RM&&d.weight10RM>0,x=d.reps&&d.difficulty;if(x&&!h){const y=d.difficulty,v=u.difficultyAdjust||0,S=d.reps||10,P=lh(S);p=Math.round(Math.max(1,Math.min(10,y+v+P))),f=ch(S,p),console.log(`[Inference] ${n}: source=${u.source} baseDiff=${y} adj=${v} reps=${S} repsAdj=${P.toFixed(1)} â†’ inferredDiff=${p} reps=${f}`)}else if(h){const y=Math.round(d.weight10RM*u.ratio);p=dh(y,a),f=10,console.log(`[Inference GYM] ${n}: weight=${d.weight10RM}kg Ã— ${u.ratio} = ${y}kg â†’ diff=${p}`)}else p=3,f=10;const g=uh(n,p);s[n]={variantId:g.id,variantName:g.name,difficulty:p,reps:f,weight10RM:h?Math.round(d.weight10RM*u.ratio):0,testDate:new Date().toISOString(),isEstimated:!0,estimatedFrom:u.source+(x&&!h?" (bodyweight)":"")}}return s}async function hn(t,a){try{const{data:r}=await t.from("exercise_modifications").select("*").eq("user_id",a.user_id).eq("program_id",a.program_id).eq("exercise_name",a.exercise_name).eq("is_active",!0).maybeSingle();if(r){const{data:o,error:l}=await t.from("exercise_modifications").update({current_variant:a.current_variant,variant_changed:a.variant_changed,current_tempo:a.current_tempo,tempo_modifier_id:a.tempo_modifier_id,tempo_changed:a.tempo_changed,current_weight:a.current_weight,weight_reduction_percent:a.weight_reduction_percent,current_reps:a.current_reps,reason:a.reason,severity:a.severity,rir_target:a.rir_target,rir_actual:a.rir_actual,applied_count:r.applied_count+1,last_applied_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(l)throw l;return{data:o,error:null}}const{data:s,error:i}=await t.from("exercise_modifications").insert({...a,is_active:!0,applied_count:1,last_applied_at:new Date().toISOString()}).select().single();if(i)throw i;return{data:s,error:null}}catch(r){return console.error("[ExerciseModification] Error saving:",r),{data:null,error:r}}}async function hh(t,a){try{const{error:r}=await t.from("exercise_modifications").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",a);if(r)throw r;return{error:null}}catch(r){return console.error("[ExerciseModification] Error removing:",r),{error:r}}}async function gh(t,a,r){try{const{data:s,error:i}=await t.from("exercise_modifications").select("*").eq("user_id",a).eq("program_id",r).eq("is_active",!0).order("created_at",{ascending:!1});if(i)throw i;return{data:s||[],error:null}}catch(s){return console.error("[ExerciseModification] Error loading:",s),{data:[],error:s}}}const gn="https://mhcdxqhhlrujbjxtgnmz.supabase.co/storage/v1/object/public/exercise-videos";function fh(t){return t.toLowerCase().replace(/[()]/g,"").replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")+".mp4"}const fn={"Australian Pull-up":"inverted-row.mp4","Australian Pull-up Veloci":"inverted-row.mp4","Australian Pull Up":"inverted-row.mp4","Trazioni Australiane":"inverted-row.mp4","Trazioni Orizzontali":"inverted-row.mp4","Inverted Row":"inverted-row.mp4","Inverted Row Alta":"inverted-row.mp4","Inverted Row 45Â°":"inverted-row.mp4","Inverted Row 30Â°":"inverted-row.mp4","Inverted Row Orizzontale":"inverted-row.mp4","Inverted Row Tempo":"inverted-row.mp4","Inverted Row (barra alta)":"inverted-row.mp4","Inverted Row (barra media)":"inverted-row.mp4","Inverted Row (barra bassa)":"inverted-row.mp4","Rematore Inverso":"inverted-row.mp4","Rematore Inverso (barra alta)":"inverted-row.mp4","Rematore Inverso (barra bassa)":"inverted-row.mp4","Pike Push-up":"pike-push-up.mp4","Pike Push Up":"pike-push-up.mp4","Pike Push-up su Ginocchia":"pike-push-up.mp4","Pike Push-up Facile":"pike-push-up.mp4","Pike Push-up Elevato":"elevated-pike-push-up.mp4","Plank to Pike":"pike-push-up.mp4","Piegamenti a V":"pike-push-up.mp4","Piegamenti a V Facili":"pike-push-up.mp4","Piegamenti a V su Ginocchia":"pike-push-up.mp4","Piegamenti a V Elevati":"elevated-pike-push-up.mp4","Nordic Curl":"nordic-hamstring-curl.mp4","Nordic Curl (solo eccentrica)":"nordic-hamstring-curl.mp4","Nordic Curl (Solo Eccentrica)":"nordic-hamstring-curl.mp4","Nordic Curl (completo)":"nordic-hamstring-curl.mp4","Nordic Curl Negativo":"nordic-hamstring-curl.mp4","Nordic Hamstring Curl":"nordic-hamstring-curl.mp4","Curl Nordico":"nordic-hamstring-curl.mp4","Curl Nordico Negativo":"nordic-hamstring-curl.mp4","Curl Nordico Eccentrico":"nordic-hamstring-curl.mp4","Pull-up Standard":"standard-pull-up.mp4","Pull-up":"standard-pull-up.mp4","Negative Pull-up (solo eccentrica)":"standard-pull-up.mp4","Negative Pull-ups (5-10s)":"standard-pull-up.mp4","Pull-ups / Chin-ups":"standard-pull-up.mp4",Trazioni:"standard-pull-up.mp4","Trazioni alla Sbarra":"standard-pull-up.mp4","Trazioni Prone":"standard-pull-up.mp4","Trazioni Negative":"standard-pull-up.mp4","Trazione Negativa (solo eccentrica)":"standard-pull-up.mp4","Chin-up":"chin-up.mp4","Chin-ups":"chin-up.mp4","Trazioni Supine":"chin-up.mp4","Trazioni Presa Supina":"chin-up.mp4","Band-Assisted Pull-up":"assisted-pull-up.mp4","Assisted Pull-up":"assisted-pull-up.mp4","Trazioni Assistite":"assisted-pull-up.mp4","Trazioni con Elastico":"assisted-pull-up.mp4","Trazione con Elastico":"assisted-pull-up.mp4","Push-up Standard":"standard-push-up.mp4","Push-up":"standard-push-up.mp4","Standard Push-up":"standard-push-up.mp4",Piegamenti:"standard-push-up.mp4","Piegamenti sulle Braccia":"standard-push-up.mp4",Flessioni:"standard-push-up.mp4","Push-up su Ginocchia":"knee-push-up.mp4","Push-up sulle Ginocchia":"knee-push-up.mp4","Push-up Ginocchia":"knee-push-up.mp4","Knee Push-up":"knee-push-up.mp4","Piegamenti sulle Ginocchia":"knee-push-up.mp4","Decline Push-up":"decline-push-up.mp4","Piegamenti Declinati":"decline-push-up.mp4","Piegamenti Piedi Elevati":"decline-push-up.mp4","Incline Push-up":"incline-push-up.mp4","Push-up Inclinato":"incline-push-up.mp4","Piegamenti Inclinati":"incline-push-up.mp4","Piegamenti su Rialzo":"incline-push-up.mp4","Push-up Inclinati":"incline-push-up.mp4","Diamond Push-up":"diamond-push-up.mp4","Piegamenti Diamante":"diamond-push-up.mp4","Piegamenti Stretti":"diamond-push-up.mp4","Push-up Diamante":"diamond-push-up.mp4","Push-up Stretti":"diamond-push-up.mp4","Push-up Mani Strette":"diamond-push-up.mp4","Close Grip Push-up":"diamond-push-up.mp4","Narrow Push-up":"diamond-push-up.mp4","Wide Push-up":"standard-push-up.mp4","Push-up Larghi":"standard-push-up.mp4","Push-up Presa Larga":"standard-push-up.mp4","Piegamenti Larghi":"standard-push-up.mp4","Wall Push-up":"wall-push-up.mp4","Wall Push Up":"wall-push-up.mp4","Push-up al Muro":"wall-push-up.mp4","Piegamenti al Muro":"wall-push-up.mp4","Flessioni al Muro":"wall-push-up.mp4","Piegamenti Pike":"pike-push-up.mp4","Air Squat":"modified-squat.mp4",Squat:"modified-squat.mp4","Squat Assistito":"modified-squat.mp4","Squat Completo":"deep-squat-hold.mp4","Bodyweight Squat":"modified-squat.mp4","Squat a Corpo Libero":"modified-squat.mp4",Accosciata:"modified-squat.mp4","Modified Squat":"modified-squat.mp4","Squat Modificato":"modified-squat.mp4","Deep Squat Hold":"deep-squat-hold.mp4","Squat Profondo":"deep-squat-hold.mp4","Squat Isometrico":"deep-squat-hold.mp4","Goblet Squat":"goblet-squat.mp4","Front Squat":"front-squat.mp4","Squat Frontale":"front-squat.mp4","Back Squat":"back-squat.mp4","Squat con Bilanciere":"back-squat.mp4","Bulgarian Split Squat":"bulgarian-split-squat.mp4","Split Squat Bulgaro":"bulgarian-split-squat.mp4","Squat Bulgaro":"bulgarian-split-squat.mp4","Affondi Bulgari":"bulgarian-split-squat.mp4","Pistol Squat":"pistol-squat.mp4","Squat su una Gamba":"pistol-squat.mp4","Slider Leg Curl":"slider-leg-curl.mp4","Sliding Leg Curl":"slider-leg-curl.mp4","Leg Curl con Slider":"slider-leg-curl.mp4","Leg Curl Scivolato":"slider-leg-curl.mp4","Leg Curl":"leg-curl.mp4","Leg Curl (Machine)":"leg-curl.mp4","Leg Curl Machine":"leg-curl.mp4","Leg Curl Sdraiato":"leg-curl.mp4","Curl Femorali":"leg-curl.mp4","Standing Leg Curl":"standing-leg-curl.mp4","Leg Curl in Piedi":"standing-leg-curl.mp4","Hip Thrust":"hip-thrust.mp4","Spinta d'Anca":"hip-thrust.mp4","Hip Thrust (Elevated)":"elevated-hip-thrust.mp4","Elevated Hip Thrust":"elevated-hip-thrust.mp4","Hip Thrust Elevato":"elevated-hip-thrust.mp4","Glute Bridge":"glute-bridge.mp4","Ponte Glutei":"glute-bridge.mp4","Single Leg Glute Bridge":"single-leg-glute-bridge.mp4","Ponte Glutei Unilaterale":"single-leg-glute-bridge.mp4","Ponte Glutei su una Gamba":"single-leg-glute-bridge.mp4","Romanian Deadlift (RDL)":"romanian-deadlift.mp4","Romanian Deadlift":"romanian-deadlift.mp4",RDL:"romanian-deadlift.mp4","Stacco Rumeno":"romanian-deadlift.mp4","Stacco a Gambe Tese":"romanian-deadlift.mp4","Single Leg RDL":"single-leg-rdl.mp4","Single Leg RDL (corpo libero)":"single-leg-rdl.mp4","Single Leg RDL (Bodyweight)":"single-leg-rdl.mp4","Single Leg Deadlift":"single-leg-rdl.mp4","Stacco Rumeno Unilaterale":"single-leg-rdl.mp4","Stacco su una Gamba":"single-leg-rdl.mp4","Sumo Deadlift":"sumo-deadlift.mp4","Stacco Sumo":"sumo-deadlift.mp4","Conventional Deadlift":"conventional-deadlift.mp4",Deadlift:"conventional-deadlift.mp4",Stacco:"conventional-deadlift.mp4","Stacco da Terra":"conventional-deadlift.mp4","Stacco Classico":"conventional-deadlift.mp4","Trap Bar Deadlift":"conventional-deadlift.mp4","Stacco con Trap Bar":"conventional-deadlift.mp4","Barbell Row":"barbell-row.mp4","Rematore Bilanciere":"barbell-row.mp4","Rematore con Bilanciere":"barbell-row.mp4","Dumbbell Row":"dumbbell-row.mp4","Rematore Manubri":"dumbbell-row.mp4","Rematore con Manubrio":"dumbbell-row.mp4","Rematore Unilaterale":"dumbbell-row.mp4","T-Bar Row":"t-bar-row.mp4","Rematore T-Bar":"t-bar-row.mp4","Seated Cable Row":"seated-cable-row.mp4","Cable Row":"seated-cable-row.mp4","Rematore ai Cavi":"seated-cable-row.mp4","Pulley Basso":"seated-cable-row.mp4","Seated Row (Band)":"seated-row-band.mp4","Band Row":"seated-row-band.mp4","Rematore con Elastico":"seated-row-band.mp4","Lat Pulldown":"lat-pulldown.mp4","Lat Pulldown (Machine)":"lat-pulldown.mp4","Lat Machine":"lat-pulldown.mp4","Tirate al Lat Machine":"lat-pulldown.mp4","Pulley Alto":"lat-pulldown.mp4","Face Pull":"face-pull.mp4","Band Face Pull":"face-pull.mp4","Face Pull con Cavi":"face-pull.mp4","Face Pull con Elastico":"face-pull.mp4",Lunges:"lunges.mp4",Affondi:"lunges.mp4","Affondi in Avanti":"lunges.mp4","Affondi Camminati":"lunges.mp4","Reverse Lunge":"reverse-lunge.mp4","Affondi Inversi":"reverse-lunge.mp4","Affondi Indietro":"reverse-lunge.mp4","Step-up":"step-up.mp4","Step Up":"step-up.mp4","Salita su Gradino":"step-up.mp4","Step Up su Panca":"step-up.mp4","Military Press":"military-press.mp4","Military Press (Barbell)":"military-press.mp4","Overhead Press":"military-press.mp4","Lento Avanti":"military-press.mp4","Distensioni Sopra la Testa":"military-press.mp4","Dumbbell Shoulder Press":"dumbbell-shoulder-press.mp4","Shoulder Press Manubri":"dumbbell-shoulder-press.mp4","Lento Avanti Manubri":"dumbbell-shoulder-press.mp4","Spinte con Manubri":"dumbbell-shoulder-press.mp4","Arnold Press":"arnold-press.mp4","Lateral Raise":"lateral-raise.mp4","Lateral Raises":"lateral-raise.mp4","Alzate Laterali":"lateral-raise.mp4","Front Raise":"front-raise.mp4","Front Raises":"front-raise.mp4","Alzate Frontali":"front-raise.mp4",Plank:"plank.mp4","Plank Frontale":"plank.mp4","Tenuta Isometrica":"plank.mp4","Side Plank":"side-plank.mp4","Plank Laterale":"side-plank.mp4","Side Plank (Modified)":"side-plank-modified.mp4","Plank Laterale Modificato":"side-plank-modified.mp4","Pallof Press":"pallof-press.mp4","Pallof Press (Kneeling)":"pallof-press-kneeling.mp4","Pallof Press in Ginocchio":"pallof-press-kneeling.mp4","Half Kneeling Chop":"half-kneeling-chop.mp4","Chop in Ginocchio":"half-kneeling-chop.mp4","Dead Bug":"dead-bug.mp4","Scarafaggio Morto":"dead-bug.mp4","Dead Bug Progression":"dead-bug-progression.mp4","Dead Bug Heel Slides":"dead-bug-heel-slides.mp4","Bear Hold":"bear-hold.mp4","Tenuta Orso":"bear-hold.mp4","Posizione dell'Orso":"bear-hold.mp4","Hanging Leg Raise":"hanging-leg-raise.mp4","Alzate Gambe alla Sbarra":"hanging-leg-raise.mp4","Crunch Inverso Sospeso":"hanging-leg-raise.mp4","Ab Wheel Rollout":"ab-wheel-rollout.mp4","Rollout con Ruota":"ab-wheel-rollout.mp4","Ruota per Addominali":"ab-wheel-rollout.mp4","Cable Crunch":"cable-crunch.mp4","Crunch ai Cavi":"cable-crunch.mp4","Crunch al Cavo Alto":"cable-crunch.mp4","Bench Press":"flat-barbell-bench-press.mp4","Flat Barbell Bench Press":"flat-barbell-bench-press.mp4","Panca Piana":"flat-barbell-bench-press.mp4","Panca Piana Bilanciere":"flat-barbell-bench-press.mp4","Distensioni su Panca":"flat-barbell-bench-press.mp4","Dumbbell Bench Press":"dumbbell-bench-press.mp4","Panca Piana Manubri":"dumbbell-bench-press.mp4","Distensioni Manubri":"dumbbell-bench-press.mp4",Dips:"chest-dips.mp4","Chest Dips":"chest-dips.mp4","Dip alle Parallele":"chest-dips.mp4",Parallele:"chest-dips.mp4","Tricep Dips":"tricep-dips.mp4","Dips su Sedia":"tricep-dips.mp4","Dip su Panca":"tricep-dips.mp4","Dips per Tricipiti":"tricep-dips.mp4","Barbell Curl":"barbell-curl.mp4","Curl con Bilanciere":"barbell-curl.mp4","Curl Bilanciere":"barbell-curl.mp4","Hammer Curl":"hammer-curl.mp4","Curl a Martello":"hammer-curl.mp4","Skull Crushers":"skull-crushers.mp4","French Press":"skull-crushers.mp4","Estensioni Tricipiti Sdraiato":"skull-crushers.mp4","Tricep Pushdown":"tricep-pushdown.mp4","Push Down Tricipiti":"tricep-pushdown.mp4","Spinte in Basso Tricipiti":"tricep-pushdown.mp4","Standing Calf Raise":"standing-calf-raise.mp4","Calf Raise in Piedi":"standing-calf-raise.mp4","Polpacci in Piedi":"standing-calf-raise.mp4","Seated Calf Raise":"seated-calf-raise.mp4","Calf Raise Seduto":"seated-calf-raise.mp4","Polpacci da Seduto":"seated-calf-raise.mp4","Cat-Cow":"cat-cow.mp4","Gatto-Mucca":"cat-cow.mp4","Gatto-Cammello":"cat-cow.mp4","Bird Dog":"bird-dog.mp4","Cane-Uccello":"bird-dog.mp4","Bird Dog (Modified)":"bird-dog-modified.mp4",Clamshells:"clamshells.mp4",Clamshell:"clamshells.mp4",Conchiglia:"clamshells.mp4","Apertura a Conchiglia":"clamshells.mp4","Good Morning":"good-morning.mp4","Good Morning BW":"good-morning.mp4",Buongiorno:"good-morning.mp4","Bodyweight Hip Hinge":"bodyweight-hip-hinge.mp4","Hip Hinge":"bodyweight-hip-hinge.mp4","Cerniera d'Anca":"bodyweight-hip-hinge.mp4","Standing Hip Circles":"standing-hip-circles.mp4","Cerchi d'Anca":"standing-hip-circles.mp4","Pelvic Tilts":"pelvic-tilts.mp4","Retroversione Bacino":"pelvic-tilts.mp4","Inclinazioni Pelviche":"pelvic-tilts.mp4","Diaphragmatic Breathing":"diaphragmatic-breathing.mp4","Respirazione Diaframmatica":"diaphragmatic-breathing.mp4","Connection Breath":"connection-breath.mp4","Respiro di Connessione":"connection-breath.mp4","Happy Baby Stretch":"happy-baby-stretch.mp4","Bambino Felice":"happy-baby-stretch.mp4","Squat to Stand":"squat-to-stand.mp4","Squat in Piedi":"squat-to-stand.mp4","Toe Taps":"toe-taps.mp4","Tocco Punte":"toe-taps.mp4","Supine Marching":"supine-marching.mp4","Marcia Supina":"supine-marching.mp4","Standing March":"standing-march.mp4","Marcia sul Posto":"standing-march.mp4","Side Lying Leg Lift":"side-lying-leg-lift.mp4","Alzate Gamba Laterali":"side-lying-leg-lift.mp4","Shoulder Blade Squeeze":"shoulder-blade-squeeze.mp4","Adduzione Scapole":"shoulder-blade-squeeze.mp4","Retrazione Scapolare":"shoulder-blade-squeeze.mp4","Pelvic Floor Activation":"pelvic-floor-activation.mp4","Attivazione Pavimento Pelvico":"pelvic-floor-activation.mp4","Wall Sit with Breathing":"wall-sit-breathing.mp4","Sedia al Muro con Respiro":"wall-sit-breathing.mp4","Seated Knee Lifts":"seated-knee-lifts.mp4","Alzate Ginocchia da Seduto":"seated-knee-lifts.mp4","Bridge with Ball Squeeze":"bridge-ball-squeeze.mp4","Ponte con Palla":"bridge-ball-squeeze.mp4","Leg Press":"leg-press.mp4","Pressa per Gambe":"leg-press.mp4","Leg Extension":"leg-extension.mp4","Estensione Gambe":"leg-extension.mp4","Leg Extension Machine":"leg-extension.mp4","Wall Handstand Push-up":"wall-handstand-push-up.mp4","Handstand Push-up":"wall-handstand-push-up.mp4","Wall HSPU":"wall-handstand-push-up.mp4",HSPU:"wall-handstand-push-up.mp4","Piegamenti in Verticale":"wall-handstand-push-up.mp4","Piegamenti in Verticale al Muro":"wall-handstand-push-up.mp4","Handstand Hold":"handstand-hold.mp4",Verticale:"handstand-hold.mp4","Tenuta in Verticale":"handstand-hold.mp4","Pause Squat":"pause-squat.mp4","Pause Squat (Bodyweight)":"pause-squat.mp4","Squat con Pausa":"pause-squat.mp4","Squat Isometrico con Pausa":"pause-squat.mp4","Squat Jump":"squat-jump.mp4","Jump Squat":"squat-jump.mp4","Salto con Squat":"squat-jump.mp4","Squat Saltato":"squat-jump.mp4","Split Squat":"split-squat.mp4","Affondi sul Posto":"split-squat.mp4","Skater Squat":"skater-squat.mp4","Squat del Pattinatore":"skater-squat.mp4","Shrimp Squat":"shrimp-squat.mp4","Squat Gambero":"shrimp-squat.mp4","Box Squat":"box-squat.mp4","Squat su Box":"box-squat.mp4","Squat sulla Scatola":"box-squat.mp4","Assisted Pistol Squat":"assisted-pistol-squat.mp4","Assisted Pistol":"assisted-pistol-squat.mp4","Pistol Squat Assistito":"assisted-pistol-squat.mp4","Pistol Assistito":"assisted-pistol-squat.mp4","Archer Push-up":"archer-push-up.mp4","Archer Push Up":"archer-push-up.mp4","Piegamenti Arciere":"archer-push-up.mp4","Ring Push-up":"ring-push-up.mp4","Ring Push Up":"ring-push-up.mp4","Piegamenti agli Anelli":"ring-push-up.mp4","Typewriter Push-up":"typewriter-push-up.mp4","Typewriter Push Up":"typewriter-push-up.mp4","Piegamenti Macchina da Scrivere":"typewriter-push-up.mp4","Clap Push-up":"clap-push-up.mp4","Clap Push Up":"clap-push-up.mp4","Piegamenti con Battito":"clap-push-up.mp4","Piegamenti Esplosivi":"clap-push-up.mp4","Pseudo Planche Push-up":"pseudo-planche-push-up.mp4","Pseudo Planche Push Up":"pseudo-planche-push-up.mp4","Piegamenti Pseudo Planche":"pseudo-planche-push-up.mp4","Elevated Pike Push-up":"elevated-pike-push-up.mp4","Elevated Pike Push Up":"elevated-pike-push-up.mp4","Wide Grip Pull-up":"wide-grip-pull-up.mp4","Wide Grip Pull Up":"wide-grip-pull-up.mp4","Trazioni Presa Larga":"wide-grip-pull-up.mp4","Neutral Grip Pull-up":"neutral-grip-pull-up.mp4","Neutral Grip Pull Up":"neutral-grip-pull-up.mp4","Trazioni Presa Neutra":"neutral-grip-pull-up.mp4","TRX Row":"trx-row.mp4","TRX Rows":"trx-row.mp4","Rematore TRX":"trx-row.mp4","Rematore in Sospensione":"trx-row.mp4","Hollow Body Hold":"hollow-body-hold.mp4","Hollow Body":"hollow-body-hold.mp4","Hollow Hold":"hollow-body-hold.mp4","Posizione Cava":"hollow-body-hold.mp4","Tenuta Hollow":"hollow-body-hold.mp4","Corpo Cavo":"hollow-body-hold.mp4","FMS Deep Squat":"fms-deep-squat.mp4","FMS Hurdle Step":"fms-hurdle-step.mp4","FMS Inline Lunge":"fms-inline-lunge.mp4","FMS Active Straight Leg Raise":"fms-active-straight-leg-raise.mp4","FMS Trunk Stability Push-up":"fms-trunk-stability-push-up.mp4","FMS Rotary Stability":"fms-rotary-stability.mp4","Hurdle Step":"fms-hurdle-step.mp4","Inline Lunge":"fms-inline-lunge.mp4","Active Straight Leg Raise":"fms-active-straight-leg-raise.mp4","Trunk Stability Push-up":"fms-trunk-stability-push-up.mp4","Rotary Stability":"fms-rotary-stability.mp4","Neck Flexion":"neck-flexion.mp4","Neck Extension":"neck-extension.mp4","Neck Lateral Flexion":"neck-lateral-flexion.mp4","Flessione Collo":"neck-flexion.mp4","Estensione Collo":"neck-extension.mp4","Flessione Laterale Collo":"neck-lateral-flexion.mp4","Neck Rotation":"neck-rotation.mp4","Rotazione Collo":"neck-rotation.mp4","Neck Harness Exercise":"neck-harness-exercise.mp4","Kettlebell Swing":"kettlebell-swing.mp4","Swing con Kettlebell":"kettlebell-swing.mp4","Kettlebell Clean":"kettlebell-clean.mp4","Clean con Kettlebell":"kettlebell-clean.mp4","Kettlebell Snatch":"kettlebell-snatch.mp4","Snatch con Kettlebell":"kettlebell-snatch.mp4","Turkish Get Up":"turkish-get-up.mp4","Turkish Get-Up":"turkish-get-up.mp4","Alzata Turca":"turkish-get-up.mp4","Battle Ropes":"battle-ropes.mp4","Corde da Battaglia":"battle-ropes.mp4","Farmers Walk":"farmers-walk.mp4","Farmer's Walk":"farmers-walk.mp4","Camminata del Contadino":"farmers-walk.mp4","Sandbag Carry":"sandbag-carry.mp4","Trasporto Sandbag":"sandbag-carry.mp4","Sled Push":"sled-push.mp4","Spinta Slitta":"sled-push.mp4","Sled Pull":"sled-pull.mp4","Tirata Slitta":"sled-pull.mp4","Landmine Press":"landmine-press.mp4","Pressa Landmine":"landmine-press.mp4","Fire Hydrant":"fire-hydrant.mp4",Idrante:"fire-hydrant.mp4","Cable Kickback":"cable-kickback.mp4","Kickback ai Cavi":"cable-kickback.mp4","Box Jump":"box-jump.mp4","Salto al Box":"box-jump.mp4","Salto sulla Scatola":"box-jump.mp4","Broad Jump":"broad-jump.mp4","Salto in Lungo":"broad-jump.mp4","Counter Movement Jump":"counter-movement-jump.mp4",CMJ:"counter-movement-jump.mp4","Salto Contromovimento":"counter-movement-jump.mp4","Drop Jump":"drop-jump.mp4","Salto di Caduta":"drop-jump.mp4","Squat Jump Test":"squat-jump-test.mp4","Med Ball Chest Pass":"med-ball-chest-pass.mp4","Lancio Petto Palla Medica":"med-ball-chest-pass.mp4","Med Ball Overhead Throw":"med-ball-overhead-throw.mp4","Lancio Sopra Testa Palla Medica":"med-ball-overhead-throw.mp4","Copenhagen Plank":"copenhagen-plank.mp4","Plank Copenhagen":"copenhagen-plank.mp4","Dragon Flag":"dragon-flag.mp4","Bandiera del Drago":"dragon-flag.mp4","L-Sit":"l-sit.mp4","L Sit":"l-sit.mp4","Tenuta a L":"l-sit.mp4","L-sit Raccolto":"l-sit.mp4","Tuck L-Sit":"l-sit.mp4","Lying Leg Raise":"lying-leg-raise.mp4","Alzate Gambe Supino":"lying-leg-raise.mp4","Alzate Gambe a Terra":"lying-leg-raise.mp4","Pistol Squat V2":"pistol-squat-v2.mp4","One Arm Push-up":"one-arm-push-up.mp4","Piegamenti a Un Braccio":"one-arm-push-up.mp4","Hip Hinge a Corpo Libero":"bodyweight-hip-hinge.mp4","Hip Hinge Bodyweight":"bodyweight-hip-hinge.mp4","Verticale al Muro Push-up":"wall-handstand-push-up.mp4","HSPU al Muro":"wall-handstand-push-up.mp4","Camminata al Muro":"wall-handstand-push-up.mp4","Wall Walk":"wall-handstand-push-up.mp4","Floor Pull":"floor-pull.mp4","Floor Pull (asciugamano)":"floor-pull.mp4","Floor Pull con Asciugamano":"floor-pull.mp4","Floor Pull Singolo Braccio":"floor-pull.mp4","Floor Pull Facilitato":"floor-pull.mp4","Prone Row":"floor-pull.mp4","Prone Y Raise":"floor-pull.mp4","Prone Y-T-W Raises":"floor-pull.mp4","Y-T-W Raises":"floor-pull.mp4","Remata a Terra":"band-rows.mp4","Back Extension":"back-extension-roman-chair.mp4","Back Extension (Roman Chair)":"back-extension-roman-chair.mp4",Iperestensioni:"back-extension-roman-chair.mp4","Estensioni Schiena":"back-extension-roman-chair.mp4","Band Rows":"band-rows.mp4","Rematore con Banda":"band-rows.mp4","Banded Hip Thrust":"banded-hip-thrust.mp4","Hip Thrust con Banda":"banded-hip-thrust.mp4","Cable Fly High to Low":"cable-fly-high-to-low.mp4","Cable Fly (High to Low)":"cable-fly-high-to-low.mp4","Croci ai Cavi Alto-Basso":"cable-fly-high-to-low.mp4","Cable Fly Low to High":"cable-fly-low-to-high.mp4","Cable Fly (Low to High)":"cable-fly-low-to-high.mp4","Croci ai Cavi Basso-Alto":"cable-fly-low-to-high.mp4","Cable Fly Mid":"cable-fly-mid.mp4","Cable Fly":"cable-fly-mid.mp4","Croci ai Cavi":"cable-fly-mid.mp4","Cable Pull Through":"cable-pull-through.mp4","Pull Through ai Cavi":"cable-pull-through.mp4","Chest Supported Row":"chest-supported-row.mp4","Rematore con Supporto Petto":"chest-supported-row.mp4","Close Grip Bench Press":"close-grip-bench-press.mp4","Panca Presa Stretta":"close-grip-bench-press.mp4","Distensioni Presa Stretta":"close-grip-bench-press.mp4","Concentration Curl":"concentration-curl.mp4","Curl di Concentrazione":"concentration-curl.mp4","Cuban Press":"cuban-press.mp4","Pressa Cubana":"cuban-press.mp4","Decline Bench Press":"decline-bench-press.mp4","Panca Declinata":"decline-bench-press.mp4","Donkey Calf Raise":"donkey-calf-raise.mp4","Polpacci alla Donkey":"donkey-calf-raise.mp4","Dumbbell Fly":"dumbbell-fly.mp4","Croci con Manubri":"dumbbell-fly.mp4","Aperture con Manubri":"dumbbell-fly.mp4","External Rotation (Band)":"external-rotation-band.mp4","Rotazione Esterna con Banda":"external-rotation-band.mp4","External Rotation (Cable)":"external-rotation-cable.mp4","Rotazione Esterna ai Cavi":"external-rotation-cable.mp4","External Rotation":"external-rotation-cable.mp4","Frog Pump":"frog-pump.mp4","Pompa Rana":"frog-pump.mp4","Hack Squat":"hack-squat.mp4","Squat Hack":"hack-squat.mp4","Hanging Knee Raise":"hanging-knee-raise.mp4","Alzate Ginocchia alla Sbarra":"hanging-knee-raise.mp4","Hollow Body Rock":"hollow-body-rock.mp4","Dondolo Hollow":"hollow-body-rock.mp4","Incline Barbell Bench Press":"incline-barbell-bench-press.mp4","Panca Inclinata Bilanciere":"incline-barbell-bench-press.mp4","Incline Bench Press":"incline-barbell-bench-press.mp4","Incline Dumbbell Bench Press":"incline-dumbbell-bench-press.mp4","Panca Inclinata Manubri":"incline-dumbbell-bench-press.mp4","Incline Dumbbell Curl":"incline-dumbbell-curl.mp4","Curl Inclinato con Manubri":"incline-dumbbell-curl.mp4","Lying Leg Curl":"lying-leg-curl.mp4","Leg Curl Prono":"lying-leg-curl.mp4","Meadows Row":"meadows-row.mp4","Rematore Meadows":"meadows-row.mp4","Overhead Tricep Extension":"overhead-tricep-extension.mp4","Estensione Tricipiti Sopra la Testa":"overhead-tricep-extension.mp4","Pec Deck":"pec-deck-machine-fly.mp4","Pec Deck Machine Fly":"pec-deck-machine-fly.mp4","Pectoral Machine":"pec-deck-machine-fly.mp4","Pendlay Row":"pendlay-row.mp4","Rematore Pendlay":"pendlay-row.mp4","Preacher Curl":"preacher-curl.mp4","Curl alla Panca Scott":"preacher-curl.mp4","Scott Curl":"preacher-curl.mp4",Pullover:"pullover-dumbbell.mp4","Pullover Dumbbell":"pullover-dumbbell.mp4","Pullover con Manubrio":"pullover-dumbbell.mp4","Rear Delt Fly (Cable)":"rear-delt-fly-cable.mp4","Rear Delt Fly Cable":"rear-delt-fly-cable.mp4","Alzate Posteriori ai Cavi":"rear-delt-fly-cable.mp4","Rear Delt Fly (Dumbbell)":"rear-delt-fly-dumbbell.mp4","Rear Delt Fly Dumbbell":"rear-delt-fly-dumbbell.mp4","Rear Delt Fly":"rear-delt-fly-dumbbell.mp4","Alzate Posteriori":"rear-delt-fly-dumbbell.mp4","Reverse Hyperextension":"reverse-hyperextension.mp4","Iperestensione Inversa":"reverse-hyperextension.mp4","Reverse Nordic Curl":"reverse-nordic-curl.mp4","Nordic Curl Inverso":"reverse-nordic-curl.mp4","Seal Row":"seal-row.mp4","Rematore Foca":"seal-row.mp4","Seated Leg Curl":"seated-leg-curl.mp4","Leg Curl Seduto":"seated-leg-curl.mp4","Single Leg Calf Raise":"single-leg-calf-raise.mp4","Polpacci su una Gamba":"single-leg-calf-raise.mp4","Single Leg Hip Thrust":"single-leg-hip-thrust.mp4","Hip Thrust su una Gamba":"single-leg-hip-thrust.mp4","Sissy Squat":"sissy-squat.mp4","Squat Sissy":"sissy-squat.mp4","Spanish Squat":"spanish-squat.mp4","Squat Spagnolo":"spanish-squat.mp4","Spider Curl":"spider-curl.mp4","Curl Ragno":"spider-curl.mp4","Straight Arm Pulldown":"straight-arm-pulldown.mp4","Pulldown Braccia Tese":"straight-arm-pulldown.mp4","Swiss Ball Leg Curl":"swiss-ball-leg-curl.mp4","Leg Curl con Palla Svizzera":"swiss-ball-leg-curl.mp4","Tibialis Raise":"tibialis-raise.mp4","Alzata Tibiale":"tibialis-raise.mp4","Tricep Kickback":"tricep-kickback.mp4","Kickback Tricipiti":"tricep-kickback.mp4","V-Up":"v-up.mp4","V Up":"v-up.mp4","Crunch a V":"v-up.mp4","Ab Wheel (in ginocchio)":"ab-wheel-rollout.mp4","Barbell Rollout":"ab-wheel-rollout.mp4","Stability Ball Rollout":"ab-wheel-rollout.mp4","Band Pull-up":"assisted-pull-up.mp4","Negative Pull-up":"standard-pull-up.mp4","Bench Press (leggero)":"flat-barbell-bench-press.mp4","Panca Piana con Bilanciere":"flat-barbell-bench-press.mp4","Panca con Manubri":"dumbbell-bench-press.mp4","Panca Inclinata":"incline-barbell-bench-press.mp4","Panca Inclinata con Manubri":"incline-dumbbell-bench-press.mp4","Floor Press":"flat-barbell-bench-press.mp4","Floor Press con Manubri":"dumbbell-bench-press.mp4","Decline Dumbbell Press":"decline-bench-press.mp4","Incline Dumbbell Press":"incline-dumbbell-bench-press.mp4","Single Arm Dumbbell Press":"dumbbell-bench-press.mp4","Chest Press (Macchina)":"flat-barbell-bench-press.mp4","Machine Chest Press":"flat-barbell-bench-press.mp4","Incline Chest Press (Macchina)":"incline-barbell-bench-press.mp4","Shoulder Press (Macchina)":"dumbbell-shoulder-press.mp4","Machine Shoulder Press":"dumbbell-shoulder-press.mp4","Machine Row":"seated-cable-row.mp4","Machine Crunch":"cable-crunch.mp4","Bulgarian Split Squat profondo":"bulgarian-split-squat.mp4","Dumbbell Squat":"goblet-squat.mp4","Dumbbell Front Squat":"goblet-squat.mp4","Goblet Squat (leggero)":"goblet-squat.mp4","Smith Machine Squat":"back-squat.mp4","Sumo Squat":"sumo-deadlift.mp4","Zercher Squat":"front-squat.mp4","Dumbbell Deadlift":"conventional-deadlift.mp4","Dumbbell Sumo Deadlift":"sumo-deadlift.mp4","Dumbbell RDL":"romanian-deadlift.mp4","Stacco con Manubri":"conventional-deadlift.mp4","Stacco in Deficit":"conventional-deadlift.mp4","Stacco Rumeno con Manubri":"romanian-deadlift.mp4","Cable Curl + Pulldown":"lat-pulldown.mp4","Cable Lateral Raise":"lateral-raise.mp4","Cable Pullover":"straight-arm-pulldown.mp4","Cable Rotation":"pallof-press.mp4","High Cable Fly":"cable-fly-high-to-low.mp4","Low Cable Fly":"cable-fly-low-to-high.mp4","Pushdown ai Cavi":"tricep-pushdown.mp4","Seated Cable Row (presa alta)":"seated-cable-row.mp4","Neutral Grip Lat Pulldown":"lat-pulldown.mp4","Supinated Lat Pulldown":"lat-pulldown.mp4","Wide Grip Lat Pulldown":"lat-pulldown.mp4","Cable Pulldown":"cable-pulldown.mp4","Pulldown ai Cavi":"cable-pulldown.mp4","Cable Lat Pulldown":"cable-pulldown.mp4","Dumbbell Push Press":"dumbbell-shoulder-press.mp4","Dumbbell Shoulder Press (pesante)":"dumbbell-shoulder-press.mp4","Shoulder Press con Manubri":"dumbbell-shoulder-press.mp4","Push Press":"military-press.mp4","Landmine Row":"t-bar-row.mp4","Leg Press (piedi alti)":"leg-press.mp4","Single Leg Press":"leg-press.mp4","Wide Stance Leg Press":"leg-press.mp4",Pressa:"leg-press.mp4","Captain Chair Leg Raise":"hanging-leg-raise.mp4","Weighted Crunch":"cable-crunch.mp4","TRX Fallout":"ab-wheel-rollout.mp4","GHD Raise":"nordic-hamstring-curl.mp4","Nordic Curl (eccentrico)":"nordic-hamstring-curl.mp4","Pike Push-up (elevato)":"elevated-pike-push-up.mp4","Push-up (piedi rialzati)":"decline-push-up.mp4","Push-up (weighted)":"standard-push-up.mp4","Dip Tricipiti":"tricep-dips.mp4","Lateral Raise + Press":"lateral-raise.mp4","Suitcase Carry":"farmers-walk.mp4",Thruster:"front-squat.mp4","Wall Sit":"wall-sit-breathing.mp4","Squat a Corpo Libero":"goblet-squat.mp4","Squat con Bilanciere":"back-squat.mp4","Squat Frontale":"front-squat.mp4","Squat Bulgaro":"bulgarian-split-squat.mp4",Pressa:"leg-press.mp4","Affondi Camminati":"lunges.mp4","Stacco da Terra":"conventional-deadlift.mp4","Stacco Rumeno":"romanian-deadlift.mp4","Stacco Sumo":"sumo-deadlift.mp4","Stacco con Trap Bar":"conventional-deadlift.mp4","Stacco Trap Bar":"conventional-deadlift.mp4","Stacco Rumeno Unilaterale":"single-leg-rdl.mp4","Hip Hinge a Corpo Libero":"bodyweight-hip-hinge.mp4","Good Morning Bodyweight":"good-morning.mp4","Hip Thrust":"hip-thrust.mp4","Hip Thrust Bodyweight":"glute-bridge.mp4","Hip Thrust Unilaterale":"single-leg-hip-thrust.mp4","Nordic Curl":"nordic-hamstring-curl.mp4","Nordic Curl (Solo Eccentrica)":"nordic-hamstring-curl.mp4","Nordic Curl Assistito":"nordic-hamstring-curl.mp4","Nordic Curl Parziale":"nordic-hamstring-curl.mp4","Nordic Curl Inverso":"reverse-nordic-curl.mp4","Leg Curl alla Macchina":"leg-curl.mp4","Leg Curl Sdraiato":"lying-leg-curl.mp4","Leg Curl Seduto":"seated-leg-curl.mp4",Piegamenti:"standard-push-up.mp4","Push-up":"standard-push-up.mp4","Push-up su Ginocchia":"knee-push-up.mp4","Piegamenti Diamante":"diamond-push-up.mp4","Piegamenti Arciere":"archer-push-up.mp4","Piegamenti in Verticale al Muro":"wall-handstand-push-up.mp4","Panca Piana":"flat-barbell-bench-press.mp4","Panca Piana con Bilanciere":"flat-barbell-bench-press.mp4","Panca Inclinata":"incline-barbell-bench-press.mp4","Panca Inclinata con Bilanciere":"incline-barbell-bench-press.mp4","Panca Inclinata con Manubri":"incline-dumbbell-bench-press.mp4","Panca Declinata":"decline-bench-press.mp4","Panca con Manubri":"dumbbell-bench-press.mp4","Panca Presa Stretta":"close-grip-bench-press.mp4","Chest Press":"flat-barbell-bench-press.mp4","Dip per Petto":"chest-dips.mp4","Dip per Tricipiti":"tricep-dips.mp4","Pike Push-up":"pike-push-up.mp4","Pike Push-up (Knee)":"pike-push-up.mp4","Pike Push-up su Ginocchia":"pike-push-up.mp4","Pike Push-up Facile":"pike-push-up.mp4","Pike Push-up Alto":"elevated-pike-push-up.mp4","Pike Push-up Elevato":"elevated-pike-push-up.mp4","Pike Push-up Inclinato":"pike-push-up.mp4","Incline Pike Push-up":"elevated-pike-push-up.mp4","Handstand Push-up":"wall-handstand-push-up.mp4","HSPU al Muro (Solo Eccentrica)":"wall-handstand-push-up.mp4","Wall Handstand Push-up (Eccentric)":"wall-handstand-push-up.mp4","Camminata al Muro":"wall-handstand-push-up.mp4","Wall Walk":"wall-handstand-push-up.mp4","Wall Shoulder Tap":"wall-handstand-push-up.mp4","Lento Avanti":"military-press.mp4","Military Press":"military-press.mp4","Spinte con Manubri":"dumbbell-shoulder-press.mp4","Shoulder Press con Manubri":"dumbbell-shoulder-press.mp4","Shoulder Press Macchina":"dumbbell-shoulder-press.mp4","Push Press":"military-press.mp4","Alzate Laterali":"lateral-raise.mp4","Alzate Frontali":"front-raise.mp4","Alzate Posteriori":"rear-delt-fly-dumbbell.mp4","Alzate Tibiali":"tibialis-raise.mp4","Trazioni alla Sbarra":"standard-pull-up.mp4","Trazioni Presa Larga":"wide-grip-pull-up.mp4","Trazioni Presa Stretta":"chin-up.mp4","Trazioni Presa Neutra":"neutral-grip-pull-up.mp4","Trazioni Presa Prona":"standard-pull-up.mp4","Trazioni Presa Supina":"chin-up.mp4","Trazioni Supine":"chin-up.mp4","Trazioni Assistite":"assisted-pull-up.mp4","Trazioni Negative":"standard-pull-up.mp4","Negative Pull-up":"standard-pull-up.mp4","Pull-up Larghe":"wide-grip-pull-up.mp4","Rematore Invertito":"inverted-row.mp4","Trazioni Orizzontali":"inverted-row.mp4","Trazioni Orizzontali Veloci":"inverted-row.mp4","Inverted Row (alto)":"inverted-row.mp4","Inverted Row (tavolo)":"inverted-row.mp4","Inverted Row Piedi Elevati":"inverted-row.mp4","Rematore con Bilanciere":"barbell-row.mp4","Rematore con Manubrio":"dumbbell-row.mp4","Rematore con Supporto Petto":"chest-supported-row.mp4","Rematore Meadows":"meadows-row.mp4","Rematore Pendlay":"pendlay-row.mp4","Rematore T-Bar":"t-bar-row.mp4","Archer Row":"inverted-row.mp4","Lat Machine":"lat-pulldown.mp4","Lat Machine Presa Larga":"lat-pulldown.mp4","Lat Machine Presa Stretta":"lat-pulldown.mp4","Pulley Basso":"seated-cable-row.mp4","Pulldown Braccia Tese":"straight-arm-pulldown.mp4","Curl con Bilanciere":"barbell-curl.mp4","Curl a Martello":"hammer-curl.mp4","Curl Concentrato":"concentration-curl.mp4","Curl alla Panca Scott":"preacher-curl.mp4","Curl su Panca Inclinata":"incline-dumbbell-curl.mp4","French Press":"skull-crushers.mp4","French Press Sopra la Testa":"overhead-tricep-extension.mp4","Pushdown ai Cavi":"tricep-pushdown.mp4","Kickback ai Cavi":"cable-kickback.mp4","Kickback Tricipiti":"tricep-kickback.mp4","Plank Laterale":"side-plank.mp4","Side Plank":"side-plank.mp4","Crunch ai Cavi":"cable-crunch.mp4","Rollout con Ruota":"ab-wheel-rollout.mp4","Ab Wheel":"ab-wheel-rollout.mp4","Alzate Gambe alla Sbarra":"hanging-leg-raise.mp4","Alzate Ginocchia alla Sbarra":"hanging-knee-raise.mp4","Leg Raise alla Sbarra":"hanging-leg-raise.mp4","Croci ai Cavi":"cable-fly-mid.mp4","Croci con Manubri":"dumbbell-fly.mp4","Pec Deck":"pec-deck-machine-fly.mp4","Iperestensioni 45Â°":"back-extension-roman-chair.mp4","Iperestensioni alla Sedia Romana":"back-extension-roman-chair.mp4","Iperestensione Inversa":"reverse-hyperextension.mp4","Calf Raise":"standing-calf-raise.mp4","Calf Raise in Piedi":"standing-calf-raise.mp4","Calf Raise da Seduto":"seated-calf-raise.mp4","Calf Raise Seduto":"seated-calf-raise.mp4","Calf Raise Donkey":"donkey-calf-raise.mp4","Calf Raise Unilaterale":"single-leg-calf-raise.mp4","Salto con Contromovimento":"counter-movement-jump.mp4","Salto sul Box":"box-jump.mp4","Salto in Lungo da Fermo":"broad-jump.mp4","Lancio Palla Medica dal Petto":"med-ball-chest-pass.mp4","Lancio Palla Medica Sopra la Testa":"med-ball-overhead-throw.mp4","Swing con Kettlebell":"kettlebell-swing.mp4","Clean con Kettlebell":"kettlebell-clean.mp4","Snatch con Kettlebell":"kettlebell-snatch.mp4","Alzata Turca":"turkish-get-up.mp4","Spinta Slitta":"sled-push.mp4","Traino Slitta":"sled-pull.mp4","Farmer Walk":"farmers-walk.mp4","Pull Through ai Cavi":"cable-pull-through.mp4","Rotazione Esterna ai Cavi":"external-rotation-cable.mp4","Pullover con Manubrio":"pullover-dumbbell.mp4","Flessione Collo":"neck-flexion.mp4","Estensione Collo":"neck-extension.mp4","Flessione Laterale Collo":"neck-lateral-flexion.mp4","Rotazione Collo":"neck-rotation.mp4","Esercizio con Neck Harness":"neck-harness-exercise.mp4","FMS Squat Profondo":"fms-deep-squat.mp4","FMS Passo Ostacolo":"fms-hurdle-step.mp4","FMS Affondo in Linea":"fms-inline-lunge.mp4","FMS Alzata Gamba Tesa":"fms-active-straight-leg-raise.mp4","FMS Push-up StabilitÃ ":"fms-trunk-stability-push-up.mp4","FMS StabilitÃ  Rotatoria":"fms-rotary-stability.mp4","Floor Pull":"floor-pull.mp4","Floor Pull (asciugamano)":"floor-pull.mp4","Floor Pull Facilitato":"floor-pull.mp4"};function xi(t){if(fn[t])return`${gn}/${fn[t]}`;const a=fh(t);return`${gn}/${a}`}async function xh(t){try{const a=xi(t),r=await fetch(a,{method:"GET",headers:{Range:"bytes=0-0"}});return r.ok||r.status===206}catch{return!0}}const bh=ta.memo(function({weeklySplit:a,showDetails:r=!0}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:a.splitName}),e.jsx("p",{className:"text-blue-100",children:a.description})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.days.map((s,i)=>e.jsx(yh,{day:s,index:i,showDetails:r},i))})]})}),vh={strength:{badge:"bg-blue-600",border:"hover:border-blue-500",icon:Jt,label:"Forza"},running:{badge:"bg-green-600",border:"hover:border-green-500",icon:Kr,label:"Corsa"},mixed:{badge:"bg-teal-600",border:"hover:border-teal-500",icon:Wt,label:"Misto"},rest:{badge:"bg-gray-600",border:"hover:border-gray-500",icon:Vr,label:"Riposo"}},yh=ta.memo(function({day:a,index:r,showDetails:s}){var x;const[i,o]=ta.useState(s),l=a.type||"strength",n=vh[l],c=n.icon,u=((x=a.exercises)==null?void 0:x.filter(g=>g&&g.name&&g.pattern))||[],d=u.filter(g=>g.pattern!=="corrective"),p=u.filter(g=>g.pattern==="corrective"),f=d.length>0,h=!!a.runningSession;return e.jsx(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.1},children:e.jsxs(Dt,{className:`bg-gray-800 border-gray-700 ${n.border} transition-all`,children:[e.jsx(zt,{className:"cursor-pointer",onClick:()=>o(!i),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`${n.badge} rounded-full w-10 h-10 flex items-center justify-center`,children:e.jsx("span",{className:"text-white font-bold",children:a.dayNumber})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"text-white text-lg",children:a.dayName}),l!=="strength"&&e.jsx("span",{className:`${n.badge} text-white text-[10px] px-1.5 py-0.5 rounded uppercase font-medium`,children:n.label})]}),e.jsxs(hd,{className:"text-gray-400 text-sm",children:[e.jsx(et,{className:"inline w-4 h-4 mr-1"}),a.focus]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[f&&e.jsxs("span",{className:"text-sm",children:[d.length," esercizi"]}),h&&e.jsxs("span",{className:"text-sm text-green-400",children:[e.jsx(Kr,{className:"inline w-4 h-4 mr-1"}),a.runningSession.totalDuration," min"]}),e.jsx(c,{className:"w-5 h-5"}),e.jsx(Ut,{className:`w-5 h-5 transition-transform duration-200 ${i?"rotate-180":""}`})]})]})}),i&&e.jsx(Bt,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[a.runningSession&&e.jsx(wh,{session:a.runningSession}),h&&f&&e.jsxs("div",{className:"flex items-center gap-2 py-2",children:[e.jsx("div",{className:"flex-1 border-t border-gray-700"}),e.jsx("span",{className:"text-xs text-gray-500 uppercase",children:"Forza"}),e.jsx("div",{className:"flex-1 border-t border-gray-700"})]}),d.map((g,y)=>e.jsx(xn,{exercise:g,index:y},y)),p.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2 uppercase tracking-wider",children:"Esercizi Correttivi"}),p.map((g,y)=>e.jsx(xn,{exercise:g,index:y,isCorrective:!0},`corrective-${y}`))]}),l==="rest"&&!f&&!h&&e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(Vr,{className:"w-8 h-8 mx-auto mb-2 text-gray-500"}),e.jsx("p",{className:"text-sm",children:"Giornata di riposo"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recupero attivo consigliato"})]})]})})]})})});function xn({exercise:t,index:a,isCorrective:r=!1}){const[s,i]=ta.useState(!1),[o,l]=ta.useState(!1),n=ro(t.name),c=xi(t.name),u=Uc(t.name),d={lower_push:"bg-green-600",lower_pull:"bg-yellow-600",horizontal_push:"bg-blue-600",horizontal_pull:"bg-cyan-600",vertical_push:"bg-purple-600",vertical_pull:"bg-pink-600",core:"bg-orange-600",corrective:"bg-gray-600"},p={lower_push:"gambe",lower_pull:"femorali",horizontal_push:"petto",horizontal_pull:"dorsali",vertical_push:"spalle",vertical_pull:"dorsali",core:"core",corrective:"correttivo"},f=d[t.pattern]||"bg-gray-600",h=p[t.pattern]||t.pattern.replace("_"," ");return e.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.05},className:`rounded-lg ${r?"bg-gray-700/50":"bg-gray-700"}`,children:[e.jsx("div",{className:"p-3 cursor-pointer",onClick:()=>i(!s),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 md:w-14 md:h-14 rounded-lg overflow-hidden bg-gray-600",children:!o&&c?e.jsx("video",{src:c,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,autoPlay:!0,onError:()=>l(!0)}):!o&&u?e.jsx("img",{src:u,alt:t.name,className:"w-full h-full object-cover",onError:()=>l(!0),loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl bg-gray-700",children:"ðŸ‹ï¸"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"text-white font-medium text-sm md:text-base truncate max-w-[180px] md:max-w-none",children:t.name}),e.jsx("div",{className:`${f} rounded px-1.5 py-0.5 text-[10px] md:text-xs font-medium text-white uppercase tracking-wider`,children:h})]}),t.warmup&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[e.jsx(uc,{className:"w-3 h-3 text-orange-400"}),e.jsx("span",{className:"text-[10px] md:text-xs text-orange-300",children:t.warmup.ramp?(()=>{const x=t.weight?parseFloat(String(t.weight).replace("kg","")):0;return`Rampa: ${t.warmup.ramp.map(g=>{const y=x>0?Math.round(x*(g.percentage/100)*2)/2:0;return y>0?`${g.reps}r@${y}kg`:`${g.reps}r@${g.percentage}%`}).join(" â†’ ")}`})():(()=>{const x=t.weight?parseFloat(String(t.weight).replace("kg","")):0,g=x>0&&t.warmup.percentage?Math.round(x*(t.warmup.percentage/100)*2)/2:0;return g>0?`Riscaldamento: ${t.warmup.sets}Ã—${t.warmup.reps} @ ${g}kg`:`Riscaldamento: ${t.warmup.sets}Ã—${t.warmup.reps} @ ${t.warmup.percentage||t.warmup.intensity}%`})()})]}),t.notes&&(()=>{const x=t.notes.split(" | ").filter(g=>!g.includes("Carico:")&&!g.includes("ðŸ’ª Carico")&&!g.includes("Baseline:")&&!g.toLowerCase().includes("pattern")&&!g.includes("stimato da")).join(" | ");return x?e.jsx("p",{className:"text-xs text-gray-400 mt-0.5 line-clamp-2",children:x}):null})()]}),e.jsx(Ut,{className:`w-4 h-4 text-gray-400 flex-shrink-0 transition-transform duration-200 ${s?"rotate-180":""}`})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-center bg-gray-800/50 rounded-lg p-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px]",children:"Sets"}),e.jsx("p",{className:"text-white font-bold text-sm",children:t.sets})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px]",children:"Reps"}),e.jsx("p",{className:"text-white font-bold text-sm",children:t.reps})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px]",children:"Rest"}),e.jsx("p",{className:"text-white font-bold text-sm",children:t.rest})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px]",children:t.weight?"Peso":"RIR"}),e.jsx("p",{className:`font-bold text-sm ${t.weight?"text-amber-400":"text-green-400"}`,children:t.weight||(()=>{var g;const x=(g=t.notes)==null?void 0:g.match(/RIR\s*(\d)/i);return x?x[1]:"2"})()})]})]}),(t.baseline||t.wasReplaced)&&e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 flex-wrap",children:[t.baseline&&e.jsxs("div",{className:"text-[10px] text-green-400 flex items-center gap-1 bg-green-400/10 px-1.5 py-0.5 rounded",children:[e.jsx(ea,{className:"w-3 h-3"}),e.jsxs("span",{children:["Riferimento: ",t.baseline.maxReps," reps"]})]}),t.wasReplaced&&e.jsx("div",{className:"bg-yellow-600/20 text-yellow-400 rounded px-1.5 py-0.5 text-[10px] font-medium",children:"Sostituito"})]})]})}),e.jsx(Ne,{children:s&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsx("div",{className:"px-3 pb-3 border-t border-gray-600 max-h-[50vh] overflow-y-auto",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 mt-3",children:[(n==null?void 0:n.description)&&e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:n.description}),(n==null?void 0:n.technique)&&n.technique.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-400 font-medium mb-2 uppercase tracking-wider",children:"Tecnica"}),e.jsx("ul",{className:"space-y-1",children:n.technique.map((x,g)=>e.jsxs("li",{className:"text-xs text-gray-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"â€¢"}),x]},g))})]}),t.intensity&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"text-blue-400",children:"IntensitÃ :"})," ",t.intensity]})}),!n&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Descrizione non disponibile per questo esercizio."})]})})})})]})}function wh({session:t}){const[a,r]=ta.useState(!1),s={continuous:"Continuo",intervals:"Intervalli",fartlek:"Fartlek",tempo:"Tempo Run",long_run:"Lungo"};return e.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-green-900/30 rounded-lg border border-green-700/50",children:[e.jsx("div",{className:"p-3 cursor-pointer",onClick:()=>r(!a),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-600 rounded-lg p-2",children:e.jsx(Kr,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsxs("p",{className:"text-green-300 text-xs",children:[s[t.type]||t.type," â€¢ RPE ",t.rpe,"/10"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-green-400 font-bold",children:[t.totalDuration," min"]}),e.jsxs("p",{className:"text-green-300 text-xs flex items-center gap-1",children:[e.jsx(Yr,{className:"w-3 h-3"}),t.targetHRZone.replace("zone","Z")]})]}),e.jsx(Ut,{className:`w-5 h-5 text-green-400 transition-transform duration-200 ${a?"rotate-180":""}`})]})]})}),e.jsx(Ne,{children:a&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-3 pb-3 border-t border-green-700/50",children:[e.jsxs("div",{className:"mt-3 space-y-2",children:[t.warmup&&e.jsx(Ir,{interval:t.warmup,label:"Riscaldamento"}),e.jsx("div",{className:"space-y-1.5",children:t.mainSet.map((i,o)=>e.jsx(Ir,{interval:i},o))}),t.cooldown&&e.jsx(Ir,{interval:t.cooldown,label:"Defaticamento"})]}),t.notes&&e.jsx("div",{className:"mt-3 pt-3 border-t border-green-700/30",children:e.jsx("p",{className:"text-xs text-green-300/80",children:t.notes})})]})})})]})}function Ir({interval:t,label:a}){const r={walk:"Camminata",easy:"Facile",zone2:"Zona 2",tempo:"Tempo",interval:"Intervallo"},i={walk:"bg-gray-600/50 border-gray-500",easy:"bg-green-600/30 border-green-500/50",zone2:"bg-green-600/50 border-green-500",tempo:"bg-yellow-600/30 border-yellow-500/50",interval:"bg-red-600/30 border-red-500/50"}[t.type]||"bg-gray-600/50 border-gray-500";return e.jsxs("div",{className:`flex items-center justify-between ${i} border rounded-lg px-3 py-2`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zs,{className:"w-4 h-4 text-green-300"}),e.jsx("span",{className:"text-white text-sm font-medium",children:a||r[t.type]||t.type}),t.pace&&e.jsxs("span",{className:"text-green-300 text-xs",children:["@ ",t.pace]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-green-400 font-bold text-sm",children:[t.duration," min"]}),t.hrZone&&e.jsx("span",{className:"text-xs text-green-300/80 bg-green-800/50 px-1.5 py-0.5 rounded",children:t.hrZone.replace("zone","Z")})]})]})}var Nh=Zn[" useId ".trim().toString()]||(()=>{}),Sh=0;function Tr(t){const[a,r]=m.useState(Nh());return Xs(()=>{r(s=>s??String(Sh++))},[t]),t||(a?`radix-${a}`:"")}function ns(t){const a=m.useRef(t);return m.useEffect(()=>{a.current=t}),m.useMemo(()=>(...r)=>{var s;return(s=a.current)==null?void 0:s.call(a,...r)},[])}function jh(t,a=globalThis==null?void 0:globalThis.document){const r=ns(t);m.useEffect(()=>{const s=i=>{i.key==="Escape"&&r(i)};return a.addEventListener("keydown",s,{capture:!0}),()=>a.removeEventListener("keydown",s,{capture:!0})},[r,a])}var _h="DismissableLayer",Wr="dismissableLayer.update",Ph="dismissableLayer.pointerDownOutside",Rh="dismissableLayer.focusOutside",bn,Vo=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ko=m.forwardRef((t,a)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:n,...c}=t,u=m.useContext(Vo),[d,p]=m.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=m.useState({}),x=na(a,M=>p(M)),g=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(y),S=d?g.indexOf(d):-1,P=u.layersWithOutsidePointerEventsDisabled.size>0,N=S>=v,I=Eh(M=>{const D=M.target,E=[...u.branches].some(U=>U.contains(D));!N||E||(i==null||i(M),l==null||l(M),M.defaultPrevented||n==null||n())},f),T=Ih(M=>{const D=M.target;[...u.branches].some(U=>U.contains(D))||(o==null||o(M),l==null||l(M),M.defaultPrevented||n==null||n())},f);return jh(M=>{S===u.layers.size-1&&(s==null||s(M),!M.defaultPrevented&&n&&(M.preventDefault(),n()))},f),m.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(bn=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),vn(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=bn)}},[d,f,r,u]),m.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),vn())},[d,u]),m.useEffect(()=>{const M=()=>h({});return document.addEventListener(Wr,M),()=>document.removeEventListener(Wr,M)},[]),e.jsx(St.div,{...c,ref:x,style:{pointerEvents:P?N?"auto":"none":void 0,...t.style},onFocusCapture:Gt(t.onFocusCapture,T.onFocusCapture),onBlurCapture:Gt(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Gt(t.onPointerDownCapture,I.onPointerDownCapture)})});Ko.displayName=_h;var kh="DismissableLayerBranch",Ch=m.forwardRef((t,a)=>{const r=m.useContext(Vo),s=m.useRef(null),i=na(a,s);return m.useEffect(()=>{const o=s.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),e.jsx(St.div,{...t,ref:i})});Ch.displayName=kh;function Eh(t,a=globalThis==null?void 0:globalThis.document){const r=ns(t),s=m.useRef(!1),i=m.useRef(()=>{});return m.useEffect(()=>{const o=n=>{if(n.target&&!s.current){let c=function(){Yo(Ph,r,u,{discrete:!0})};const u={originalEvent:n};n.pointerType==="touch"?(a.removeEventListener("click",i.current),i.current=c,a.addEventListener("click",i.current,{once:!0})):c()}else a.removeEventListener("click",i.current);s.current=!1},l=window.setTimeout(()=>{a.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),a.removeEventListener("pointerdown",o),a.removeEventListener("click",i.current)}},[a,r]),{onPointerDownCapture:()=>s.current=!0}}function Ih(t,a=globalThis==null?void 0:globalThis.document){const r=ns(t),s=m.useRef(!1);return m.useEffect(()=>{const i=o=>{o.target&&!s.current&&Yo(Rh,r,{originalEvent:o},{discrete:!1})};return a.addEventListener("focusin",i),()=>a.removeEventListener("focusin",i)},[a,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function vn(){const t=new CustomEvent(Wr);document.dispatchEvent(t)}function Yo(t,a,r,{discrete:s}){const i=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});a&&i.addEventListener(t,a,{once:!0}),s?vd(i,o):i.dispatchEvent(o)}var Ar="focusScope.autoFocusOnMount",Mr="focusScope.autoFocusOnUnmount",yn={bubbles:!1,cancelable:!0},Th="FocusScope",Zo=m.forwardRef((t,a)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...l}=t,[n,c]=m.useState(null),u=ns(i),d=ns(o),p=m.useRef(null),f=na(a,g=>c(g)),h=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(s){let g=function(P){if(h.paused||!n)return;const N=P.target;n.contains(N)?p.current=N:Ft(p.current,{select:!0})},y=function(P){if(h.paused||!n)return;const N=P.relatedTarget;N!==null&&(n.contains(N)||Ft(p.current,{select:!0}))},v=function(P){if(document.activeElement===document.body)for(const I of P)I.removedNodes.length>0&&Ft(n)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const S=new MutationObserver(v);return n&&S.observe(n,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),S.disconnect()}}},[s,n,h.paused]),m.useEffect(()=>{if(n){Nn.add(h);const g=document.activeElement;if(!n.contains(g)){const v=new CustomEvent(Ar,yn);n.addEventListener(Ar,u),n.dispatchEvent(v),v.defaultPrevented||(Ah(Oh(Xo(n)),{select:!0}),document.activeElement===g&&Ft(n))}return()=>{n.removeEventListener(Ar,u),setTimeout(()=>{const v=new CustomEvent(Mr,yn);n.addEventListener(Mr,d),n.dispatchEvent(v),v.defaultPrevented||Ft(g??document.body,{select:!0}),n.removeEventListener(Mr,d),Nn.remove(h)},0)}}},[n,u,d,h]);const x=m.useCallback(g=>{if(!r&&!s||h.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(y&&v){const S=g.currentTarget,[P,N]=Mh(S);P&&N?!g.shiftKey&&v===N?(g.preventDefault(),r&&Ft(P,{select:!0})):g.shiftKey&&v===P&&(g.preventDefault(),r&&Ft(N,{select:!0})):v===S&&g.preventDefault()}},[r,s,h.paused]);return e.jsx(St.div,{tabIndex:-1,...l,ref:f,onKeyDown:x})});Zo.displayName=Th;function Ah(t,{select:a=!1}={}){const r=document.activeElement;for(const s of t)if(Ft(s,{select:a}),document.activeElement!==r)return}function Mh(t){const a=Xo(t),r=wn(a,t),s=wn(a.reverse(),t);return[r,s]}function Xo(t){const a=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)a.push(r.currentNode);return a}function wn(t,a){for(const r of t)if(!Lh(r,{upTo:a}))return r}function Lh(t,{upTo:a}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(a!==void 0&&t===a)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Dh(t){return t instanceof HTMLInputElement&&"select"in t}function Ft(t,{select:a=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&Dh(t)&&a&&t.select()}}var Nn=zh();function zh(){let t=[];return{add(a){const r=t[0];a!==r&&(r==null||r.pause()),t=Sn(t,a),t.unshift(a)},remove(a){var r;t=Sn(t,a),(r=t[0])==null||r.resume()}}}function Sn(t,a){const r=[...t],s=r.indexOf(a);return s!==-1&&r.splice(s,1),r}function Oh(t){return t.filter(a=>a.tagName!=="A")}var Bh="Portal",Qo=m.forwardRef((t,a)=>{var n;const{container:r,...s}=t,[i,o]=m.useState(!1);Xs(()=>o(!0),[]);const l=r||i&&((n=globalThis==null?void 0:globalThis.document)==null?void 0:n.body);return l?Ac.createPortal(e.jsx(St.div,{...s,ref:a}),l):null});Qo.displayName=Bh;function Fh(t,a){return m.useReducer((r,s)=>a[r][s]??r,t)}var lr=t=>{const{present:a,children:r}=t,s=$h(a),i=typeof r=="function"?r({present:s.isPresent}):m.Children.only(r),o=na(s.ref,qh(i));return typeof r=="function"||s.isPresent?m.cloneElement(i,{ref:o}):null};lr.displayName="Presence";function $h(t){const[a,r]=m.useState(),s=m.useRef(null),i=m.useRef(t),o=m.useRef("none"),l=t?"mounted":"unmounted",[n,c]=Fh(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=Fs(s.current);o.current=n==="mounted"?u:"none"},[n]),Xs(()=>{const u=s.current,d=i.current;if(d!==t){const f=o.current,h=Fs(u);t?c("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==h?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,c]),Xs(()=>{if(a){let u;const d=a.ownerDocument.defaultView??window,p=h=>{const g=Fs(s.current).includes(CSS.escape(h.animationName));if(h.target===a&&g&&(c("ANIMATION_END"),!i.current)){const y=a.style.animationFillMode;a.style.animationFillMode="forwards",u=d.setTimeout(()=>{a.style.animationFillMode==="forwards"&&(a.style.animationFillMode=y)})}},f=h=>{h.target===a&&(o.current=Fs(s.current))};return a.addEventListener("animationstart",f),a.addEventListener("animationcancel",p),a.addEventListener("animationend",p),()=>{d.clearTimeout(u),a.removeEventListener("animationstart",f),a.removeEventListener("animationcancel",p),a.removeEventListener("animationend",p)}}else c("ANIMATION_END")},[a,c]),{isPresent:["mounted","unmountSuspended"].includes(n),ref:m.useCallback(u=>{s.current=u?getComputedStyle(u):null,r(u)},[])}}function Fs(t){return(t==null?void 0:t.animationName)||"none"}function qh(t){var s,i;let a=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?t.ref:(a=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Lr=0;function Hh(){m.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??jn()),document.body.insertAdjacentElement("beforeend",t[1]??jn()),Lr++,()=>{Lr===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(a=>a.remove()),Lr--}},[])}function jn(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ks="right-scroll-bar-position",Ys="width-before-scroll-bar",Wh="with-scroll-bars-hidden",Gh="--removed-body-scroll-bar-size";function Dr(t,a){return typeof t=="function"?t(a):t&&(t.current=a),t}function Uh(t,a){var r=m.useState(function(){return{value:t,callback:a,facade:{get current(){return r.value},set current(s){var i=r.value;i!==s&&(r.value=s,r.callback(s,i))}}}})[0];return r.callback=a,r.facade}var Vh=typeof window<"u"?m.useLayoutEffect:m.useEffect,_n=new WeakMap;function Kh(t,a){var r=Uh(null,function(s){return t.forEach(function(i){return Dr(i,s)})});return Vh(function(){var s=_n.get(r);if(s){var i=new Set(s),o=new Set(t),l=r.current;i.forEach(function(n){o.has(n)||Dr(n,null)}),o.forEach(function(n){i.has(n)||Dr(n,l)})}_n.set(r,t)},[t]),r}function Yh(t){return t}function Zh(t,a){a===void 0&&(a=Yh);var r=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(o){var l=a(o,s);return r.push(l),function(){r=r.filter(function(n){return n!==l})}},assignSyncMedium:function(o){for(s=!0;r.length;){var l=r;r=[],l.forEach(o)}r={push:function(n){return o(n)},filter:function(){return r}}},assignMedium:function(o){s=!0;var l=[];if(r.length){var n=r;r=[],n.forEach(o),l=r}var c=function(){var d=l;l=[],d.forEach(o)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){l.push(d),u()},filter:function(d){return l=l.filter(d),r}}}};return i}function Xh(t){t===void 0&&(t={});var a=Zh(null);return a.options=$t({async:!0,ssr:!1},t),a}var Jo=function(t){var a=t.sideCar,r=no(t,["sideCar"]);if(!a)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=a.read();if(!s)throw new Error("Sidecar medium not found");return m.createElement(s,$t({},r))};Jo.isSideCarExport=!0;function Qh(t,a){return t.useMedium(a),Jo}var el=Xh(),zr=function(){},cr=m.forwardRef(function(t,a){var r=m.useRef(null),s=m.useState({onScrollCapture:zr,onWheelCapture:zr,onTouchMoveCapture:zr}),i=s[0],o=s[1],l=t.forwardProps,n=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,p=t.shards,f=t.sideCar,h=t.noRelative,x=t.noIsolation,g=t.inert,y=t.allowPinchZoom,v=t.as,S=v===void 0?"div":v,P=t.gapMode,N=no(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),I=f,T=Kh([r,a]),M=$t($t({},N),i);return m.createElement(m.Fragment,null,d&&m.createElement(I,{sideCar:el,removeScrollBar:u,shards:p,noRelative:h,noIsolation:x,inert:g,setCallbacks:o,allowPinchZoom:!!y,lockRef:r,gapMode:P}),l?m.cloneElement(m.Children.only(n),$t($t({},M),{ref:T})):m.createElement(S,$t({},M,{className:c,ref:T}),n))});cr.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};cr.classNames={fullWidth:Ys,zeroRight:Ks};var Jh=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function eg(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var a=Jh();return a&&t.setAttribute("nonce",a),t}function tg(t,a){t.styleSheet?t.styleSheet.cssText=a:t.appendChild(document.createTextNode(a))}function ag(t){var a=document.head||document.getElementsByTagName("head")[0];a.appendChild(t)}var sg=function(){var t=0,a=null;return{add:function(r){t==0&&(a=eg())&&(tg(a,r),ag(a)),t++},remove:function(){t--,!t&&a&&(a.parentNode&&a.parentNode.removeChild(a),a=null)}}},rg=function(){var t=sg();return function(a,r){m.useEffect(function(){return t.add(a),function(){t.remove()}},[a&&r])}},tl=function(){var t=rg(),a=function(r){var s=r.styles,i=r.dynamic;return t(s,i),null};return a},ig={left:0,top:0,right:0,gap:0},Or=function(t){return parseInt(t||"",10)||0},ng=function(t){var a=window.getComputedStyle(document.body),r=a[t==="padding"?"paddingLeft":"marginLeft"],s=a[t==="padding"?"paddingTop":"marginTop"],i=a[t==="padding"?"paddingRight":"marginRight"];return[Or(r),Or(s),Or(i)]},og=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return ig;var a=ng(t),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:a[0],top:a[1],right:a[2],gap:Math.max(0,s-r+a[2]-a[0])}},lg=tl(),Aa="data-scroll-locked",cg=function(t,a,r,s){var i=t.left,o=t.top,l=t.right,n=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(Wh,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(n,"px ").concat(s,`;
  }
  body[`).concat(Aa,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([a&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(n,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(n,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ks,` {
    right: `).concat(n,"px ").concat(s,`;
  }
  
  .`).concat(Ys,` {
    margin-right: `).concat(n,"px ").concat(s,`;
  }
  
  .`).concat(Ks," .").concat(Ks,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Ys," .").concat(Ys,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Aa,`] {
    `).concat(Gh,": ").concat(n,`px;
  }
`)},Pn=function(){var t=parseInt(document.body.getAttribute(Aa)||"0",10);return isFinite(t)?t:0},dg=function(){m.useEffect(function(){return document.body.setAttribute(Aa,(Pn()+1).toString()),function(){var t=Pn()-1;t<=0?document.body.removeAttribute(Aa):document.body.setAttribute(Aa,t.toString())}},[])},ug=function(t){var a=t.noRelative,r=t.noImportant,s=t.gapMode,i=s===void 0?"margin":s;dg();var o=m.useMemo(function(){return og(i)},[i]);return m.createElement(lg,{styles:cg(o,!a,i,r?"":"!important")})},Gr=!1;if(typeof window<"u")try{var $s=Object.defineProperty({},"passive",{get:function(){return Gr=!0,!0}});window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{Gr=!1}var ka=Gr?{passive:!1}:!1,mg=function(t){return t.tagName==="TEXTAREA"},al=function(t,a){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[a]!=="hidden"&&!(r.overflowY===r.overflowX&&!mg(t)&&r[a]==="visible")},pg=function(t){return al(t,"overflowY")},hg=function(t){return al(t,"overflowX")},Rn=function(t,a){var r=a.ownerDocument,s=a;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=sl(t,s);if(i){var o=rl(t,s),l=o[1],n=o[2];if(l>n)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},gg=function(t){var a=t.scrollTop,r=t.scrollHeight,s=t.clientHeight;return[a,r,s]},fg=function(t){var a=t.scrollLeft,r=t.scrollWidth,s=t.clientWidth;return[a,r,s]},sl=function(t,a){return t==="v"?pg(a):hg(a)},rl=function(t,a){return t==="v"?gg(a):fg(a)},xg=function(t,a){return t==="h"&&a==="rtl"?-1:1},bg=function(t,a,r,s,i){var o=xg(t,window.getComputedStyle(a).direction),l=o*s,n=r.target,c=a.contains(n),u=!1,d=l>0,p=0,f=0;do{if(!n)break;var h=rl(t,n),x=h[0],g=h[1],y=h[2],v=g-y-o*x;(x||v)&&sl(t,n)&&(p+=v,f+=x);var S=n.parentNode;n=S&&S.nodeType===Node.DOCUMENT_FRAGMENT_NODE?S.host:S}while(!c&&n!==document.body||c&&(a.contains(n)||a===n));return(d&&Math.abs(p)<1||!d&&Math.abs(f)<1)&&(u=!0),u},qs=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},kn=function(t){return[t.deltaX,t.deltaY]},Cn=function(t){return t&&"current"in t?t.current:t},vg=function(t,a){return t[0]===a[0]&&t[1]===a[1]},yg=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},wg=0,Ca=[];function Ng(t){var a=m.useRef([]),r=m.useRef([0,0]),s=m.useRef(),i=m.useState(wg++)[0],o=m.useState(tl)[0],l=m.useRef(t);m.useEffect(function(){l.current=t},[t]),m.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var g=Pd([t.lockRef.current],(t.shards||[]).map(Cn),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var n=m.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!l.current.allowPinchZoom;var v=qs(g),S=r.current,P="deltaX"in g?g.deltaX:S[0]-v[0],N="deltaY"in g?g.deltaY:S[1]-v[1],I,T=g.target,M=Math.abs(P)>Math.abs(N)?"h":"v";if("touches"in g&&M==="h"&&T.type==="range")return!1;var D=Rn(M,T);if(!D)return!0;if(D?I=M:(I=M==="v"?"h":"v",D=Rn(M,T)),!D)return!1;if(!s.current&&"changedTouches"in g&&(P||N)&&(s.current=I),!I)return!0;var E=s.current||I;return bg(E,y,g,E==="h"?P:N)},[]),c=m.useCallback(function(g){var y=g;if(!(!Ca.length||Ca[Ca.length-1]!==o)){var v="deltaY"in y?kn(y):qs(y),S=a.current.filter(function(I){return I.name===y.type&&(I.target===y.target||y.target===I.shadowParent)&&vg(I.delta,v)})[0];if(S&&S.should){y.cancelable&&y.preventDefault();return}if(!S){var P=(l.current.shards||[]).map(Cn).filter(Boolean).filter(function(I){return I.contains(y.target)}),N=P.length>0?n(y,P[0]):!l.current.noIsolation;N&&y.cancelable&&y.preventDefault()}}},[]),u=m.useCallback(function(g,y,v,S){var P={name:g,delta:y,target:v,should:S,shadowParent:Sg(v)};a.current.push(P),setTimeout(function(){a.current=a.current.filter(function(N){return N!==P})},1)},[]),d=m.useCallback(function(g){r.current=qs(g),s.current=void 0},[]),p=m.useCallback(function(g){u(g.type,kn(g),g.target,n(g,t.lockRef.current))},[]),f=m.useCallback(function(g){u(g.type,qs(g),g.target,n(g,t.lockRef.current))},[]);m.useEffect(function(){return Ca.push(o),t.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:f}),document.addEventListener("wheel",c,ka),document.addEventListener("touchmove",c,ka),document.addEventListener("touchstart",d,ka),function(){Ca=Ca.filter(function(g){return g!==o}),document.removeEventListener("wheel",c,ka),document.removeEventListener("touchmove",c,ka),document.removeEventListener("touchstart",d,ka)}},[]);var h=t.removeScrollBar,x=t.inert;return m.createElement(m.Fragment,null,x?m.createElement(o,{styles:yg(i)}):null,h?m.createElement(ug,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Sg(t){for(var a=null;t!==null;)t instanceof ShadowRoot&&(a=t.host,t=t.host),t=t.parentNode;return a}const jg=Qh(el,Ng);var il=m.forwardRef(function(t,a){return m.createElement(cr,$t({},t,{ref:a,sideCar:jg}))});il.classNames=cr.classNames;var _g=function(t){if(typeof document>"u")return null;var a=Array.isArray(t)?t[0]:t;return a.ownerDocument.body},Ea=new WeakMap,Hs=new WeakMap,Ws={},Br=0,nl=function(t){return t&&(t.host||nl(t.parentNode))},Pg=function(t,a){return a.map(function(r){if(t.contains(r))return r;var s=nl(r);return s&&t.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},Rg=function(t,a,r,s){var i=Pg(a,Array.isArray(t)?t:[t]);Ws[r]||(Ws[r]=new WeakMap);var o=Ws[r],l=[],n=new Set,c=new Set(i),u=function(p){!p||n.has(p)||(n.add(p),u(p.parentNode))};i.forEach(u);var d=function(p){!p||c.has(p)||Array.prototype.forEach.call(p.children,function(f){if(n.has(f))d(f);else try{var h=f.getAttribute(s),x=h!==null&&h!=="false",g=(Ea.get(f)||0)+1,y=(o.get(f)||0)+1;Ea.set(f,g),o.set(f,y),l.push(f),g===1&&x&&Hs.set(f,!0),y===1&&f.setAttribute(r,"true"),x||f.setAttribute(s,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return d(a),n.clear(),Br++,function(){l.forEach(function(p){var f=Ea.get(p)-1,h=o.get(p)-1;Ea.set(p,f),o.set(p,h),f||(Hs.has(p)||p.removeAttribute(s),Hs.delete(p)),h||p.removeAttribute(r)}),Br--,Br||(Ea=new WeakMap,Ea=new WeakMap,Hs=new WeakMap,Ws={})}},kg=function(t,a,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),i=_g(t);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live], script"))),Rg(s,i,r,"aria-hidden")):function(){return null}},dr="Dialog",[ol]=wd(dr),[Cg,ot]=ol(dr),ll=t=>{const{__scopeDialog:a,children:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,n=m.useRef(null),c=m.useRef(null),[u,d]=yd({prop:s,defaultProp:i??!1,onChange:o,caller:dr});return e.jsx(Cg,{scope:a,triggerRef:n,contentRef:c,contentId:Tr(),titleId:Tr(),descriptionId:Tr(),open:u,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(p=>!p),[d]),modal:l,children:r})};ll.displayName=dr;var cl="DialogTrigger",Eg=m.forwardRef((t,a)=>{const{__scopeDialog:r,...s}=t,i=ot(cl,r),o=na(a,i.triggerRef);return e.jsx(St.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":yi(i.open),...s,ref:o,onClick:Gt(t.onClick,i.onOpenToggle)})});Eg.displayName=cl;var bi="DialogPortal",[Ig,dl]=ol(bi,{forceMount:void 0}),ul=t=>{const{__scopeDialog:a,forceMount:r,children:s,container:i}=t,o=ot(bi,a);return e.jsx(Ig,{scope:a,forceMount:r,children:m.Children.map(s,l=>e.jsx(lr,{present:r||o.open,children:e.jsx(Qo,{asChild:!0,container:i,children:l})}))})};ul.displayName=bi;var er="DialogOverlay",ml=m.forwardRef((t,a)=>{const r=dl(er,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=ot(er,t.__scopeDialog);return o.modal?e.jsx(lr,{present:s||o.open,children:e.jsx(Ag,{...i,ref:a})}):null});ml.displayName=er;var Tg=Nd("DialogOverlay.RemoveScroll"),Ag=m.forwardRef((t,a)=>{const{__scopeDialog:r,...s}=t,i=ot(er,r);return e.jsx(il,{as:Tg,allowPinchZoom:!0,shards:[i.contentRef],children:e.jsx(St.div,{"data-state":yi(i.open),...s,ref:a,style:{pointerEvents:"auto",...s.style}})})}),ra="DialogContent",pl=m.forwardRef((t,a)=>{const r=dl(ra,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=ot(ra,t.__scopeDialog);return e.jsx(lr,{present:s||o.open,children:o.modal?e.jsx(Mg,{...i,ref:a}):e.jsx(Lg,{...i,ref:a})})});pl.displayName=ra;var Mg=m.forwardRef((t,a)=>{const r=ot(ra,t.__scopeDialog),s=m.useRef(null),i=na(a,r.contentRef,s);return m.useEffect(()=>{const o=s.current;if(o)return kg(o)},[]),e.jsx(hl,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Gt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Gt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,n=l.button===0&&l.ctrlKey===!0;(l.button===2||n)&&o.preventDefault()}),onFocusOutside:Gt(t.onFocusOutside,o=>o.preventDefault())})}),Lg=m.forwardRef((t,a)=>{const r=ot(ra,t.__scopeDialog),s=m.useRef(!1),i=m.useRef(!1);return e.jsx(hl,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var l,n;(l=t.onCloseAutoFocus)==null||l.call(t,o),o.defaultPrevented||(s.current||(n=r.triggerRef.current)==null||n.focus(),o.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:o=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=o.target;((u=r.triggerRef.current)==null?void 0:u.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),hl=m.forwardRef((t,a)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,...l}=t,n=ot(ra,r),c=m.useRef(null),u=na(a,c);return Hh(),e.jsxs(e.Fragment,{children:[e.jsx(Zo,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:o,children:e.jsx(Ko,{role:"dialog",id:n.contentId,"aria-describedby":n.descriptionId,"aria-labelledby":n.titleId,"data-state":yi(n.open),...l,ref:u,onDismiss:()=>n.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Dg,{titleId:n.titleId}),e.jsx(Og,{contentRef:c,descriptionId:n.descriptionId})]})]})}),vi="DialogTitle",gl=m.forwardRef((t,a)=>{const{__scopeDialog:r,...s}=t,i=ot(vi,r);return e.jsx(St.h2,{id:i.titleId,...s,ref:a})});gl.displayName=vi;var fl="DialogDescription",xl=m.forwardRef((t,a)=>{const{__scopeDialog:r,...s}=t,i=ot(fl,r);return e.jsx(St.p,{id:i.descriptionId,...s,ref:a})});xl.displayName=fl;var bl="DialogClose",vl=m.forwardRef((t,a)=>{const{__scopeDialog:r,...s}=t,i=ot(bl,r);return e.jsx(St.button,{type:"button",...s,ref:a,onClick:Gt(t.onClick,()=>i.onOpenChange(!1))})});vl.displayName=bl;function yi(t){return t?"open":"closed"}var yl="DialogTitleWarning",[mx,wl]=Sd(yl,{contentName:ra,titleName:vi,docsSlug:"dialog"}),Dg=({titleId:t})=>{const a=wl(yl),r=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return m.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},zg="DialogDescriptionWarning",Og=({contentRef:t,descriptionId:a})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${wl(zg).contentName}}.`;return m.useEffect(()=>{var o;const i=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");a&&i&&(document.getElementById(a)||console.warn(s))},[s,t,a]),null},Bg=ll,Fg=ul,Nl=ml,Sl=pl,jl=gl,_l=xl,$g=vl;const qg=Bg,Hg=Fg,Pl=m.forwardRef(({className:t,...a},r)=>e.jsx(Nl,{ref:r,className:jt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));Pl.displayName=Nl.displayName;const Rl=m.forwardRef(({className:t,children:a,...r},s)=>e.jsxs(Hg,{children:[e.jsx(Pl,{}),e.jsxs(Sl,{ref:s,className:jt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[a,e.jsxs($g,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Rl.displayName=Sl.displayName;const kl=({className:t,...a})=>e.jsx("div",{className:jt("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});kl.displayName="DialogHeader";const Cl=m.forwardRef(({className:t,...a},r)=>e.jsx(jl,{ref:r,className:jt("text-lg font-semibold leading-none tracking-tight",t),...a}));Cl.displayName=jl.displayName;const El=m.forwardRef(({className:t,...a},r)=>e.jsx(_l,{ref:r,className:jt("text-sm text-muted-foreground",t),...a}));El.displayName=_l.displayName;const Qa=m.forwardRef(({className:t,type:a,...r},s)=>e.jsx("input",{type:a,className:jt("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r}));Qa.displayName="Input";var Wg=Symbol.for("react.lazy"),tr=Zn[" use ".trim().toString()];function Gg(t){return typeof t=="object"&&t!==null&&"then"in t}function Il(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===Wg&&"_payload"in t&&Gg(t._payload)}function Ug(t){const a=Vg(t),r=m.forwardRef((s,i)=>{let{children:o,...l}=s;Il(o)&&typeof tr=="function"&&(o=tr(o._payload));const n=m.Children.toArray(o),c=n.find(Yg);if(c){const u=c.props.children,d=n.map(p=>p===c?m.Children.count(u)>1?m.Children.only(null):m.isValidElement(u)?u.props.children:null:p);return e.jsx(a,{...l,ref:i,children:m.isValidElement(u)?m.cloneElement(u,void 0,d):null})}return e.jsx(a,{...l,ref:i,children:o})});return r.displayName=`${t}.Slot`,r}function Vg(t){const a=m.forwardRef((r,s)=>{let{children:i,...o}=r;if(Il(i)&&typeof tr=="function"&&(i=tr(i._payload)),m.isValidElement(i)){const l=Xg(i),n=Zg(o,i.props);return i.type!==m.Fragment&&(n.ref=s?jd(s,l):l),m.cloneElement(i,n)}return m.Children.count(i)>1?m.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var Kg=Symbol("radix.slottable");function Yg(t){return m.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Kg}function Zg(t,a){const r={...a};for(const s in a){const i=t[s],o=a[s];/^on[A-Z]/.test(s)?i&&o?r[s]=(...n)=>{const c=o(...n);return i(...n),c}:i&&(r[s]=i):s==="style"?r[s]={...i,...o}:s==="className"&&(r[s]=[i,o].filter(Boolean).join(" "))}return{...t,...r}}function Xg(t){var s,i;let a=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?t.ref:(a=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Qg=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Jg=Qg.reduce((t,a)=>{const r=Ug(`Primitive.${a}`),s=m.forwardRef((i,o)=>{const{asChild:l,...n}=i,c=l?r:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...n,ref:o})});return s.displayName=`Primitive.${a}`,{...t,[a]:s}},{}),e0="Label",Tl=m.forwardRef((t,a)=>e.jsx(Jg.label,{...t,ref:a,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Tl.displayName=e0;var Al=Tl;const t0=io("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ht=m.forwardRef(({className:t,...a},r)=>e.jsx(Al,{ref:r,className:jt(t0(),t),...a}));ht.displayName=Al.displayName;const Ml=m.forwardRef(({className:t,...a},r)=>e.jsx("textarea",{className:jt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...a}));Ml.displayName="Textarea";const a0=io("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function s0({className:t,variant:a,...r}){return e.jsx("div",{className:jt(a0({variant:a}),t),...r})}const Ie={NOSE:0,LEFT_EYE:2,RIGHT_EYE:5,LEFT_EAR:7,RIGHT_EAR:8,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32};function r0(t){const a=r=>{var s,i,o,l;return{x:((s=t[r])==null?void 0:s.x)||0,y:((i=t[r])==null?void 0:i.y)||0,z:((o=t[r])==null?void 0:o.z)||0,visibility:((l=t[r])==null?void 0:l.visibility)||0}};return{nose:a(Ie.NOSE),left_eye:a(Ie.LEFT_EYE),right_eye:a(Ie.RIGHT_EYE),left_ear:a(Ie.LEFT_EAR),right_ear:a(Ie.RIGHT_EAR),left_shoulder:a(Ie.LEFT_SHOULDER),right_shoulder:a(Ie.RIGHT_SHOULDER),left_elbow:a(Ie.LEFT_ELBOW),right_elbow:a(Ie.RIGHT_ELBOW),left_wrist:a(Ie.LEFT_WRIST),right_wrist:a(Ie.RIGHT_WRIST),left_hip:a(Ie.LEFT_HIP),right_hip:a(Ie.RIGHT_HIP),left_knee:a(Ie.LEFT_KNEE),right_knee:a(Ie.RIGHT_KNEE),left_ankle:a(Ie.LEFT_ANKLE),right_ankle:a(Ie.RIGHT_ANKLE),left_heel:a(Ie.LEFT_HEEL),right_heel:a(Ie.RIGHT_HEEL),left_foot_index:a(Ie.LEFT_FOOT_INDEX),right_foot_index:a(Ie.RIGHT_FOOT_INDEX)}}function i0(t){const a=[t.left_shoulder,t.right_shoulder,t.left_hip,t.right_hip,t.left_knee,t.right_knee,t.left_ankle,t.right_ankle];return a.reduce((s,i)=>s+i.visibility,0)/a.length}class n0{constructor(){this.pose=null,this.isInitialized=!1,this.initPromise=null}async initialize(){if(!this.isInitialized){if(this.initPromise)return this.initPromise;this.initPromise=this._doInitialize(),await this.initPromise}}async _doInitialize(){try{const{Pose:a}=await Vc(async()=>{const{Pose:r}=await import("./pose-BltDzaxB.js").then(s=>s.p);return{Pose:r}},__vite__mapDeps([0,1]));this.pose=new a({locateFile:r=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${r}`}),this.pose.setOptions({modelComplexity:2,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),await this.pose.initialize(),this.isInitialized=!0,console.log("[PoseDetector] Initialized successfully")}catch(a){throw console.error("[PoseDetector] Failed to initialize:",a),new Error("Failed to initialize pose detection")}}async detectPose(a){return this.isInitialized||await this.initialize(),new Promise(r=>{this.pose.onResults(s=>{if(s.poseLandmarks&&s.poseLandmarks.length>0){const i=r0(s.poseLandmarks),o=i0(i);r({success:!0,landmarks:i,confidence:o})}else r({success:!1,confidence:0,error:"No pose detected in frame"})}),this.pose.send({image:a})})}async analyzeVideo(a,r,s=10){this.isInitialized||await this.initialize();const i=[],o=a.duration,l=Math.floor(o*s),n=1/s;let c=0,u=0;const d=document.createElement("canvas");d.width=a.videoWidth,d.height=a.videoHeight;const p=d.getContext("2d");console.log(`[PoseDetector] Analyzing video: ${o}s, ${l} frames at ${s} fps`),r==null||r({currentFrame:0,totalFrames:l,percentage:0,status:"extracting"});for(let h=0;h<l;h++){const x=h*n;a.currentTime=x,await new Promise(y=>{const v=()=>{a.removeEventListener("seeked",v),y()};a.addEventListener("seeked",v)}),p.drawImage(a,0,0);const g=await this.detectPose(d);g.success&&g.landmarks?(i.push(g.landmarks),c+=g.confidence,u++):i.length>0&&i.push({...i[i.length-1]}),r==null||r({currentFrame:h+1,totalFrames:l,percentage:Math.round((h+1)/l*100),status:"extracting"})}const f=u/l;return f<.5?{success:!1,frameSequence:[],fps:s,duration:o,averageConfidence:0,error:`Pose detection riuscita solo nel ${Math.round(f*100)}% dei frame. Assicurati di essere completamente inquadrato.`}:(r==null||r({currentFrame:l,totalFrames:l,percentage:100,status:"completed"}),{success:!0,frameSequence:i,fps:s,duration:o,averageConfidence:u>0?c/u:0})}async analyzeVideoBlob(a,r){const s=URL.createObjectURL(a),i=document.createElement("video");i.src=s,i.muted=!0,i.playsInline=!0,await new Promise((o,l)=>{i.onloadedmetadata=()=>o(),i.onerror=()=>l(new Error("Failed to load video")),i.load()});try{return await this.analyzeVideo(i,r)}finally{URL.revokeObjectURL(s)}}close(){this.pose&&(this.pose.close(),this.pose=null),this.isInitialized=!1,this.initPromise=null}}let Fr=null;function o0(){return Fr||(Fr=new n0),Fr}function l0(){try{const t=document.createElement("canvas");return!!(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch{return!1}}function Ll(t){const a=t.toLowerCase().trim();return a.includes("back squat")||a.includes("squat bilanciere")||a.includes("squat con bilanciere")||a==="barbell squat"?"BACK_SQUAT":a.includes("front squat")||a.includes("squat frontale")?"FRONT_SQUAT":a.includes("goblet")?"BACK_SQUAT":a.includes("bulgarian")||a.includes("split squat")||a.includes("bulgaro")?"BULGARIAN_SPLIT_SQUAT":a.includes("squat")&&!a.includes("pistol")&&!a.includes("skater")?"BACK_SQUAT":a.includes("sumo")?"DEADLIFT_SUMO":a.includes("romanian")||a.includes("rdl")||a.includes("rumeno")?"ROMANIAN_DEADLIFT":a.includes("deadlift")||a.includes("stacco")?"DEADLIFT_CONVENTIONAL":a.includes("bench")||a.includes("panca piana")||a.includes("distensioni")?"BENCH_PRESS":a.includes("overhead")||a.includes("military")||a.includes("lento avanti")?"OVERHEAD_PRESS":a.includes("pull-up")||a.includes("pullup")||a.includes("trazioni")?"PULL_UP":a.includes("chin-up")||a.includes("chinup")?"CHIN_UP":a.includes("lat pulldown")||a.includes("lat machine")?"LAT_PULLDOWN":a.includes("barbell row")||a.includes("rematore bilanciere")?"BARBELL_ROW":a.includes("dumbbell row")||a.includes("rematore manubrio")?"DUMBBELL_ROW":a.includes("row")||a.includes("rematore")?"BARBELL_ROW":a.includes("hip thrust")||a.includes("ponte glutei")?"HIP_THRUST":a.includes("push-up")||a.includes("pushup")||a.includes("piegamenti")?"PUSH_UP":a.includes("dip")?"DIP":a.includes("pistol squat")||a.includes("pistol")||a==="pistol"?"PISTOL_SQUAT":a.includes("skater squat")||a.includes("skater")?"SKATER_SQUAT":a.includes("archer push")||a.includes("archer pushup")||a.includes("piegamenti arciere")?"ARCHER_PUSH_UP":a.includes("inverted row")||a.includes("australian")||a.includes("body row")||a.includes("trazioni orizzontali")||a.includes("trazioni australiane")?"INVERTED_ROW":a.includes("lunge")||a.includes("affondo")?"LUNGE_FORWARD":a.includes("leg press")?"LEG_PRESS":a.includes("leg extension")?"LEG_EXTENSION":a.includes("leg curl")?"LEG_CURL":a.includes("cable row")||a.includes("pulley")?"CABLE_ROW":a.includes("chest press")?"CHEST_PRESS":a.includes("shoulder press machine")?"SHOULDER_PRESS_MACHINE":null}function c0(t,a){var r;return{success:!0,source:"internal",score:t.overallScore,issues:t.issues.map(s=>({name:s.code,severity:s.severity.toLowerCase(),description:s.description,timestamp_seconds:s.timestamp?[s.timestamp]:void 0})),corrections:t.recommendations.immediate,warnings:t.issues.filter(s=>s.type==="SAFETY").map(s=>s.description),loadRecommendation:d0(t),stickingPoint:t.stickingPoint?{detected:t.stickingPoint.detected,position:t.stickingPoint.position,recommendations:(r=t.stickingPoint.recommendations)==null?void 0:r.cues}:void 0,morphotype:t.morphotype?{type:t.morphotype.type,note:t.morphotype.note}:void 0,framesAnalyzed:t.framesAnalyzed,confidence:a}}function d0(t){const a=t.issues.filter(i=>i.type==="SAFETY"),r=a.filter(i=>i.severity==="HIGH").length,s=a.filter(i=>i.severity==="MEDIUM").length;return r>=2?"decrease_20_percent":r>=1||s>=2?"decrease_10_percent":t.overallScore>=8&&t.issues.length===0?"increase_5_percent":"maintain"}class u0{constructor(a){this.onProgress=a}updateProgress(a,r,s){var i;(i=this.onProgress)==null||i.call(this,{stage:a,percentage:r,message:s})}async analyzeVideo(a,r,s,i){const o=Date.now();if(!l0())return console.log("[VideoCorrectionEngine] WebGL not supported, using Gemini fallback"),this.fallbackToGemini(a,r,s,i);const l=Ll(r);if(!l)return console.log(`[VideoCorrectionEngine] Exercise "${r}" not supported internally, using Gemini`),this.fallbackToGemini(a,r,s,i);try{this.updateProgress("initializing",5,"Inizializzazione analisi...");const n=o0();await n.initialize(),this.updateProgress("extracting",10,"Estrazione movimento dal video...");const c=await n.analyzeVideoBlob(a,f=>{const h=10+f.percentage*.5;this.updateProgress("extracting",h,`Analisi frame ${f.currentFrame}/${f.totalFrames}...`)});if(!c.success||c.frameSequence.length===0)return console.log("[VideoCorrectionEngine] Pose detection failed:",c.error),this.fallbackToGemini(a,r,s,i);this.updateProgress("analyzing",65,"Analisi biomeccanica in corso...");const u={exercise:l,fps:c.fps,style:l.includes("SUMO")?"sumo":"conventional"},d=Gp(c.frameSequence,u);this.updateProgress("analyzing",90,"Generazione feedback...");const p=c0(d,c.averageConfidence);return p.processingTime=Date.now()-o,i&&await this.saveResultToDatabase(i,p),this.updateProgress("completed",100,"Analisi completata!"),console.log(`[VideoCorrectionEngine] Internal analysis completed in ${p.processingTime}ms`),p}catch(n){return console.error("[VideoCorrectionEngine] Internal analysis failed:",n),this.fallbackToGemini(a,r,s,i)}}async fallbackToGemini(a,r,s,i){var o;if(this.updateProgress("fallback",50,"Utilizzo AI avanzata per analisi..."),!s||!i)return{success:!1,source:"failed",error:"Analisi fallita: parametri mancanti per il fallback"};try{const{data:{session:l}}=await ne.auth.getSession(),n=l==null?void 0:l.access_token;if(!n)throw new Error("No access token available");const c=Date.now(),u=`${r.replace(/\s+/g,"-")}_${c}.mp4`,d=`${s}/${u}`,{error:p}=await ne.storage.from("user-exercise-videos").upload(d,a,{contentType:"video/mp4"});if(p&&!p.message.includes("already exists"))throw p;await ne.from("video_corrections").update({video_url:d,ai_model_used:"gemini-1.5-pro-fallback"}).eq("id",i);const x=await fetch("https://mhcdxqhhlrujbjxtgnmz.supabase.co/functions/v1/analyze-exercise-video",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({video_url:d,exercise_name:r,user_id:s,correction_id:i})});if(!x.ok)throw new Error(`Gemini API error: ${x.status}`);const g=await x.json();return this.updateProgress("completed",100,"Analisi biomeccanica completata!"),{success:!0,source:"gemini",score:(o=g.feedback)==null?void 0:o.score,issues:[],corrections:[],warnings:[]}}catch(l){return console.error("[VideoCorrectionEngine] Gemini fallback failed:",l),this.updateProgress("failed",100,"Analisi fallita"),{success:!1,source:"failed",error:l instanceof Error?l.message:"Analisi fallita"}}}async saveResultToDatabase(a,r){try{await ne.from("video_corrections").update({processing_status:"completed",ai_model_used:"internal-biomechanics",feedback_score:r.score,feedback_issues:r.issues,feedback_corrections:r.corrections,feedback_warnings:r.warnings,load_recommendation:r.loadRecommendation,processed_at:new Date().toISOString(),metadata:{source:r.source,framesAnalyzed:r.framesAnalyzed,confidence:r.confidence,processingTime:r.processingTime,stickingPoint:r.stickingPoint,morphotype:r.morphotype}}).eq("id",a),console.log("[VideoCorrectionEngine] Result saved to database")}catch(s){console.error("[VideoCorrectionEngine] Failed to save result:",s)}}}async function m0(t,a,r,s,i){return new u0(i).analyzeVideo(t,a,r,s)}function wi(t){return Ll(t)!==null}const En={steps:[{icon:"ðŸ“",text:"Posiziona il telefono dietro di te, leggermente di lato (45Â°)"},{icon:"ðŸ‘ï¸",text:"La camera deve vedere sia la schiena che il fianco"},{icon:"ðŸ“",text:"Altezza: circa all'altezza dei fianchi (1 metro)"},{icon:"ðŸ“",text:"Distanza: 2-3 metri (devi stare tutto nell'inquadratura)"},{icon:"ðŸ’¡",text:"Assicurati che ci sia buona illuminazione (no controluce)"}],benefits:["Rileva asimmetrie dx/sx","Identifica rotazione del tronco","Analizza distribuzione del peso","Verifica posizione scapole"]};function Dl({open:t,onClose:a,exerciseName:r,exercisePattern:s,workoutLogId:i,setNumber:o,onUploadComplete:l}){const n=so(ue=>ue.userId),[c,u]=m.useState(null),[d,p]=m.useState(!1),[f,h]=m.useState(null),[x,g]=m.useState(0),[y,v]=m.useState("idle"),[S,P]=m.useState(""),[N,I]=m.useState(""),[T,M]=m.useState(null),[D,E]=m.useState(null),[U,W]=m.useState(!0),C=m.useRef(null),G=m.useRef(null),H=m.useRef([]),Y=m.useRef(null);m.useEffect(()=>{t&&n&&oe()},[t,n]);async function oe(){if(!n)return;const ue=await Rd(n);u(ue)}async function X(){try{const ue=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});C.current&&(C.current.srcObject=ue,C.current.play());const Se=new MediaRecorder(ue,{mimeType:"video/webm"});G.current=Se,H.current=[],Se.ondataavailable=$e=>{$e.data.size>0&&H.current.push($e.data)},Se.onstop=()=>{const $e=new Blob(H.current,{type:"video/webm"});h($e),ue.getTracks().forEach(ze=>ze.stop()),C.current&&(C.current.srcObject=null,C.current.src=URL.createObjectURL($e))},Se.start(),p(!0)}catch(ue){console.error("Failed to start recording:",ue),P("Impossibile accedere alla camera. Verifica i permessi.")}}function ee(){G.current&&d&&(G.current.stop(),p(!1))}function pe(ue){var $e;const Se=($e=ue.target.files)==null?void 0:$e[0];Se&&(h(Se),C.current&&(C.current.src=URL.createObjectURL(Se)))}async function ie(){if(!(!f||!n)){v("uploading"),g(0),P(""),M(null),E(null);try{const ue=Date.now(),Se=`${r.replace(/\s+/g,"-")}_${ue}.mp4`,$e=`${n}/${Se}`;I("Caricamento video...");const{error:ze}=await ne.storage.from("user-exercise-videos").upload($e,f,{contentType:"video/mp4"});if(ze)throw new Error(`Upload fallito: ${ze.message}`);g(20);const{data:oa,error:Oe}=await ne.from("video_corrections").insert({user_id:n,video_url:$e,video_filename:Se,video_size_bytes:f.size,exercise_name:r,exercise_pattern:s,workout_log_id:i,set_number:o,processing_status:"pending"}).select().single();if(Oe||!oa)throw new Error(`Creazione record fallita: ${Oe==null?void 0:Oe.message}`);g(30),v("processing");const Ge=wi(r);M(Ge?"internal":"gemini");const ft=await m0(f,r,n,oa.id,q=>{g(30+q.percentage*.7),I(q.message),q.stage==="fallback"&&M("gemini")});if(ft.success)v("success"),E(ft),M(ft.source==="internal"?"internal":"gemini"),I("Analisi completata!"),l==null||l(oa.id);else throw new Error(ft.error||"Analisi fallita")}catch(ue){console.error("Video analysis failed:",ue),v("error"),P(ue instanceof Error?ue.message:"Analisi fallita. Riprova.")}}}function ye(){h(null),v("idle"),g(0),p(!1),I(""),P(""),M(null),E(null),C.current&&(C.current.src="",C.current.srcObject=null),a()}return t?c&&!c.can_upload?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gray-900 rounded-lg p-6 max-w-md w-full mx-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Quota Esaurita"}),e.jsx("button",{onClick:ye,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"text-center py-6",children:[e.jsx(qt,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-300 mb-2",children:["Hai utilizzato tutte le ",c.max_allowed," video correzioni del tuo piano"," ",e.jsx("span",{className:"font-bold text-blue-400",children:c.tier.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-gray-400 mb-6",children:["Reset fra ",Math.ceil(c.days_until_reset)," giorni"]}),e.jsx("button",{onClick:()=>{ye()},className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-opacity",children:"Upgrade a PRO/PREMIUM"})]})]})}):e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gray-900 rounded-lg p-6 max-w-2xl w-full mx-4 border border-gray-700 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Video Correzione AI"}),e.jsx("p",{className:"text-sm text-gray-400",children:r})]}),e.jsx("button",{onClick:ye,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]}),c&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 mb-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-400",children:["Piano ",c.tier.toUpperCase()]}),e.jsxs("p",{className:"text-white font-medium",children:[c.used,"/",c.max_allowed," video usati"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Reset fra"}),e.jsxs("p",{className:"text-blue-400 font-medium",children:[Math.ceil(c.days_until_reset)," giorni"]})]})]}),e.jsx("div",{className:"bg-black rounded-lg mb-4 aspect-video overflow-hidden",children:e.jsx("video",{ref:C,className:"w-full h-full object-cover",controls:!!f,playsInline:!0})}),e.jsx(Ne,{children:y==="success"&&e.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-green-900/50 border border-green-700 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(We,{className:"w-6 h-6 text-green-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-green-400 font-medium",children:"Analisi Completata!"}),T&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${T==="internal"?"bg-blue-800 text-blue-300":"bg-purple-800 text-purple-300"}`,children:T==="internal"?"Biomechanica":"Gemini AI"})]}),(D==null?void 0:D.score)&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-300",children:"Punteggio:"}),e.jsxs("span",{className:`font-bold ${D.score>=8?"text-green-400":D.score>=6?"text-yellow-400":"text-red-400"}`,children:[D.score,"/10"]}),D.morphotype&&e.jsxs("span",{className:"text-xs text-gray-400",children:["â€¢ ",D.morphotype.type.replace("_"," ")]})]})]})]})})}),S&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qt,{className:"w-6 h-6 text-red-400"}),e.jsx("p",{className:"text-red-400",children:S})]})}),y==="processing"&&e.jsxs("div",{className:"bg-blue-900/50 border border-blue-700 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[T==="internal"?e.jsx(mc,{className:"w-6 h-6 text-blue-400 animate-pulse"}):e.jsx(Gn,{className:"w-6 h-6 text-purple-400 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-blue-400 font-medium",children:N}),T&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${T==="internal"?"bg-blue-800 text-blue-300":"bg-purple-800 text-purple-300"}`,children:T==="internal"?"Analisi Locale":"Gemini AI"})]}),e.jsx("p",{className:"text-sm text-gray-300",children:T==="internal"?"Analisi in tempo reale sul tuo dispositivo":"Analisi cloud con AI avanzata"})]})]}),e.jsx("div",{className:"mt-3 w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${T==="internal"?"bg-blue-500":"bg-purple-500"}`,style:{width:`${x}%`}})})]}),y==="uploading"&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Upload in corso..."}),e.jsxs("span",{className:"text-sm text-white",children:[x,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),e.jsxs("div",{className:"flex gap-3",children:[!f&&!d&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:X,className:"flex-1 bg-red-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Zr,{className:"w-5 h-5"}),"Registra Video"]}),e.jsxs("button",{onClick:()=>{var ue;return(ue=Y.current)==null?void 0:ue.click()},className:"flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(pc,{className:"w-5 h-5"}),"Carica Video"]}),e.jsx("input",{ref:Y,type:"file",accept:"video/*",onChange:pe,className:"hidden"})]}),d&&e.jsx("button",{onClick:ee,className:"flex-1 bg-red-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors animate-pulse",children:"â¹ï¸ Stop Recording"}),f&&y==="idle"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{h(null),C.current&&(C.current.src="")},className:"flex-1 bg-gray-700 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors",children:"Riprova"}),e.jsx("button",{onClick:ie,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-3 rounded-lg font-medium hover:opacity-90 transition-opacity",children:"Analizza con AI"})]}),y==="success"&&e.jsx("button",{onClick:ye,className:"flex-1 bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Visualizza Feedback"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("button",{onClick:()=>W(!U),className:"w-full flex items-center justify-between p-3 bg-gray-800 rounded-lg hover:bg-gray-750 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ei,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Come posizionare la camera (45Â° latero-posteriore)"})]}),e.jsx(Un,{className:`w-4 h-4 text-gray-400 transition-transform ${U?"rotate-180":""}`})]}),e.jsx(Ne,{children:U&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-900/30 to-purple-900/30 rounded-b-lg border-t border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsxs("div",{className:"relative w-48 h-32 bg-gray-800/50 rounded-lg p-2",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs",children:"Tu"})}),e.jsx("div",{className:"absolute bottom-2 right-2 transform rotate-[-45deg]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ei,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{className:"text-xs text-green-400",children:"45Â°"})]})}),e.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16",children:e.jsx("div",{className:"w-full h-full border-l-2 border-b-2 border-green-400/30 rounded-bl-full"})}),e.jsx("span",{className:"absolute top-1 left-2 text-[10px] text-gray-400",children:"Vista dall'alto"})]})}),e.jsx("div",{className:"space-y-2 mb-4",children:En.steps.map((ue,Se)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-base",children:ue.icon}),e.jsx("span",{className:"text-gray-300",children:ue.text})]},Se))}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(hc,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Questa angolazione permette di rilevare:"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:En.benefits.map((ue,Se)=>e.jsx("span",{className:"text-xs px-2 py-1 bg-purple-800/50 text-purple-200 rounded-full",children:ue},Se))})]})]})})})]})]})}):null}function p0({open:t,onClose:a,userId:r,programId:s,dayName:i,splitType:o,exercises:l,onWorkoutLogged:n}){const{t:c}=ia(),[u,d]=m.useState({}),[p,f]=m.useState("normal"),[h,x]=m.useState(7),[g,y]=m.useState(""),[v,S]=m.useState(!1),[P,N]=m.useState(!1),[I,T]=m.useState(null);m.useEffect(()=>{if(t&&l.length>0){const C={};l.forEach(G=>{C[G.name]={sets_completed:G.sets,reps_completed:typeof G.reps=="number"?G.reps:parseInt(G.reps.split("-")[0]),exercise_rpe:7,difficulty_vs_baseline:"as_expected",notes:""}}),d(C)}},[t,l]);const M=()=>{const C=Object.values(u).map(G=>G.exercise_rpe);return C.length===0?7:Math.round(C.reduce((G,H)=>G+H,0)/C.length*10)/10},D=(C,G,H)=>{d(Y=>({...Y,[C]:{...Y[C],[G]:H}}))},E=async()=>{S(!0);try{console.log("[WorkoutLogger] Inizio salvataggio workout...");const{data:C,error:G}=await Za.createWorkoutLog(r,s,i,o);if(G||!C)throw new Error("Errore creazione workout log");console.log("[WorkoutLogger] Workout log creato:",C.id);for(const ee of l){const pe=u[ee.name];if(!pe)continue;const{error:ie}=await Za.addExerciseLog(C.id,{exercise_name:ee.name,pattern:ee.pattern,sets_completed:pe.sets_completed,reps_completed:pe.reps_completed,weight_used:pe.weight_used,exercise_rpe:pe.exercise_rpe,difficulty_vs_baseline:pe.difficulty_vs_baseline,notes:pe.notes});ie?console.error("[WorkoutLogger] Errore log esercizio:",ee.name,ie):console.log("[WorkoutLogger] Exercise log salvato:",ee.name,"RPE:",pe.exercise_rpe)}const{error:H}=await Za.completeWorkout(C.id,l.length,g,p,h);if(H)throw new Error("Errore completamento workout");console.log("[WorkoutLogger] âœ… Workout completato"),console.log("[WorkoutLogger] ðŸ¤– Trigger auto-regulation...");const{data:Y,error:oe}=await Za.applyAutoRegulation(r,s);if(oe)console.warn("[WorkoutLogger] Warning auto-regulation:",oe);else if(Y){const ee=Y.volume_change_percent,pe=ee>0?"aumentato":"ridotto";re.success("ðŸ¤– Auto-Regulation Attivato!",{description:`Volume ${pe} del ${Math.abs(ee)}% in base al tuo RPE medio (${Y.avg_rpe_before}/10). ${Y.exercises_affected.length} esercizi modificati.`,duration:6e3}),console.log("[WorkoutLogger] âœ… Auto-regulation applicato:",Y)}else console.log("[WorkoutLogger] âœ… RPE nel range ottimale, nessun adjustment necessario");const X=M();re.success("Workout salvato!",{description:`RPE medio sessione: ${X}/10. Ottimo lavoro! ðŸ’ª`}),n&&n(),a()}catch(C){console.error("[WorkoutLogger] Errore salvataggio workout:",C),re.error("Errore salvataggio workout",{description:C.message||"Riprova piÃ¹ tardi"})}finally{S(!1)}},U=C=>C<=5?"text-green-600":C<=7?"text-yellow-600":C<=8.5?"text-orange-600":"text-red-600",W=C=>C<=5?"Facile":C<=6.5?"Moderato":C<=8?"Impegnativo":C<=9?"Molto duro":"Massimale";return e.jsxs(qg,{open:t,onOpenChange:a,children:[e.jsxs(Rl,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(kl,{children:[e.jsxs(Cl,{className:"font-display text-2xl",children:[c("workoutLogger.title")," - ",i]}),e.jsx(El,{children:c("workoutLogger.description")})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:c("workoutLogger.split")}),e.jsx("p",{className:"font-medium",children:o})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:c("workoutLogger.sessionRPE")}),e.jsxs("p",{className:`text-2xl font-bold ${U(M())}`,children:[M(),"/10"]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:c("workoutLogger.exercises")}),l.map((C,G)=>{const H=u[C.name]||{sets_completed:C.sets,reps_completed:typeof C.reps=="number"?C.reps:10,exercise_rpe:7,difficulty_vs_baseline:"as_expected",notes:""};return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:C.name}),e.jsx(s0,{variant:"outline",children:C.pattern})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsxs(ht,{htmlFor:`sets-${G}`,className:"text-xs",children:[c("workout.sets")," ",c("workout.completed").toLowerCase()]}),e.jsx(Qa,{id:`sets-${G}`,type:"number",min:1,value:H.sets_completed,onChange:Y=>D(C.name,"sets_completed",parseInt(Y.target.value)),className:"h-9"})]}),e.jsxs("div",{children:[e.jsx(ht,{htmlFor:`reps-${G}`,className:"text-xs",children:c("workout.reps")}),e.jsx(Qa,{id:`reps-${G}`,type:"number",min:1,value:H.reps_completed,onChange:Y=>D(C.name,"reps_completed",parseInt(Y.target.value)),className:"h-9"})]}),e.jsxs("div",{children:[e.jsxs(ht,{htmlFor:`weight-${G}`,className:"text-xs",children:[c("workout.weight")," (kg)"]}),e.jsx(Qa,{id:`weight-${G}`,type:"number",min:0,step:.5,value:H.weight_used||"",onChange:Y=>D(C.name,"weight_used",parseFloat(Y.target.value)||void 0),placeholder:C.weight||c("workoutLogger.optional"),className:"h-9"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(ht,{className:"text-xs",children:["RPE - ",W(H.exercise_rpe)]}),e.jsxs("span",{className:`text-xl font-bold ${U(H.exercise_rpe)}`,children:[H.exercise_rpe,"/10"]})]}),e.jsx(Fi,{value:[H.exercise_rpe],onValueChange:([Y])=>D(C.name,"exercise_rpe",Y),min:1,max:10,step:.5,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:c("rpe.2")}),e.jsx("span",{children:c("rpe.4")}),e.jsx("span",{children:c("rpe.10")})]})]}),e.jsxs("div",{children:[e.jsx(ht,{className:"text-xs mb-2 block",children:c("workoutLogger.vsBaseline")}),e.jsx("div",{className:"flex gap-2",children:["easier","as_expected","harder"].map(Y=>e.jsxs(Ya,{type:"button",variant:H.difficulty_vs_baseline===Y?"default":"outline",size:"sm",onClick:()=>D(C.name,"difficulty_vs_baseline",Y),className:"flex-1 text-xs",children:[Y==="easier"&&e.jsx(wt,{className:"w-3 h-3 mr-1"}),Y==="as_expected"&&e.jsx($r,{className:"w-3 h-3 mr-1"}),Y==="harder"&&e.jsx(De,{className:"w-3 h-3 mr-1"}),c(Y==="easier"?"workoutLogger.easier":Y==="as_expected"?"workoutLogger.asExpected":"workoutLogger.harder")]},Y))})]}),e.jsxs("div",{children:[e.jsx(ht,{htmlFor:`notes-${G}`,className:"text-xs",children:c("workoutLogger.notesOptional")}),e.jsx(Qa,{id:`notes-${G}`,value:H.notes,onChange:Y=>D(C.name,"notes",Y.target.value),placeholder:c("workoutLogger.notesPlaceholder"),className:"h-9 text-sm"})]}),wi(C.name)&&e.jsx("div",{children:e.jsxs(Ya,{type:"button",variant:"outline",size:"sm",onClick:()=>{T(C),N(!0)},className:"w-full",children:[e.jsx(Zr,{className:"w-4 h-4 mr-2"}),"ðŸ“¹ Record Form Check"]})})]},G)})]}),e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:c("workoutLogger.sessionDetails")}),e.jsxs("div",{children:[e.jsx(ht,{className:"text-xs mb-2 block",children:c("mood.question")}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["energized","normal","tired","stressed"].map(C=>e.jsx(Ya,{type:"button",variant:p===C?"default":"outline",size:"sm",onClick:()=>f(C),children:C==="energized"?`âš¡ ${c("mood.energized")}`:C==="normal"?`ðŸ˜Š ${c("mood.normal")}`:C==="tired"?`ðŸ˜´ ${c("mood.tired")}`:`ðŸ˜° ${c("mood.stressed")}`},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ht,{className:"text-xs",children:c("workoutLogger.sleepQuality")}),e.jsxs("span",{className:"font-semibold",children:[h,"/10"]})]}),e.jsx(Fi,{value:[h],onValueChange:([C])=>x(C),min:1,max:10,step:1,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx(ht,{htmlFor:"workout-notes",className:"text-xs",children:c("workout.notes")}),e.jsx(Ml,{id:"workout-notes",value:g,onChange:C=>y(C.target.value),placeholder:c("workout.notes_placeholder"),rows:3,className:"text-sm"})]})]}),M()>8.5&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 flex items-start gap-3",children:[e.jsx(gt,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-orange-900",children:c("workoutLogger.rpeHigh")}),e.jsx("p",{className:"text-orange-700",children:c("workoutLogger.rpeWarning").replace("{rpe}",M().toString())})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(Ya,{variant:"outline",onClick:a,disabled:v,className:"flex-1",children:c("common.cancel")}),e.jsx(Ya,{onClick:E,disabled:v,className:"flex-1",children:c(v?"common.saving":"common.save")})]})]})]}),P&&I&&e.jsx(Dl,{open:P,onClose:()=>{N(!1),T(null)},exerciseName:I.name,exercisePattern:I.pattern,onUploadComplete:C=>{N(!1),T(null),re.success("Video caricato! Analisi in corso...")}})]})}class h0{constructor(){this.sessionPainEvents=[]}async logPain(a){try{const{data:r,error:s}=await ne.from("pain_logs").insert({user_id:a.user_id,program_id:a.program_id,exercise_name:a.exercise_name,session_date:a.session_date||new Date().toISOString(),day_name:a.day_name,set_number:a.set_number,weight_used:a.weight_used,reps_completed:a.reps_completed,rom_percentage:a.rom_percentage||100,pain_level:a.pain_level,rpe:a.rpe,pain_location:a.pain_location,adaptations:a.adaptations||[],notes:a.notes}).select().single();return s?(console.error("[PainService] Error logging pain:",s),{success:!1,error:s.message}):(console.log("[PainService] âœ… Pain logged:",r.id),{success:!0})}catch(r){return console.error("[PainService] Exception:",r),{success:!1,error:String(r)}}}logPainEvent(a){this.sessionPainEvents.push(a),console.log("[PainService] Pain event logged:",a)}getSessionPainEvents(){return[...this.sessionPainEvents]}clearSessionEvents(){this.sessionPainEvents=[]}suggestAdaptation(a,r,s,i,o,l){const n=Math.min(10,Math.max(0,Math.round(a))),c=Hr(n),u={intensity:n,timestamp:new Date().toISOString()},d=dn(u,{isRecurringIssue:o.length>=2});if(c==="none"||c==="mild")return{action:"continue",message:d.messageIt,alert_level:"success",_painDetectResponse:d};if(c==="moderate"){const p=Uo(n),f=p.load>0?Math.round(r*(1-p.load/100)/2.5)*2.5:r;return o.length>=2?{action:"substitute_exercise",message:`âš ï¸ Fastidio persistente (${a}/10). Considera un esercizio alternativo per questa zona.`,alert_level:"warning",_painDetectResponse:d}:{action:"reduce_weight",message:d.messageIt,new_weight:f,alert_level:"warning",_painDetectResponse:d}}return c==="significant"?{action:"stop_exercise",message:d.messageIt,alert_level:"error",_painDetectResponse:d}:{action:"stop_exercise",message:`âš ï¸ Fastidio severo (${a}/10). Ti consigliamo di fermarti e consultare un professionista.`,alert_level:"error",_painDetectResponse:d}}evaluateDiscomfortV2(a,r,s,i){const o={intensity:r,timestamp:new Date().toISOString()};return dn(o,{alternativeAvailable:i})}findSubstitute(a,r,s){const i=ih(a,r,s);return{found:i.found,substitute:i.substitute,rationale:i.rationaleIt}}applyAdaptationsToExercise(a,r,s="gym"){return sh(a,r,s)}async getPainThreshold(a,r){try{const{data:s,error:i}=await ne.from("pain_thresholds").select("*").eq("user_id",a).eq("exercise_name",r).maybeSingle();return i?(console.error("[PainService] Error fetching threshold:",i),null):s}catch(s){return console.error("[PainService] Exception:",s),null}}async updatePainThreshold(a,r,s,i,o,l){try{const n=await this.getPainThreshold(a,r),c=new Date().toISOString(),u={user_id:a,exercise_name:r,last_pain_level:s,last_pain_date:s>0?c:n==null?void 0:n.last_pain_date,last_session_date:c,total_sessions:((n==null?void 0:n.total_sessions)||0)+1,max_pain_recorded:Math.max(s,(n==null?void 0:n.max_pain_recorded)||0),consecutive_pain_free_sessions:s<=3?((n==null?void 0:n.consecutive_pain_free_sessions)||0)+1:0,needs_physiotherapist_contact:s>=un.PROFESSIONAL_ADVICE||(n==null?void 0:n.consecutive_pain_free_sessions)===0&&((n==null?void 0:n.total_sessions)||0)>=3,last_safe_weight:s<=3?i:n==null?void 0:n.last_safe_weight,last_safe_reps:s<=3?o:n==null?void 0:n.last_safe_reps,last_safe_rom:s<=3?l:n==null?void 0:n.last_safe_rom},{error:d}=await ne.from("pain_thresholds").upsert(u,{onConflict:"user_id,exercise_name"});return d?(console.error("[PainService] Error updating threshold:",d),{success:!1}):{success:!0}}catch(n){return console.error("[PainService] Exception:",n),{success:!1}}}async getPainHistory(a,r,s=10){try{const{data:i,error:o}=await ne.from("pain_logs").select("*").eq("user_id",a).eq("exercise_name",r).order("session_date",{ascending:!1}).limit(s);return o?(console.error("[PainService] Error fetching history:",o),[]):i||[]}catch(i){return console.error("[PainService] Exception:",i),[]}}async shouldActivateHybridRecovery(a,r){try{const s=await this.getPainHistory(a,r,10);if(s.length<2)return{shouldActivate:!1,sessions:0,avgPain:0};const i=new Map;s.forEach(c=>{var d;const u=(d=c.session_date)==null?void 0:d.split("T")[0];u&&(i.has(u)||i.set(u,[]),i.get(u).push(c))});const o=Array.from(i.values()).slice(0,3).map(c=>({avgPain:c.reduce((u,d)=>u+d.pain_level,0)/c.length,maxPain:Math.max(...c.map(u=>u.pain_level)),count:c.length}));if(o.length<2)return{shouldActivate:!1,sessions:0,avgPain:0};const l=o.filter(c=>c.avgPain>=4&&c.avgPain<=6);if(l.length>=2){const c=l.reduce((u,d)=>u+d.avgPain,0)/l.length;return{shouldActivate:!0,reason:`Fastidio moderato persistente (${c.toFixed(1)}/10) per ${l.length} sessioni. Ti proponiamo un protocollo di recupero.`,sessions:l.length,avgPain:c}}const n=o.filter(c=>c.maxPain>=7);return n.length>=2?{shouldActivate:!0,reason:`Fastidio significativo (â‰¥7/10) per ${n.length} sessioni. Consigliamo un periodo di recupero e consulto professionale.`,sessions:n.length,avgPain:n.reduce((c,u)=>c+u.maxPain,0)/n.length}:{shouldActivate:!1,sessions:0,avgPain:0}}catch(s){return console.error("[PainService] Exception:",s),{shouldActivate:!1,sessions:0,avgPain:0}}}getMobilityProtocol(a){const r={lower_back:{name:"Mobility Protocol - Lombare",mobility:[{name:"Cat-Cow",sets:2,duration:"60 secondi"},{name:"Child's Pose",sets:2,duration:"45 secondi"},{name:"Thread the Needle",sets:2,duration:"30 secondi per lato"}],reinforcement:[{name:"Dead Bug",sets:3,reps:"10 per lato"},{name:"Bird Dog",sets:3,reps:"8 per lato"},{name:"Glute Bridge",sets:3,reps:"12-15"}]},knee:{name:"Mobility Protocol - Ginocchio",mobility:[{name:"Quad Stretch",sets:2,duration:"45 secondi per lato"},{name:"Half Kneeling Hip Flexor Stretch",sets:2,duration:"45 secondi per lato"},{name:"Foam Roll Quads/IT Band",sets:2,duration:"60 secondi per lato"}],reinforcement:[{name:"Terminal Knee Extension (TKE)",sets:3,reps:"12-15"},{name:"Single Leg Balance",sets:3,reps:"30 secondi per lato"},{name:"Step-up controllato",sets:3,reps:"8-10 per lato"}]},shoulder:{name:"Mobility Protocol - Spalla",mobility:[{name:"Shoulder Circles",sets:2,duration:"30 secondi per direzione"},{name:"Wall Slides",sets:2,reps:"10-12"},{name:"Cross Body Stretch",sets:2,duration:"30 secondi per lato"}],reinforcement:[{name:"Face Pull",sets:3,reps:"15-20"},{name:"External Rotation",sets:3,reps:"12-15 per lato"},{name:"Prone Y-T-W",sets:2,reps:"8 per posizione"}]},hip:{name:"Mobility Protocol - Anca",mobility:[{name:"90/90 Hip Stretch",sets:2,duration:"60 secondi per lato"},{name:"Pigeon Pose",sets:2,duration:"45 secondi per lato"},{name:"Hip Circles",sets:2,duration:"10 cerchi per direzione"}],reinforcement:[{name:"Clamshell",sets:3,reps:"12-15 per lato"},{name:"Fire Hydrant",sets:3,reps:"10-12 per lato"},{name:"Glute Bridge",sets:3,reps:"12-15"}]},ankle:{name:"Mobility Protocol - Caviglia",mobility:[{name:"Ankle Circles",sets:2,duration:"30 secondi per direzione"},{name:"Calf Stretch (muro)",sets:2,duration:"45 secondi per lato"},{name:"Dorsiflexion Mobilization",sets:2,duration:"30 secondi per lato"}],reinforcement:[{name:"Single Leg Calf Raise",sets:3,reps:"12-15 per lato"},{name:"Tibialis Anterior Raise",sets:3,reps:"15-20"},{name:"Balance Reach",sets:3,reps:"8 per direzione"}]},elbow:{name:"Mobility Protocol - Gomito",mobility:[{name:"Stretching Bicipiti",sets:2,duration:"45 secondi"},{name:"Stretching Tricipiti",sets:2,duration:"45 secondi"},{name:"Pronazione/Supinazione",sets:2,duration:"15 ripetizioni"}],reinforcement:[{name:"Hammer Curl leggero",sets:3,reps:"12-15"},{name:"Reverse Curl",sets:3,reps:"10-12"},{name:"Wrist Curl",sets:3,reps:"15-20"}]},wrist:{name:"Mobility Protocol - Polso",mobility:[{name:"Wrist Circles",sets:2,duration:"30 secondi per direzione"},{name:"Prayer Stretch",sets:2,duration:"30 secondi"},{name:"Reverse Prayer Stretch",sets:2,duration:"30 secondi"}],reinforcement:[{name:"Wrist Curl",sets:3,reps:"15-20"},{name:"Reverse Wrist Curl",sets:3,reps:"15-20"},{name:"Finger Extensions",sets:3,reps:"15-20"}]},neck:{name:"Mobility Protocol - Collo",mobility:[{name:"Neck Rotations",sets:2,duration:"30 secondi per direzione"},{name:"Lateral Neck Stretch",sets:2,duration:"30 secondi per lato"},{name:"Chin Tucks",sets:2,reps:"10-12"}],reinforcement:[{name:"Isometric Neck Hold",sets:3,reps:"10 secondi per direzione"},{name:"Prone Neck Extension",sets:3,reps:"10-12"},{name:"Wall Angels",sets:3,reps:"10-12"}]}};return r[a]||r.lower_back}get disclaimer(){return ah}get thresholds(){return un}get bodyAreaLabels(){return Go}classifyPain(a){return Hr(a)}}const Gs=new h0,In={lower_back:{primary:["Squat","Deadlift","Good Morning","Romanian DL","Back Squat","Front Squat"],secondary:["Leg Press","Lunges","Step-ups"],icon:"ðŸ¦´"},knee:{primary:["Squat","Leg Extension","Leg Press","Lunges","Bulgarian Split Squat"],secondary:["Deadlift","Leg Curl","Step-ups"],icon:"ðŸ¦µ"},shoulder:{primary:["Overhead Press","Lateral Raise","Face Pull","Arnold Press","Military Press"],secondary:["Bench Press","Dips","Pullups","Incline Press"],icon:"ðŸ’ª"},hip:{primary:["Hip Thrust","Lunges","Bulgarian Split Squat","Step-ups"],secondary:["Squat","Deadlift","Leg Press"],icon:"ðŸ¦¿"},neck:{primary:["Shrugs","Neck Extensions"],secondary:["Overhead Press","Upright Row"],icon:"ðŸ¦´"},ankle:{primary:["Calf Raise","Seated Calf Raise","Jump"],secondary:["Squat","Lunges","Leg Press"],icon:"ðŸ¦µ"},elbow:{primary:["Bicep Curl","Tricep Extension","Skull Crushers"],secondary:["Bench Press","Overhead Press","Rows"],icon:"ðŸ¦´"},wrist:{primary:["Wrist Curl","Reverse Wrist Curl"],secondary:["Bench Press","Overhead Press","Deadlift"],icon:"âœ‹"}},Tn={lower_back:"Lower Back",knee:"Ginocchio",shoulder:"Spalla",hip:"Anca",neck:"Collo",ankle:"Caviglia",elbow:"Gomito",wrist:"Polso"};function g0({open:t,onClose:a,exerciseName:r,painLevel:s,sessions:i,allExercises:o,onActivate:l,onSkip:n}){const[c,u]=m.useState("confirm"),[d,p]=m.useState(null),[f,h]=m.useState({primary:[],secondary:[],normal:[]});if(m.useEffect(()=>{t&&(u("confirm"),p(null),h({primary:[],secondary:[],normal:[]}))},[t]),m.useEffect(()=>{if(!d)return;const v=In[d];if(!v)return;const S=[],P=[],N=[];o.forEach(I=>{const T=v.primary.some(D=>I.toLowerCase().includes(D.toLowerCase())),M=v.secondary.some(D=>I.toLowerCase().includes(D.toLowerCase()));T?S.push(I):M?P.push(I):N.push(I)}),h({primary:S,secondary:P,normal:N}),console.log("ðŸ” Affected exercises identified:",{primary:S,secondary:P,normal:N})},[d,o]),!t)return null;const x=()=>e.jsxs(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-red-500/20",children:e.jsx(gt,{className:"w-7 h-7 text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-1",children:["DOLORE PERSISTENTE (",s,"/10)"]}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Rilevato per ",i," sessioni consecutive"]})]}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-4",children:[e.jsx("p",{className:"text-red-300 font-semibold mb-2",children:"Dopo 3 tentativi di riduzione il dolore persiste durante:"}),e.jsx("p",{className:"text-white text-lg font-bold",children:r})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-slate-300 font-semibold",children:"Vuoi attivare RECOVERY MODE per questa area corporea?"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Il Recovery Mode ti permetterÃ  di:"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2 text-slate-300",children:[e.jsx(Fe,{className:"w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Continuare allenamento normale per il resto del corpo"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300",children:[e.jsx(Fe,{className:"w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Recuperare gradualmente l'area dolorosa con parametri ridotti"})]}),e.jsxs("li",{className:"flex items-start gap-2 text-slate-300",children:[e.jsx(Fe,{className:"w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Non perdere sessioni e mantenere progressi"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:n,className:"bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-4 rounded-xl transition-colors flex items-center justify-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"No, salta esercizio"]}),e.jsxs("button",{onClick:()=>u("select_area"),className:"bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"SÃ¬, attiva Recovery"]})]}),e.jsx("p",{className:"text-slate-500 text-xs text-center",children:"Il Recovery Mode applicherÃ  parametri ridotti (2 sets, 40-60% carico, ROM 50%) solo agli esercizi che coinvolgono l'area dolorosa."})]}),g=()=>e.jsxs(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-orange-500/20",children:e.jsx(ea,{className:"w-6 h-6 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"QUALE AREA CORPOREA?"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Seleziona l'area che causa dolore"})]})]}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(Tn).map(([v,S])=>e.jsx("button",{onClick:()=>{p(v),u("summary")},className:`
              p-4 rounded-xl border-2 transition-all duration-300 text-left
              ${d===v?"border-orange-500 bg-orange-500/20":"border-slate-700 hover:border-slate-600 bg-slate-800/50 hover:bg-slate-800"}
            `,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:In[v].icon}),e.jsx("span",{className:"text-white font-semibold",children:S})]})},v))}),e.jsx("button",{onClick:()=>u("confirm"),className:"w-full bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-lg transition-colors",children:"Indietro"})]}),y=()=>{if(!d)return null;const v=Tn[d];return f.primary.length+f.secondary.length,e.jsxs(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-emerald-500/20",children:e.jsx(Fe,{className:"w-6 h-6 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"RECOVERY MODE ATTIVATO"}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Area: ",v]})]})]}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[f.primary.length>0&&e.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-xl p-4",children:[e.jsxs("p",{className:"text-orange-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4"}),"Esercizi in RECOVERY MODE (",f.primary.length,")"]}),e.jsx("div",{className:"space-y-2",children:f.primary.map((S,P)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-400"}),e.jsx("span",{className:"text-slate-300 text-sm",children:S})]},P))})]}),f.secondary.length>0&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4",children:[e.jsxs("p",{className:"text-yellow-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),"Esercizi con cautela (",f.secondary.length,")"]}),e.jsx("div",{className:"space-y-2",children:f.secondary.map((S,P)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400"}),e.jsx("span",{className:"text-slate-300 text-sm",children:S})]},P))})]}),f.normal.length>0&&e.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-4",children:[e.jsxs("p",{className:"text-emerald-300 font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),"Altri esercizi: NORMALI (",f.normal.length,")"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.normal.slice(0,6).map((S,P)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-3 h-3 text-emerald-400"}),e.jsx("span",{className:"text-slate-400 text-xs truncate",children:S})]},P)),f.normal.length>6&&e.jsxs("span",{className:"text-slate-500 text-xs col-span-2",children:["+",f.normal.length-6," altri..."]})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-slate-300 font-semibold mb-3",children:"Parametri Recovery:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Sets"}),e.jsx("p",{className:"text-white font-bold",children:"2"})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Reps"}),e.jsx("p",{className:"text-white font-bold",children:"8-10"})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Carico"}),e.jsx("p",{className:"text-white font-bold",children:"40-60%"})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"ROM"}),e.jsx("p",{className:"text-white font-bold",children:"50% (ridotto)"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>{const S=[...f.primary,...f.secondary];l(d,S),a()},className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Continua Workout"]}),e.jsx("button",{onClick:()=>u("select_area"),className:"w-full bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-lg transition-colors",children:"Cambia area corporea"})]}),e.jsx("p",{className:"text-slate-500 text-xs text-center",children:"Il sistema monitorerÃ  il dolore e proporrÃ  progressioni quando l'area sarÃ  recuperata."})]})};return e.jsx(Ne,{children:e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:a,children:e.jsx(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-slate-900 rounded-2xl p-6 max-w-lg w-full border border-slate-700 shadow-2xl max-h-[90vh] overflow-y-auto",onClick:v=>v.stopPropagation(),children:e.jsxs(Ne,{mode:"wait",children:[c==="confirm"&&x(),c==="select_area"&&g(),c==="summary"&&y()]})})})})}const f0=[{id:"shoulder",label:"Spalla",emoji:"ðŸ¦¾"},{id:"elbow",label:"Gomito",emoji:"ðŸ’ª"},{id:"wrist",label:"Polso",emoji:"âœ‹"},{id:"lower_back",label:"Zona Lombare",emoji:"ðŸ”™"},{id:"upper_back",label:"Zona Dorsale",emoji:"ðŸ”"},{id:"knee",label:"Ginocchio",emoji:"ðŸ¦µ"},{id:"hip",label:"Anca",emoji:"ðŸ¦´"},{id:"ankle",label:"Caviglia",emoji:"ðŸ¦¶"},{id:"neck",label:"Collo",emoji:"ðŸ¦’"}];function x0({open:t,onClose:a,exerciseName:r,exercisePattern:s,currentWeight:i,onReduceWeight:o,onReplaceExercise:l,onReportPain:n}){const{t:c}=ia(),[u,d]=m.useState(null),[p,f]=m.useState("main"),[h,x]=m.useState(""),[g,y]=m.useState(5),[v,S]=m.useState(""),P=()=>{d(null),f("main"),x(""),y(5),S(""),a()},N=()=>{o(15),S(c("exercise_dislike.weight_reduced")),f("action_taken"),setTimeout(()=>{P()},2e3)},I=D=>{x(D),f("pain_level")},T=()=>{n(h,g),g>=7?(l("pain"),S(c("exercise_dislike.replaced_for_pain"))):g>=4?(o(20),S(c("exercise_dislike.weight_reduced_for_pain"))):(o(10),S(c("exercise_dislike.mild_pain_adjusted"))),f("action_taken"),setTimeout(()=>{P()},2500)},M=D=>{D?(o(15),S(c("exercise_dislike.weight_reduced_dislike"))):(l("dislike"),S(c("exercise_dislike.replaced_for_dislike"))),f("action_taken"),setTimeout(()=>{P()},2500)};return t?e.jsx(Ne,{children:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-slate-800/95 backdrop-blur-xl rounded-2xl max-w-md w-full border border-slate-700 shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:p==="action_taken"?"âœ… "+c("common.done"):"ðŸ’¬ "+c("exercise_dislike.title")}),e.jsx("button",{onClick:P,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-emerald-400 font-bold text-xl",children:r}),i&&e.jsxs("p",{className:"text-slate-400 text-sm mt-1",children:[c("exercise_dislike.current_weight"),": ",i," kg"]})]}),p==="main"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-slate-300 text-center mb-4",children:c("exercise_dislike.why_not_like")}),e.jsx("button",{onClick:N,className:"w-full bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/50 rounded-xl p-4 text-left transition-all group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qr,{className:"w-6 h-6 text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-300 font-semibold",children:c("exercise_dislike.too_heavy")}),e.jsx("p",{className:"text-amber-400/60 text-sm",children:c("exercise_dislike.too_heavy_desc")})]}),e.jsx(wr,{className:"w-5 h-5 text-amber-400/50 group-hover:text-amber-400 ml-auto transition-colors"})]})}),e.jsx("button",{onClick:()=>{d("pain"),f("pain_area")},className:"w-full bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 rounded-xl p-4 text-left transition-all group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gt,{className:"w-6 h-6 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-300 font-semibold",children:c("exercise_dislike.feel_pain")}),e.jsx("p",{className:"text-red-400/60 text-sm",children:c("exercise_dislike.feel_pain_desc")})]}),e.jsx(wr,{className:"w-5 h-5 text-red-400/50 group-hover:text-red-400 ml-auto transition-colors"})]})}),e.jsx("button",{onClick:()=>{d("dislike"),f("dislike_confirm")},className:"w-full bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 rounded-xl p-4 text-left transition-all group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Vn,{className:"w-6 h-6 text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-300 font-semibold",children:c("exercise_dislike.dont_like")}),e.jsx("p",{className:"text-purple-400/60 text-sm",children:c("exercise_dislike.dont_like_desc")})]}),e.jsx(wr,{className:"w-5 h-5 text-purple-400/50 group-hover:text-purple-400 ml-auto transition-colors"})]})})]}),p==="pain_area"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-slate-300 text-center mb-4",children:c("exercise_dislike.where_pain")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:f0.map(D=>e.jsxs("button",{onClick:()=>I(D.id),className:"bg-slate-700/50 hover:bg-red-500/20 border border-slate-600 hover:border-red-500/50 rounded-lg p-3 text-center transition-all",children:[e.jsx("span",{className:"text-2xl block mb-1",children:D.emoji}),e.jsx("span",{className:"text-xs text-slate-300",children:D.label})]},D.id))}),e.jsxs("button",{onClick:()=>f("main"),className:"w-full mt-4 text-slate-400 hover:text-white text-sm transition-colors",children:["â† ",c("common.back")]})]}),p==="pain_level"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-slate-300 text-center mb-2",children:c("exercise_dislike.pain_intensity")}),e.jsxs("p",{className:"text-red-400 text-center font-bold text-4xl mb-4",children:[g,"/10"]}),e.jsx("input",{type:"range",min:"1",max:"10",value:g,onChange:D=>y(parseInt(D.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-red-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[e.jsx("span",{children:c("exercise_dislike.pain_mild")}),e.jsx("span",{children:c("exercise_dislike.pain_moderate")}),e.jsx("span",{children:c("exercise_dislike.pain_severe")})]}),e.jsx("div",{className:"mt-4 p-3 rounded-lg bg-slate-700/50 text-sm",children:g>=7?e.jsxs("p",{className:"text-red-300",children:["âš ï¸ ",c("exercise_dislike.pain_will_replace")]}):g>=4?e.jsxs("p",{className:"text-amber-300",children:["ðŸ”„ ",c("exercise_dislike.pain_will_reduce")]}):e.jsxs("p",{className:"text-green-300",children:["âœ… ",c("exercise_dislike.pain_will_adjust")]})}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>f("pain_area"),className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg font-semibold transition-colors",children:["â† ",c("common.back")]}),e.jsx("button",{onClick:T,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-semibold transition-colors",children:c("common.confirm")})]})]}),p==="dislike_confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-slate-300 text-center mb-4",children:c("exercise_dislike.dislike_try_lighter")}),e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-purple-300 text-sm text-center",children:c("exercise_dislike.dislike_lighter_suggestion")})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>M(!0),className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-semibold transition-colors",children:["âœ… ",c("exercise_dislike.try_lighter")]}),e.jsxs("button",{onClick:()=>M(!1),className:"w-full bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg font-semibold transition-colors",children:["ðŸ”„ ",c("exercise_dislike.replace_exercise")]}),e.jsxs("button",{onClick:()=>f("main"),className:"w-full text-slate-400 hover:text-white text-sm transition-colors mt-2",children:["â† ",c("common.back")]})]})]}),p==="action_taken"&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx(L.div,{initial:{scale:0},animate:{scale:1},className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Fe,{className:"w-8 h-8 text-emerald-400"})}),e.jsx("p",{className:"text-emerald-300 font-semibold text-lg",children:v})]})]})]})})}):null}function b0({exerciseName:t,showOnVideo:a=!1,className:r=""}){const[s,i]=m.useState(!1),[o,l]=m.useState("critical"),n=zo(t),c=Om(t);if(!n)return null;const u=h=>{switch(h){case"setup":return"ðŸŽ¯";case"execution":return"ðŸ’ª";case"breathing":return"ðŸ«";case"common_errors":return"âŒ";case"safety":return"âš ï¸";default:return"âœ…"}},d=h=>{switch(h){case"setup":return"text-blue-400 border-blue-500/30 bg-blue-500/10";case"execution":return"text-green-400 border-green-500/30 bg-green-500/10";case"breathing":return"text-cyan-400 border-cyan-500/30 bg-cyan-500/10";case"common_errors":return"text-red-400 border-red-500/30 bg-red-500/10";case"safety":return"text-amber-400 border-amber-500/30 bg-amber-500/10";default:return"text-slate-400 border-slate-500/30 bg-slate-500/10"}},p=h=>h==="critical"?e.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-500/20 text-red-300 rounded font-bold",children:"CRITICO"}):h==="important"?e.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-500/20 text-amber-300 rounded font-semibold",children:"IMPORTANTE"}):null,f=o==="all"?n.cues:o==="critical"?c:n.cues.filter(h=>h.category===o);return!s&&a?e.jsx("div",{className:`absolute bottom-4 left-4 right-4 ${r}`,children:e.jsxs("div",{className:"bg-black/80 backdrop-blur-sm border border-white/20 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"Key Points"})]}),e.jsx("button",{onClick:()=>i(!0),className:"text-xs text-blue-400 hover:text-blue-300 font-semibold",children:"Vedi tutti â†’"})]}),e.jsx("div",{className:"space-y-1",children:n.keyPoints.slice(0,3).map((h,x)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx($r,{className:"w-3 h-3 text-green-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-white/90",children:h})]},x))})]})}):e.jsx("div",{className:`${a?"absolute inset-0 flex items-center justify-center p-4":""} ${r}`,children:e.jsxs("div",{className:`${a?"max-w-2xl w-full max-h-[80vh] overflow-y-auto bg-slate-900/95 backdrop-blur-md":"bg-slate-800"} border border-slate-700 rounded-xl`,children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex items-center justify-between rounded-t-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(os,{className:"w-5 h-5 text-white"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:"Form Cues"}),e.jsx("p",{className:"text-blue-100 text-xs",children:n.exerciseName})]})]}),a&&e.jsx("button",{onClick:()=>i(!1),className:"text-white/80 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 border-b border-slate-700 bg-slate-800/50",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx($r,{className:"w-4 h-4 text-green-400"}),"Punti Chiave"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:n.keyPoints.map((h,x)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm bg-green-500/10 border border-green-500/30 rounded-lg p-2",children:[e.jsx("span",{className:"text-green-400 font-bold",children:"â€¢"}),e.jsx("span",{className:"text-white",children:h})]},x))})]}),e.jsx("div",{className:"p-4 border-b border-slate-700 bg-slate-800/30",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:["critical","all","setup","execution","common_errors"].map(h=>e.jsxs("button",{onClick:()=>l(h),className:`px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${o===h?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[h==="critical"&&"ðŸ”¥ Critici",h==="all"&&"ðŸ“‹ Tutti",h==="setup"&&"ðŸŽ¯ Setup",h==="execution"&&"ðŸ’ª Esecuzione",h==="common_errors"&&"âŒ Errori Comuni"]},h))})}),e.jsxs("div",{className:"p-4 space-y-3 max-h-96 overflow-y-auto",children:[f.length===0&&e.jsx("p",{className:"text-slate-400 text-sm text-center py-8",children:"Nessun cue disponibile per questa categoria"}),f.map((h,x)=>e.jsxs("div",{className:`border rounded-lg p-3 ${d(h.category)}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx("span",{className:"text-lg",children:u(h.category)}),e.jsx("p",{className:"text-white text-sm flex-1",children:h.text})]}),p(h.priority)]}),e.jsx("div",{className:"ml-7",children:e.jsx("span",{className:"text-xs uppercase font-semibold opacity-70",children:h.category.replace("_"," ")})})]},x))]}),e.jsx("div",{className:"p-3 border-t border-slate-700 bg-slate-800/50 rounded-b-xl",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:[f.length," cue",f.length!==1?"s":""," mostrati"]}),e.jsxs("span",{className:"text-slate-400",children:[c.length," critici â€¢ ",n.cues.length," totali"]})]})})]})})}function v0({exerciseName:t,autoPlay:a=!1,loop:r=!0,muted:s=!0,className:i="",showFormCues:o=!0}){const[l,n]=m.useState(null),[c,u]=m.useState(!0),[d,p]=m.useState(!1),[f,h]=m.useState(a),[x,g]=m.useState(!1),[y,v]=m.useState(s),S=m.useRef(null),P=ta.useMemo(()=>xi(t),[t]);m.useEffect(()=>{let C=!0;return n(null),u(!0),p(!1),xh(t).then(G=>{C&&(n(G),G||u(!1))}),()=>{C=!1}},[t]);const N=m.useCallback(()=>{u(!0),p(!1)},[]),I=m.useCallback(()=>{u(!1)},[]),T=m.useCallback(()=>{u(!1),p(!0)},[]),M=m.useCallback(()=>{h(!0)},[]),D=m.useCallback(()=>{h(!1)},[]),E=m.useCallback(()=>{S.current&&(f?S.current.pause():S.current.play(),h(!f))},[f]),U=m.useCallback(C=>{C.stopPropagation(),S.current&&(S.current.muted=!S.current.muted,v(S.current.muted))},[]),W=m.useCallback(C=>{C.stopPropagation(),g(G=>!G)},[]);return l===!1||l===null?null:d?e.jsx("div",{className:`bg-gray-800 rounded-lg flex items-center justify-center ${i}`,children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-600 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Video non disponibile"})]})}):e.jsxs("div",{className:`relative bg-gray-900 rounded-lg overflow-hidden ${i}`,children:[c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 z-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),e.jsx("video",{ref:S,src:P,autoPlay:a,loop:r,muted:s,playsInline:!0,onLoadStart:N,onCanPlay:I,onError:T,onPlay:M,onPause:D,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:E,className:"absolute inset-0 flex items-center justify-center bg-black/20 hover:bg-black/30 transition-colors group",children:!f&&!c&&e.jsx("div",{className:"bg-blue-500 rounded-full p-3 group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})}),e.jsx("button",{onClick:U,className:"absolute bottom-2 right-2 p-2 bg-black/50 rounded-full hover:bg-black/70 transition-colors",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:y?e.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"}):e.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})}),o&&e.jsx("button",{onClick:W,className:`absolute top-2 right-2 p-2 rounded-full transition-colors ${x?"bg-blue-600 hover:bg-blue-700":"bg-black/50 hover:bg-black/70"}`,title:"Mostra/Nascondi Form Cues",children:e.jsx(os,{className:"w-4 h-4 text-white"})}),o&&x&&e.jsx(b0,{exerciseName:t,showOnVideo:!0})]})}const zl=m.memo(v0,(t,a)=>t.exerciseName===a.exerciseName&&t.autoPlay===a.autoPlay&&t.loop===a.loop&&t.muted===a.muted&&t.className===a.className&&t.showFormCues===a.showFormCues);zl.displayName="ExerciseVideoPlayer";function y0({exercises:t,exerciseLogs:a,dayName:r,isResting:s,restTimeLeft:i,onCompleteSet:o,onSkipRest:l,onFinishWorkout:n,onEndWorkoutEarly:c,onClose:u}){const[d,p]=m.useState(null),[f,h]=m.useState(!1),[x,g]=m.useState(10),[y,v]=m.useState(0),[S,P]=m.useState(7),N=()=>a.reduce((W,C)=>{var G;return W+(((G=C.sets)==null?void 0:G.filter(H=>H.completed).length)||0)},0),I=()=>t.reduce((W,C)=>W+C.sets,0),T=W=>{const C=Math.floor(W/60),G=W%60;return`${C}:${G.toString().padStart(2,"0")}`};m.useEffect(()=>{if(d!==null){const W=t[d],C=typeof W.reps=="number"?W.reps:parseInt(String(W.reps).split("-")[0])||10;g(C);const G=typeof W.weight=="number"?W.weight:parseFloat(String(W.weight))||0;v(G)}},[d,t]);const M=(W,C)=>{var oe;o(W,C,x,y,S);const G=t[W],H=a[W];(((oe=H==null?void 0:H.sets)==null?void 0:oe.filter(X=>X.completed).length)||0)+1>=G.sets&&p(null)},D=N(),E=I(),U=D===E;return e.jsxs("div",{style:{minHeight:"100vh",background:"#1a202c",padding:"1rem"},children:[e.jsxs("div",{style:{maxWidth:600,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem",padding:"1rem",background:"#2d3748",borderRadius:12},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{color:"white",fontSize:"1.25rem",margin:0},children:r}),e.jsxs("p",{style:{color:"#a0aec0",fontSize:"0.875rem",margin:"0.25rem 0 0"},children:[D,"/",E," serie completate"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>h(!0),style:{padding:"0.5rem 1rem",background:"#e53e3e",border:"none",borderRadius:8,color:"white",fontSize:"0.875rem",cursor:"pointer"},children:"Termina"}),e.jsx("button",{onClick:u,style:{padding:"0.5rem",background:"#4a5568",border:"none",borderRadius:8,color:"white",cursor:"pointer"},children:e.jsx(ke,{size:20})})]})]}),e.jsx("div",{style:{height:6,background:"#4a5568",borderRadius:3,marginBottom:"1.5rem",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${E>0?D/E*100:0}%`,background:"linear-gradient(90deg, #48bb78, #38a169)",borderRadius:3,transition:"width 0.3s ease"}})}),s&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:12,padding:"1rem",marginBottom:"1rem",textAlign:"center"},children:[e.jsx("p",{style:{color:"rgba(255,255,255,0.8)",margin:0,fontSize:"0.875rem"},children:"Riposo"}),e.jsx("p",{style:{color:"white",fontSize:"2rem",fontWeight:"bold",margin:"0.25rem 0"},children:T(i)}),e.jsx("button",{onClick:l,style:{padding:"0.5rem 1rem",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:6,color:"white",fontSize:"0.875rem",cursor:"pointer"},children:"Salta riposo"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem"},children:t.map((W,C)=>{var pe;const G=a[C],H=((pe=G==null?void 0:G.sets)==null?void 0:pe.filter(ie=>ie.completed).length)||0,Y=W.sets,oe=H>=Y,X=d===C,ee=H>0&&!oe;return e.jsxs("button",{onClick:()=>p(X?null:C),style:{padding:"1rem",background:X?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":oe?"#2f855a":"#2d3748",border:X?"2px solid #a78bfa":ee?"2px solid #667eea":"2px solid transparent",borderRadius:12,cursor:"pointer",textAlign:"left",opacity:oe&&!X?.7:1,transition:"all 0.2s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.25rem"},children:oe?"âœ…":ee?"ðŸ‹ï¸":"âšª"}),e.jsxs("span",{style:{fontSize:"0.75rem",color:X?"white":"#a0aec0",background:X?"rgba(255,255,255,0.2)":"#4a5568",padding:"0.125rem 0.5rem",borderRadius:4},children:[H,"/",Y]})]}),e.jsx("p",{style:{color:"white",fontSize:"0.9rem",fontWeight:600,margin:0,lineHeight:1.3},children:W.name}),e.jsxs("p",{style:{color:X?"rgba(255,255,255,0.8)":"#a0aec0",fontSize:"0.75rem",margin:"0.25rem 0 0"},children:[W.sets,"x",W.reps," â€¢ ",W.weight||"â€”","kg"]}),W.supersetGroup&&e.jsx("span",{style:{display:"inline-block",marginTop:"0.5rem",fontSize:"0.65rem",background:"#ed8936",color:"white",padding:"0.125rem 0.375rem",borderRadius:4},children:"SUPERSET"})]},C)})}),e.jsx(Ne,{children:d!==null&&(()=>{var oe,X;const W=t[d],C=a[d],G=((oe=C==null?void 0:C.sets)==null?void 0:oe.filter(ee=>ee.completed))||[],H=((X=C==null?void 0:C.sets)==null?void 0:X.findIndex(ee=>!ee.completed))??0,Y=G.length>=W.sets;return e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},style:{marginTop:"1.5rem",background:"#2d3748",borderRadius:16,padding:"1.5rem",border:"2px solid #667eea"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{color:"white",fontSize:"1.25rem",margin:0},children:W.name}),e.jsxs("p",{style:{color:"#a0aec0",fontSize:"0.875rem",margin:"0.25rem 0 0"},children:[W.sets," serie x ",W.reps," reps"]})]}),e.jsx("button",{onClick:()=>p(null),style:{background:"none",border:"none",color:"#a0aec0",fontSize:"1.5rem",cursor:"pointer",padding:0,lineHeight:1},children:"x"})]}),G.length>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("p",{style:{color:"#a0aec0",fontSize:"0.75rem",marginBottom:"0.5rem"},children:"Serie completate:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:G.map((ee,pe)=>e.jsxs("span",{style:{background:"#48bb78",color:"white",padding:"0.25rem 0.5rem",borderRadius:6,fontSize:"0.75rem"},children:["S",ee.set_number,": ",ee.reps_completed,"x",ee.weight_used||0,"kg"]},pe))})]}),Y?e.jsxs("div",{style:{textAlign:"center",padding:"1rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"ðŸŽ‰"}),e.jsx("p",{style:{color:"#48bb78",fontSize:"1rem",fontWeight:600,margin:"0.5rem 0"},children:"Esercizio completato!"}),e.jsx("button",{onClick:()=>p(null),style:{marginTop:"0.5rem",padding:"0.5rem 1rem",background:"#4a5568",border:"none",borderRadius:8,color:"white",cursor:"pointer"},children:"Chiudi"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{color:"#667eea",fontSize:"0.875rem",fontWeight:600,marginBottom:"1rem"},children:["Serie ",H+1," di ",W.sets]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{color:"#a0aec0",fontSize:"0.75rem",display:"block",marginBottom:"0.5rem"},children:"Ripetizioni"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>g(ee=>Math.max(0,ee-1)),style:{width:44,height:44,background:"#4a5568",border:"none",borderRadius:8,color:"white",fontSize:"1.25rem",cursor:"pointer"},children:"-"}),e.jsx("input",{type:"number",value:x,onChange:ee=>g(parseInt(ee.target.value)||0),style:{flex:1,padding:"0.75rem",background:"#1a202c",border:"1px solid #4a5568",borderRadius:8,color:"white",fontSize:"1.25rem",textAlign:"center"}}),e.jsx("button",{onClick:()=>g(ee=>ee+1),style:{width:44,height:44,background:"#4a5568",border:"none",borderRadius:8,color:"white",fontSize:"1.25rem",cursor:"pointer"},children:"+"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{color:"#a0aec0",fontSize:"0.75rem",display:"block",marginBottom:"0.5rem"},children:"Peso (kg)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>v(ee=>Math.max(0,ee-2.5)),style:{width:44,height:44,background:"#4a5568",border:"none",borderRadius:8,color:"white",fontSize:"1.25rem",cursor:"pointer"},children:"-"}),e.jsx("input",{type:"number",value:y,onChange:ee=>v(parseFloat(ee.target.value)||0),step:"0.5",style:{flex:1,padding:"0.75rem",background:"#1a202c",border:"1px solid #4a5568",borderRadius:8,color:"white",fontSize:"1.25rem",textAlign:"center"}}),e.jsx("button",{onClick:()=>v(ee=>ee+2.5),style:{width:44,height:44,background:"#4a5568",border:"none",borderRadius:8,color:"white",fontSize:"1.25rem",cursor:"pointer"},children:"+"})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{style:{color:"#a0aec0",fontSize:"0.75rem",display:"block",marginBottom:"0.5rem"},children:["RPE (sforzo percepito): ",S]}),e.jsx("input",{type:"range",min:"1",max:"10",value:S,onChange:ee=>P(parseInt(ee.target.value)),style:{width:"100%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#718096",fontSize:"0.65rem"},children:[e.jsx("span",{children:"Facile"}),e.jsx("span",{children:"Massimale"})]})]}),e.jsxs("button",{onClick:()=>M(d,H),style:{width:"100%",padding:"1rem",background:"linear-gradient(135deg, #48bb78 0%, #38a169 100%)",border:"none",borderRadius:12,color:"white",fontSize:"1.1rem",fontWeight:600,cursor:"pointer"},children:["Completa Serie ",H+1]})]})]})})()}),U&&e.jsx("button",{onClick:n,style:{width:"100%",marginTop:"1.5rem",padding:"1.25rem",background:"linear-gradient(135deg, #48bb78 0%, #38a169 100%)",border:"none",borderRadius:12,color:"white",fontSize:"1.1rem",fontWeight:600,cursor:"pointer"},children:"ðŸ† Completa Allenamento"})]}),f&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100,padding:"1rem"},children:e.jsxs("div",{style:{background:"#2d3748",borderRadius:16,padding:"1.5rem",maxWidth:350,width:"100%"},children:[e.jsx("h3",{style:{color:"white",margin:"0 0 1rem"},children:"Terminare l'allenamento?"}),e.jsxs("p",{style:{color:"#a0aec0",fontSize:"0.9rem",marginBottom:"1.5rem"},children:["Hai completato ",D," di ",E," serie."]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[e.jsx("button",{onClick:()=>h(!1),style:{flex:1,padding:"0.75rem",background:"#4a5568",border:"none",borderRadius:8,color:"white",cursor:"pointer"},children:"Continua"}),e.jsx("button",{onClick:()=>{h(!1),c()},style:{flex:1,padding:"0.75rem",background:"#e53e3e",border:"none",borderRadius:8,color:"white",cursor:"pointer"},children:"Termina"})]})]})})]})}const w0={lower_push:{bg:"from-rose-500/20 to-rose-600/10",border:"border-rose-500/40",text:"text-rose-400"},horizontal_push:{bg:"from-blue-500/20 to-blue-600/10",border:"border-blue-500/40",text:"text-blue-400"},vertical_push:{bg:"from-sky-500/20 to-sky-600/10",border:"border-sky-500/40",text:"text-sky-400"},vertical_pull:{bg:"from-violet-500/20 to-violet-600/10",border:"border-violet-500/40",text:"text-violet-400"},lower_pull:{bg:"from-amber-500/20 to-amber-600/10",border:"border-amber-500/40",text:"text-amber-400"},core:{bg:"from-emerald-500/20 to-emerald-600/10",border:"border-emerald-500/40",text:"text-emerald-400"},compound:{bg:"from-orange-500/20 to-orange-600/10",border:"border-orange-500/40",text:"text-orange-400"},isolation:{bg:"from-teal-500/20 to-teal-600/10",border:"border-teal-500/40",text:"text-teal-400"},accessory:{bg:"from-slate-500/20 to-slate-600/10",border:"border-slate-500/40",text:"text-slate-400"}},N0={bg:"from-slate-500/20 to-slate-600/10",border:"border-slate-500/40",text:"text-slate-400"};function S0({workout:t,onStartGuided:a,onStartExercise:r,completedExercises:s=new Set,currentExerciseIndex:i=0}){const[o,l]=m.useState("selection"),[n,c]=m.useState(null),u=m.useMemo(()=>{const p=t.exercises.length,f=s.size,h=t.exercises.reduce((g,y)=>g+y.sets,0),x=t.exercises.filter(g=>s.has(g.name)).reduce((g,y)=>g+y.sets,0);return{total:p,completed:f,totalSets:h,completedSets:x,percent:Math.round(f/p*100)}},[t.exercises,s]),d=p=>{const f=p.pattern||p.category||"accessory";return w0[f]||N0};return o==="selection"?e.jsx("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-6",children:e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.dayName}),e.jsxs("p",{className:"text-slate-400",children:[t.exercises.length," esercizi â€¢ ~",Math.round(t.exercises.length*8)," min"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{l("guided"),a()},className:`w-full bg-gradient-to-br from-emerald-600/90 to-emerald-700/80 
                         hover:from-emerald-500 hover:to-emerald-600 
                         rounded-2xl p-6 text-left transition-all duration-200
                         border border-emerald-500/30 shadow-lg shadow-emerald-500/20`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-400/20 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(gc,{className:"w-7 h-7 text-emerald-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"ModalitÃ  Guidata"}),e.jsx("span",{className:"px-2 py-0.5 bg-emerald-400/20 text-emerald-300 text-xs rounded-full font-medium",children:"Consigliata"})]}),e.jsx("p",{className:"text-emerald-200/80 text-sm mb-3",children:"Segui gli esercizi in ordine ottimizzato per la tua performance"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-emerald-300/60",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(et,{className:"w-3.5 h-3.5"}),"Progressione automatica"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ts,{className:"w-3.5 h-3.5"}),"Timer integrato"]})]})]}),e.jsx(nt,{className:"w-6 h-6 text-emerald-300/50 flex-shrink-0 mt-2"})]})}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>l("free"),className:`w-full bg-gradient-to-br from-slate-700/90 to-slate-800/80 
                         hover:from-slate-600 hover:to-slate-700 
                         rounded-2xl p-6 text-left transition-all duration-200
                         border border-slate-600/30 shadow-lg`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-500/20 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(fc,{className:"w-7 h-7 text-slate-300"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"ModalitÃ  Libera"}),e.jsx("p",{className:"text-slate-400 text-sm mb-3",children:"Scegli gli esercizi nell'ordine che preferisci"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400/60",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xc,{className:"w-3.5 h-3.5"}),"Ordine flessibile"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"w-3.5 h-3.5"}),"Per esperti"]})]})]}),e.jsx(nt,{className:"w-6 h-6 text-slate-500 flex-shrink-0 mt-2"})]})})]}),e.jsx("div",{className:"mt-6 p-4 bg-slate-800/50 rounded-xl border border-slate-700/50",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(os,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[e.jsx("span",{className:"text-slate-300 font-medium",children:"ModalitÃ  Guidata"})," ottimizza l'ordine per massimizzare la performance (es. compound prima di isolation).",e.jsx("span",{className:"text-slate-300 font-medium",children:" ModalitÃ  Libera"})," Ã¨ utile quando un attrezzo Ã¨ occupato o preferisci variare."]})]})})]})}):o==="free"?e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:t.dayName}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Seleziona un esercizio per iniziare"})]}),e.jsx("button",{onClick:()=>l("selection"),className:"px-4 py-2 bg-slate-700/50 hover:bg-slate-700 rounded-lg text-sm text-slate-300 transition-colors",children:"Cambia modalitÃ "})]}),e.jsx("div",{className:"bg-slate-800/50 rounded-full h-2 overflow-hidden",children:e.jsx(L.div,{initial:{width:0},animate:{width:`${u.percent}%`},className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400"})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-slate-500",children:[e.jsxs("span",{children:[u.completed,"/",u.total," esercizi"]}),e.jsxs("span",{children:[u.percent,"% completato"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-4",children:e.jsx(Ne,{children:t.exercises.map((p,f)=>{const h=s.has(p.name),x=n===f,g=d(p);return e.jsx(L.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:f*.05},className:"relative",children:e.jsxs("button",{onClick:()=>{h||c(f)},disabled:h,className:`
                      w-full aspect-square rounded-2xl p-4 text-left transition-all duration-200
                      flex flex-col justify-between relative overflow-hidden
                      ${h?"bg-emerald-900/30 border-2 border-emerald-500/40 opacity-60":x?`bg-gradient-to-br ${g.bg} border-2 ${g.border} ring-2 ring-white/20`:`bg-gradient-to-br ${g.bg} border border-slate-700/50 hover:border-slate-600`}
                    `,children:[h&&e.jsx("div",{className:"absolute top-3 right-3 w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx(Fe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:`text-xs font-medium ${h?"text-emerald-400":g.text} uppercase tracking-wider`,children:["#",f+1]}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-bold text-base md:text-lg leading-tight mb-2 ${h?"text-emerald-300":"text-white"}`,children:p.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:`flex items-center gap-1 ${h?"text-emerald-400/60":"text-slate-400"}`,children:[e.jsx(Jt,{className:"w-3 h-3"}),p.sets,"x",p.reps]}),p.weight&&e.jsxs("span",{className:`${h?"text-emerald-400/60":"text-slate-400"}`,children:["â€¢ ",p.weight]})]})]}),p.pattern&&e.jsx("div",{className:`absolute bottom-3 right-3 text-[10px] font-medium ${g.text} uppercase opacity-50`,children:p.pattern.replace("_"," ")})]})},p.name)})})}),e.jsx(Ne,{children:n!==null&&!s.has(t.exercises[n].name)&&e.jsx(L.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-slate-900 via-slate-900/95 to-transparent",children:e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsx("div",{className:"bg-slate-800 rounded-2xl p-4 border border-slate-700 shadow-xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-white text-lg",children:t.exercises[n].name}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[t.exercises[n].sets," serie Ã— ",t.exercises[n].reps," reps",t.exercises[n].weight&&` â€¢ ${t.exercises[n].weight}`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(null),className:"px-4 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl text-slate-300 transition-colors",children:"Annulla"}),e.jsxs("button",{onClick:()=>{r(t.exercises[n],n),c(null)},className:"px-6 py-3 bg-emerald-600 hover:bg-emerald-500 rounded-xl text-white font-semibold flex items-center gap-2 transition-colors",children:[e.jsx(Xr,{className:"w-5 h-5"}),"Inizia"]})]})]})})})})}),u.completed===u.total&&e.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"mt-8 p-6 bg-gradient-to-br from-emerald-900/40 to-emerald-800/20 rounded-2xl border border-emerald-500/30 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Fe,{className:"w-8 h-8 text-emerald-400"})}),e.jsx("h3",{className:"text-xl font-bold text-emerald-300 mb-2",children:"Workout Completato!"}),e.jsx("p",{className:"text-emerald-300/60",children:"Hai completato tutti gli esercizi della sessione"})]})]}):null}const j0=[{id:"squat_basic",name:"Bodyweight Squat",difficulty:3,equipment:"bodyweight",primary:["quadriceps","glutes"],secondary:["hamstrings","core"]},{id:"squat_goblet",name:"Goblet Squat",difficulty:4,equipment:"gym",primary:["quadriceps","glutes"],secondary:["hamstrings","core"]},{id:"squat_front",name:"Front Squat",difficulty:6,equipment:"gym",primary:["quadriceps"],secondary:["glutes","core","upper_back"]},{id:"squat_back",name:"Back Squat",difficulty:5,equipment:"gym",primary:["quadriceps","glutes"],secondary:["hamstrings","core","erectors"]},{id:"leg_press",name:"Leg Press",difficulty:4,equipment:"gym",primary:["quadriceps","glutes"],secondary:["hamstrings"]},{id:"bulgarian_split",name:"Bulgarian Split Squat",difficulty:5,equipment:"both",primary:["quadriceps","glutes"],secondary:["hamstrings","core"]},{id:"pistol_squat",name:"Pistol Squat",difficulty:8,equipment:"bodyweight",primary:["quadriceps","glutes"],secondary:["hamstrings","core","balance"]}],_0=[{id:"hinge_basic",name:"Bodyweight Hip Hinge",difficulty:2,equipment:"bodyweight",primary:["hamstrings","glutes"],secondary:["erectors","core"]},{id:"deadlift_conventional",name:"Conventional Deadlift",difficulty:6,equipment:"gym",primary:["hamstrings","glutes","erectors"],secondary:["lats","traps","forearms"]},{id:"deadlift_romanian",name:"Romanian Deadlift (RDL)",difficulty:5,equipment:"gym",primary:["hamstrings","glutes"],secondary:["erectors","lats"]},{id:"deadlift_sumo",name:"Sumo Deadlift",difficulty:5,equipment:"gym",primary:["glutes","hamstrings","adductors"],secondary:["quadriceps","erectors"]},{id:"deadlift_trap_bar",name:"Trap Bar Deadlift",difficulty:4,equipment:"gym",primary:["quadriceps","glutes","hamstrings"],secondary:["erectors","traps"]},{id:"nordic_curl",name:"Nordic Hamstring Curl",difficulty:7,equipment:"bodyweight",primary:["hamstrings"],secondary:["glutes","core"]},{id:"leg_curl",name:"Leg Curl (Machine)",difficulty:3,equipment:"gym",primary:["hamstrings"],secondary:["calves"]}],P0=[{id:"pushup_standard",name:"Standard Push-up",difficulty:4,equipment:"bodyweight",primary:["pectorals","triceps"],secondary:["front_delts","core"]},{id:"pushup_diamond",name:"Diamond Push-up",difficulty:6,equipment:"bodyweight",primary:["triceps","pectorals"],secondary:["front_delts","core"]},{id:"pushup_archer",name:"Archer Push-up",difficulty:7,equipment:"bodyweight",primary:["pectorals","triceps"],secondary:["front_delts","core","obliques"]},{id:"bench_flat",name:"Flat Barbell Bench Press",difficulty:5,equipment:"gym",primary:["pectorals","triceps"],secondary:["front_delts"]},{id:"bench_incline",name:"Incline Bench Press",difficulty:5,equipment:"gym",primary:["upper_pectorals","front_delts"],secondary:["triceps"]},{id:"bench_decline",name:"Decline Bench Press",difficulty:4,equipment:"gym",primary:["lower_pectorals","triceps"],secondary:["front_delts"]},{id:"dumbbell_press",name:"Dumbbell Bench Press",difficulty:5,equipment:"gym",primary:["pectorals","triceps"],secondary:["front_delts","stabilizers"]},{id:"dips_chest",name:"Chest Dips",difficulty:6,equipment:"both",primary:["lower_pectorals","triceps"],secondary:["front_delts"]}],R0=[{id:"pike_pushup",name:"Pike Push-up",difficulty:5,equipment:"bodyweight",primary:["front_delts","triceps"],secondary:["upper_pectorals","core"]},{id:"handstand_wall",name:"Wall Handstand Push-up",difficulty:8,equipment:"bodyweight",primary:["front_delts","triceps"],secondary:["traps","core"]},{id:"military_press",name:"Military Press (Barbell)",difficulty:6,equipment:"gym",primary:["front_delts","triceps"],secondary:["upper_pectorals","core"]},{id:"overhead_press_db",name:"Dumbbell Shoulder Press",difficulty:5,equipment:"gym",primary:["front_delts","triceps"],secondary:["stabilizers","core"]},{id:"arnold_press",name:"Arnold Press",difficulty:6,equipment:"gym",primary:["front_delts","side_delts"],secondary:["triceps","rotator_cuff"]},{id:"push_press",name:"Push Press",difficulty:6,equipment:"gym",primary:["front_delts","triceps"],secondary:["quadriceps","core","power"]}],k0=[{id:"pullup_standard",name:"Standard Pull-up",difficulty:7,equipment:"both",primary:["lats","biceps"],secondary:["rear_delts","traps","core"]},{id:"pullup_wide",name:"Wide Grip Pull-up",difficulty:8,equipment:"both",primary:["lats","teres_major"],secondary:["biceps","rear_delts"]},{id:"pullup_chinup",name:"Chin-up (Supinated)",difficulty:6,equipment:"both",primary:["biceps","lats"],secondary:["rear_delts","core"]},{id:"pullup_neutral",name:"Neutral Grip Pull-up",difficulty:6,equipment:"both",primary:["lats","biceps"],secondary:["brachialis","rear_delts"]},{id:"lat_pulldown",name:"Lat Pulldown (Machine)",difficulty:4,equipment:"gym",primary:["lats","biceps"],secondary:["rear_delts","traps"]},{id:"assisted_pullup",name:"Assisted Pull-up",difficulty:4,equipment:"gym",primary:["lats","biceps"],secondary:["rear_delts","core"]}],C0=[{id:"row_inverted",name:"Inverted Row",difficulty:5,equipment:"both",primary:["mid_back","biceps"],secondary:["rear_delts","core"]},{id:"row_barbell",name:"Barbell Row",difficulty:6,equipment:"gym",primary:["lats","mid_back"],secondary:["biceps","erectors","rear_delts"]},{id:"row_dumbbell",name:"Dumbbell Row",difficulty:5,equipment:"gym",primary:["lats","mid_back"],secondary:["biceps","rear_delts"]},{id:"row_cable",name:"Seated Cable Row",difficulty:4,equipment:"gym",primary:["mid_back","lats"],secondary:["biceps","rear_delts"]},{id:"row_tbar",name:"T-Bar Row",difficulty:6,equipment:"gym",primary:["mid_back","lats"],secondary:["biceps","erectors"]}],E0=[{id:"plank_standard",name:"Plank",difficulty:3,equipment:"bodyweight",primary:["rectus_abdominis","transverse"],secondary:["obliques","hip_flexors"]},{id:"plank_side",name:"Side Plank",difficulty:4,equipment:"bodyweight",primary:["obliques","transverse"],secondary:["glute_medius","shoulder_stabilizers"]},{id:"leg_raise",name:"Hanging Leg Raise",difficulty:6,equipment:"both",primary:["lower_abs","hip_flexors"],secondary:["lats","grip"]},{id:"ab_wheel",name:"Ab Wheel Rollout",difficulty:7,equipment:"both",primary:["rectus_abdominis","transverse"],secondary:["lats","hip_flexors"]},{id:"crunch_cable",name:"Cable Crunch",difficulty:4,equipment:"gym",primary:["rectus_abdominis"],secondary:["obliques"]},{id:"pallof_press",name:"Pallof Press",difficulty:5,equipment:"gym",primary:["obliques","transverse"],secondary:["shoulder_stabilizers"]}];function I0(t,a){const s={lower_push:j0,lower_pull:_0,horizontal_push:P0,horizontal_pull:C0,vertical_push:R0,vertical_pull:k0,core:E0}[a];return s?s.map(i=>i.name).filter(i=>i!==t):[]}const Ia=(t,a)=>{if(t){const r=t.match(/RIR\s*(\d)/i);if(r)return parseInt(r[1])}if(a){const r=a.toLowerCase();if(r.includes("cedimento")||r.includes("failure")||r.includes("max"))return 0;if(r.includes("heavy")||r.includes("pesante"))return 1;if(r.includes("moderate")||r.includes("moderato"))return 2;if(r.includes("light")||r.includes("leggero")||r.includes("volume"))return 3}return 2},An=(t,a,r,s)=>{let i=0;return t>=8?i-=1:t>=7&&(i-=.5),a<=3?i-=1:a<=5&&(i-=.5),r==="poor"?i-=.5:r==="good"&&(i+=.25),s==="poor"?i-=.5:s==="good"&&(i+=.25),i},Mn=t=>{const a=t.trim().toLowerCase();if(a.includes("min")){const s=a.match(/(\d+)/);if(s)return parseInt(s[1])*60}const r=a.match(/(\d+)/);return r?parseInt(r[1]):90},Ln=["lower_push","lower_pull","squat","deadlift","horizontal_push","horizontal_pull","bench","row","vertical_push","vertical_pull","press","pullup"],Dn=["accessory","core","corrective","isolation"],T0=(t,a,r=!1)=>{if(a>=45)return{exercises:t,adaptationMode:"full",message:""};if(r)return a<30?{exercises:t.filter(c=>{var f,h;const u=((f=c.pattern)==null?void 0:f.toLowerCase())||"",d=((h=c.name)==null?void 0:h.toLowerCase())||"";return Dn.some(x=>u.includes(x))?!1:["squat","stacco","deadlift","panca","bench","press","row","rematore","trazioni","pullup"].some(x=>d.includes(x))||Ln.some(x=>u.includes(x))}),adaptationMode:"compound_only",message:`ðŸ¤° Gravidanza: esercizi ridotti per ${a} minuti (no superset per sicurezza)`}:{exercises:t,adaptationMode:"full",message:"ðŸ¤° Gravidanza: pause normali mantenute per sicurezza"};const s=n=>{var p,f;const c=((p=n.pattern)==null?void 0:p.toLowerCase())||"",u=((f=n.name)==null?void 0:f.toLowerCase())||"";return Ln.some(h=>c.includes(h))?!0:Dn.some(h=>c.includes(h))?!1:["squat","stacco","deadlift","panca","bench","press","row","rematore","trazioni","pullup","pull-up","dip","military"].some(h=>u.includes(h))?!0:n.weight&&Number(n.weight)>=20},i=t.filter(s),o=t.filter(n=>!s(n));if(a<30)return{exercises:i,adaptationMode:"compound_only",message:`âš¡ ModalitÃ  Express: ${o.length} esercizi complementari rimossi per rispettare i ${a} minuti`};const l=[];for(let n=0;n<o.length;n+=2){const c=o[n],u=o[n+1];if(u){const d=Math.floor(n/2)+100;l.push({...c,supersetGroup:d,rest:"60s",notes:`${c.notes||""} [SUPERSET con ${u.name}]`.trim()}),l.push({...u,supersetGroup:d,rest:c.rest,notes:`${u.notes||""} [SUPERSET]`.trim()})}else l.push(c)}return{exercises:[...i,...l],adaptationMode:"superset",message:`ðŸ”„ ModalitÃ  Superset: ${Math.floor(o.length/2)} superset creati per ottimizzare i ${a} minuti`}};function A0({open:t,onClose:a,userId:r,programId:s,dayName:i,exercises:o,onWorkoutComplete:l,onLocationChange:n,recoveryData:c,originalLocation:u="gym"}){var ki,Ci;const{t:d}=ia(),[p,f]=m.useState(!c),[h,x]=m.useState(c?c.sleepHours>=7?"good":"tired":"good"),[g,y]=m.useState((c==null?void 0:c.sleepHours)??7),[v,S]=m.useState((c==null?void 0:c.stressLevel)??5),[P]=m.useState((c==null?void 0:c.availableTime)??45),[N,I]=m.useState("normal"),[T,M]=m.useState("normal"),[D,E]=m.useState(!1),[U,W]=m.useState(!1),[C,G]=m.useState({dumbbell:!1,barbell:!1,pullUpBar:!1,rings:!1,bands:!1,kettlebell:!1,bench:!1}),[H,Y]=m.useState([]),[oe,X]=m.useState(!1),[ee,pe]=m.useState(null),[ie,ye]=m.useState("none"),[ue,Se]=m.useState(14),[$e,ze]=m.useState(!1),[oa,Oe]=m.useState(!1),[Ge,ft]=m.useState(""),[q,lt]=m.useState(75),[ls,ur]=m.useState({}),[he,Ue]=m.useState(o),[qe,Vt]=m.useState(""),[Pe,tt]=m.useState(0),[Te,ct]=m.useState(1),[Ae,Kt]=m.useState({}),[_t,la]=m.useState(null),[xt,cs]=m.useState(!1),[ca,ds]=m.useState("gym"),[Da,Ze]=m.useState(!1),[dt,ut]=m.useState(!1),[da,bt]=m.useState({}),[at,ua]=m.useState(7),[xe,ma]=m.useState(2),[Re,za]=m.useState(5),[Xe,pa]=m.useState(0),[Be,st]=m.useState(0),[Yt,Pt]=m.useState(!1),[us,vt]=m.useState(0),[ha,ga]=m.useState(!1),[ms,Oa]=m.useState(!1),[ge,ps]=m.useState(null),[Ni,hs]=m.useState({}),[mr,gs]=m.useState({}),[pr,fa]=m.useState(!1),[rt,Rt]=m.useState(0),[hr,gr]=m.useState(!1),[fs,Zt]=m.useState([]),[Le,xs]=m.useState(null),[bs,vs]=m.useState(!1),[mt,ys]=m.useState(null),[ws,xa]=m.useState(!1),[Xt,fr]=m.useState(null),[Ns,Ba]=m.useState(!1),[Fa,kt]=m.useState({}),[Ss,Ct]=m.useState(!1),[$a,js]=m.useState([]),[ba,qa]=m.useState(!1),[Et,Ha]=m.useState(!1),[_s,Wa]=m.useState(!1),[Ps,It]=m.useState(!1),[xr,br]=m.useState([]),[j,B]=m.useState(!1),[A,ae]=m.useState(null),[Z,le]=m.useState(null),[Q,me]=m.useState(0),[V,be]=m.useState(null),w=he[Pe],de=he.length,fe=typeof(w==null?void 0:w.reps)=="number"?w.reps:parseInt(((ki=w==null?void 0:w.reps)==null?void 0:ki.split("-")[0])||"10"),ve=w?ro(w.name):null,[Me,Tt]=m.useState({}),Ce=Me[w==null?void 0:w.name]||(w==null?void 0:w.sets)||3,it=(w==null?void 0:w.supersetGroup)!==void 0,He=()=>{if(!it||!w)return!0;const b=w.supersetGroup;return!he.slice(Pe+1).find(k=>k.supersetGroup===b)},Qe=()=>{if(!it||!w)return null;const b=w.supersetGroup;return he.slice(Pe+1).find(_=>_.supersetGroup===b)||null},[vr,At]=m.useState([]);m.useEffect(()=>{(async()=>{var _,k,R;try{const{data:O}=await ne.auth.getUser();if(O.user){const{data:z}=await ne.from("user_profiles").select("onboarding_data").eq("user_id",O.user.id).single();if(z!=null&&z.onboarding_data){const se=z.onboarding_data;if(((_=se.personalInfo)==null?void 0:_.gender)==="F"&&Oe(!0),se.goal&&ft(se.goal),(k=se.personalInfo)!=null&&k.weight){const J=Number(se.personalInfo.weight);J>0&&J<300&&(lt(J),console.log(`âš–ï¸ User bodyweight: ${J}kg`))}}const{data:K}=await ne.from("user_programs").select("screening_data").eq("user_id",O.user.id).order("created_at",{ascending:!1}).limit(1).single();if((R=K==null?void 0:K.screening_data)!=null&&R.patternBaselines){const se=K.screening_data.patternBaselines,J={};Object.entries(se).forEach(([we,te])=>{te!=null&&te.weight10RM&&te.weight10RM>0&&(J[we]=te.weight10RM,console.log(`ðŸ‹ï¸ Real load for ${we}: ${te.weight10RM}kg (from test)`))}),Object.keys(J).length>0&&(ur(J),console.log("ðŸ“Š Real loads from screening:",J))}}}catch(O){console.error("Error fetching user data:",O)}})()},[]),m.useEffect(()=>{if(c&&!_t){const b=Ra(Ge),_=T0(o,P,b);(_.exercises.length!==he.length||_.message)&&(Ue(_.exercises),Vt(_.message),console.log(`â±ï¸ Time adaptation (${P}min, pregnancy=${b}):`,_.message))}},[c,P,Ge,o,_t]),m.useEffect(()=>{c&&!p&&!_t&&(qe&&re.info(qe,{duration:5e3}),la(new Date),(async()=>{try{const{workoutId:_,error:k}=await Oi({userId:r,programId:s,dayName:i,totalExercises:he.length,mood:c.sleepHours>=7?"good":"tired",sleepQuality:c.sleepHours,notes:c.hasInjury?`Injury: ${c.injuryDetails}`:void 0});_&&(le(_),console.log("[ProgressiveWorkout] Auto-started with ID:",_))}catch(_){console.error("[ProgressiveWorkout] Failed to start:",_)}})())},[c,p,_t,qe,r,s,i,he.length]),m.useEffect(()=>{if(!r||!t)return;(async()=>{try{(await Promise.all(o.map(k=>Gs.getPainThreshold(r,k.name)))).forEach((k,R)=>{k&&k.last_pain_level>0&&(console.log(`ðŸ©¹ Pain threshold found for ${o[R].name}:`,k),k.last_safe_weight&&console.log(`   Safe weight: ${k.last_safe_weight}kg`),k.needs_physiotherapist_contact&&re.warning(`âš ï¸ ${o[R].name}: contatta fisioterapista (dolore precedente ${k.last_pain_level}/10)`,{duration:8e3}))})}catch(_){console.error("Error fetching pain thresholds:",_)}})()},[r,t,o]),m.useEffect(()=>{if(!r||!s||!t)return;(async()=>{try{const{data:_,error:k}=await gh(ne,r,s);if(k){console.error("[ExerciseModifications] Error loading:",k);return}if(_&&_.length>0){const R={},O={};_.forEach(se=>{R[se.exercise_name]=se,se.tempo_changed&&se.tempo_modifier_id&&se.tempo_modifier_id!=="standard"&&(O[se.exercise_name]=se.tempo_modifier_id)}),gs(R),bt(O),console.log("[ExerciseModifications] Loaded:",_.length,"modifications");const z=Object.keys(O).length,K=_.filter(se=>se.variant_changed).length;(z>0||K>0)&&re.info(`ðŸ“‹ ${_.length} modifiche caricate: ${z} TUT, ${K} varianti`,{duration:4e3})}}catch(_){console.error("[ExerciseModifications] Error:",_)}})()},[r,s,t]);const Ve=async()=>{try{W(!0),console.log("ðŸ‹ï¸ Switching location for this SESSION ONLY (temporary)"),console.log("Equipment selected:",C),console.log("Current exercises:",he.map(K=>`${K.name} (${K.pattern})`));const b={barbell:!1,dumbbellMaxKg:C.dumbbell?30:0,kettlebellKg:C.kettlebell?[16,24]:void 0,bands:C.bands||!1,pullupBar:C.pullUpBar||!1,bench:!1},k=C.dumbbell||C.bands||C.pullUpBar||C.kettlebell?"with_equipment":"bodyweight";console.log("ðŸ  Home type:",k),console.log("ðŸ› ï¸ Equipment config:",b),console.log(`âš–ï¸ User bodyweight: ${q}kg`),console.log("ðŸ“Š Real loads from tests:",ls);const R=yo(he,{location:"home",homeType:k,equipment:b,userBodyweight:q,realLoads:ls}),O=[];R.forEach((K,se)=>{K.name!==he[se].name&&(O.push(`${he[se].name} â†’ ${K.name}`),console.log(`ðŸ”„ ${he[se].pattern}: ${he[se].name} â†’ ${K.name}`))});const z=R.map((K,se)=>({...he[se],name:K.name,notes:K.name!==he[se].name?`Adattato da: ${he[se].name}. ${he[se].notes||""}`:he[se].notes}));Ue(z),cs(!0),ds("home"),E(!1),W(!1),O.length>0?re.success("ðŸ  Location cambiata per questa sessione!",{description:`${O.length} esercizi adattati per casa`}):re.success("ðŸ  Location cambiata!",{description:"Esercizi giÃ  compatibili con allenamento casa"}),console.log("âœ… Session exercises adapted for home:",z),console.log("ðŸ“ Changes made:",O)}catch(b){console.error("âŒ Error switching location:",b),re.error("Errore durante cambio location"),W(!1)}},yt=b=>{H.find(k=>k.area===b)?(Y(k=>k.filter(R=>R.area!==b)),pe(null)):(Y(k=>[...k,{area:b,intensity:5}]),pe(b))},pt=(b,_)=>{Y(k=>k.map(R=>R.area===b?{...R,intensity:_}:R))},Si=b=>{const _=b.name.toLowerCase(),k=b.pattern;let R=[],O=[],z="medium",K=[];return k==="vertical_push"?(R=["shoulder"],O=["elbow","upper_back"],K=["shoulder","upper_back","core"],z=_.includes("bilanciere")||_.includes("handstand")?"high":"medium"):k==="horizontal_push"?(R=["shoulder","elbow"],O=["wrist","upper_back"],K=["shoulder","upper_back","core"],z=_.includes("panca")||_.includes("bilanciere")?"high":"medium"):k==="vertical_pull"?(R=["shoulder","upper_back"],O=["elbow","neck"],K=["shoulder","upper_back","core","elbow"],z=_.includes("trazioni")||_.includes("pull-up")?"high":"medium"):k==="horizontal_pull"?(R=["upper_back","shoulder"],O=["elbow","lower_back"],K=["upper_back","shoulder","core","lower_back"],z=_.includes("bilanciere")?"high":"medium"):k==="lower_push"?(R=["knee","hip"],O=["ankle","lower_back"],K=["ankle","knee","hip","core","lower_back"],z=_.includes("bilanciere")||_.includes("squat")?"high":"medium"):k==="lower_pull"&&(R=["hip","lower_back"],O=["knee","upper_back"],K=["ankle","knee","hip","lower_back","core"],z=_.includes("stacchi")||_.includes("deadlift")?"high":"medium"),{primaryJoints:R,secondaryJoints:O,loadLevel:z,kinecticChain:K}},Rs=b=>({shoulder:["Face Pulls 2x15","Band Pull-Aparts 2x20","Wall Slides 2x10","Scapular Push-ups 2x12"],upper_back:["Cat-Cow 2x10","Thoracic Rotations 2x8/side","Foam Roll T-Spine 3min"],lower_back:["Dead Bugs 2x10/side","Bird Dogs 2x10/side","Cat-Cow 2x10","Side Plank 2x20s/side"],hip:["Hip 90/90 Stretch 2x30s/side","Clamshells 2x15","Hip Bridges 2x15"],knee:["Terminal Knee Extensions 2x15","Wall Sits 2x30s","VMO Activation Drills"],ankle:["Ankle Circles 2x10/direction","Calf Raises 2x15","Ankle Dorsiflexion Stretch 2x30s"],elbow:["Wrist Curls 2x15","Forearm Stretches 2x30s","Elbow Circles 2x10"],wrist:["Wrist Circles 2x10","Prayer Stretches 2x30s","Fist Pumps 2x20"],neck:["Neck Retractions 2x10","Chin Tucks 2x10","Gentle Neck Rotations 2x5/side"]})[b]||[],ks=b=>{if(H.length===0)return b;console.log("ðŸ©¹ Adapting exercises with biomechanical intelligence:",H);const _=[];H.forEach(({area:R,intensity:O})=>{if(O>=4){const z=Rs(R);z.length>0&&z.forEach(K=>{_.push({name:K,pattern:"corrective",sets:2,reps:"10-15",rest:"30s",intensity:"Low",notes:`ðŸ©¹ Correttivo per ${R} - Esegui con focus sulla qualitÃ `})})}});const k=b.map(R=>{let O={...R},z=[];const K=Si(R);return H.forEach(({area:se,intensity:J})=>{const we=K.primaryJoints.includes(se),te=K.secondaryJoints.includes(se),_e=K.kinecticChain.includes(se);if(!(!we&&!te&&!_e))switch(se){case"shoulder":if(["vertical_push","horizontal_push","vertical_pull"].includes(R.pattern))if(J>=7){const je={"Military Press":"Lateral Raises (leggero)","Shoulder Press Manubri":"Front Raises","Panca Piana":"Push-up su Ginocchia (ROM ridotto)",Trazioni:"Lat Machine (ROM ridotto)","Pike Push-up":"Shoulder Mobility Work"};je[R.name]&&(O.name=je[R.name],z.push("âš ï¸ DOLORE SPALLA: Esercizio sostituito"))}else J>=4?(O.sets=Math.max(1,R.sets-1),O.intensity="RPE 5-6 (ridotto)",z.push("ðŸ©¹ Dolore spalla: -1 set, intensitÃ  ridotta")):z.push("âš¡ Dolore spalla lieve: Warm-up scapolare 5min");break;case"elbow":["horizontal_push","vertical_pull","horizontal_pull"].includes(R.pattern)&&(J>=7?(O.reps=typeof R.reps=="number"?Math.floor(R.reps*.7):R.reps,O.intensity="RPE 4-5 (molto ridotto)",z.push("âš ï¸ DOLORE GOMITO: Volume ridotto 30%")):J>=4&&z.push("ðŸ©¹ Dolore gomito: ROM ridotto, no lockout"));break;case"wrist":R.pattern==="horizontal_push"&&(J>=7?R.name.includes("Push-up")&&(O.name="Push-up su Pugni Chiusi",z.push("âš ï¸ DOLORE POLSO: Push-up su pugni")):J>=4&&z.push("ðŸ©¹ Dolore polso: Usa wrist wraps o pugni chiusi"));break;case"lower_back":if(["lower_pull","lower_push"].includes(R.pattern))if(J>=7){const je={"Squat (Bilanciere)":"Goblet Squat (leggero)","Stacchi Rumeni":"Glute Bridge","Good Morning":"Bird Dog (isometrico)"};je[R.name]&&(O.name=je[R.name],z.push("âš ï¸ DOLORE SCHIENA: Esercizio sostituito"))}else J>=4?(O.sets=Math.max(2,R.sets-1),z.push("ðŸ©¹ Dolore schiena: ROM ridotto, no flexion completa")):z.push("âš¡ Dolore schiena lieve: Warm-up core 5min");break;case"knee":if(R.pattern==="lower_push")if(J>=7){const je={"Squat (Bilanciere)":"Wall Sit (isometrico)","Bulgarian Split Squat":"Step-up (basso)","Leg Press":"Leg Extension (leggero)"};je[R.name]&&(O.name=je[R.name],z.push("âš ï¸ DOLORE GINOCCHIO: Esercizio sostituito"))}else J>=4&&z.push("ðŸ©¹ Dolore ginocchio: ProfonditÃ  ridotta (1/2 squat)");break;case"hip":R.pattern==="lower_push"&&J>=4&&z.push("ðŸ©¹ Dolore anca: ROM ridotto, stance piÃ¹ stretta");break;case"upper_back":["horizontal_pull","vertical_pull"].includes(R.pattern)&&(J>=7?(O.sets=Math.max(1,R.sets-1),O.intensity="RPE 5-6 (ridotto)",z.push("âš ï¸ DOLORE DORSO: Volume ridotto, evita sovraccarico")):J>=4?z.push("ðŸ©¹ Dolore dorso: ROM controllato, no overstretch"):z.push("âš¡ Dolore dorso lieve: Warm-up scapole + thoracic mobility"));break;case"ankle":if(R.pattern==="lower_push")if(J>=7){const je={"Squat (Bilanciere)":"Leg Press (piedi alti)","Bulgarian Split Squat":"Leg Extension","Air Squat + Jump":"Seated Leg Press","Pistol Squat Assistito":"Single Leg Press"};je[R.name]&&(O.name=je[R.name],z.push("âš ï¸ DOLORE CAVIGLIA: Esercizio sostituito (no ankle mobility)"))}else J>=4?z.push("ðŸ©¹ Dolore caviglia: ROM ridotto, stance piÃ¹ ampia, talloni rialzati"):z.push("âš¡ Dolore caviglia lieve: Warm-up ankle mobility 5min");break;case"neck":R.pattern==="vertical_pull"&&J>=4&&z.push("ðŸ©¹ Dolore collo: Testa neutra, no protrazione");break}}),z.length>0&&(O.notes=z.join(" | ")+(R.notes?` | ${R.notes}`:"")),O});return[..._,...k]},Cs=b=>{if(ie==="none")return b;console.log("ðŸ©¸ Adapting exercises for menstrual cycle:",ie,`Day ${ue}`);let _=1,k="",R=[];switch(ie){case"follicular":_=1,k="RPE 7-9 (normal/alto)",R.push("ðŸ’ª Fase Follicolare: Energia alta, ottimale per progressione");break;case"ovulation":_=1.1,k="RPE 8-9 (push it!)",R.push("ðŸ”¥ Ovulazione: Picco energia, max performance");break;case"luteal":_=.85,k="RPE 6-7 (moderato)",R.push("âš ï¸ Fase Luteale: Energia ridotta, focus su tecnica");break;case"menstrual":_=.7,k="RPE 4-6 (leggero)",R.push("ðŸ©¸ Mestruale: Riduci intensitÃ , ascolta il corpo");break;case"menopause":_=.95,k="RPE 6-7 (moderato, focus resistenza)",R.push("ðŸ§˜â€â™€ï¸ Menopausa: Focus resistenza e densitÃ  ossea, +20% rest");break}return b.map(O=>{var K;const z={...O};return ie==="ovulation"?z.sets=Math.min(O.sets+1,O.sets+1):ie==="luteal"?(z.sets=Math.max(Math.floor(O.sets*_),2),z.rest=va(O.rest)):ie==="menstrual"?(z.sets=Math.max(Math.floor(O.sets*_),1),z.rest=va(O.rest),O.pattern==="core"&&ue<=3&&(z.intensity="RPE 3-4 (molto leggero)",z.notes="ðŸ©¸ Crampi? Sostituisci con stretching dolce | "+(O.notes||""))):ie==="menopause"&&(z.sets=Math.max(Math.floor(O.sets*_),2),z.rest=va(O.rest)),k&&ie!=="follicular"&&(z.intensity=k),R.length>0&&!((K=z.notes)!=null&&K.includes(R[0]))&&(z.notes=R[0]+(z.notes?` | ${z.notes}`:"")),z})},va=b=>`${parseInt(b.replace(/\D/g,""))+30}s`,Es=async()=>{let b=he;if(H.length>0&&(b=ks(b),re.success("ðŸ©¹ Esercizi adattati per dolore",{description:`${H.length} zona/e con adattamenti`})),ie!=="none"){b=Cs(b);const _={follicular:"ðŸ’ª Fase Follicolare: Energia ottimale",ovulation:"ðŸ”¥ Ovulazione: Picco performance",luteal:"âš ï¸ Fase Luteale: Ridotta intensitÃ  15%",menstrual:"ðŸ©¸ Mestruale: Ridotto volume 30%"};re.info(_[ie],{description:`Giorno ${ue} del ciclo`})}Ue(b),f(!1),Wa(!0)},Ga=async b=>{Wa(!1),Ha(b),la(new Date);try{const{workoutId:R,error:O}=await Oi({userId:r,programId:s,dayName:i,totalExercises:he.length,mood:h,sleepQuality:g,notes:H.length>0?`Pain areas: ${H.map(z=>`${z.area}(${z.intensity})`).join(", ")}`:void 0});R?(le(R),console.log("[ProgressiveWorkout] Workout started with ID:",R)):console.error("[ProgressiveWorkout] Failed to create workout:",O)}catch(R){console.error("[ProgressiveWorkout] Error starting workout:",R)}const _=H.length>0?` â€¢ Pain: ${H.map(R=>R.area).join(", ")}`:"",k=ie!=="none"?` â€¢ Cycle: ${ie} (day ${ue})`:"";re.success("ðŸ’ª Workout iniziato!",{description:`Mood: ${h} â€¢ Sleep: ${g}/10${xt?" â€¢ Casa":""}${_}${k}`})};m.useEffect(()=>{if(Z&&!p){const b=Object.keys(Ae).length;Kc(Z,Pe,Te,b).then(_=>{_&&console.log(`[ProgressiveWorkout] Progress updated: Ex ${Pe+1}/${de}, Set ${Te}`)}).catch(_=>{console.error("[ProgressiveWorkout] Error updating progress:",_)})}},[Z,Pe,Te,p]),m.useEffect(()=>{if(Yt){const b=setInterval(()=>{vt(_=>_<=1?(Pt(!1),re.success("â° Rest completato!",{description:"Pronto per il prossimo set"}),0):_-1)},1e3);return()=>clearInterval(b)}},[Yt]);const Ua=async b=>{try{const{error:_}=await ne.from("rir_safety_alerts").insert({user_id:r,program_id:s,workout_log_id:Z,...b});_?console.error("[RIR Safety] Failed to save alert:",_):console.log("[RIR Safety] Alert saved:",b.severity,b.exercise_name)}catch(_){console.error("[RIR Safety] Error saving alert:",_)}},Va=async b=>{if(!w)return;const _=typeof w.reps=="number"?w.reps:parseInt(String(w.reps).split("-")[0])||10,k=w.targetRir??Ia(w.notes,w.intensity),R=typeof Be=="number"?Be:parseFloat(String(Be))||0,z=sn(w.name)?"bodyweight":"weighted",K=b??xe,se=K-k,J=Object.values(mr).find(te=>te.current_variant===w.name||te.exercise_name===w.name);if(se<=-2){const te=Qp({exerciseName:w.name,exercisePattern:w.pattern,exerciseType:z,targetReps:_,targetRIR:k,actualRIR:K,currentWeight:R,location:ca});te.needsDowngrade&&(te.severity==="critical"?re.error(te.userMessage,{duration:1e4}):re.warning(te.userMessage,{duration:6e3}),re.info(eh(te.severity),{duration:8e3}),te.newWeight&&(kt(_e=>({..._e,[w.name]:te.newWeight})),st(te.newWeight)),bt(_e=>{const je={..._e};return delete je[w.name],je}),await hn(ne,{user_id:r,program_id:s,cycle_number:1,exercise_name:w.name,exercise_pattern:w.pattern,original_variant:te.newVariant?w.name:void 0,current_variant:te.newVariant||w.name,variant_changed:!!te.newVariant,original_tempo:"2-0-1-0",current_tempo:"2-0-1-0",tempo_modifier_id:void 0,tempo_changed:!1,original_weight:R,current_weight:te.newWeight,weight_reduction_percent:te.weightReductionPercent,original_reps:_,current_reps:te.newReps,reason:"rir_exceeded_downgrade",severity:te.severity,rir_target:k,rir_actual:K}),await Ua({exercise_name:w.name,exercise_pattern:w.pattern,set_number:Te,target_rir:k,actual_rir:K,target_reps:_,actual_reps:Xe,weight_used:R||void 0,severity:te.severity,auto_adjustment_applied:!0,adjustment_details:{type:"downgrade",new_variant:te.newVariant,new_weight:te.newWeight,new_reps:te.newReps}}),console.log("[Downgrade] Applied:",te))}else if(se>=2){const te=Jp({exerciseName:w.name,exercisePattern:w.pattern,exerciseType:z,targetRIR:k,actualRIR:K,targetReps:_,currentWeight:R,activeModification:J?{original_variant:J.original_variant||void 0,current_variant:J.current_variant,tempo_modifier_id:J.tempo_modifier_id||void 0,original_weight:J.original_weight||void 0,current_weight:J.current_weight||void 0,original_reps:J.original_reps||void 0}:void 0,location:ca});te.canUpgrade&&(re.success(te.userMessage,{duration:8e3}),te.upgradeType==="add_tut"?(bt(_e=>({..._e,[w.name]:te.newTempo.id})),await hn(ne,{user_id:r,program_id:s,cycle_number:1,exercise_name:w.name,exercise_pattern:w.pattern,original_variant:void 0,current_variant:w.name,variant_changed:!1,original_tempo:"2-0-1-0",current_tempo:te.newTempo.tempo,tempo_modifier_id:te.newTempo.id,tempo_changed:!0,original_weight:R,current_weight:R,original_reps:_,current_reps:te.newReps,reason:"rir_high_add_tut",severity:"warning",rir_target:k,rir_actual:K}),console.log("[Upgrade] Added TUT:",te.newTempo)):(te.upgradeType==="upgrade_variant"||te.upgradeType==="increase_weight")&&(bt(_e=>{const je={..._e};return delete je[w.name],te.newVariant&&delete je[te.newVariant],je}),te.newWeight&&kt(_e=>({..._e,[w.name]:te.newWeight})),J!=null&&J.id&&(await hh(ne,J.id),gs(_e=>{const je={..._e},Ke=Object.keys(_e).find(Ka=>_e[Ka].id===J.id);return Ke&&delete je[Ke],je}),console.log("[Upgrade] Removed modification, upgraded to:",te))))}else se===-1?(re.warning("âš ï¸ Sei andato leggermente oltre il limite",{description:`Hai fatto RIR ${K} invece di RIR ${k}. La prossima volta fermati 1 rep prima.`,duration:6e3}),await Ua({exercise_name:w.name,exercise_pattern:w.pattern,set_number:Te,target_rir:k,actual_rir:K,target_reps:_,actual_reps:Xe,weight_used:R||void 0,severity:"warning",auto_adjustment_applied:!1})):console.log(`[RIR] OK: ${K} vs target ${k}`);const we={set_number:Te,reps_completed:Xe,weight_used:Be||void 0,rpe:at,rir_perceived:K,adjusted:!1};Kt(te=>({...te,[w.name]:[...te[w.name]||[],we]})),Z&&Bi({workout_log_id:Z,exercise_name:w.name,exercise_index:Pe,set_number:Te,reps_completed:Xe,weight_used:Be||void 0,rpe:at,rir:K,was_adjusted:!1}).then(te=>{te&&console.log(`[ProgressiveWorkout] Set saved from RIR validation: ${w.name} Set ${Te}`)}).catch(te=>{console.error("[ProgressiveWorkout] Error saving set:",te)}),pa(0),st(0),ua(7),ma(2),Is(!0)},Is=(b=!1)=>{if(Xe===0){re.error("Inserisci il numero di reps completate");return}if(!w)return;if(Ae[w.name]||Kt(k=>({...k,[w.name]:[]})),it&&!He()){const k={set_number:Te,reps_completed:Xe,weight_used:Be||void 0,rpe:0,rir_perceived:0,adjusted:!1};Kt(O=>({...O,[w.name]:[...O[w.name]||[],k]}));const R=Qe();if(R){const O=he.findIndex(z=>z.name===R.name);O!==-1&&(tt(O),re.info(`âš¡ Superset: ${R.name}`,{duration:2e3}))}pa(0),st(0);return}if(Te<Ce||Pe<de-1){let k=Mn(w.rest);ie==="menopause"&&(k=Math.round(k*1.2)),vt(k),Pt(!0),console.log(`â±ï¸ Rest timer started: ${k}s`)}b?yr():Ze(!0)},Ts=(b,_)=>{console.log("ðŸ”„ Hybrid Recovery activated:",{bodyArea:b,affectedExercises:_,currentExercise:w==null?void 0:w.name}),re.success(`âœ… Recovery Mode attivato per ${b}. ${_.length} esercizi coinvolti.`,{duration:6e3}),xa(!1),Pe<de-1&&(tt(k=>k+1),ct(1),Ze(!1),ut(!1),bt(null),Rt(0),Zt([]))},As=()=>{console.log("â­ï¸ Exercise skipped without recovery activation"),xa(!1),wa("fatigue")},ya=()=>{if(!(!ge||!w)){if(ge.action==="downgrade"&&ge.newExercise){const b=he.map((_,k)=>k===Pe?{..._,name:ge.newExercise,notes:`Adattato da ${w.name} (difficoltÃ  ridotta)`}:_);Ue(b),hs(_=>({..._,[w.name]:{adjusted:!0,originalName:w.name}})),re.success(`ðŸ”„ Esercizio adattato: ${ge.newExercise}`,{description:"Versione piÃ¹ gestibile per questa sessione"})}else ge.action==="reduce_weight"&&ge.newWeight&&(st(ge.newWeight),hs(b=>({...b,[w.name]:{adjusted:!0,originalName:w.name,newWeight:ge.newWeight}})),re.info(`âš–ï¸ Peso ridotto a ${ge.newWeight}kg`,{description:"Per le prossime serie"}));Oa(!1),ps(null)}},ji=()=>{Oa(!1),ps(null)},Zl=async()=>{if(!V||!w)return;let b="",_="";if(V.type==="reduce"&&V.newSets?(Tt(k=>({...k,[w.name]:V.newSets})),b="Volume ridotto",_=`${w.name}: ${V.newSets} sets`):V.type==="increase"&&V.newSets&&(Tt(k=>({...k,[w.name]:V.newSets})),b="Volume aumentato",_=`${w.name}: ${V.newSets} sets`),V.weightAdjustment&&V.weightAdjustment!==0){const k=typeof w.weight=="number"?w.weight:parseFloat(String(w.weight))||0;if(k>0){const R=Math.round(k*(1+V.weightAdjustment/100)*2)/2;kt(O=>({...O,[w.name]:R}));try{await Xl(w.name,R,V.weightAdjustment),V.weightAdjustment>0?(b=b||"Peso aumentato",_=`${w.name}: ${k}kg â†’ ${R}kg (+${V.weightAdjustment}%)`):(b=b||"Peso ridotto",_=`${w.name}: ${k}kg â†’ ${R}kg (${V.weightAdjustment}%)`),console.log(`[RIR Adjustment] Persisted weight change for ${w.name}: ${k}kg â†’ ${R}kg`)}catch(O){console.error("[RIR Adjustment] Failed to persist weight change:",O),re.error("Errore nel salvare l'aggiustamento")}}}b&&re.success(b,{description:_}),Kt(k=>{const R=k[w.name]||[],O=R[R.length-1];return O&&(O.adjusted=!0,O.adjustment_reason=V.message),{...k}}),be(null),yr()},Xl=async(b,_,k)=>{try{const{data:R,error:O}=await ne.from("training_programs").select("*").eq("id",s).single();if(O||!R)throw new Error("Failed to fetch program");const z=Zc(R);if(!z)throw new Error("Failed to normalize program");const K=Xc(z,b,_,`Auto-adjusted ${k>0?"+":""}${k}% (RIR feedback)`),se=Qc(K),{error:J}=await ne.from("training_programs").update(se).eq("id",s);if(J)throw J;await ne.from("program_adjustments").insert({user_id:r,program_id:s,trigger_type:k>0?"low_rpe":"high_rpe",avg_rpe_before:at,sessions_analyzed:1,adjustment_type:k>0?"increase_volume":"decrease_volume",volume_change_percent:k,exercises_affected:[{exercise_name:b,pattern:w==null?void 0:w.pattern,avg_rpe:at,old_weight:w==null?void 0:w.weight,new_weight:_,reason:`RIR ${xe} feedback`}],applied:!0,user_accepted:!0}).catch(we=>{console.warn("[RIR Adjustment] Failed to log adjustment:",we)}),localStorage.removeItem("currentProgram"),console.log(`[RIR Adjustment] âœ… Persisted: ${b} â†’ ${_}kg (${k>0?"+":""}${k}%)`)}catch(R){throw console.error("[RIR Adjustment] Error persisting weight adjustment:",R),R}},Ql=()=>{be(null),yr()},yr=()=>{if(w){if(it&&He()){const b=w.supersetGroup,_=he.find(k=>k.supersetGroup===b);if(_&&Te<Ce){const k=he.findIndex(R=>R.name===_.name);if(k!==-1){tt(k),ct(R=>R+1),re.info(`ðŸ”„ Set ${Te+1} - Superset`,{duration:2e3});return}}}if(Te<Ce)ct(b=>b+1);else if(Pe<de-1){let b=Pe+1;if(it){const _=w.supersetGroup;for(;b<de&&he[b].supersetGroup===_;)b++}b<de?(tt(b),ct(1),re.success(`âœ… ${w.name} completato!`,{description:"Prossimo esercizio"})):Mt()}else Mt()}},Jl=b=>{b<0||b>=he.length||(tt(b),ct(1),pa(0),st(0),ua(7),ma(2),Ze(!1),ut(!1),Pt(!1),vt(0),qa(!1),re.info(`â­ï¸ Passato a: ${he[b].name}`,{duration:2e3}))},ec=b=>({neck:"neck",shoulder:"shoulder",elbow:"elbow",wrist:"wrist",scapula:"upper_back",thoracic_spine:"upper_back",upper_back:"upper_back",lower_back:"lower_back",hip:"hip",knee:"knee",ankle:"ankle"})[b]||"lower_back",_i=async b=>{var _,k;if(!(!Le||!w)){switch(console.log(`ðŸ©¹ User choice: ${b}`),vs(!1),b){case"continue_normal":re.info("ðŸ‘ Continui normalmente. Monitora il fastidio.",{duration:3e3});break;case"continue_adapted":const R=((_=Le.autoAdaptations)==null?void 0:_.load)||20,O=Be?Math.round(Be*(1-R/100)/2.5)*2.5:void 0;O&&(re.warning(`âš ï¸ Carico ridotto: ${Be}kg â†’ ${O}kg (-${R}%)`,{duration:5e3}),kt(z=>({...z,[w.name]:O}))),Zt([...fs,{type:"weight_reduced",from:Be,to:O,reason:`pain_${rt}`,timestamp:new Date().toISOString()}]);break;case"substitute_exercise":if(mt){const z=Gs.findSubstitute(w.name,mt,rt);z.found&&z.substitute?(Ue(K=>K.map((se,J)=>J===Pe?{...se,name:z.substitute,notes:`ðŸ”„ Sostituito: ${w.name}`}:se)),re.success(`ðŸ”„ ${w.name} â†’ ${z.substitute}`,{duration:5e3})):re.error("Nessuna alternativa disponibile. Considera di saltare.",{duration:5e3})}break;case"skip_exercise":re.info(`â­ï¸ ${w.name} saltato`,{duration:3e3}),Pe<de-1?(tt(z=>z+1),ct(1),Ze(!1),ut(!1),Rt(0),Zt([])):Mt();break;case"skip_area":mt&&(re.warning(`ðŸ›‘ Tutti gli esercizi per ${((k=Go[mt])==null?void 0:k.it)||mt} saranno saltati`,{duration:5e3}),Y(z=>[...z.filter(K=>ec(K.area)!==mt),{area:mt,intensity:10}])),_i("skip_exercise");break;case"end_session":re.info("ðŸ‘‹ Sessione terminata. Il recupero Ã¨ parte dell'allenamento!",{duration:5e3}),Mt();break}xs(null),ys(null)}},Mt=async()=>{if(!_t){Z&&(console.log("[ProgressiveWorkout] Abandoning workout due to early termination"),await Jc(Z)),a();return}const b=Math.round((new Date().getTime()-_t.getTime())/1e3/60),_=tc();re.success("ðŸŽ‰ Workout completato!",{description:`${b} minuti â€¢ RPE medio: ${_}`});try{const k=Object.entries(Ae).filter(([,J])=>J&&J.length>0).map(([J,we])=>{var je;const te=he.find(Ke=>Ke.name===J),_e=we.reduce((Ke,Ka)=>Ke+Ka.rpe,0)/we.length;return{exercise_name:J,pattern:te.pattern,sets_completed:we.length,reps_completed:Math.round(we.reduce((Ke,Ka)=>Ke+Ka.reps_completed,0)/we.length),weight_used:(je=we[0])==null?void 0:je.weight_used,exercise_rpe:_e,difficulty_vs_baseline:_e>8?"harder":_e<5?"easier":"as_expected",notes:we.some(Ke=>Ke.adjusted)?"Volume auto-adjusted during workout":""}}),R=H.length>0?`Pain areas: ${H.map(J=>`${J.area}(${J.intensity}/10)`).join(", ")}`:"",O=`Context: stress=${v}/10, nutrition=${N}, hydration=${T}`,z=An(v,g,N,T),K=Math.max(1,Math.min(10,_+z)),se=["Live workout with real-time RPE feedback",R,O,z!==0?`RPE adjusted by ${z>0?"+":""}${z.toFixed(1)} for context`:""].filter(Boolean).join(" | ");Z&&(await ed(Z,{sessionRpe:K,durationMinutes:b,exercisesCompleted:Object.keys(Ae).length,notes:se}),console.log("[ProgressiveWorkout] Workout completed and finalized")),await Za.logWorkout(r,s,{day_name:i,split_type:(w==null?void 0:w.pattern)||"Full Body",session_duration_minutes:b,session_rpe:K,exercises:k,mood:h,sleep_quality:g,notes:se,stress_level:v,nutrition_quality:N,hydration:T,context_adjustment:z,is_location_adapted:xt,original_location:u,actual_location:ca,exclude_from_progression:xt});for(const J of k){const we=J.exercise_rpe;(we>=9||we<=5)&&console.log(`[Calibrazione] ${J.exercise_name}: RPE ${we.toFixed(1)} fuori range â†’ suggerito adattamento peso ${we>=9?"-5%":"+5%"} per prossima sessione`),!J.weight_used&&we!==void 0&&(we>=9?console.log(`[Calibrazione BW] ${J.exercise_name}: troppo difficile â†’ considera regressione`):we<=5&&console.log(`[Calibrazione BW] ${J.exercise_name}: troppo facile â†’ considera progressione`))}l&&l(k),a()}catch(k){console.error("Error saving workout:",k),re.error("Errore salvataggio workout")}},tc=()=>{const b=Object.values(Ae).flatMap(_=>_.map(k=>k.rpe));return b.length===0?7:Math.round(b.reduce((_,k)=>_+k,0)/b.length*10)/10},ac=()=>{It(!0)},wa=async(b,_,k)=>{if(w){It(!1);try{const{alert:R}=await td(r,w.name,w.pattern,{programId:s,skipReason:b,painArea:_,painLevel:k,dayName:i});R?(ae(R),B(!0),re.warning(`Hai saltato esercizi per ${jr[R.muscle_group]} nelle ultime ${R.consecutive_sessions} sedute`,{duration:5e3})):re.info("Esercizio saltato. Passiamo al prossimo.",{duration:3e3}),console.log(`[SkipTracking] Exercise skipped: ${w.name}, reason: ${b}`)}catch(R){console.error("[SkipTracking] Error logging skip:",R),re.info("Esercizio saltato. Passiamo al prossimo.",{duration:3e3})}Pe<de-1?(tt(R=>R+1),ct(1),Ze(!1),ut(!1),bt(null),Rt(0),Zt([])):Mt()}},Pi=async b=>{A&&(await ad(A.id,b?"accepted":"declined"),b&&A.load_reduction_percent&&re.success(`Carico ridotto del ${A.load_reduction_percent}% per ${jr[A.muscle_group]}`,{duration:5e3}),B(!1),ae(null))},sc=b=>{if(!w)return;const _=Fa[w.name]||(typeof w.weight=="number"?w.weight:parseFloat(String(w.weight))||0),k=Math.round(_*(1-b/100)*10)/10;kt(R=>({...R,[w.name]:k})),st(k),re.success(`ðŸ’ª Peso ridotto: ${_}kg â†’ ${k}kg (-${b}%)`),console.log(`[DISLIKE] Weight reduced for ${w.name}: ${_}kg â†’ ${k}kg`)},rc=b=>{if(!w)return;const _=I0(w.name,w.pattern);if(_&&_.length>0){const k=_.find(R=>R!==w.name)||_[0];Ue(R=>R.map((O,z)=>z===Pe?{...O,name:k,notes:`${b==="pain"?"ðŸ©¹":"ðŸ”„"} Sostituito: ${w.name}`}:O)),re.success(`ðŸ”„ ${w.name} â†’ ${k}`),console.log(`[DISLIKE] Exercise replaced: ${w.name} â†’ ${k} (reason: ${b})`)}else re.error("âŒ Nessuna variante disponibile per questo esercizio"),console.warn(`[DISLIKE] No variants found for ${w.name}`)},ic=(b,_)=>{console.log(`[DISLIKE] Pain reported: ${b} - Level ${_}/10`),Y(k=>[...k.filter(R=>R.area!==b),{area:b,intensity:_}]),Gs.logPainEvent({area:b,intensity:_,exercise:(w==null?void 0:w.name)||"",timestamp:new Date().toISOString()})},nc=()=>he.map((b,_)=>{const k=Ae[b.name]||[],R=Me[b.name]||b.sets,O=Array.from({length:R},(z,K)=>{const se=k[K];return se?{set_number:K+1,reps_completed:se.reps_completed,weight_used:se.weight_used,rpe:se.rpe,completed:!0}:{set_number:K+1,reps_completed:0,weight_used:0,rpe:7,completed:!1}});return{exerciseName:b.name,sets:O}}),oc=async(b,_,k,R,O)=>{const z=he[b];if(!z)return;const K={set_number:_+1,reps_completed:k,weight_used:R||void 0,rpe:O,rpe_adjusted:O,adjusted:!1};if(Kt(_e=>{const Ke=[..._e[z.name]||[]];return Ke[_]=K,{..._e,[z.name]:Ke}}),Z)try{await Bi({workout_log_id:Z,exercise_name:z.name,exercise_index:b,set_number:_+1,reps_completed:k,weight_used:R||void 0,rpe:O})}catch(_e){console.error("[GridView] Error saving set:",_e)}const se=Mn(z.rest||"90s"),J=Ae[z.name]||[],we=Me[z.name]||z.sets;J.length+1<we&&(vt(se),Pt(!0))},lc=()=>{Mt()},cc=()=>{Pt(!1),vt(0)},dc=()=>{confirm("Vuoi terminare il workout anticipatamente?")&&Mt()},Ri=()=>{if(w)return Fa[w.name]||(typeof w.weight=="number",w.weight)};return t?p?e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-slate-900 rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"ðŸ‘‹ Pre-Workout Check-In"}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-slate-300 text-sm mb-3",children:d("mood.question")}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{value:"great",emoji:"ðŸ”¥",label:d("mood.great")},{value:"good",emoji:"ðŸ˜Š",label:d("mood.good")},{value:"ok",emoji:"ðŸ˜",label:d("mood.ok")},{value:"tired",emoji:"ðŸ˜´",label:d("mood.tired")}].map(({value:b,emoji:_,label:k})=>e.jsxs("button",{onClick:()=>x(b),className:`p-3 rounded-lg border-2 transition-all duration-200 ${h===b?"bg-emerald-500/20 border-emerald-500 text-emerald-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:_}),e.jsx("div",{className:"text-xs font-semibold",children:k})]},b))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-400 mb-2",children:[e.jsx("span",{children:"QualitÃ  del sonno"}),e.jsxs("span",{className:"text-white font-bold",children:[g,"/10"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:g,onChange:b=>y(parseInt(b.target.value)),className:"w-full h-3 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 mt-1",children:[1,2,3,4,5,6,7,8,9,10].map(b=>e.jsx("div",{className:`text-center text-xs ${g===b?"text-emerald-400 font-bold":"text-slate-600"}`,children:b},b))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-400 mb-2",children:[e.jsx("span",{children:"Livello di stress"}),e.jsxs("span",{className:"text-white font-bold",children:[v,"/10"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:b=>S(parseInt(b.target.value)),className:"w-full h-3 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-orange-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mt-1",children:[e.jsx("span",{children:"Rilassato"}),e.jsx("span",{children:"Molto stressato"})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm mb-2",children:"Nutrizione oggi"}),e.jsx("div",{className:"flex flex-col gap-2",children:[{value:"good",emoji:"ðŸ¥—",label:"Buona"},{value:"normal",emoji:"ðŸ½ï¸",label:"Normale"},{value:"poor",emoji:"ðŸŸ",label:"Scarsa"}].map(({value:b,emoji:_,label:k})=>e.jsxs("button",{onClick:()=>I(b),className:`p-2 rounded-lg border-2 transition-all duration-200 flex items-center gap-2 ${N===b?"bg-emerald-500/20 border-emerald-500 text-emerald-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("span",{className:"text-lg",children:_}),e.jsx("span",{className:"text-xs font-semibold",children:k})]},b))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm mb-2",children:"Idratazione"}),e.jsx("div",{className:"flex flex-col gap-2",children:[{value:"good",emoji:"ðŸ’§",label:"Buona"},{value:"normal",emoji:"ðŸ¥¤",label:"Normale"},{value:"poor",emoji:"ðŸœï¸",label:"Scarsa"}].map(({value:b,emoji:_,label:k})=>e.jsxs("button",{onClick:()=>M(b),className:`p-2 rounded-lg border-2 transition-all duration-200 flex items-center gap-2 ${T===b?"bg-blue-500/20 border-blue-500 text-blue-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("span",{className:"text-lg",children:_}),e.jsx("span",{className:"text-xs font-semibold",children:k})]},b))})]})]}),(v>=7||N==="poor"||T==="poor"||g<=4)&&e.jsxs("div",{className:"mb-6 bg-amber-500/10 border border-amber-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-amber-300 text-xs font-semibold mb-1",children:"âš ï¸ Fattori che potrebbero influenzare il workout"}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[v>=7&&"â€¢ Stress alto â†’ RPE potrebbe essere inflazionato",g<=4&&" â€¢ Sonno scarso â†’ Performance ridotta",N==="poor"&&" â€¢ Nutrizione scarsa â†’ Energia bassa",T==="poor"&&" â€¢ Disidratazione â†’ Fatica precoce"]}),e.jsx("p",{className:"text-amber-400 text-xs mt-2 font-semibold",children:"Il sistema terrÃ  conto di questi fattori nel calcolo RPE"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"text-slate-300 text-sm font-semibold",children:"ðŸ©¹ Hai dolori oggi?"}),H.length>0&&e.jsxs("span",{className:"text-xs text-red-400 font-bold",children:[H.length," zona/e"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[{key:"shoulder",label:"Spalla",color:"red"},{key:"elbow",label:"Gomito",color:"orange"},{key:"wrist",label:"Polso",color:"yellow"},{key:"upper_back",label:"Dorso",color:"blue"},{key:"lower_back",label:"Schiena Bassa",color:"red"},{key:"knee",label:"Ginocchio",color:"orange"},{key:"hip",label:"Anca",color:"yellow"},{key:"ankle",label:"Caviglia",color:"amber"},{key:"neck",label:"Collo",color:"purple"}].map(({key:b,label:_,color:k})=>{const R=H.find(z=>z.area===b),O=(R==null?void 0:R.intensity)||5;return e.jsxs("div",{children:[e.jsx("button",{onClick:()=>yt(b),className:`w-full p-3 rounded-lg border-2 transition-all duration-200 ${R?O>=7?"bg-red-500/20 border-red-500 text-red-300":O>=4?"bg-orange-500/20 border-orange-500 text-orange-300":"bg-yellow-500/20 border-yellow-500 text-yellow-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-sm font-semibold",children:_}),R&&e.jsxs("div",{className:"text-xs opacity-70",children:["IntensitÃ : ",O,"/10"]})]})})}),R&&e.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-2 px-2",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:O,onChange:z=>pt(b,parseInt(z.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-red-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mt-1",children:[e.jsx("span",{children:"Lieve"}),e.jsx("span",{children:"Severo"})]})]})]},b)})}),H.length>0&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-300 text-xs font-semibold mb-1",children:"âš ï¸ Esercizi adattati automaticamente"}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[H.filter(b=>b.intensity>=7).length>0&&"â€¢ Dolore alto (7-10): Esercizi sostituiti",H.filter(b=>b.intensity>=4&&b.intensity<7).length>0&&" â€¢ Dolore medio (4-6): Volume ridotto",H.filter(b=>b.intensity<4).length>0&&" â€¢ Dolore lieve (1-3): Warm-up extra"]})]})]}),oa&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:`text-sm font-semibold ${Ra(Ge)?"text-slate-500":"text-slate-300"}`,children:["ðŸ©¸ ",d("menstrual.track")]}),ie!=="none"&&!Ra(Ge)&&e.jsxs("span",{className:"text-xs text-pink-400 font-bold",children:["Giorno ",ue]})]}),Ra(Ge)?e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"ðŸ¤° Durante la gravidanza il tracking del ciclo mestruale non Ã¨ applicabile."}),e.jsx("p",{className:"text-xs text-slate-500",children:"Il tuo programma Ã¨ giÃ  ottimizzato per questa fase speciale."}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-3 opacity-40 pointer-events-none",children:[{key:"none",label:d("menstrual.not_track"),emoji:"âšª",days:""},{key:"follicular",label:d("menstrual.follicular"),emoji:"ðŸ’ª",days:"(6-13)"},{key:"ovulation",label:d("menstrual.ovulation"),emoji:"ðŸ”¥",days:"(14-16)"},{key:"luteal",label:d("menstrual.luteal"),emoji:"âš ï¸",days:"(17-28)"},{key:"menstrual",label:d("menstrual.menstruation"),emoji:"ðŸ©¸",days:"(1-5)"}].map(({key:b,label:_,emoji:k,days:R})=>e.jsx("div",{className:"p-3 rounded-lg border-2 bg-slate-800 border-slate-700 text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl grayscale",children:k}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-xs font-semibold",children:_}),R&&e.jsx("div",{className:"text-xs opacity-60",children:R})]})]})},b))})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"I numeri indicano i giorni del ciclo (es: 6-13 = giorni dal 6Â° al 13Â° del tuo ciclo mestruale)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{key:"none",label:d("menstrual.not_track"),emoji:"âšª",color:"gray",days:""},{key:"follicular",label:d("menstrual.follicular"),emoji:"ðŸ’ª",color:"green",days:"(6-13)"},{key:"ovulation",label:d("menstrual.ovulation"),emoji:"ðŸ”¥",color:"orange",days:"(14-16)"},{key:"luteal",label:d("menstrual.luteal"),emoji:"âš ï¸",color:"yellow",days:"(17-28)"},{key:"menstrual",label:d("menstrual.menstruation"),emoji:"ðŸ©¸",color:"red",days:"(1-5)"}].map(({key:b,label:_,emoji:k,color:R,days:O})=>e.jsx("button",{onClick:()=>{ye(b),b==="follicular"?Se(10):b==="ovulation"?Se(14):b==="luteal"?Se(21):b==="menstrual"&&Se(3)},className:`p-3 rounded-lg border-2 transition-all duration-200 ${ie===b?R==="green"?"bg-green-500/20 border-green-500 text-green-300":R==="orange"?"bg-orange-500/20 border-orange-500 text-orange-300":R==="yellow"?"bg-yellow-500/20 border-yellow-500 text-yellow-300":R==="red"?"bg-red-500/20 border-red-500 text-red-300":"bg-slate-700 border-slate-600 text-slate-400":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:k}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-xs font-semibold",children:_}),O&&e.jsx("div",{className:"text-xs opacity-60",children:O})]})]})},b))})]}),ie!=="none"&&!Ra(Ge)&&e.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-2",children:[e.jsx("span",{children:d("menstrual.day")}),e.jsxs("span",{className:"text-white font-bold",children:[ue,"/28"]})]}),e.jsx("input",{type:"range",min:"1",max:"28",value:ue,onChange:b=>{const _=parseInt(b.target.value);Se(_),_>=1&&_<=5?ye("menstrual"):_>=6&&_<=13?ye("follicular"):_>=14&&_<=16?ye("ovulation"):ye("luteal")},className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-pink-500"})]}),ie!=="none"&&!Ra(Ge)&&e.jsxs("div",{className:`mt-3 rounded-lg p-3 border ${ie==="follicular"?"bg-green-500/10 border-green-500/30":ie==="ovulation"?"bg-orange-500/10 border-orange-500/30":ie==="luteal"?"bg-yellow-500/10 border-yellow-500/30":"bg-red-500/10 border-red-500/30"}`,children:[e.jsxs("p",{className:`text-xs font-semibold mb-1 ${ie==="follicular"?"text-green-300":ie==="ovulation"?"text-orange-300":ie==="luteal"?"text-yellow-300":"text-red-300"}`,children:[ie==="follicular"&&"ðŸ’ª Energia alta - Ottimale per progressione",ie==="ovulation"&&"ðŸ”¥ Picco performance - Push it!",ie==="luteal"&&"âš ï¸ Energia ridotta - IntensitÃ  -15%",ie==="menstrual"&&"ðŸ©¸ Crampi/Fatica - Volume -30%"]}),e.jsxs("p",{className:"text-slate-400 text-xs",children:[ie==="follicular"&&"Allenamenti intensi, volume alto, focus forza",ie==="ovulation"&&"Max volume/intensitÃ , sfrutta il picco ormonale",ie==="luteal"&&"Ridurre intensitÃ , piÃ¹ recupero, focus tecnica",ie==="menstrual"&&"Evitare core intenso, stretching/mobilitÃ  OK"]})]})]}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>E(!0),className:"w-full mb-4 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 transition-all duration-300",children:["ðŸ  ",d("location.change_today")]}),xt&&e.jsx("div",{className:"mb-4 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg text-center",children:e.jsxs("p",{className:"text-purple-300 text-sm font-semibold",children:["âœ… ",d("location.session_adapted")]})}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Es,className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 shadow-lg transition-all duration-300",children:[e.jsx(Xr,{className:"w-5 h-5"}),d("dashboard.start_workout")]}),D&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>E(!1),children:e.jsxs(L.div,{initial:{scale:.9},animate:{scale:1},className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full border border-slate-700",onClick:b=>b.stopPropagation(),children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4",children:["ðŸ  ",d("location.available_equipment")]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[{key:"dumbbell",label:d("equipment.dumbbells"),icon:"ðŸ‹ï¸"},{key:"barbell",label:d("equipment.barbell"),icon:"âš¡"},{key:"pullUpBar",label:d("equipment.pullup_bar"),icon:"ðŸ”¥"},{key:"rings",label:d("equipment.rings"),icon:"â­•"},{key:"bands",label:d("equipment.bands"),icon:"ðŸŽ—ï¸"},{key:"kettlebell",label:d("equipment.kettlebell"),icon:"ðŸŽ¯"}].map(({key:b,label:_,icon:k})=>e.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border-2 cursor-pointer transition-all ${C[b]?"bg-emerald-500/20 border-emerald-500 text-emerald-300":"bg-slate-700 border-slate-600 text-slate-300 hover:border-slate-500"}`,children:[e.jsx("input",{type:"checkbox",checked:C[b],onChange:R=>G(O=>({...O,[b]:R.target.checked})),className:"w-4 h-4 rounded accent-emerald-500"}),e.jsx("span",{className:"text-xl",children:k}),e.jsx("span",{className:"text-sm font-semibold",children:_})]},b))}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-blue-300 text-sm",children:"ðŸ’¡ Gli esercizi verranno adattati automaticamente in base all'attrezzatura disponibile"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E(!1),className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg transition-colors",children:"Annulla"}),e.jsx("button",{onClick:Ve,disabled:U,className:"flex-1 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 disabled:opacity-50 text-white font-bold py-3 rounded-lg transition-all",children:U?"Adattamento...":"Conferma"})]})]})})]})}):_s?e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-slate-900 rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"ðŸŽ¯ Scegli ModalitÃ "}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]}),e.jsx(S0,{workout:{dayName:i,exercises:he.map(b=>{var _;return{id:b.name,name:b.name,sets:b.sets,reps:b.reps,rest:parseInt(((_=b.rest)==null?void 0:_.replace(/\D/g,""))||"90"),weight:typeof b.weight=="number"?String(b.weight):b.weight||null,notes:b.notes,pattern:b.pattern}})},onStartGuided:()=>Ga(!1),onStartExercise:(b,_)=>{Ga(!0),setTimeout(()=>{tt(_)},100)},completedExercises:new Set(Object.keys(Ae).filter(b=>{var _,k;return((_=Ae[b])==null?void 0:_.length)>=(Me[b]||((k=he.find(R=>R.name===b))==null?void 0:k.sets)||0)}))})]})}):w?e.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:[e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},className:"bg-slate-900 rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"ðŸ’ª Live Workout"}),e.jsx("p",{className:"text-slate-400 text-sm",children:i})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ha(!Et),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${Et?"bg-emerald-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,title:Et?"Vista Lineare":"Vista Griglia",children:Et?"ðŸ“‹ Lineare":"ðŸ“Š Griglia"}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]})]}),Et?e.jsx(y0,{exercises:he,exerciseLogs:nc(),dayName:i,isResting:Yt,restTimeLeft:us,onCompleteSet:oc,onSkipRest:cc,onFinishWorkout:lc,onEndWorkoutEarly:dc,onClose:a}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm text-slate-400 mb-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>qa(!ba),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-lg transition-all",children:[e.jsxs("span",{children:["Esercizio ",Pe+1,"/",de]}),e.jsx(Ut,{className:`w-4 h-4 transition-transform ${ba?"rotate-180":""}`})]}),ba&&e.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute top-full left-0 mt-1 w-72 max-h-64 overflow-y-auto bg-slate-800 border border-slate-600 rounded-lg shadow-xl z-50",children:he.map((b,_)=>{var z;const k=b.supersetGroup,R=_===Pe,O=((z=Ae[b.name])==null?void 0:z.length)>=(Me[b.name]||b.sets);return e.jsxs("button",{onClick:()=>Jl(_),className:`w-full text-left px-4 py-2.5 flex items-center gap-3 transition-all border-b border-slate-700 last:border-b-0 ${R?"bg-emerald-500/20 text-emerald-300":O?"bg-slate-700/50 text-slate-400":"hover:bg-slate-700 text-white"}`,children:[e.jsx("span",{className:`w-6 h-6 flex items-center justify-center rounded-full text-xs font-bold ${R?"bg-emerald-500 text-white":O?"bg-green-500/30 text-green-300":"bg-slate-600 text-slate-300"}`,children:O?"âœ“":_+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:b.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[b.sets,"x",b.reps," ",k&&`â€¢ Superset ${b.supersetGroup}`]})]}),R&&e.jsx("span",{className:"text-xs bg-emerald-500/30 px-2 py-0.5 rounded",children:"Attuale"})]},_)})})]}),e.jsxs("span",{children:["Set ",Te,"/",Ce]})]}),e.jsx("div",{className:"h-2 bg-slate-800 rounded-full overflow-hidden",children:e.jsx(L.div,{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",initial:{width:0},animate:{width:`${(Pe*100+Te/Ce*100)/de}%`},transition:{duration:.3}})})]}),e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-slate-800/50 rounded-xl p-6 mb-6 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:w.name}),w.is_recovery&&e.jsx("span",{className:"px-2 py-1 bg-orange-500/20 border border-orange-500/50 rounded text-orange-300 text-xs font-bold",children:"ðŸ”„ RECOVERY"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{const b=Yc(w.name,ca==="gym");js(b),Ct(!0)},className:"flex items-center gap-1.5 px-3 py-2 bg-slate-700/50 hover:bg-amber-500/20 border border-slate-600 hover:border-amber-500/50 rounded-lg transition-all group",title:"Postazione occupata? Trova un'alternativa",children:[e.jsx(bc,{className:"w-4 h-4 text-slate-400 group-hover:text-amber-400 transition-colors"}),e.jsx("span",{className:"text-xs font-medium text-slate-400 group-hover:text-amber-400 transition-colors",children:"Occupata"})]}),e.jsx("button",{onClick:()=>Ba(!0),className:"p-2 bg-slate-700/50 hover:bg-red-500/20 border border-slate-600 hover:border-red-500/50 rounded-lg transition-all group",title:d("exercise_dislike.title"),children:e.jsx(Vn,{className:"w-5 h-5 text-slate-400 group-hover:text-red-400 transition-colors"})})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(zl,{exerciseName:w.name,autoPlay:!0,loop:!0,muted:!0,className:"w-full aspect-video rounded-lg",showFormCues:!0})}),e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Target"}),e.jsxs("p",{className:"text-emerald-400 font-bold text-xl",children:[fe," reps"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Sets"}),e.jsxs("p",{className:"text-blue-400 font-bold text-xl",children:[Te,"/",Ce]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"RIR"}),e.jsx("p",{className:"text-orange-400 font-bold text-xl",children:w.targetRir??Ia(w.notes,w.intensity)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Rest"}),e.jsx("p",{className:"text-purple-400 font-bold text-xl",children:w.rest})]})]}),e.jsxs("div",{className:"mt-4 bg-purple-500/10 border border-purple-500/30 rounded-xl p-3",children:[e.jsxs("p",{className:"text-purple-300 text-sm text-center",children:["Fermati quando ti restano ",e.jsxs("span",{className:"font-bold",children:["~",w.targetRir??Ia(w.notes,w.intensity)," reps"]})," in tank"]}),e.jsx("p",{className:"text-slate-500 text-xs text-center mt-1",children:"Non forzare le reps a costo di superare questo limite"})]}),w&&da[w.name]&&!Xp(da[w.name])&&(()=>{const b=Wo(da[w.name]);return b?e.jsxs("div",{className:"mt-3 bg-amber-500/10 border border-amber-500/30 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-amber-300 text-sm font-medium",children:["â±ï¸ TUT Attivo: ",b.name]}),e.jsxs("p",{className:"text-slate-400 text-xs mt-0.5",children:[Zp(b.tempo)," (",b.tut_per_rep,"s/rep, +",Math.round(b.difficulty_increase*100),"% difficoltÃ )"]})]}),e.jsx("button",{onClick:()=>{const _={...da};delete _[w.name],bt(_)},className:"text-slate-500 hover:text-amber-400 text-xs underline",children:"Reset"})]}),e.jsx("p",{className:"text-slate-500 text-xs mt-2 italic",children:b.description_it})]}):null})(),ve&&e.jsxs("div",{className:"mt-4 bg-slate-900/80 rounded-lg p-4 border border-slate-700/50",children:[e.jsx("p",{className:"text-sm text-slate-300 mb-3 leading-relaxed",children:ve.description}),ve.technique&&ve.technique.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-400 font-medium mb-2 uppercase tracking-wide",children:"Tecnica Corretta"}),e.jsx("ul",{className:"space-y-1.5",children:ve.technique.map((b,_)=>e.jsxs("li",{className:"text-xs text-slate-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:b})]},_))})]})]})]},w.name),Yt&&e.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-blue-500/20 border border-blue-500/50 rounded-xl p-4 mb-6 text-center",children:[e.jsx("p",{className:"text-blue-300 font-bold text-lg mb-2",children:"â±ï¸ Rest Timer"}),e.jsxs("p",{className:"text-5xl font-bold text-blue-400",children:[us,"s"]}),e.jsx("button",{onClick:()=>{Pt(!1),vt(0)},className:"mt-3 text-sm text-blue-400 hover:text-blue-300 transition-colors",children:"Skip Rest â†’"})]}),!Da&&!Yt&&!V&&e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-sm mb-2",children:"Reps Completate"}),e.jsx("input",{type:"number",value:Xe||"",onChange:b=>pa(parseInt(b.target.value)||0),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white text-2xl font-bold text-center",placeholder:`${fe}`,autoFocus:!0})]}),w.pattern!=="core"&&!sn(w.name)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-slate-300 text-sm mb-2",children:["Peso (kg)",w.weight&&e.jsxs("span",{className:"text-amber-400 font-bold",children:[" - Suggerito: ",w.weight]})]}),e.jsx("input",{type:"number",step:"0.5",value:Be||"",onChange:b=>st(parseFloat(b.target.value)||0),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",placeholder:w.weight||"0"})]}),e.jsxs("button",{onClick:()=>{Xe!==0&&ut(!0)},disabled:Xe===0,className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 disabled:from-slate-700 disabled:to-slate-800 text-white font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"Set Completato"]})]}),dt&&!Da&&w&&e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Hai completato"}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:[Xe," reps",Be>0&&e.jsxs("span",{className:"text-emerald-400",children:[" @ ",Be,"kg"]})]})]}),e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-xl p-4",children:[e.jsxs("p",{className:"text-purple-300 font-bold text-center mb-2",children:["Hai rispettato RIR ",w.targetRir??Ia(w.notes,w.intensity),"?"]}),e.jsxs("p",{className:"text-slate-400 text-xs text-center",children:["Ti sei fermato quando ti restavano ~",w.targetRir??Ia(w.notes,w.intensity)," reps?"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{const b=w.targetRir??Ia(w.notes,w.intensity);ma(b),ua(10-b),ut(!1),Va(b)},className:"bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl transition-colors flex items-center justify-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"SÃ¬"]}),e.jsx("button",{onClick:()=>{ut(!1),Ze(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-4 rounded-xl transition-colors",children:"No, diverso"})]})]}),Da&&!V&&w&&e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4",children:[e.jsx("p",{className:"text-blue-300 font-bold mb-2",children:"Feedback Post-Set"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"RPE e RIR per calibrare la progressione"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("p",{className:"text-emerald-400 font-bold text-sm",children:"SCALA RPE (Rating of Perceived Exertion)"}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Quanto Ã¨ stato faticoso questo set da 1 a 10?"})]}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-400 mb-2",children:[e.jsx("span",{children:"Molto Facile"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:at}),e.jsx("span",{children:"Massimo Sforzo"})]}),e.jsx("input",{type:"range",min:"1",max:"10",value:at,onChange:b=>ua(parseInt(b.target.value)),className:"w-full h-3 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-emerald-500"}),e.jsx("div",{className:"grid grid-cols-10 gap-1 mt-2",children:[1,2,3,4,5,6,7,8,9,10].map(b=>e.jsx("div",{className:`text-center text-xs ${at===b?"text-emerald-400 font-bold":"text-slate-600"}`,children:b},b))})]}),e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("p",{className:"text-purple-400 font-bold text-sm",children:"SCALA RIR (Reps In Reserve)"}),e.jsx("p",{className:"text-slate-500 text-xs",children:"Quante ripetizioni potevi ancora fare prima di cedere?"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-300 font-bold",children:"RIR selezionato"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"0 = cedimento, 5+ = molto facile"})]}),e.jsx("span",{className:"text-3xl font-bold text-purple-400",children:xe})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:[0,1,2,3,4,5].map(b=>e.jsxs("button",{onClick:()=>ma(b),className:`p-3 rounded-lg border-2 transition-all duration-200 ${xe===b?"bg-purple-500/30 border-purple-500 text-purple-300":"bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-600"}`,children:[e.jsx("div",{className:"text-lg font-bold",children:b}),e.jsxs("div",{className:"text-xs",children:[b===0&&"Max",b===1&&"1 rep",b===2&&"2 rep",b===3&&"3 rep",b===4&&"4 rep",b===5&&"5+"]})]},b))}),(()=>{const b=Math.max(0,10-at);return Math.abs(xe-b)>=2?e.jsxs("div",{className:"mt-3 bg-amber-500/10 border border-amber-500/30 rounded-lg p-2",children:[e.jsxs("p",{className:"text-amber-300 text-xs font-semibold",children:["âš ï¸ RPE ",at," suggerisce RIR ~",b,", ma hai indicato RIR ",xe]}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:xe>b?"Il carico potrebbe essere troppo leggero per il target":"Il carico potrebbe essere troppo pesante per il target"})]}):null})()]}),xt&&e.jsxs("div",{className:"bg-cyan-500/10 border border-cyan-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-cyan-300 font-bold",children:"ðŸ“Š DifficoltÃ  Esercizio"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Quanto Ã¨ stato difficile questo esercizio?"})]}),e.jsx("span",{className:`text-3xl font-bold ${Re<=4?"text-green-400":Re<=6?"text-yellow-400":Re<=8?"text-orange-400":"text-red-400"}`,children:Re})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:Re,onChange:b=>za(parseInt(b.target.value)),className:"w-full accent-cyan-500"}),e.jsx("div",{className:"flex justify-between text-xs",children:[1,2,3,4,5,6,7,8,9,10].map(b=>e.jsx("button",{onClick:()=>za(b),className:`p-1 rounded text-xs font-bold transition-all ${Re===b?b<=4?"bg-green-500/30 text-green-300":b<=6?"bg-yellow-500/30 text-yellow-300":b<=8?"bg-orange-500/30 text-orange-300":"bg-red-500/30 text-red-300":"bg-slate-800 text-slate-600"}`,children:b},b))}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-green-400",children:"1-4"}),e.jsx("p",{className:"text-slate-500",children:"Facile"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-yellow-400",children:"5-6"}),e.jsx("p",{className:"text-slate-500",children:"Medio"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-orange-400",children:"7-8"}),e.jsx("p",{className:"text-slate-500",children:"Difficile"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-red-400",children:"9-10"}),e.jsx("p",{className:"text-slate-500",children:"Max"})]})]})]}),Re>=8&&e.jsxs("div",{className:"mt-3 bg-amber-500/10 border border-amber-500/30 rounded-lg p-2",children:[e.jsx("p",{className:"text-amber-300 text-xs font-semibold",children:"âš ï¸ Esercizio molto difficile"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:Re>=9?"Il sistema suggerirÃ  una versione piÃ¹ facile":"Considera una variante piÃ¹ accessibile se non riesci a mantenere la forma"})]})]}),r&&s&&i&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-300 font-bold",children:"ðŸ©¹ Livello Dolore"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"0 = nessuno, 10 = insopportabile"})]}),e.jsx("span",{className:"text-3xl font-bold text-red-400",children:rt})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"range",min:"0",max:"10",value:rt,onChange:b=>Rt(parseInt(b.target.value)),className:"w-full h-3 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-red-500"}),e.jsx("div",{className:"grid grid-cols-11 gap-1",children:[0,1,2,3,4,5,6,7,8,9,10].map(b=>e.jsx("button",{type:"button",onClick:()=>Rt(b),className:`p-2 rounded text-xs font-bold transition-all ${rt===b?b===0?"bg-green-500/30 text-green-300":b<=3?"bg-yellow-500/30 text-yellow-300":b<=6?"bg-orange-500/30 text-orange-300":"bg-red-500/30 text-red-300":"bg-slate-800 text-slate-600"}`,children:b},b))}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mt-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-green-400",children:"0-3"}),e.jsx("p",{className:"text-slate-500",children:"Lieve/OK"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-orange-400",children:"4-6"}),e.jsx("p",{className:"text-slate-500",children:"Moderato"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-red-400",children:"7-10"}),e.jsx("p",{className:"text-slate-500",children:"Severo"})]})]})]}),rt>=4&&e.jsxs("div",{className:"mt-3 bg-amber-500/10 border border-amber-500/30 rounded-lg p-2",children:[e.jsx("p",{className:"text-amber-300 text-xs font-semibold",children:"âš ï¸ Dolore moderato/alto rilevato"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:rt>=7?"Sistema ridurrÃ  ROM o sospenderÃ  esercizio":"Sistema adatterÃ  automaticamente carico/reps"})]})]}),wi(w.name)&&e.jsxs("button",{onClick:()=>fa(!0),className:"w-full bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2 mb-3",children:[e.jsx("span",{children:"ðŸ“¹"}),e.jsx("span",{children:"Carica Video Form Check"})]}),e.jsxs("button",{onClick:()=>{Ze(!1),Va()},className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"Continua"]})]}),e.jsx(Ne,{children:V&&e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`rounded-xl p-4 mb-6 border ${V.type==="reduce"?"bg-red-500/10 border-red-500/30":V.type==="increase"?"bg-emerald-500/10 border-emerald-500/30":"bg-blue-500/10 border-blue-500/30"}`,children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[V.type==="reduce"&&e.jsx(gt,{className:"w-6 h-6 text-red-400 flex-shrink-0"}),V.type==="increase"&&e.jsx(De,{className:"w-6 h-6 text-emerald-400 flex-shrink-0"}),V.type==="maintain"&&e.jsx(We,{className:"w-6 h-6 text-blue-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`font-bold mb-1 ${V.type==="reduce"?"text-red-300":V.type==="increase"?"text-emerald-300":"text-blue-300"}`,children:[V.type==="reduce"&&"âš ï¸ Auto-Regulation Suggerita",V.type==="increase"&&"ðŸ“ˆ Potenziale da Esprimere",V.type==="maintain"&&"âœ… RPE Ottimale"]}),e.jsx("p",{className:"text-slate-300 text-sm",children:V.message}),(V.newSets||V.newReps)&&e.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:[V.newSets&&e.jsxs("span",{children:["Sets: ",Ce," â†’ ",V.newSets]}),V.newReps&&e.jsxs("span",{className:"ml-3",children:["Reps: ",fe," â†’ ",V.newReps]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[V.type!=="maintain"&&e.jsx("button",{onClick:Zl,className:`flex-1 font-bold py-3 rounded-lg transition-all duration-300 ${V.type==="reduce"?"bg-red-600 hover:bg-red-700 text-white":"bg-emerald-600 hover:bg-emerald-700 text-white"}`,children:"Applica Modifica"}),e.jsx("button",{onClick:Ql,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-lg transition-all duration-300",children:V.type==="maintain"?"Continua":"Ignora"})]})]})}),e.jsx(Ne,{children:ms&&ge&&e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`rounded-xl p-4 mb-6 border ${ge.action==="downgrade"||ge.action==="reduce_weight"?"bg-orange-500/10 border-orange-500/30":ge.action==="upgrade"||ge.action==="increase_weight"?"bg-emerald-500/10 border-emerald-500/30":"bg-blue-500/10 border-blue-500/30"}`,children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[(ge.action==="downgrade"||ge.action==="reduce_weight")&&e.jsx(wt,{className:"w-6 h-6 text-orange-400 flex-shrink-0"}),(ge.action==="upgrade"||ge.action==="increase_weight")&&e.jsx(De,{className:"w-6 h-6 text-emerald-400 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`font-bold mb-1 ${ge.action==="downgrade"||ge.action==="reduce_weight"?"text-orange-300":"text-emerald-300"}`,children:[ge.action==="downgrade"&&"ðŸ“‰ Esercizio Troppo Difficile",ge.action==="reduce_weight"&&"âš–ï¸ Riduzione Carico Suggerita",ge.action==="upgrade"&&"ðŸ“ˆ Pronto per Progressione",ge.action==="increase_weight"&&"ðŸ’ª Aumenta il Carico"]}),e.jsx("p",{className:"text-slate-300 text-sm mb-2",children:ge.reason}),e.jsx("p",{className:"text-slate-400 text-xs whitespace-pre-line",children:ge.recommendation}),ge.newExercise&&e.jsxs("div",{className:"mt-3 bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Alternativa suggerita:"}),e.jsx("p",{className:"text-white font-bold",children:ge.newExercise})]}),ge.newWeight&&e.jsxs("div",{className:"mt-3 bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Nuovo peso suggerito:"}),e.jsxs("p",{className:"text-white font-bold",children:[ge.newWeight,"kg"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[(ge.action==="downgrade"||ge.action==="reduce_weight")&&e.jsx("button",{onClick:ya,className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 rounded-lg transition-all duration-300",children:ge.action==="downgrade"?"Cambia Esercizio":"Applica Riduzione"}),(ge.action==="upgrade"||ge.action==="increase_weight")&&e.jsx("button",{onClick:ya,className:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 rounded-lg transition-all duration-300",children:"Ricorda per Prossima Sessione"}),e.jsx("button",{onClick:ji,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-lg transition-all duration-300",children:"Continua CosÃ¬"})]})]})}),((Ci=Ae[w.name])==null?void 0:Ci.length)>0&&e.jsxs("div",{className:"bg-slate-800/30 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-slate-400 text-sm",children:"Set Completati:"}),Ae[w.name].length>=2&&(()=>{const b=Ae[w.name],_=b.slice(0,Math.ceil(b.length/2)).reduce((O,z)=>O+z.rpe,0)/Math.ceil(b.length/2),R=b.slice(Math.ceil(b.length/2)).reduce((O,z)=>O+z.rpe,0)/(b.length-Math.ceil(b.length/2))-_;return R>=1.5?e.jsxs("span",{className:"text-xs bg-red-500/20 text-red-300 px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(De,{className:"w-3 h-3"})," Fatica alta"]}):R>=.5?e.jsxs("span",{className:"text-xs bg-amber-500/20 text-amber-300 px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(De,{className:"w-3 h-3"})," Fatica crescente"]}):R<=-.5?e.jsxs("span",{className:"text-xs bg-emerald-500/20 text-emerald-300 px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(wt,{className:"w-3 h-3"})," Warming up"]}):null})()]}),e.jsx("div",{className:"space-y-2",children:Ae[w.name].map((b,_)=>{const k=An(v,g,N,T),R=Math.max(1,Math.min(10,b.rpe+k));return e.jsxs("div",{className:"flex items-center justify-between text-sm bg-slate-800/50 rounded-lg px-3 py-2",children:[e.jsxs("span",{className:"text-slate-300 font-semibold",children:["Set ",b.set_number]}),e.jsxs("span",{className:"text-emerald-400",children:[b.reps_completed," reps"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-bold ${b.rpe>=9?"text-red-400":b.rpe>=8?"text-orange-400":b.rpe<=4?"text-blue-400":"text-slate-300"}`,children:["RPE ",b.rpe]}),k!==0&&e.jsxs("span",{className:"text-xs text-slate-500",children:["(adj: ",R.toFixed(1),")"]})]}),b.rir_perceived!==void 0&&e.jsxs("span",{className:"text-xs text-purple-400",children:["RIR ",b.rir_perceived]}),b.adjusted&&e.jsx("span",{className:"text-amber-400 text-xs",children:"âš¡"})]},_)})}),Ae[w.name].length>=2&&(Ae[w.name].slice(-2).reduce((k,R)=>k+R.rpe,0)/2>=9&&Te<Ce?e.jsxs("div",{className:"mt-3 bg-red-500/10 border border-red-500/30 rounded-lg p-2",children:[e.jsx("p",{className:"text-red-300 text-xs font-semibold",children:"âš ï¸ RPE molto alto negli ultimi set. Considera di:"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"â€¢ Ridurre le reps per i prossimi set â€¢ Aumentare il recupero â€¢ Terminare l'esercizio in anticipo"})]}):null),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700/50 flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Media RPE:"}),e.jsx("span",{className:"text-white font-bold",children:(Ae[w.name].reduce((b,_)=>b+_.rpe,0)/Ae[w.name].length).toFixed(1)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ac,className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-lg transition-colors text-sm",children:"Salta Esercizio"}),e.jsx("button",{onClick:()=>{confirm("Vuoi terminare il workout?")&&Mt()},className:"ml-auto px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm",children:"Termina Workout"})]})]})]}),Xt&&e.jsx(g0,{open:ws,onClose:()=>xa(!1),exerciseName:Xt.exerciseName,painLevel:Xt.painLevel,sessions:Xt.sessions,allExercises:he.map(b=>b.name),onActivate:Ts,onSkip:As}),bs&&Le&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:`p-4 ${Le.level==="mild"?"bg-green-500":Le.level==="moderate"?"bg-amber-500":"bg-red-500"} text-white`,children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[Le.level==="mild"&&"ðŸ’ª Fastidio Lieve",Le.level==="moderate"&&"âš ï¸ Fastidio Moderato",Le.level==="significant"&&"ðŸ›‘ Fastidio Significativo",Le.level==="severe"&&"âŒ Fastidio Severo"]}),e.jsxs("p",{className:"text-sm opacity-90 mt-1",children:[rt,"/10 - ",w==null?void 0:w.name]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-200 mb-4",children:Le.messageIt}),Le.educationalNoteIt&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-3 rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["ðŸ’¡ ",Le.educationalNoteIt]})}),Le.showTolerableReminder&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/30 p-3 rounded-lg mb-4",children:e.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:"âœ… Un fastidio 3-4/10 che non peggiora Ã¨ generalmente accettabile."})}),e.jsx("div",{className:"space-y-2",children:Le.options.map(b=>e.jsxs("button",{onClick:()=>_i(b.choice),className:`
                      w-full p-3 rounded-xl text-left transition-all
                      ${b.recommended?"bg-blue-500 text-white hover:bg-blue-600 ring-2 ring-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600"}
                    `,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:b.icon}),e.jsx("span",{className:"font-medium",children:b.labelIt}),b.recommended&&e.jsx("span",{className:"ml-auto text-xs bg-white/20 px-2 py-0.5 rounded-full",children:"Consigliato"})]}),e.jsx("p",{className:"text-sm mt-1 opacity-80 ml-8",children:b.descriptionIt}),b.loadReductionPercent&&e.jsxs("p",{className:"text-xs mt-1 opacity-60 ml-8",children:["ðŸ“‰ -",b.loadReductionPercent,"% carico"]})]},b.choice))}),Le.suggestProfessional&&e.jsx("div",{className:"mt-4 p-3 bg-amber-50 dark:bg-amber-900/30 rounded-lg border border-amber-200 dark:border-amber-700",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:["âš•ï¸ ",Le.professionalMessageIt]})})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[Gs.disclaimer.it.substring(0,80),"..."]})})]})}),e.jsx(Dl,{open:pr,onClose:()=>fa(!1),exerciseName:w.name,exercisePattern:w.pattern,setNumber:Te,onUploadComplete:b=>{fa(!1),re.success("Video caricato! Analisi in corso...",{description:`Riceverai il feedback tra pochi secondi. ID: ${b.substring(0,8)}...`})}}),e.jsx(x0,{open:Ns,onClose:()=>Ba(!1),exerciseName:w.name,exercisePattern:w.pattern,currentWeight:Ri(),onReduceWeight:sc,onReplaceExercise:rc,onReportPain:ic}),e.jsx(Ne,{children:Ss&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>Ct(!1),children:e.jsxs(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full border border-slate-700 shadow-2xl",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(vc,{className:"w-5 h-5 text-amber-400"}),"Postazione Occupata?"]}),e.jsx("button",{onClick:()=>Ct(!1),className:"p-1 hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(ke,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("p",{className:"text-slate-400 text-sm mb-4",children:["Ecco delle alternative equivalenti per ",e.jsx("span",{className:"text-white font-semibold",children:w.name}),":"]}),$a.length>0?e.jsx("div",{className:"space-y-3",children:$a.map((b,_)=>{const k=Ri(),R=b.weightFactor&&k>0?Math.round(k*b.weightFactor):null,O=b.repsFactor&&b.repsFactor!==1?Math.round(fe*b.repsFactor):null;return e.jsx("button",{onClick:()=>{const z=[...he],K=w.name;z[Pe]={...w,name:b.name,notes:`${w.notes||""} (sostituito da ${K})`.trim(),...R&&{weight:R},...O&&{reps:O}},Ue(z),Ct(!1),re.success("Esercizio cambiato!",{description:`${K} â†’ ${b.name}${R?` (${R}kg)`:""}`})},className:"w-full bg-slate-700/50 hover:bg-amber-500/20 border border-slate-600 hover:border-amber-500/50 rounded-xl p-4 text-left transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold group-hover:text-amber-300 transition-colors",children:b.name}),b.notes&&e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:b.notes})]}),e.jsxs("div",{className:"text-right",children:[R&&e.jsxs("p",{className:"text-amber-400 font-bold text-lg",children:[R,"kg"]}),O&&e.jsxs("p",{className:"text-blue-400 text-sm",children:[O," reps"]}),!R&&!O&&e.jsx("span",{className:"text-slate-500 text-xs",children:b.equipment==="bodyweight"?"ðŸ  Corpo libero":"ðŸ‹ï¸ Palestra"})]})]})},_)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-slate-400",children:"Nessuna alternativa disponibile per questo esercizio."}),e.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Prova a chiedere aiuto al trainer."})]}),e.jsx("button",{onClick:()=>Ct(!1),className:"w-full mt-4 py-3 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-xl transition-colors",children:"Annulla"})]})})}),e.jsx(Ne,{children:Ps&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>It(!1),children:e.jsxs(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full border border-slate-700 shadow-2xl",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(yc,{className:"w-5 h-5 text-amber-400"}),"PerchÃ© salti questo esercizio?"]}),e.jsx("button",{onClick:()=>It(!1),className:"p-1 hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(ke,{className:"w-5 h-5 text-slate-400"})})]}),e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Tracciamo i motivi per aiutarti a migliorare il programma."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>wa("pain"),className:"w-full py-3 px-4 bg-red-500/20 hover:bg-red-500/30 text-red-300 rounded-xl transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸ©¹"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:"Dolore/Fastidio"}),e.jsx("p",{className:"text-xs text-red-400/70",children:"Sento dolore in questa zona"})]})]}),e.jsxs("button",{onClick:()=>wa("fatigue"),className:"w-full py-3 px-4 bg-amber-500/20 hover:bg-amber-500/30 text-amber-300 rounded-xl transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸ˜“"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:"Troppo stanco"}),e.jsx("p",{className:"text-xs text-amber-400/70",children:"Non ho energie per questo esercizio"})]})]}),e.jsxs("button",{onClick:()=>wa("equipment"),className:"w-full py-3 px-4 bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 rounded-xl transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸ‹ï¸"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:"Attrezzatura non disponibile"}),e.jsx("p",{className:"text-xs text-blue-400/70",children:"Postazione occupata o macchinario rotto"})]})]}),e.jsxs("button",{onClick:()=>wa("time"),className:"w-full py-3 px-4 bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 rounded-xl transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"â°"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:"Poco tempo"}),e.jsx("p",{className:"text-xs text-purple-400/70",children:"Devo accorciare la seduta"})]})]}),e.jsxs("button",{onClick:()=>wa("dislike"),className:"w-full py-3 px-4 bg-slate-600/50 hover:bg-slate-600/70 text-slate-300 rounded-xl transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸ‘Ž"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold",children:"Non mi piace"}),e.jsx("p",{className:"text-xs text-slate-400/70",children:"Preferisco altri esercizi"})]})]})]}),e.jsx("button",{onClick:()=>It(!1),className:"w-full mt-4 py-3 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-xl transition-colors",children:"Annulla"})]})})}),e.jsx(Ne,{children:j&&A&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(L.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-b from-amber-900/50 to-slate-800 rounded-2xl p-6 max-w-md w-full border border-amber-500/30 shadow-2xl",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-amber-500/20 rounded-full flex items-center justify-center mb-3",children:e.jsx(gt,{className:"w-8 h-8 text-amber-400"})}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Pattern Rilevato"}),e.jsx("p",{className:"text-amber-300 font-semibold mt-1",children:jr[A.muscle_group]})]}),e.jsx("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:e.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:A.suggested_action})}),e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-xl p-3 mb-4",children:[e.jsxs("p",{className:"text-green-300 text-sm font-semibold",children:["ðŸ’¡ Suggerimento: -",A.load_reduction_percent,"% carico"]}),e.jsx("p",{className:"text-green-400/70 text-xs mt-1",children:"Ridurremo automaticamente il carico per prevenire infortuni"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Pi(!0),className:"flex-1 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl transition-colors",children:"Accetta"}),e.jsx("button",{onClick:()=>Pi(!1),className:"flex-1 py-3 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-xl transition-colors",children:"Ignora"})]})]})})})]}):null:null}function zn(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function On(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?zn(Object(r),!0).forEach(function(s){M0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zn(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function M0(t,a,r){return(a=L0(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function L0(t){var a=D0(t,"string");return typeof a=="symbol"?a:a+""}function D0(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function ar(){return ar=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},ar.apply(null,arguments)}var z0=(t,a)=>{var r;if(m.isValidElement(t))r=m.cloneElement(t,a);else if(typeof t=="function")r=t(a);else{if(!Ht(a.x1)||!Ht(a.y1)||!Ht(a.x2)||!Ht(a.y2))return null;r=m.createElement("line",ar({},a,{className:"recharts-reference-line-line"}))}return r},O0=(t,a,r,s,i,o)=>{var{x:l,width:n}=o,c=i.y.apply(t,{position:r});if(ai(c)||a==="discard"&&!i.y.isInRange(c))return null;var u=[{x:l+n,y:c},{x:l,y:c}];return s==="left"?u.reverse():u},B0=(t,a,r,s,i,o)=>{var{y:l,height:n}=o,c=i.x.apply(t,{position:r});if(ai(c)||a==="discard"&&!i.x.isInRange(c))return null;var u=[{x:c,y:l+n},{x:c,y:l}];return s==="top"?u.reverse():u},F0=(t,a,r,s)=>{var i=t.map(o=>s.apply(o,{position:r}));return a==="discard"&&i.some(o=>!s.isInRange(o))?null:i},$0=(t,a,r,s,i,o)=>{var{x:l,y:n,segment:c,ifOverflow:u}=o,d=qi(l),p=qi(n);return p?O0(n,u,r,i,t,a):d?B0(l,u,r,s,t,a):c!=null&&c.length===2?F0(c,u,r,t):null};function q0(t){var a=Cd();return m.useEffect(()=>(a(Ed(t)),()=>{a(Id(t))})),null}function H0(t){var{xAxisId:a,yAxisId:r,shape:s,className:i,ifOverflow:o}=t,l=ti(),n=Td(),c=Xa(T=>Ad(T,a)),u=Xa(T=>Md(T,r)),d=Xa(T=>$i(T,"xAxis",a,l)),p=Xa(T=>$i(T,"yAxis",r,l)),f=Ld();if(!n||!f||c==null||u==null||d==null||p==null)return null;var h=Dd({x:d,y:p}),x=$0(h,f,t.position,c.orientation,u.orientation,t);if(!x)return null;var[{x:g,y},{x:v,y:S}]=x,P=o==="hidden"?"url(#".concat(n,")"):void 0,N=On(On({clipPath:P},lo(t)),{},{x1:g,y1:y,x2:v,y2:S}),I=Bd({x1:g,y1:y,x2:v,y2:S});return m.createElement(co,{zIndex:t.zIndex},m.createElement(is,{className:bo("recharts-reference-line",i)},z0(s,N),m.createElement(zd,ar({},I,{lowerWidth:I.width,upperWidth:I.width}),m.createElement(Od,{label:t.label}),t.children)))}var W0={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:oo.line};function Ur(t){var a=ei(t,W0);return m.createElement(m.Fragment,null,m.createElement(q0,{yAxisId:a.yAxisId,xAxisId:a.xAxisId,ifOverflow:a.ifOverflow,x:a.x,y:a.y,segment:a.segment}),m.createElement(H0,a))}Ur.displayName="ReferenceLine";var Ol=(t,a,r,s)=>uo(t,"xAxis",a,s),Bl=(t,a,r,s)=>mo(t,"xAxis",a,s),Fl=(t,a,r,s)=>uo(t,"yAxis",r,s),$l=(t,a,r,s)=>mo(t,"yAxis",r,s),G0=si([ri,Ol,Fl,Bl,$l],(t,a,r,s,i)=>po(t,"xAxis")?Wi(a,s,!1):Wi(r,i,!1)),U0=(t,a,r,s,i)=>i,ql=si([Hd,U0],(t,a)=>t.filter(r=>r.type==="area").find(r=>r.id===a)),V0=(t,a,r,s,i)=>{var o,l=ql(t,a,r,s,i);if(l!=null){var n=ri(t),c=po(n,"xAxis"),u;if(c?u=Hi(t,"yAxis",r,s):u=Hi(t,"xAxis",a,s),u!=null){var{stackId:d}=l,p=qd(l);if(!(d==null||p==null)){var f=(o=u[d])===null||o===void 0?void 0:o.stackedData;return f==null?void 0:f.find(h=>h.key===p)}}}},K0=si([ri,Ol,Fl,Bl,$l,V0,Fd,G0,ql,$d],(t,a,r,s,i,o,l,n,c,u)=>{var{chartData:d,dataStartIndex:p,dataEndIndex:f}=l;if(!(c==null||t!=="horizontal"&&t!=="vertical"||a==null||r==null||s==null||i==null||s.length===0||i.length===0||n==null)){var{data:h}=c,x;if(h&&h.length>0?x=h:x=d==null?void 0:d.slice(p,f+1),x!=null)return hf({layout:t,xAxis:a,yAxis:r,xAxisTicks:s,yAxisTicks:i,dataStartIndex:p,areaSettings:c,stackedData:o,displayedData:x,chartBaseValue:u,bandSize:n})}}),Y0=["id"],Z0=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function Qt(){return Qt=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Qt.apply(null,arguments)}function Hl(t,a){if(t==null)return{};var r,s,i=X0(t,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function X0(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function Bn(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,s)}return r}function Ta(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?Bn(Object(r),!0).forEach(function(s){Q0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bn(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Q0(t,a,r){return(a=J0(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function J0(t){var a=ef(t,"string");return typeof a=="symbol"?a:a+""}function ef(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function sr(t,a){return t&&t!=="none"?t:a}var tf=t=>{var{dataKey:a,name:r,stroke:s,fill:i,legendType:o,hide:l}=t;return[{inactive:l,dataKey:a,type:o,color:sr(s,i),value:ho(r,a),payload:t}]};function af(t){var{dataKey:a,data:r,stroke:s,strokeWidth:i,fill:o,name:l,hide:n,unit:c}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:s,strokeWidth:i,fill:o,dataKey:a,nameKey:void 0,name:ho(l,a),hide:n,type:t.tooltipType,color:sr(s,o),unit:c}}}function sf(t){var{clipPathId:a,points:r,props:s}=t,{needClip:i,dot:o,dataKey:l}=s,n=go(s);return m.createElement(lu,{points:r,dot:o,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:l,baseProps:n,needClip:i,clipPathId:a})}function rf(t){var{showLabels:a,children:r,points:s}=t,i=s.map(o=>{var l,n,c={x:(l=o.x)!==null&&l!==void 0?l:0,y:(n=o.y)!==null&&n!==void 0?n:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Ta(Ta({},c),{},{value:o.value,payload:o.payload,parentViewBox:void 0,viewBox:c,fill:void 0})});return m.createElement(ou,{value:a?i:void 0},r)}function Fn(t){var{points:a,baseLine:r,needClip:s,clipPathId:i,props:o}=t,{layout:l,type:n,stroke:c,connectNulls:u,isRange:d}=o,{id:p}=o,f=Hl(o,Y0),h=go(f),x=lo(f);return m.createElement(m.Fragment,null,(a==null?void 0:a.length)>1&&m.createElement(is,{clipPath:s?"url(#clipPath-".concat(i,")"):void 0},m.createElement(_r,Qt({},x,{id:p,points:a,connectNulls:u,type:n,baseLine:r,layout:l,stroke:"none",className:"recharts-area-area"})),c!=="none"&&m.createElement(_r,Qt({},h,{className:"recharts-area-curve",layout:l,type:n,connectNulls:u,fill:"none",points:a})),c!=="none"&&d&&m.createElement(_r,Qt({},h,{className:"recharts-area-curve",layout:l,type:n,connectNulls:u,fill:"none",points:r}))),m.createElement(sf,{points:a,props:f,clipPathId:i}))}function nf(t){var{alpha:a,baseLine:r,points:s,strokeWidth:i}=t,o=s[0].y,l=s[s.length-1].y;if(!Ht(o)||!Ht(l))return null;var n=a*Math.abs(o-l),c=Math.max(...s.map(u=>u.x||0));return Ma(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(u=>u.x||0),c)),Ma(c)?m.createElement("rect",{x:0,y:o<l?o:o-n,width:c+(i?parseInt("".concat(i),10):1),height:Math.floor(n)}):null}function of(t){var{alpha:a,baseLine:r,points:s,strokeWidth:i}=t,o=s[0].x,l=s[s.length-1].x;if(!Ht(o)||!Ht(l))return null;var n=a*Math.abs(o-l),c=Math.max(...s.map(u=>u.y||0));return Ma(r)?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(...r.map(u=>u.y||0),c)),Ma(c)?m.createElement("rect",{x:o<l?o:o-n,y:0,width:n,height:Math.floor(c+(i?parseInt("".concat(i),10):1))}):null}function lf(t){var{alpha:a,layout:r,points:s,baseLine:i,strokeWidth:o}=t;return r==="vertical"?m.createElement(nf,{alpha:a,points:s,baseLine:i,strokeWidth:o}):m.createElement(of,{alpha:a,points:s,baseLine:i,strokeWidth:o})}function cf(t){var{needClip:a,clipPathId:r,props:s,previousPointsRef:i,previousBaselineRef:o}=t,{points:l,baseLine:n,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:p,onAnimationStart:f,onAnimationEnd:h}=s,x=su(s,"recharts-area-"),[g,y]=m.useState(!1),v=!g,S=m.useCallback(()=>{typeof h=="function"&&h(),y(!1)},[h]),P=m.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]),N=i.current,I=o.current;return m.createElement(rf,{showLabels:v,points:l},s.children,m.createElement(ru,{animationId:x,begin:u,duration:d,isActive:c,easing:p,onAnimationEnd:S,onAnimationStart:P,key:x},T=>{if(N){var M=N.length/l.length,D=T===1?l:l.map((U,W)=>{var C=Math.floor(W*M);if(N[C]){var G=N[C];return Ta(Ta({},U),{},{x:Sa(G.x,U.x,T),y:Sa(G.y,U.y,T)})}return U}),E;return Ma(n)?E=Sa(I,n,T):iu(n)||ai(n)?E=Sa(I,0,T):E=n.map((U,W)=>{var C=Math.floor(W*M);if(Array.isArray(I)&&I[C]){var G=I[C];return Ta(Ta({},U),{},{x:Sa(G.x,U.x,T),y:Sa(G.y,U.y,T)})}return U}),T>0&&(i.current=D,o.current=E),m.createElement(Fn,{points:D,baseLine:E,needClip:a,clipPathId:r,props:s})}return T>0&&(i.current=l,o.current=n),m.createElement(is,null,c&&m.createElement("defs",null,m.createElement("clipPath",{id:"animationClipPath-".concat(r)},m.createElement(lf,{alpha:T,points:l,baseLine:n,layout:s.layout,strokeWidth:s.strokeWidth}))),m.createElement(is,{clipPath:"url(#animationClipPath-".concat(r,")")},m.createElement(Fn,{points:l,baseLine:n,needClip:a,clipPathId:r,props:s})))}),m.createElement(nu,{label:s.label}))}function df(t){var{needClip:a,clipPathId:r,props:s}=t,i=m.useRef(null),o=m.useRef();return m.createElement(cf,{needClip:a,clipPathId:r,props:s,previousPointsRef:i,previousBaselineRef:o})}class uf extends m.PureComponent{render(){var{hide:a,dot:r,points:s,className:i,top:o,left:l,needClip:n,xAxisId:c,yAxisId:u,width:d,height:p,id:f,baseLine:h,zIndex:x}=this.props;if(a)return null;var g=bo("recharts-area",i),y=f,{r:v,strokeWidth:S}=eu(r),P=tu(r),N=v*2+S;return m.createElement(co,{zIndex:x},m.createElement(is,{className:g},n&&m.createElement("defs",null,m.createElement(au,{clipPathId:y,xAxisId:c,yAxisId:u}),!P&&m.createElement("clipPath",{id:"clipPath-dots-".concat(y)},m.createElement("rect",{x:l-N/2,y:o-N/2,width:d+N,height:p+N}))),m.createElement(df,{needClip:n,clipPathId:y,props:this.props})),m.createElement(Gi,{points:s,mainColor:sr(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(h)&&m.createElement(Gi,{points:h,mainColor:sr(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var Wl={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Yd.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0,zIndex:oo.area};function mf(t){var a,r=ei(t,Wl),{activeDot:s,animationBegin:i,animationDuration:o,animationEasing:l,connectNulls:n,dot:c,fill:u,fillOpacity:d,hide:p,isAnimationActive:f,legendType:h,stroke:x,xAxisId:g,yAxisId:y}=r,v=Hl(r,Z0),S=Zd(),P=Xd(),{needClip:N}=Qd(g,y),I=ti(),{points:T,isRange:M,baseLine:D}=(a=Xa(H=>K0(H,g,y,I,t.id)))!==null&&a!==void 0?a:{},E=Jd();if(S!=="horizontal"&&S!=="vertical"||E==null||P!=="AreaChart"&&P!=="ComposedChart")return null;var{height:U,width:W,x:C,y:G}=E;return!T||!T.length?null:m.createElement(uf,Qt({},v,{activeDot:s,animationBegin:i,animationDuration:o,animationEasing:l,baseLine:D,connectNulls:n,dot:c,fill:u,fillOpacity:d,height:U,hide:p,layout:S,isAnimationActive:f,isRange:M,legendType:h,needClip:N,points:T,stroke:x,width:W,left:C,top:G,xAxisId:g,yAxisId:y}))}var pf=(t,a,r,s,i)=>{var o=r??a;if(Ma(o))return o;var l=t==="horizontal"?i:s,n=l.scale.domain();if(l.type==="number"){var c=Math.max(n[0],n[1]),u=Math.min(n[0],n[1]);return o==="dataMin"?u:o==="dataMax"||c<0?c:Math.max(Math.min(n[0],n[1]),0)}return o==="dataMin"?n[0]:o==="dataMax"?n[1]:n[0]};function hf(t){var{areaSettings:{connectNulls:a,baseValue:r,dataKey:s},stackedData:i,layout:o,chartBaseValue:l,xAxis:n,yAxis:c,displayedData:u,dataStartIndex:d,xAxisTicks:p,yAxisTicks:f,bandSize:h}=t,x=i&&i.length,g=pf(o,l,r,n,c),y=o==="horizontal",v=!1,S=u.map((N,I)=>{var T;x?T=i[d+I]:(T=Ui(N,s),Array.isArray(T)?v=!0:T=[g,T]);var M=T[1]==null||x&&!a&&Ui(N,s)==null;return y?{x:Vi({axis:n,ticks:p,bandSize:h,entry:N,index:I}),y:M?null:c.scale(T[1]),value:T,payload:N}:{x:M?null:n.scale(T[1]),y:Vi({axis:c,ticks:f,bandSize:h,entry:N,index:I}),value:T,payload:N}}),P;return x||v?P=S.map(N=>{var I=Array.isArray(N.value)?N.value[0]:null;return y?{x:N.x,y:I!=null&&N.y!=null?c.scale(I):null,payload:N.payload}:{x:I!=null?n.scale(I):null,y:N.y,payload:N.payload}}):P=y?c.scale(g):n.scale(g),{points:S,baseLine:P,isRange:v}}function gf(t){var a=ei(t,Wl),r=ti();return m.createElement(Wd,{id:a.id,type:"area"},s=>m.createElement(m.Fragment,null,m.createElement(Gd,{legendPayload:tf(a)}),m.createElement(Ud,{fn:af,args:a}),m.createElement(Vd,{type:"area",id:s,data:a.data,dataKey:a.dataKey,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,stackId:Kd(a.stackId),hide:a.hide,barSize:void 0,baseValue:a.baseValue,isPanorama:r,connectNulls:a.connectNulls}),m.createElement(mf,Qt({},a,{id:s}))))}var Gl=m.memo(gf);Gl.displayName="Area";var ff=["axis"],xf=m.forwardRef((t,a)=>m.createElement(fo,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ff,tooltipPayloadSearcher:xo,categoricalChartProps:t,ref:a})),bf=["axis"],vf=m.forwardRef((t,a)=>m.createElement(fo,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bf,tooltipPayloadSearcher:xo,categoricalChartProps:t,ref:a}));const Lt={knee:"#ef4444",lower_back:"#f97316",shoulder:"#eab308",wrist:"#22c55e",ankle:"#3b82f6",elbow:"#8b5cf6",hip:"#ec4899",neck:"#06b6d4",general:"#6b7280"},Us={knee:"Ginocchio",lower_back:"Schiena Bassa",shoulder:"Spalla",wrist:"Polso",ankle:"Caviglia",elbow:"Gomito",hip:"Anca",neck:"Collo",general:"Generale"};function yf({userId:t,className:a=""}){const[r,s]=m.useState([]),[i,o]=m.useState(!0),[l,n]=m.useState([]),[c,u]=m.useState("30d"),[d,p]=m.useState(!0);m.useEffect(()=>{f()},[t,c]);const f=async()=>{o(!0);try{let N=ne.from("pain_logs").select("*").eq("user_id",t).order("session_date",{ascending:!0});if(c!=="all"){const D=c==="7d"?7:c==="30d"?30:90,E=new Date;E.setDate(E.getDate()-D),N=N.gte("session_date",E.toISOString())}const{data:I,error:T}=await N;if(T){console.error("Error loading pain data:",T);return}s(I||[]);const M=[...new Set((I||[]).map(D=>D.pain_location).filter(Boolean))];l.length===0&&M.length>0&&n(M)}catch(N){console.error("Error:",N)}finally{o(!1)}},h=m.useMemo(()=>{if(r.length===0)return[];const N=new Map;r.forEach(T=>{var D;const M=((D=T.session_date)==null?void 0:D.split("T")[0])||"";N.has(M)||N.set(M,[]),N.get(M).push(T)});const I=[];return N.forEach((T,M)=>{const D={date:M,formattedDate:new Date(M).toLocaleDateString("it-IT",{day:"2-digit",month:"short"})},E=new Map;T.forEach(U=>{const W=U.pain_location||"general";E.has(W)||E.set(W,[]),E.get(W).push(U.pain_level)}),E.forEach((U,W)=>{const C=U.reduce((G,H)=>G+H,0)/U.length;D[`pain_${W}`]=Math.round(C*10)/10}),I.push(D)}),I.sort((T,M)=>T.date.localeCompare(M.date))},[r]),x=m.useMemo(()=>[...new Set(r.map(N=>N.pain_location).filter(Boolean))],[r]),g=m.useMemo(()=>{const N={};return x.forEach(I=>{var H;const T=r.filter(Y=>Y.pain_location===I).sort((Y,oe)=>(Y.session_date||"").localeCompare(oe.session_date||""));if(T.length<2){N[I]={trend:"stable",change:0,current:((H=T[0])==null?void 0:H.pain_level)||0};return}const M=Math.floor(T.length/2),D=T.slice(0,M),E=T.slice(M),U=D.reduce((Y,oe)=>Y+oe.pain_level,0)/D.length,C=E.reduce((Y,oe)=>Y+oe.pain_level,0)/E.length-U,G=T[T.length-1].pain_level;N[I]={trend:C>.5?"up":C<-.5?"down":"stable",change:Math.round(C*10)/10,current:G}}),N},[r,x]),y=N=>{n(I=>I.includes(N)?I.filter(T=>T!==N):[...I,N])},v=({active:N,payload:I,label:T})=>!N||!I||!I.length?null:e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-white mb-2",children:T}),I.map((M,D)=>{const E=M.dataKey.replace("pain_","");return e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:M.color}}),e.jsxs("span",{className:"text-slate-400",children:[Us[E]||E,":"]}),e.jsxs("span",{className:"font-medium",style:{color:M.color},children:[M.value,"/10"]})]},D)})]}),S=m.useMemo(()=>{if(r.length===0)return null;const N=r.reduce((E,U)=>E+U.pain_level,0)/r.length,I=Math.max(...r.map(E=>E.pain_level)),T=Math.min(...r.map(E=>E.pain_level)),M=r.slice(-5),D=M.reduce((E,U)=>E+U.pain_level,0)/M.length;return{avgPain:Math.round(N*10)/10,maxPain:I,minPain:T,recentAvg:Math.round(D*10)/10,trend:D<N?"improving":D>N?"worsening":"stable"}},[r]);if(i)return e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-slate-700 rounded"})]});const P=r.length===0;return e.jsxs("div",{className:`bg-slate-800/50 rounded-xl overflow-hidden ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-slate-700/30 transition-colors",onClick:()=>p(!d),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ii,{className:"w-5 h-5 text-red-400"}),e.jsx("h3",{className:"font-semibold text-white",children:"Monitoraggio Dolore"}),x.length>0&&e.jsxs("span",{className:"text-xs bg-red-500/20 text-red-400 px-2 py-0.5 rounded-full",children:[x.length," zone"]})]}),e.jsx(Ut,{className:`w-5 h-5 text-slate-400 transition-transform ${d?"rotate-180":""}`})]}),e.jsx(Ne,{children:d&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("div",{className:"flex gap-1 bg-slate-700/50 rounded-lg p-1 mb-4 w-fit",children:["7d","30d","90d","all"].map(N=>e.jsx("button",{onClick:()=>u(N),className:`px-3 py-1 text-xs rounded-md transition-colors ${c===N?"bg-red-500 text-white":"text-slate-400 hover:text-white"}`,children:N==="all"?"Tutto":N},N))}),S&&e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Media"}),e.jsx("p",{className:"text-xl font-bold text-white",children:S.avgPain})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Recente"}),e.jsx("p",{className:`text-xl font-bold ${S.trend==="improving"?"text-emerald-400":S.trend==="worsening"?"text-red-400":"text-white"}`,children:S.recentAvg})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Max"}),e.jsx("p",{className:"text-xl font-bold text-red-400",children:S.maxPain})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Min"}),e.jsx("p",{className:"text-xl font-bold text-emerald-400",children:S.minPain})]})]}),!P&&x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:x.map(N=>{const I=g[N],T=l.includes(N),M=Lt[N]||Lt.general;return e.jsxs("button",{onClick:()=>y(N),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-all ${T?"bg-slate-700 border-2":"bg-slate-800/50 border border-slate-600 opacity-50"}`,style:{borderColor:T?M:void 0},children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:M}}),e.jsx("span",{className:"text-white",children:Us[N]||N}),I&&e.jsxs("span",{className:`text-xs ${I.trend==="down"?"text-emerald-400":I.trend==="up"?"text-red-400":"text-slate-400"}`,children:[I.trend==="down"&&e.jsx(wt,{className:"w-3 h-3 inline"}),I.trend==="up"&&e.jsx(De,{className:"w-3 h-3 inline"}),I.current,"/10"]})]},N)})}),!P&&x.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:x.filter(N=>l.includes(N)).map(N=>{const I=g[N];if(!I)return null;const T=Lt[N]||Lt.general,M=I.trend==="down",D=I.trend==="up";return e.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 border-l-4",style:{borderColor:T},children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:Us[N]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:I.current}),e.jsx("span",{className:"text-slate-400",children:"/10"})]}),e.jsxs("div",{className:`text-xs mt-1 flex items-center gap-1 ${M?"text-emerald-400":D?"text-red-400":"text-slate-400"}`,children:[M&&e.jsxs(e.Fragment,{children:[e.jsx(wt,{className:"w-3 h-3"}),e.jsx(We,{className:"w-3 h-3"})]}),D&&e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-3 h-3"}),e.jsx(gt,{className:"w-3 h-3"})]}),e.jsx("span",{children:M?`${Math.abs(I.change)} in meno`:D?`+${I.change} aumento`:"Stabile"})]})]},N)})}),e.jsx("div",{className:"h-64",children:P?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsx(Ii,{className:"w-12 h-12 text-slate-500 mb-3"}),e.jsx("p",{className:"text-slate-400",children:"Nessun dato dolore nel periodo"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"I dati appariranno dopo aver registrato il dolore durante gli allenamenti"})]}):e.jsx(ii,{width:"100%",height:"100%",children:e.jsxs(xf,{data:h,children:[e.jsx(ni,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(oi,{dataKey:"formattedDate",stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(Qs,{domain:[0,10],stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:12},label:{value:"Dolore",angle:-90,position:"insideLeft",fill:"#9ca3af"}}),e.jsx(li,{content:e.jsx(v,{})}),e.jsx(Ur,{y:3,stroke:"#22c55e",strokeDasharray:"5 5"}),e.jsx(Ur,{y:7,stroke:"#ef4444",strokeDasharray:"5 5"}),l.map(N=>e.jsx(Gl,{type:"monotone",dataKey:`pain_${N}`,name:Us[N]||N,stroke:Lt[N]||Lt.general,fill:Lt[N]||Lt.general,fillOpacity:.2,strokeWidth:2,connectNulls:!0},N))]})})}),!P&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-4 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-0.5 border-t border-dashed border-emerald-500"}),e.jsx("span",{children:"Soglia sicura (0-3)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-0.5 border-t border-dashed border-red-500"}),e.jsx("span",{children:"Zona attenzione (7+)"})]})]})]})})})]})}function wf(t,a){return a===1?t:(a>12&&(a=12),t*(1+a/30))}function Nf(t,a,r){return t*a*r}function Sf({userId:t,className:a=""}){const[r,s]=m.useState([]),[i,o]=m.useState(!0),[l,n]=m.useState("30d"),[c,u]=m.useState(!0),[d,p]=m.useState("combined");m.useEffect(()=>{f()},[t,l]);const f=async()=>{o(!0);try{let v=ne.from("workout_logs").select("*").eq("user_id",t).order("created_at",{ascending:!0});if(l!=="all"){const N=l==="7d"?7:l==="30d"?30:90,I=new Date;I.setDate(I.getDate()-N),v=v.gte("created_at",I.toISOString())}const{data:S,error:P}=await v;if(P){console.error("Error loading workout data:",P);return}s(S||[])}catch(v){console.error("Error:",v)}finally{o(!1)}},h=m.useMemo(()=>{if(r.length===0)return[];const v=new Map;r.forEach(P=>{var I;const N=((I=P.created_at)==null?void 0:I.split("T")[0])||"";v.has(N)||v.set(N,[]),v.get(N).push(P)});const S=[];return v.forEach((P,N)=>{let I=0,T=0,M=0,D=0,E=0,U=0;P.forEach(W=>{const C=W.weight||0,G=W.reps||0,H=W.sets||1;I+=Nf(C,G,H),T+=C,M=Math.max(M,C),D+=wf(C,G),E+=H,U+=G*H}),S.push({date:N,formattedDate:new Date(N).toLocaleDateString("it-IT",{day:"2-digit",month:"short"}),totalVolume:Math.round(I),avgWeight:Math.round(T/P.length),maxWeight:M,avgE1RM:Math.round(D/P.length),totalSets:E,totalReps:U})}),S.sort((P,N)=>P.date.localeCompare(N.date))},[r]),x=m.useMemo(()=>{if(h.length===0)return null;const v=h.map(oe=>oe.totalVolume),S=h.map(oe=>oe.avgE1RM),P=v.reduce((oe,X)=>oe+X,0)/v.length,N=Math.max(...v),I=S.reduce((oe,X)=>oe+X,0)/S.length,T=Math.max(...S),M=Math.floor(h.length/2),D=h.slice(0,M).reduce((oe,X)=>oe+X.totalVolume,0)/Math.max(M,1),E=h.slice(M).reduce((oe,X)=>oe+X.totalVolume,0)/Math.max(h.length-M,1),U=E>D*1.05?"up":E<D*.95?"down":"stable",W=h.slice(0,M).reduce((oe,X)=>oe+X.avgE1RM,0)/Math.max(M,1),C=h.slice(M).reduce((oe,X)=>oe+X.avgE1RM,0)/Math.max(h.length-M,1),G=C>W*1.02?"up":C<W*.98?"down":"stable",H=D>0?(E-D)/D*100:0,Y=W>0?(C-W)/W*100:0;return{avgVolume:Math.round(P),maxVolume:N,avgE1RM:Math.round(I),maxE1RM:T,volumeTrend:U,strengthTrend:G,volumeChange:Math.round(H),strengthChange:Math.round(Y*10)/10,totalWorkouts:h.length}},[h]),g=({active:v,payload:S,label:P})=>!v||!S||!S.length?null:e.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-white mb-2",children:P}),S.map((N,I)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.color}}),e.jsxs("span",{className:"text-slate-400",children:[N.name,":"]}),e.jsxs("span",{className:"font-medium",style:{color:N.color},children:[N.value.toLocaleString(),N.dataKey==="totalVolume"||N.dataKey==="avgE1RM"||N.dataKey==="avgWeight"?" kg":""]})]},I))]});if(i)return e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-slate-700 rounded"})]});const y=h.length===0;return e.jsxs("div",{className:`bg-slate-800/50 rounded-xl overflow-hidden ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-slate-700/30 transition-colors",onClick:()=>u(!c),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-5 h-5 text-emerald-400"}),e.jsx("h3",{className:"font-semibold text-white",children:"Progressione Forza & Volume"}),x&&e.jsxs("span",{className:"text-xs bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded-full",children:[x.totalWorkouts," sessioni"]})]}),e.jsx(Ut,{className:`w-5 h-5 text-slate-400 transition-transform ${c?"rotate-180":""}`})]}),e.jsx(Ne,{children:c&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsx("div",{className:"flex gap-1 bg-slate-700/50 rounded-lg p-1",children:["7d","30d","90d","all"].map(v=>e.jsx("button",{onClick:()=>n(v),className:`px-3 py-1 text-xs rounded-md transition-colors ${l===v?"bg-emerald-500 text-white":"text-slate-400 hover:text-white"}`,children:v==="all"?"Tutto":v},v))}),e.jsx("div",{className:"flex gap-1 bg-slate-700/50 rounded-lg p-1",children:["volume","strength","combined"].map(v=>e.jsx("button",{onClick:()=>p(v),className:`px-3 py-1 text-xs rounded-md transition-colors ${d===v?"bg-blue-500 text-white":"text-slate-400 hover:text-white"}`,children:v==="volume"?"Volume":v==="strength"?"Forza":"Tutto"},v))})]}),x&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Jt,{className:"w-4 h-4 text-blue-400"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Volume Medio"})]}),e.jsx("p",{className:"text-xl font-bold text-white",children:x.avgVolume.toLocaleString()}),e.jsx("p",{className:"text-xs text-slate-500",children:"kg per sessione"}),x.volumeTrend!=="stable"&&e.jsxs("p",{className:`text-xs mt-1 flex items-center gap-1 ${x.volumeTrend==="up"?"text-emerald-400":"text-red-400"}`,children:[e.jsx(De,{className:`w-3 h-3 ${x.volumeTrend==="down"?"rotate-180":""}`}),x.volumeChange>0?"+":"",x.volumeChange,"%"]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(et,{className:"w-4 h-4 text-amber-400"}),e.jsx("p",{className:"text-xs text-slate-400",children:"E1RM Medio"})]}),e.jsx("p",{className:"text-xl font-bold text-white",children:x.avgE1RM}),e.jsx("p",{className:"text-xs text-slate-500",children:"kg stimato"}),x.strengthTrend!=="stable"&&e.jsxs("p",{className:`text-xs mt-1 flex items-center gap-1 ${x.strengthTrend==="up"?"text-emerald-400":"text-red-400"}`,children:[e.jsx(De,{className:`w-3 h-3 ${x.strengthTrend==="down"?"rotate-180":""}`}),x.strengthChange>0?"+":"",x.strengthChange,"%"]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Wt,{className:"w-4 h-4 text-purple-400"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Volume Max"})]}),e.jsx("p",{className:"text-xl font-bold text-white",children:x.maxVolume.toLocaleString()}),e.jsx("p",{className:"text-xs text-slate-500",children:"kg record"})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(et,{className:"w-4 h-4 text-emerald-400"}),e.jsx("p",{className:"text-xs text-slate-400",children:"E1RM Max"})]}),e.jsx("p",{className:"text-xl font-bold text-white",children:x.maxE1RM}),e.jsx("p",{className:"text-xs text-slate-500",children:"kg record"})]})]}),e.jsx("div",{className:"h-72",children:y?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsx(Jt,{className:"w-12 h-12 text-slate-500 mb-3"}),e.jsx("p",{className:"text-slate-400",children:"Nessun dato di allenamento"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Completa i tuoi primi workout per vedere i progressi"})]}):e.jsx(ii,{width:"100%",height:"100%",children:e.jsxs(vf,{data:h,children:[e.jsx(ni,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(oi,{dataKey:"formattedDate",stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(Qs,{yAxisId:"volume",stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:12},label:{value:"Volume (kg)",angle:-90,position:"insideLeft",fill:"#9ca3af"}}),e.jsx(Qs,{yAxisId:"strength",orientation:"right",stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:12},label:{value:"E1RM (kg)",angle:90,position:"insideRight",fill:"#9ca3af"}}),e.jsx(li,{content:e.jsx(g,{})}),e.jsx(cu,{}),(d==="volume"||d==="combined")&&e.jsx(du,{yAxisId:"volume",dataKey:"totalVolume",name:"Volume",fill:"#3b82f6",opacity:.7,radius:[4,4,0,0]}),(d==="strength"||d==="combined")&&e.jsx(Js,{yAxisId:"strength",type:"monotone",dataKey:"avgE1RM",name:"E1RM Stimato",stroke:"#f59e0b",strokeWidth:3,dot:{fill:"#f59e0b",r:4},activeDot:{r:6}}),(d==="strength"||d==="combined")&&e.jsx(Js,{yAxisId:"strength",type:"monotone",dataKey:"avgWeight",name:"Peso Medio",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})})}),!y&&e.jsxs("div",{className:"mt-3 p-3 bg-slate-700/30 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-400",children:e.jsx("strong",{className:"text-slate-300",children:"Formule utilizzate:"})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"E1RM (Epley): Peso x (1 + Reps/30) | Volume: Peso x Reps x Serie"})]})]})})})]})}function Ul(t,a){return a===1?t:t*(1+a/30)}function Vl(t,a){return a===1?t:a>=37?t*2:t*(36/(37-a))}function Kl(t,a){if(a===1)return t;const r=101.3-2.67123*a;return r<=0?t*2:100*t/r}function jf(t,a){const r=Ul(t,a),s=Vl(t,a),i=Kl(t,a);return Math.round((r+s+i)/3)}function _f(t,a,r){const o=r?[-216.0475144,16.2606339,-.002388645,-.00113732,701863e-11,-1291e-11]:[594.31747775582,-27.23842536447,.82112226871,-.00930733913,4731582e-11,-9054e-11],l=a,n=o[0]+o[1]*l+o[2]*l**2+o[3]*l**3+o[4]*l**4+o[5]*l**5;return n===0?0:Math.round(500/n*t*100)/100}function Pf(t,a,r){const o=r?[-307.75076,24.0900756,-.1918759221,.0007391293,-1093e-9]:[-57.96288,13.6175032,-.1126655495,.0005158568,-10706e-10],l=a,n=o[0]+o[1]*l+o[2]*l**2+o[3]*l**3+o[4]*l**4;return n===0?0:Math.round(500/n*t*100)/100}function Rf(t,a,r){const s={squat:{beginner:.75,intermediate:1.25,advanced:1.75,elite:2.5},bench:{beginner:.5,intermediate:1,advanced:1.5,elite:2},deadlift:{beginner:1,intermediate:1.5,advanced:2,elite:2.75},press:{beginner:.35,intermediate:.65,advanced:.95,elite:1.35},row:{beginner:.5,intermediate:.85,advanced:1.2,elite:1.6},default:{beginner:.5,intermediate:1,advanced:1.5,elite:2}},i=r.toLowerCase();let o="default";i.includes("squat")?o="squat":i.includes("bench")||i.includes("panca")?o="bench":i.includes("deadlift")||i.includes("stacco")?o="deadlift":i.includes("press")||i.includes("military")?o="press":(i.includes("row")||i.includes("rematore"))&&(o="row");const l=s[o],n=t/a;if(n<l.beginner)return{level:"Fondamenta",percentile:Math.round(n/l.beginner*25),color:"#94a3b8"};if(n<l.intermediate){const c=(n-l.beginner)/(l.intermediate-l.beginner);return{level:"Costruzione",percentile:Math.round(25+c*25),color:"#22c55e"}}else if(n<l.advanced){const c=(n-l.intermediate)/(l.advanced-l.intermediate);return{level:"Padronanza",percentile:Math.round(50+c*25),color:"#3b82f6"}}else if(n<l.elite){const c=(n-l.advanced)/(l.elite-l.advanced);return{level:"Elite",percentile:Math.round(75+c*20),color:"#f59e0b"}}else return{level:"Campione",percentile:99,color:"#ef4444"}}function $n(t,a,r){return Math.round(t*Math.pow(1+a/100,r))}function kf({userId:t,className:a="",userWeight:r=75,userGender:s="M"}){const[i,o]=m.useState([]),[l,n]=m.useState(!0),[c,u]=m.useState(!0),[d,p]=m.useState("");m.useEffect(()=>{f()},[t]);const f=async()=>{n(!0);try{const{data:v,error:S}=await ne.from("workout_logs").select("*").eq("user_id",t).order("created_at",{ascending:!0});if(S){console.error("Error loading workout data:",S);return}if(o(v||[]),v&&v.length>0&&!d){const P=[...new Set(v.map(N=>N.exercise_name))];p(P[0]||"")}}catch(v){console.error("Error:",v)}finally{n(!1)}},h=m.useMemo(()=>[...new Set(i.map(v=>v.exercise_name))],[i]),x=m.useMemo(()=>d?i.filter(S=>S.exercise_name===d).sort((S,P)=>S.created_at.localeCompare(P.created_at)).map(S=>({date:S.created_at.split("T")[0],formattedDate:new Date(S.created_at).toLocaleDateString("it-IT",{day:"2-digit",month:"short"}),weight:S.weight,reps:S.reps,e1rm_epley:Math.round(Ul(S.weight,S.reps)),e1rm_brzycki:Math.round(Vl(S.weight,S.reps)),e1rm_lander:Math.round(Kl(S.weight,S.reps)),e1rm_avg:jf(S.weight,S.reps),volume:S.weight*S.reps*S.sets})):[],[i,d]),g=m.useMemo(()=>{if(x.length<2)return null;const v=x[x.length-1],S=x[0],P=s==="M",N=v.e1rm_avg-S.e1rm_avg,I=(N/S.e1rm_avg*100).toFixed(1),T=(new Date(v.date).getTime()-new Date(S.date).getTime())/(1e3*60*60*24),M=Math.max(T/7,1),D=N/S.e1rm_avg*100/M,E=_f(v.e1rm_avg,r,P),U=Pf(v.e1rm_avg,r,P),W=Rf(v.e1rm_avg,r,d),C=$n(v.e1rm_avg,D,4),G=$n(v.e1rm_avg,D,12),H=x.map(ee=>ee.volume),Y=H.reduce((ee,pe)=>ee+pe,0)/H.length,oe=H.slice(-3).reduce((ee,pe)=>ee+pe,0)/Math.min(3,H.length),X=((oe-Y)/Y*100).toFixed(1);return{current:{e1rm:v.e1rm_avg,weight:v.weight,reps:v.reps,e1rm_epley:v.e1rm_epley,e1rm_brzycki:v.e1rm_brzycki,e1rm_lander:v.e1rm_lander},progress:{absolute:N,percent:I,weeklyRate:D.toFixed(2),weeksDiff:Math.round(M)},relativeStrength:{wilks:E,dots:U,ratio:(v.e1rm_avg/r).toFixed(2)},strengthLevel:W,projections:{weeks4:C,weeks12:G},volume:{trend:X,isIncreasing:oe>Y}}},[x,r,s,d]);if(m.useMemo(()=>g?[{formula:"Epley",value:g.current.e1rm_epley},{formula:"Brzycki",value:g.current.e1rm_brzycki},{formula:"Lander",value:g.current.e1rm_lander},{formula:"Media",value:g.current.e1rm}]:[],[g]),l)return e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-slate-700 rounded"})]});const y=i.length===0;return e.jsxs("div",{className:`bg-gradient-to-br from-slate-800/70 to-slate-900/70 rounded-xl overflow-hidden border border-slate-700/50 ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-slate-700/30 transition-colors",onClick:()=>u(!c),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-amber-500/20 to-orange-500/20 rounded-lg",children:e.jsx(Ti,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Database Progressi Scientifici"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Formule e metriche per capire i tuoi miglioramenti"})]})]}),e.jsx(Ut,{className:`w-5 h-5 text-slate-400 transition-transform ${c?"rotate-180":""}`})]}),e.jsx(Ne,{children:c&&e.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsx("div",{className:"px-4 pb-4",children:y?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ti,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"Nessun dato disponibile"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Completa i tuoi allenamenti per vedere le analisi scientifiche"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-xs text-slate-400 mb-2 block",children:"Seleziona esercizio:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(v=>e.jsx("button",{onClick:()=>p(v),className:`px-3 py-1.5 rounded-lg text-sm transition-all ${d===v?"bg-amber-500 text-white":"bg-slate-700/50 text-slate-400 hover:text-white"}`,children:v},v))})]}),g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 mb-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4 text-amber-400"}),"Stato Attuale - ",d]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-white",children:g.current.e1rm}),e.jsx("p",{className:"text-xs text-slate-400",children:"E1RM (kg)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-amber-400",children:["+",g.progress.percent,"%"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Progresso totale"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-emerald-400",children:[g.progress.weeklyRate,"%"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Crescita/settimana"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold",style:{color:g.strengthLevel.color},children:g.strengthLevel.level}),e.jsxs("p",{className:"text-xs text-slate-400",children:["Top ",100-g.strengthLevel.percentile,"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(wc,{className:"w-4 h-4 text-blue-400"}),"Formule 1RM a Confronto"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"Epley"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Peso Ã— (1 + Reps/30)"})]}),e.jsxs("p",{className:"text-lg font-bold text-blue-400",children:[g.current.e1rm_epley," kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"Brzycki"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Peso Ã— 36/(37-Reps)"})]}),e.jsxs("p",{className:"text-lg font-bold text-purple-400",children:[g.current.e1rm_brzycki," kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"Lander"}),e.jsx("p",{className:"text-xs text-slate-500",children:"100Ã—Peso/(101.3-2.67Ã—Reps)"})]}),e.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:[g.current.e1rm_lander," kg"]})]}),e.jsxs("div",{className:"border-t border-slate-600 pt-2 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:"Media Ponderata"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PiÃ¹ accurata per range 3-10 reps"})]}),e.jsxs("p",{className:"text-xl font-bold text-amber-400",children:[g.current.e1rm," kg"]})]})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(Nc,{className:"w-4 h-4 text-purple-400"}),"Forza Relativa al Peso Corporeo"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"Rapporto Peso/BW"}),e.jsx("p",{className:"text-xs text-slate-500",children:"E1RM Ã· Peso corporeo"})]}),e.jsxs("p",{className:"text-lg font-bold text-white",children:[g.relativeStrength.ratio,"x"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"Wilks Score"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Standard powerlifting"})]}),e.jsx("p",{className:"text-lg font-bold text-amber-400",children:g.relativeStrength.wilks})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white",children:"DOTS Score"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Formula moderna IPF"})]}),e.jsx("p",{className:"text-lg font-bold text-emerald-400",children:g.relativeStrength.dots})]}),e.jsxs("div",{className:"pt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-slate-400",children:"Livello popolazione"}),e.jsx("span",{style:{color:g.strengthLevel.color},children:g.strengthLevel.level})]}),e.jsx("div",{className:"h-2 bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${g.strengthLevel.percentile}%`,backgroundColor:g.strengthLevel.color}})}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Sei piÃ¹ forte del ",g.strengthLevel.percentile,"% della popolazione"]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-900/30 to-blue-900/30 rounded-xl p-4 mb-4 border border-emerald-500/20",children:[e.jsxs("h4",{className:"text-sm font-medium text-white mb-3 flex items-center gap-2",children:[e.jsx(Gn,{className:"w-4 h-4 text-emerald-400"}),"Proiezioni Future (al ritmo attuale)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(ts,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Tra 4 settimane"})]}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:[g.projections.weeks4," kg"]}),e.jsxs("p",{className:"text-xs text-emerald-300/60",children:["+",g.projections.weeks4-g.current.e1rm," kg previsti"]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(ts,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Tra 12 settimane"})]}),e.jsxs("p",{className:"text-2xl font-bold text-blue-400",children:[g.projections.weeks12," kg"]}),e.jsxs("p",{className:"text-xs text-blue-300/60",children:["+",g.projections.weeks12-g.current.e1rm," kg previsti"]})]})]}),e.jsxs("p",{className:"text-xs text-slate-400 mt-3 text-center",children:["Basato sul tuo rate di crescita di ",g.progress.weeklyRate,"% a settimana"]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-slate-300 mb-3 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4 text-emerald-400"}),"Progressione E1RM nel Tempo"]}),e.jsx("div",{className:"h-48",children:e.jsx(ii,{width:"100%",height:"100%",children:e.jsxs(uu,{data:x,children:[e.jsx(ni,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(oi,{dataKey:"formattedDate",stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:10}}),e.jsx(Qs,{stroke:"#9ca3af",tick:{fill:"#9ca3af",fontSize:10},domain:["dataMin - 5","dataMax + 5"]}),e.jsx(li,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(Js,{type:"monotone",dataKey:"e1rm_avg",name:"E1RM",stroke:"#f59e0b",strokeWidth:3,dot:{fill:"#f59e0b",r:4},activeDot:{r:6}}),e.jsx(Js,{type:"monotone",dataKey:"weight",name:"Peso usato",stroke:"#10b981",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})})})]}),e.jsx("div",{className:"mt-4 p-4 bg-gradient-to-r from-amber-500/10 to-orange-500/10 rounded-xl border border-amber-500/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(We,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white font-medium",children:"Stai migliorando!"}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["In ",g.progress.weeksDiff," settimane hai aumentato il tuo E1RM su ",d," di"," ",e.jsxs("span",{className:"text-emerald-400 font-medium",children:["+",g.progress.absolute," kg"]})," ","(",g.progress.percent,"%). Continua cosÃ¬!"]})]})]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(os,{className:"w-10 h-10 text-slate-500 mx-auto mb-2"}),e.jsx("p",{className:"text-slate-400",children:"Seleziona un esercizio con almeno 2 sessioni registrate"})]})]})})})})]})}function Cf(t,a){return a===1?t:(a>12&&(a=12),Math.round(t*(1+a/30)))}function Ef(t){const a=t.toLowerCase();return a.includes("squat")||a.includes("accosciata")?a.includes("front")||a.includes("frontale")?"Front Squat":a.includes("goblet")?"Goblet Squat":"Back Squat":a.includes("bench")||a.includes("panca")?a.includes("incline")||a.includes("inclinata")?"Panca Inclinata":"Panca Piana":a.includes("deadlift")||a.includes("stacco")?a.includes("romanian")||a.includes("rumeno")||a.includes("rdl")?"Stacco Rumeno":a.includes("sumo")?"Stacco Sumo":"Stacco da Terra":a.includes("overhead")||a.includes("military")||a.includes("lento avanti")||a.includes("shoulder press")?"Lento Avanti":a.includes("row")||a.includes("rematore")?"Rematore":a.includes("pull-up")||a.includes("pullup")||a.includes("trazioni")?"Trazioni":t}function If({userId:t,className:a=""}){const[r,s]=m.useState([]),[i,o]=m.useState(!0),[l,n]=m.useState(!0),[c,u]=m.useState("e1rm");m.useEffect(()=>{d()},[t]);const d=async()=>{o(!0);try{const{data:x,error:g}=await ne.from("exercise_logs").select(`
          id,
          exercise_name,
          weight_used,
          reps_completed,
          created_at,
          workout_log_id,
          workout_logs!inner(user_id)
        `).eq("workout_logs.user_id",t).gt("weight_used",0).order("created_at",{ascending:!0});if(g){console.error("Error loading workout data:",g);return}const y=(x||[]).map(v=>({id:v.id,exercise_name:v.exercise_name,weight:v.weight_used,reps:v.reps_completed,created_at:v.created_at}));s(y)}catch(x){console.error("Error:",x)}finally{o(!1)}},p=m.useMemo(()=>{if(r.length===0)return[];const x=new Map;r.forEach(y=>{const v=Ef(y.exercise_name);x.has(v)||x.set(v,[]),x.get(v).push(y)});const g=[];return x.forEach((y,v)=>{if(y.length===0)return;const P=y.sort((E,U)=>new Date(E.created_at).getTime()-new Date(U.created_at).getTime()).map(E=>({e1rm:Cf(E.weight,E.reps),date:E.created_at})),N=P[0].e1rm,I=P[P.length-1].e1rm,T=Math.max(...P.map(E=>E.e1rm)),M=I-N,D=N>0?M/N*100:0;g.push({exercise:v,currentE1RM:I,firstE1RM:N,maxE1RM:T,change:M,changePercent:Math.round(D*10)/10,trend:M>2?"up":M<-2?"down":"stable",lastUpdated:P[P.length-1].date,totalSessions:y.length})}),g.sort((y,v)=>c==="name"?y.exercise.localeCompare(v.exercise):c==="e1rm"?v.currentE1RM-y.currentE1RM:v.changePercent-y.changePercent)},[r,c]),f=m.useMemo(()=>{if(p.length===0)return null;const x=p.reduce((S,P)=>S+P.currentE1RM,0),g=p.reduce((S,P)=>S+P.changePercent,0)/p.length,y=p.filter(S=>S.trend==="up").length,v=p.filter(S=>S.trend==="down").length;return{totalE1RM:x,avgChange:Math.round(g*10)/10,improving:y,declining:v,stable:p.length-y-v}},[p]);if(i)return e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-slate-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(x=>e.jsx("div",{className:"h-16 bg-slate-700 rounded"},x))})]});const h=p.length===0;return e.jsxs("div",{className:`bg-gradient-to-br from-amber-900/30 to-orange-900/20 rounded-xl overflow-hidden border border-amber-700/30 ${a}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-slate-700/30 transition-colors",onClick:()=>n(!l),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-amber-500/20 to-yellow-500/20 rounded-lg",children:e.jsx(Ai,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Tutti i Tuoi 1RM"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Personal Records per ogni esercizio"})]}),f&&e.jsxs("span",{className:"text-xs bg-amber-500/20 text-amber-400 px-2 py-0.5 rounded-full ml-2",children:[p.length," esercizi"]})]}),e.jsx(Ut,{className:`w-5 h-5 text-slate-400 transition-transform ${l?"rotate-180":""}`})]}),l&&e.jsx("div",{className:"px-4 pb-4",children:h?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Jt,{className:"w-12 h-12 text-slate-500 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400",children:"Nessun dato disponibile"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Completa i tuoi allenamenti per vedere i PR"})]}):e.jsxs(e.Fragment,{children:[f&&e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:f.totalE1RM}),e.jsx("p",{className:"text-xs text-slate-400",children:"Totale E1RM"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsxs("p",{className:`text-2xl font-bold ${f.avgChange>=0?"text-emerald-400":"text-red-400"}`,children:[f.avgChange>=0?"+":"",f.avgChange,"%"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Media Î”"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:f.improving}),e.jsx("p",{className:"text-xs text-slate-400",children:"In crescita"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-400",children:f.stable}),e.jsx("p",{className:"text-xs text-slate-400",children:"Stabili"})]})]}),e.jsx("div",{className:"flex gap-1 bg-slate-700/50 rounded-lg p-1 mb-4 w-fit",children:[{key:"e1rm",label:"Per Forza"},{key:"change",label:"Per Progresso"},{key:"name",label:"A-Z"}].map(({key:x,label:g})=>e.jsx("button",{onClick:()=>u(x),className:`px-3 py-1 text-xs rounded-md transition-colors ${c===x?"bg-amber-500 text-white":"text-slate-400 hover:text-white"}`,children:g},x))}),e.jsx("div",{className:"space-y-2",children:p.map((x,g)=>e.jsxs(L.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:g*.05},className:"bg-slate-800/50 rounded-lg p-3 flex items-center justify-between hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${x.trend==="up"?"bg-emerald-500/20":x.trend==="down"?"bg-red-500/20":"bg-slate-600/50"}`,children:g===0&&c==="e1rm"?e.jsx(Ai,{className:"w-5 h-5 text-amber-400"}):e.jsx(Jt,{className:`w-5 h-5 ${x.trend==="up"?"text-emerald-400":x.trend==="down"?"text-red-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:x.exercise}),e.jsxs("p",{className:"text-xs text-slate-500",children:[x.totalSessions," sessioni"]})]})]}),e.jsxs("div",{className:"text-right mr-4",children:[e.jsxs("p",{className:"text-xl font-bold text-white",children:[x.currentE1RM," ",e.jsx("span",{className:"text-sm text-slate-400",children:"kg"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"E1RM attuale"})]}),e.jsxs("div",{className:`flex items-center gap-1 min-w-[80px] justify-end ${x.trend==="up"?"text-emerald-400":x.trend==="down"?"text-red-400":"text-slate-400"}`,children:[x.trend==="up"&&e.jsx(De,{className:"w-4 h-4"}),x.trend==="down"&&e.jsx(wt,{className:"w-4 h-4"}),x.trend==="stable"&&e.jsx(Mi,{className:"w-4 h-4"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[x.change>=0?"+":"",x.change," kg"]}),e.jsxs("p",{className:"text-xs opacity-70",children:[x.changePercent>=0?"+":"",x.changePercent,"%"]})]})]})]},x.exercise))}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4 text-emerald-400"}),e.jsx("span",{children:"In crescita (>2kg)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mi,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{children:"Stabile (Â±2kg)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{children:"In calo (>2kg)"})]})]}),e.jsx("div",{className:"mt-3 p-2 bg-slate-700/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-slate-500",children:[e.jsx("strong",{className:"text-slate-400",children:"E1RM"})," = 1 Rep Max stimato (formula Epley: Peso Ã— (1 + Reps/30))"]})})]})})]})}function Tf({open:t,onClose:a,adjustment:r,onAccept:s,onReject:i,onPostpone:o}){const{t:l}=ia(),[n,c]=m.useState(!1),[u,d]=m.useState(Math.abs(r.volume_change_percent));if(!t)return null;const p=r.adjustment_type==="deload_week",f=r.adjustment_type==="decrease_volume",h=r.adjustment_type==="increase_volume",x=()=>(u/Math.abs(r.volume_change_percent),{...r,volume_change_percent:h?u:-u,exercises_affected:r.exercises_affected.map(g=>({...g,new_sets:h?Math.round(g.old_sets*(1+u/100)):Math.max(1,Math.round(g.old_sets*(1-u/100)))}))});return e.jsx(Ne,{children:e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:a,children:e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-slate-900 rounded-2xl p-6 max-w-lg w-full border border-slate-700 shadow-2xl",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`p-3 rounded-xl ${p?"bg-red-500/20":f?"bg-orange-500/20":"bg-emerald-500/20"}`,children:[p&&e.jsx(gt,{className:"w-6 h-6 text-red-400"}),f&&e.jsx(wt,{className:"w-6 h-6 text-orange-400"}),h&&e.jsx(De,{className:"w-6 h-6 text-emerald-400"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[p&&l("deload.suggested"),f&&l("deload.reduce_volume"),h&&l("deload.increase_volume")]}),e.jsxs("p",{className:"text-slate-400 text-sm",children:["Basato su ",r.sessions_analyzed," sessioni analizzate"]})]})]}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:`rounded-xl p-4 mb-6 ${p?"bg-red-500/10 border border-red-500/30":f?"bg-orange-500/10 border border-orange-500/30":"bg-emerald-500/10 border border-emerald-500/30"}`,children:[e.jsxs("p",{className:`font-semibold mb-2 ${p?"text-red-300":f?"text-orange-300":"text-emerald-300"}`,children:[p&&"RPE critico rilevato",f&&"RPE troppo alto",h&&"RPE troppo basso"]}),e.jsxs("p",{className:"text-slate-300 text-sm",children:[p&&e.jsxs(e.Fragment,{children:["Il tuo RPE medio delle ultime sessioni (",r.avg_rpe_before.toFixed(1),"/10) indica un rischio di sovrallenamento. Un deload di una settimana permetterÃ  al corpo di recuperare."]}),f&&e.jsxs(e.Fragment,{children:["Il tuo RPE medio (",r.avg_rpe_before.toFixed(1),"/10) suggerisce che il carico attuale Ã¨ troppo alto. Riducendo il volume potrai mantenere la qualitÃ  dell'allenamento."]}),h&&e.jsxs(e.Fragment,{children:["Il tuo RPE medio (",r.avg_rpe_before.toFixed(1),"/10) suggerisce che il carico attuale Ã¨ troppo basso. Aumentare il volume stimolerÃ  maggiori adattamenti."]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"RPE Medio"}),e.jsx("p",{className:`text-2xl font-bold ${r.avg_rpe_before>=9?"text-red-400":r.avg_rpe_before>=8?"text-orange-400":r.avg_rpe_before<=5?"text-blue-400":"text-white"}`,children:r.avg_rpe_before.toFixed(1)})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Target RPE"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:"7-8"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Sessioni"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.sessions_analyzed})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("p",{className:"text-slate-300 font-semibold",children:"Modifica suggerita"}),e.jsxs("span",{className:`text-lg font-bold ${h?"text-emerald-400":"text-orange-400"}`,children:[h?"+":"-",u,"%"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"range",min:"5",max:p?50:30,step:"5",value:u,onChange:g=>d(parseInt(g.target.value)),className:`w-full h-2 rounded-lg appearance-none cursor-pointer ${h?"accent-emerald-500":"accent-orange-500"}`}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mt-1",children:[e.jsx("span",{children:"5%"}),e.jsx("span",{children:"Personalizza"}),e.jsx("span",{children:p?"50%":"30%"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-slate-400 text-sm",children:[r.exercises_affected.length," esercizi coinvolti"]}),e.jsxs("button",{onClick:()=>c(!n),className:"text-blue-400 text-sm hover:text-blue-300 transition-colors flex items-center gap-1",children:[e.jsx(Sc,{className:"w-4 h-4"}),n?"Nascondi":"Dettagli"]})]})]}),e.jsx(Ne,{children:n&&e.jsx(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 overflow-hidden",children:e.jsxs("div",{className:"bg-slate-800/30 rounded-xl p-4 max-h-48 overflow-y-auto",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-3 font-semibold",children:"Modifiche per esercizio:"}),e.jsx("div",{className:"space-y-2",children:x().exercises_affected.map((g,y)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-300 truncate flex-1",children:g.exercise_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-slate-500",children:[g.old_sets," sets"]}),e.jsx("span",{className:"text-slate-400",children:"â†’"}),e.jsxs("span",{className:h?"text-emerald-400":"text-orange-400",children:[g.new_sets," sets"]})]})]},y))})]})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>s(x()),className:`w-full font-bold py-4 rounded-xl transition-all duration-300 flex items-center justify-center gap-2 ${h?"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white":"bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white"}`,children:[e.jsx(Fe,{className:"w-5 h-5"}),p&&l("deload.apply"),f&&l("deload.reduce_volume"),h&&l("deload.increase_volume")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:o,className:"bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),l("deload.postpone")]}),e.jsxs("button",{onClick:i,className:"bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),l("deload.ignore")]})]})]}),e.jsx("p",{className:"text-slate-500 text-xs text-center mt-4",children:p?"Un deload ogni 4-6 settimane aiuta il recupero e previene infortuni":"Il sistema continuerÃ  a monitorare il tuo RPE per futuri aggiustamenti"})]})})})}const qn={forza:[10,6,3,1],ipertrofia:[10,8,8,6],resistenza:[10,12,15,20],dimagrimento:[10,10,12,15],prestazioni:[10,6,4,2]},Af={beginner:6,intermediate:3,advanced:1},Hn={1:{description:"Test del massimale singolo - Trova il carico massimo per 1 ripetizione",intensity:"100% 1RM",rest:300},2:{description:"Test del doppio - Trova il carico massimo per 2 ripetizioni",intensity:"95% 1RM",rest:240},3:{description:"Test del triplo - Trova il carico massimo per 3 ripetizioni",intensity:"93% 1RM",rest:240},4:{description:"Test del quadruplo - Trova il carico massimo per 4 ripetizioni",intensity:"90% 1RM",rest:180},6:{description:"Test del 6RM - Trova il carico massimo per 6 ripetizioni",intensity:"85% 1RM",rest:180},8:{description:"Test dell'8RM - Trova il carico massimo per 8 ripetizioni",intensity:"80% 1RM",rest:150},10:{description:"Test del 10RM - Trova il carico massimo per 10 ripetizioni",intensity:"75% 1RM",rest:120},12:{description:"Test del 12RM - Trova il carico massimo per 12 ripetizioni",intensity:"70% 1RM",rest:90},15:{description:"Test del 15RM - Trova il carico massimo per 15 ripetizioni",intensity:"65% 1RM",rest:90},20:{description:"Test del 20RM - Trova il carico massimo per 20 ripetizioni",intensity:"60% 1RM",rest:60}},Mf=7;function Yl(){return{volumeReduction:.5,intensityReduction:.15,frequencyReduction:0,guidelines:["Mantieni la stessa frequenza di allenamento","Riduci le serie del 40-50% per ogni esercizio","Usa carichi al 80-85% del normale","Nessuna serie a cedimento (RPE max 7)","Focus sulla tecnica e sul controllo","Aumenta il recupero tra le serie","Dormi 7-9 ore per notte","Cura particolarmente l'alimentazione"],focusAreas:["Recupero muscolare e articolare","QualitÃ  del movimento","MobilitÃ  e stretching","Preparazione mentale per il test"]}}function Lf(){const t=Yl();return["SETTIMANA DI DELOAD","==================","","OBIETTIVO: Dissipare la fatica accumulata per esprimere","il massimo potenziale nel test della prossima settimana.","","LINEE GUIDA:",...t.guidelines.map((a,r)=>`${r+1}. ${a}`),"","AREE DI FOCUS:",...t.focusAreas.map(a=>`â€¢ ${a}`),"","ESEMPIO PRATICO:","Se normalmente fai 4x8 Squat @ 100kg:",`â†’ Deload: 2x8 @ 85kg (${Math.round(t.volumeReduction*100)}% volume, ${Math.round(t.intensityReduction*100)}% intensitÃ  in meno)`,"","IMPORTANTE:","â€¢ NON saltare gli allenamenti - il recupero attivo Ã¨ meglio",'â€¢ NON aggiungere volume "perchÃ© ti senti bene"',"â€¢ Il test sarÃ  piÃ¹ preciso se arrivi riposato"]}function Df(t,a,r="intermediate"){const s=qn[t]||qn.ipertrofia,i=Af[r],o=Math.min(a-1,s.length-1);let l=s[o];l<i&&(l=i,console.log(`[RetestProgression] Target RM limitato a ${i}RM per livello ${r}`));const n=Hn[l]||Hn[10];return{cycle:a,targetRM:l,description:n.description,intensity:n.intensity,restSeconds:n.rest}}function zf(t,a,r="intermediate",s=28){const i=new Date(t),o=new Date,l=s+Mf,n=Math.floor((o.getTime()-i.getTime())/(1e3*60*60*24)),u=Math.floor(n/l)+1,d=n%l;let p,f=!1,h=!1,x,g;d<s?(p="training",x=s-d,g=l-d):d<l-2?(p="deload",f=!0,x=0,g=l-d):(p="retest",h=!0,x=0,g=l-d);const y=new Date(o);y.setDate(y.getDate()+g);const v=Df(a,u+1,r),S=p==="training"||p==="deload"?Yl():null;return{isRetestDue:h,daysUntilRetest:g,nextRetestDate:y.toISOString(),currentCycle:u,nextConfig:v,isDeloadWeek:f,daysUntilDeload:x,deloadConfig:S,phase:p}}function Of(t,a){return a===1?t:a>10?t*(1+a/30):t*(36/(37-a))}function Bf(t,a){if(a===1)return t;const r=t*((37-a)/36);return Math.round(r*2)/2}function Ff(t){const a=[`Obiettivo: Trovare il carico massimo per ${t.targetRM} ripetizioni`,"","PREPARAZIONE:","1. Riscaldamento generale (5-10 min cardio leggero)","2. MobilitÃ  articolare specifica","3. Serie di riscaldamento progressivo:","   - 10 reps @ 40%","   - 5 reps @ 60%","   - 3 reps @ 80%","","PROTOCOLLO TEST:"];return t.targetRM<=3?a.push(`4. Primo tentativo: peso stimato ${t.targetRM}RM`,"5. Riposo completo (4-5 minuti)","6. Aggiusta peso (+/- 2.5kg) in base al risultato","7. Massimo 5 tentativi totali","","CRITERI DI COMPLETAMENTO:",`- Completare esattamente ${t.targetRM} reps con buona tecnica`,"- Nessuna assistenza esterna","- Range completo di movimento"):a.push(`4. Primo tentativo: peso stimato ${t.targetRM}RM`,`5. Riposo (${Math.floor(t.restSeconds/60)} minuti)`,"6. Se completato facilmente: +5% peso","7. Se fallito: -5% peso","8. Massimo 3 tentativi","","CRITERI DI COMPLETAMENTO:",`- Completare esattamente ${t.targetRM} reps`,"- Le ultime 2 reps devono essere difficili (RPE 9-10)","- Tecnica mantenuta fino alla fine"),a.push("","SICUREZZA:","- Usa sempre safety pins/spotter per esercizi pesanti","- Interrompi se senti dolore o tecnica compromessa","- Non testare se affaticato o malato"),a}function $f(t,a,r){const s={};for(const[i,o]of Object.entries(t))if(o.weight10RM){const l=Of(o.weight10RM,a),n=Bf(l,r);s[i]={suggestedWeight:n,targetReps:r}}return s}function qf({schedule:t,goal:a,baselines:r,onStartRetest:s,onDismiss:i}){const[o,l]=m.useState(!1),[n,c]=m.useState(!1),{isRetestDue:u,daysUntilRetest:d,currentCycle:p,nextConfig:f}=t,h=$f(r,10,f.targetRM),x=Ff(f),g={forza:"Forza",ipertrofia:"Ipertrofia",resistenza:"Resistenza",dimagrimento:"Dimagrimento",prestazioni:"Prestazioni"};return u?e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-br from-amber-900/30 to-orange-900/20 backdrop-blur-xl rounded-2xl p-6 border border-amber-500/30 shadow-2xl shadow-amber-500/10 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-amber-500/20",children:e.jsx(gt,{className:"w-6 h-6 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-amber-300",children:"Ãˆ tempo di retestare!"}),e.jsxs("p",{className:"text-sm text-slate-400",children:["Ciclo ",p," completato - Calibra i nuovi carichi"]})]})]}),e.jsx("button",{onClick:i,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(et,{className:"w-5 h-5 text-amber-400"}),e.jsxs("span",{className:"font-bold text-white text-lg",children:["Test ",f.targetRM,"RM"]}),e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-amber-500/20 text-amber-300 border border-amber-500/30",children:g[a]})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:f.description}),e.jsxs("div",{className:"flex gap-4 text-xs text-slate-400",children:[e.jsxs("span",{children:["IntensitÃ : ",e.jsx("span",{className:"text-amber-300",children:f.intensity})]}),e.jsxs("span",{children:["Recupero: ",e.jsxs("span",{className:"text-amber-300",children:[Math.floor(f.restSeconds/60)," min"]})]})]})]}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 mb-4",children:[e.jsxs("p",{className:"text-sm text-blue-300 font-semibold mb-1",children:["PerchÃ© test ",f.targetRM,"RM?"]}),e.jsxs("p",{className:"text-xs text-slate-400",children:[a==="forza"&&e.jsx(e.Fragment,{children:"Il tuo obiettivo Ã¨ la forza massimale. Man mano che progredisci, i test diventano piÃ¹ specifici (10RM â†’ 6RM â†’ 3RM â†’ 1RM) per calibrare meglio i carichi pesanti."}),a==="ipertrofia"&&e.jsx(e.Fragment,{children:"Per l'ipertrofia, il range 6-12 reps Ã¨ ottimale. Test nell'8RM ti permette di calibrare perfettamente il volume nel range di crescita muscolare."}),(a==="resistenza"||a==="dimagrimento")&&e.jsxs(e.Fragment,{children:["Per ",g[a].toLowerCase(),", reps piÃ¹ alte sono piÃ¹ specifiche. Test a ",f.targetRM,"RM ti permette di calibrare la capacitÃ  di lavoro e il volume totale."]}),a==="prestazioni"&&e.jsxs(e.Fragment,{children:["Per le prestazioni atletiche, la potenza richiede intensitÃ  moderate-alte. Test a ",f.targetRM,"RM calibra sia forza che velocitÃ  di esecuzione."]})]})]}),Object.keys(h).length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(ea,{className:"w-4 h-4"}),"Pesi suggeriti per il test"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(h).slice(0,6).map(([y,v])=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 text-sm",children:[e.jsx("p",{className:"text-slate-400 text-xs truncate",children:y.replace(/_/g," ")}),e.jsxs("p",{className:"font-bold text-white",children:[v.suggestedWeight,"kg Ã— ",v.targetReps]})]},y))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"* Pesi basati sul tuo 10RM precedente. Inizia leggermente sotto e aggiusta."})]}),e.jsx("button",{onClick:()=>c(!n),className:"w-full text-left bg-slate-800/50 rounded-lg p-3 mb-4 hover:bg-slate-800/70 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-300 font-semibold",children:"Istruzioni complete"}),e.jsx(nt,{className:`w-4 h-4 text-slate-400 transition-transform ${n?"rotate-90":""}`})]})}),e.jsx(Ne,{children:n&&e.jsx(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4 overflow-hidden",children:e.jsx("div",{className:"bg-slate-800/30 rounded-lg p-4 max-h-60 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-slate-400 whitespace-pre-wrap font-sans",children:x.join(`
`)})})})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:s,className:"flex-1 bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-700 hover:to-orange-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-amber-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"Inizia Retest"]}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:i,className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-4 rounded-xl transition-colors flex items-center justify-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Rimanda"]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700/50",children:[e.jsxs("p",{className:"text-xs text-slate-500 text-center",children:["Progressione ",a,": ",a==="forza"?"10RM â†’ 6RM â†’ 3RM â†’ 1RM":a==="ipertrofia"?"10RM â†’ 8RM â†’ 8RM â†’ 6RM":a==="resistenza"?"10RM â†’ 12RM â†’ 15RM â†’ 20RM":"10RM â†’ 10RM â†’ 12RM â†’ 15RM"]}),e.jsx("div",{className:"flex justify-center gap-1 mt-2",children:[1,2,3,4].map(y=>e.jsx("div",{className:`w-3 h-3 rounded-full ${y<p?"bg-emerald-500":y===p?"bg-amber-500":"bg-slate-600"}`,title:`Ciclo ${y}`},y))})]})]}):e.jsxs(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-slate-800/50 backdrop-blur-sm rounded-lg p-3 border border-slate-700/50 mb-4 cursor-pointer hover:border-slate-600 transition-colors",onClick:()=>l(!o),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(Kn,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-slate-300",children:["Prossimo retest tra ",e.jsxs("span",{className:"font-bold text-blue-400",children:[d," giorni"]})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Ciclo ",p," â†’ Test ",f.targetRM,"RM (",g[a],")"]})]})]}),e.jsx(nt,{className:`w-5 h-5 text-slate-400 transition-transform ${o?"rotate-90":""}`})]}),e.jsx(Ne,{children:o&&e.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 pt-3 border-t border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:f.description}),e.jsxs("p",{className:"text-xs text-slate-500",children:["IntensitÃ : ",f.intensity," | Recupero: ",Math.floor(f.restSeconds/60)," min"]})]})})]})}function Hf({daysUntilRetest:t,deloadConfig:a,nextRetestConfig:r,currentCycle:s,onDismiss:i}){const{t:o}=ia(),[l,n]=m.useState(!1),[c,u]=m.useState(!1),d=Lf();return e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-br from-emerald-900/30 to-teal-900/20 backdrop-blur-xl rounded-2xl p-6 border border-emerald-500/30 shadow-2xl shadow-emerald-500/10 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-emerald-500/20",children:e.jsx(jc,{className:"w-6 h-6 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-emerald-300",children:o("deload.title")}),e.jsx("p",{className:"text-sm text-slate-400",children:"Recupero attivo prima del test"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:t}),e.jsx("p",{className:"text-xs text-slate-500",children:"giorni al test"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(os,{className:"w-4 h-4 text-emerald-400"}),e.jsx("span",{className:"font-semibold text-white text-sm",children:o("deload.why")})]}),e.jsxs("p",{className:"text-sm text-slate-300",children:["Dopo 4 settimane di carico progressivo, il tuo corpo ha accumulato fatica. Questa settimana permette la ",e.jsx("span",{className:"text-emerald-400 font-semibold",children:"supercompensazione"}),": recuperi e diventi piÃ¹ forte per il test."]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx(Jt,{className:"w-5 h-5 text-emerald-400 mx-auto mb-1"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:["-",Math.round(a.volumeReduction*100),"%"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Volume"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx(ea,{className:"w-5 h-5 text-emerald-400 mx-auto mb-1"}),e.jsxs("p",{className:"text-lg font-bold text-white",children:["-",Math.round(a.intensityReduction*100),"%"]}),e.jsx("p",{className:"text-xs text-slate-400",children:"IntensitÃ "})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-center",children:[e.jsx(Yr,{className:"w-5 h-5 text-emerald-400 mx-auto mb-1"}),e.jsx("p",{className:"text-lg font-bold text-white",children:"RPE â‰¤7"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Max sforzo"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-slate-300 mb-2 flex items-center gap-2",children:[e.jsx(Vr,{className:"w-4 h-4"}),o("deload.guidelines")]}),e.jsx("ul",{className:"space-y-1",children:a.guidelines.slice(0,4).map((p,f)=>e.jsxs("li",{className:"text-xs text-slate-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"â€¢"}),p]},f))})]}),e.jsx("button",{onClick:()=>n(!l),className:"w-full text-left bg-slate-800/50 rounded-lg p-3 mb-4 hover:bg-slate-800/70 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-300 font-semibold",children:"Aree di focus"}),e.jsx(nt,{className:`w-4 h-4 text-slate-400 transition-transform ${l?"rotate-90":""}`})]})}),e.jsx(Ne,{children:l&&e.jsx(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4 overflow-hidden",children:e.jsx("div",{className:"bg-slate-800/30 rounded-lg p-4 space-y-2",children:a.focusAreas.map((p,f)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4 text-emerald-400 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-slate-300",children:p})]},f))})})}),e.jsx("button",{onClick:()=>u(!c),className:"w-full text-left bg-slate-800/50 rounded-lg p-3 mb-4 hover:bg-slate-800/70 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-300 font-semibold",children:"Istruzioni complete"}),e.jsx(nt,{className:`w-4 h-4 text-slate-400 transition-transform ${c?"rotate-90":""}`})]})}),e.jsx(Ne,{children:c&&e.jsx(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4 overflow-hidden",children:e.jsx("div",{className:"bg-slate-800/30 rounded-lg p-4 max-h-60 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-slate-400 whitespace-pre-wrap font-sans",children:d.join(`
`)})})})}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Kn,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-300",children:["Prossimo test: ",r.targetRM,"RM"]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:r.description}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Ciclo ",s," â†’ Ciclo ",s+1]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-slate-500 text-center mb-2",children:"Progressione ciclo"}),e.jsx("div",{className:"flex justify-center gap-1",children:Array.from({length:5},(p,f)=>{const h=f+1,x=h===5,g=h<=4;return e.jsx("div",{className:`h-2 rounded-full ${x?"w-6 bg-emerald-500 animate-pulse":g?"w-4 bg-emerald-500":"w-4 bg-slate-600"}`,title:x?"Deload (ora)":`Settimana ${h}`},f)})}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mt-1 px-1",children:[e.jsx("span",{children:"Training"}),e.jsx("span",{children:"Deload"})]})]})]})}const Wn=[{id:"shoulder",label:"Spalla",icon:"ðŸ¦¾"},{id:"elbow",label:"Gomito",icon:"ðŸ’ª"},{id:"wrist",label:"Polso",icon:"âœ‹"},{id:"lower_back",label:"Zona Lombare",icon:"ðŸ”™"},{id:"upper_back",label:"Zona Dorsale",icon:"ðŸ”"},{id:"hip",label:"Anca",icon:"ðŸ¦´"},{id:"knee",label:"Ginocchio",icon:"ðŸ¦µ"},{id:"ankle",label:"Caviglia",icon:"ðŸ¦¶"}],Vs=[{id:"forza",label:"Forza",icon:"ðŸ’ª",description:"Aumentare i carichi massimali"},{id:"ipertrofia",label:"Ipertrofia",icon:"ðŸ‹ï¸",description:"Aumentare la massa muscolare"},{id:"dimagrimento",label:"Dimagrimento",icon:"ðŸ”¥",description:"Perdere grasso mantenendo muscolo"},{id:"resistenza",label:"Resistenza",icon:"ðŸƒ",description:"Migliorare endurance e capacitÃ "}];function Wf({currentCycle:t,currentWeight:a=0,currentLocation:r="gym",currentGoal:s="ipertrofia",onComplete:i,onDismiss:o}){var T,M,D;const[l,n]=m.useState("intro"),[c,u]=m.useState(a),[d,p]=m.useState([]),[f,h]=m.useState(r),[x,g]=m.useState(s),[y,v]=m.useState(!1),S=E=>{p(U=>U.includes(E)?U.filter(W=>W!==E):[...U,E])},P=f!==r,N=x!==s,I=async()=>{v(!0);try{const{data:{user:E}}=await ne.auth.getUser();if(E){const{error:U}=await ne.from("onboarding_data").update({personal_info:{weight:c},pain_areas:d,training_location:f,goal:x,last_screening_date:new Date().toISOString(),last_screening_cycle:t}).eq("user_id",E.id);U&&console.error("Error updating onboarding:",U);const W=localStorage.getItem("onboarding_data");if(W){const C=JSON.parse(W);C.personalInfo={...C.personalInfo,weight:c},C.painAreas=d,C.trainingLocation=f,C.goal=x,C.lastScreeningDate=new Date().toISOString(),C.lastScreeningCycle=t,localStorage.setItem("onboarding_data",JSON.stringify(C))}}i({weight:c,painAreas:d,location:f,goal:x,locationChanged:P,goalChanged:N})}catch(E){console.error("Error saving cycle screening:",E)}finally{v(!1)}};return e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-br from-blue-900/30 to-indigo-900/20 backdrop-blur-xl rounded-2xl p-6 border border-blue-500/30 shadow-2xl shadow-blue-500/10 mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-500/20",children:e.jsx(ea,{className:"w-6 h-6 text-blue-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-300",children:["Aggiornamento Ciclo ",t]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Aggiorna i tuoi parametri per il prossimo ciclo"})]})]}),e.jsx("button",{onClick:o,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsxs(Ne,{mode:"wait",children:[l==="intro"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("p",{className:"text-slate-300 mb-3",children:["Hai completato il ",e.jsxs("strong",{className:"text-blue-400",children:["Ciclo ",t]}),"! Prima di iniziare il nuovo ciclo, aggiorniamo alcuni parametri:"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-400",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(qr,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{children:"Peso corporeo attuale"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{children:"Eventuali dolori o fastidi"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Nr,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{children:"Conferma location (palestra/casa)"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4 text-emerald-400"}),e.jsx("span",{children:"Conferma obiettivo"})]})]})]}),e.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-sm text-emerald-300",children:"Questi dati permettono di ottimizzare il programma del prossimo ciclo e prevenire infortuni."})}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("weight"),className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:["Inizia",e.jsx(nt,{className:"w-5 h-5"})]})]},"intro"),l==="weight"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(qr,{className:"w-6 h-6 text-blue-400"}),e.jsx("h4",{className:"text-lg font-bold text-white",children:"Peso Attuale"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>u(E=>Math.max(30,E-.5)),className:"w-12 h-12 rounded-full bg-slate-700 hover:bg-slate-600 text-white text-2xl font-bold transition-colors",children:"-"}),e.jsxs("div",{className:"text-center",children:[e.jsx("input",{type:"number",value:c,onChange:E=>u(parseFloat(E.target.value)||0),className:"w-24 text-center text-4xl font-bold bg-transparent text-white border-b-2 border-blue-500 focus:outline-none",step:"0.5",min:"30",max:"200"}),e.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"kg"})]}),e.jsx("button",{onClick:()=>u(E=>Math.min(200,E+.5)),className:"w-12 h-12 rounded-full bg-slate-700 hover:bg-slate-600 text-white text-2xl font-bold transition-colors",children:"+"})]}),a>0&&e.jsxs("p",{className:"text-center text-sm text-slate-400 mt-4",children:["Peso precedente: ",a,"kg",c!==a&&e.jsxs("span",{className:c>a?"text-amber-400":"text-emerald-400",children:[" ","(",c>a?"+":"",(c-a).toFixed(1),"kg)"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("intro"),className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-xl transition-colors",children:"Indietro"}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("pain"),disabled:c<=0,className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:["Avanti",e.jsx(nt,{className:"w-5 h-5"})]})]})]},"weight"),l==="pain"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(qt,{className:"w-6 h-6 text-amber-400"}),e.jsx("h4",{className:"text-lg font-bold text-white",children:"Dolori o Fastidi?"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Seleziona le zone dove senti dolore o fastidio (anche lieve). Questo ci aiuta a modificare gli esercizi per prevenire infortuni."}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Wn.map(E=>e.jsx("button",{onClick:()=>S(E.id),className:`p-3 rounded-xl border-2 text-left transition-all duration-200 ${d.includes(E.id)?"border-amber-500 bg-amber-500/20 shadow-lg shadow-amber-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:E.icon}),e.jsx("span",{className:`text-sm font-medium ${d.includes(E.id)?"text-amber-300":"text-slate-300"}`,children:E.label})]})},E.id))}),d.length===0&&e.jsx("div",{className:"mt-4 p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-emerald-300 flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Nessun dolore? Perfetto! Clicca avanti."]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("weight"),className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-xl transition-colors",children:"Indietro"}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("location"),className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:["Avanti",e.jsx(nt,{className:"w-5 h-5"})]})]})]},"pain"),l==="location"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Nr,{className:"w-6 h-6 text-purple-400"}),e.jsx("h4",{className:"text-lg font-bold text-white",children:"Dove ti allenerai?"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Conferma dove vuoi allenarti nel prossimo ciclo. Se cambi location, genereremo un nuovo programma adatto."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>h("gym"),className:`p-4 rounded-xl border-2 transition-all duration-200 ${f==="gym"?"border-emerald-500 bg-emerald-500/20 shadow-lg shadow-emerald-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ðŸ‹ï¸"}),e.jsx("span",{className:`font-bold ${f==="gym"?"text-emerald-300":"text-slate-300"}`,children:"Palestra"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Attrezzatura completa"})]})}),e.jsx("button",{onClick:()=>h("home"),className:`p-4 rounded-xl border-2 transition-all duration-200 ${f==="home"?"border-blue-500 bg-blue-500/20 shadow-lg shadow-blue-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ðŸ "}),e.jsx("span",{className:`font-bold ${f==="home"?"text-blue-300":"text-slate-300"}`,children:"Casa"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Corpo libero / minima"})]})})]}),P&&e.jsx("div",{className:"mt-4 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-300",children:["âš ï¸ Cambio location: verrÃ  generato un nuovo programma adatto a ",f==="gym"?"palestra":"casa"]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("pain"),className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-xl transition-colors",children:"Indietro"}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("goal"),className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:["Avanti",e.jsx(nt,{className:"w-5 h-5"})]})]})]},"location"),l==="goal"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(et,{className:"w-6 h-6 text-emerald-400"}),e.jsx("h4",{className:"text-lg font-bold text-white",children:"Obiettivo"})]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Conferma o cambia il tuo obiettivo per il prossimo ciclo."}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Vs.map(E=>e.jsxs("button",{onClick:()=>g(E.id),className:`p-3 rounded-xl border-2 text-left transition-all duration-200 ${x===E.id?"border-emerald-500 bg-emerald-500/20 shadow-lg shadow-emerald-500/10":"border-slate-600 bg-slate-700/50 hover:border-slate-500"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl",children:E.icon}),e.jsx("span",{className:`font-bold text-sm ${x===E.id?"text-emerald-300":"text-slate-300"}`,children:E.label})]}),e.jsx("p",{className:"text-xs text-slate-400",children:E.description})]},E.id))}),N&&e.jsx("div",{className:"mt-4 p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-emerald-300",children:['âš ï¸ Cambio obiettivo: il programma verrÃ  ottimizzato per "',(T=Vs.find(E=>E.id===x))==null?void 0:T.label,'"']})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("location"),className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-xl transition-colors",children:"Indietro"}),e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("confirm"),className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:["Avanti",e.jsx(nt,{className:"w-5 h-5"})]})]})]},"goal"),l==="confirm"&&e.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[e.jsx("h4",{className:"text-lg font-bold text-white mb-4",children:"Riepilogo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-700/50 rounded-lg",children:[e.jsx("span",{className:"text-slate-400",children:"Peso"}),e.jsxs("span",{className:"font-bold text-white",children:[c," kg"]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[e.jsx("span",{className:"text-slate-400",children:"Dolori"}),e.jsx("div",{className:"mt-2",children:d.length===0?e.jsxs("span",{className:"text-emerald-400 flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Nessun dolore segnalato"]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(E=>{const U=Wn.find(W=>W.id===E);return e.jsxs("span",{className:"px-2 py-1 bg-amber-500/20 text-amber-300 rounded-full text-xs font-medium",children:[U==null?void 0:U.icon," ",U==null?void 0:U.label]},E)})})})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(Nr,{className:"w-4 h-4 text-purple-400"}),"Location"]}),e.jsxs("span",{className:`font-bold ${P?"text-purple-300":"text-white"}`,children:[f==="gym"?"ðŸ‹ï¸ Palestra":"ðŸ  Casa",P&&e.jsx("span",{className:"text-xs ml-2 text-purple-400",children:"(cambiato)"})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-700/50 rounded-lg",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4 text-emerald-400"}),"Obiettivo"]}),e.jsxs("span",{className:`font-bold ${N?"text-emerald-300":"text-white"}`,children:[(M=Vs.find(E=>E.id===x))==null?void 0:M.icon," ",(D=Vs.find(E=>E.id===x))==null?void 0:D.label,N&&e.jsx("span",{className:"text-xs ml-2 text-emerald-400",children:"(cambiato)"})]})]})]})]}),d.length>0&&e.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-sm text-amber-300",children:"Il prossimo programma terrÃ  conto dei dolori segnalati, evitando esercizi che potrebbero aggravare la situazione."})}),(P||N)&&e.jsx("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-sm text-purple-300",children:P&&N?"âš ï¸ Hai cambiato location e obiettivo: verrÃ  generato un nuovo programma personalizzato.":P?"âš ï¸ Hai cambiato location: verrÃ  generato un nuovo programma adatto.":"âš ï¸ Hai cambiato obiettivo: il programma verrÃ  ottimizzato di conseguenza."})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("goal"),className:"px-6 bg-slate-700 hover:bg-slate-600 text-slate-300 font-semibold py-3 rounded-xl transition-colors",children:"Indietro"}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:I,disabled:y,className:"flex-1 bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold py-3 rounded-xl shadow-lg shadow-emerald-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Salvataggio..."]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-5 h-5"}),"Conferma e Inizia Ciclo ",t+1]})})]})]},"confirm")]})]})}function Gf({open:t,onClose:a,onSelectPlan:r,userProgress:s}){const{t:i}=ia(),[o,l]=m.useState("pro"),[n,c]=m.useState(!1),[u,d]=m.useState(null);if(!t)return null;const p=[{tier:"base",name:"Early Bird",price:"12.90",monthlyEquivalent:"8.60",badge:"EARLY BIRD",icon:De,color:"from-amber-500 to-orange-500",borderColor:"border-amber-500",features:[{text:i("paywall.feature.complete_program"),included:!0},{text:i("paywall.feature.progressive_overload"),included:!0},{text:i("paywall.feature.pain_management"),included:!0},{text:i("paywall.feature.workout_logger"),included:!0},{text:i("paywall.feature.deload_week"),included:!0},{text:i("paywall.feature.video_corrections"),included:!1,note:i("paywall.feature.videos_included").replace("{{count}}","0")}]},{tier:"pro",name:"Pro",price:"24.90",monthlyEquivalent:"16.60",badge:i("paywall.most_chosen"),icon:Wt,color:"from-blue-600 to-purple-600",borderColor:"border-blue-500",features:[{text:i("paywall.feature.all_base"),included:!0},{text:i("paywall.feature.12_videos"),included:!0,highlight:!0,note:i("paywall.feature.per_week").replace("{{count}}","2")},{text:i("paywall.feature.technique_history"),included:!0},{text:i("paywall.feature.hd_tutorials"),included:!0},{text:i("paywall.feature.exercise_library"),included:!0},{text:i("paywall.feature.pdf_export"),included:!1}]},{tier:"premium",name:"Coach",price:"39.90",monthlyEquivalent:"26.60",badge:i("paywall.maximum"),icon:_c,color:"from-purple-600 to-pink-600",borderColor:"border-purple-500",features:[{text:i("paywall.feature.all_pro"),included:!0},{text:i("paywall.feature.unlimited_videos"),included:!0,highlight:!0},{text:i("paywall.feature.pdf_export"),included:!0},{text:i("paywall.feature.priority_support"),included:!0},{text:i("paywall.feature.early_access"),included:!0}]}],f=async h=>{d(null),c(!0);try{const{data:{user:x},error:g}=await ne.auth.getUser();if(g||!x){d(i("paywall.error.not_logged_in")),c(!1);return}r==null||r(h),await mu(h,x.id,x.email||"")}catch(x){console.error("[PAYWALL] Payment error:",x),d(x instanceof Error?x.message:i("paywall.error.generic")),c(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gray-900 rounded-lg max-w-6xl w-full my-8 border border-gray-700 relative max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-10",children:e.jsx(ke,{className:"w-6 h-6"})}),e.jsxs("div",{className:"p-8 text-center border-b border-gray-700",children:[e.jsx("h2",{className:"text-4xl font-bold text-white mb-3",children:i("paywall.congrats_title")}),e.jsx("p",{className:"text-gray-300 text-lg mb-6",children:i("paywall.unlock_subtitle")}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:s.workoutsCompleted}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.workouts_completed")})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:s.baselineImprovements.length}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.baseline_improvements")})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:s.injuriesAvoided}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.injuries_avoided")})]})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:p.map(h=>{const x=h.icon,g=o===h.tier,y=h.tier==="pro";return e.jsxs(L.div,{whileHover:{scale:1.02},onClick:()=>l(h.tier),className:`
                    relative bg-gray-800 rounded-lg p-6 cursor-pointer
                    transition-all duration-200 border-2
                    ${g?h.borderColor:"border-gray-700"}
                    ${y?"ring-2 ring-blue-500 ring-offset-2 ring-offset-gray-900":""}
                  `,children:[h.badge&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xs font-bold px-3 py-1 rounded-full",children:h.badge})}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:`bg-gradient-to-r ${h.color} w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3`,children:e.jsx(x,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:h.name})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-baseline justify-center gap-1",children:[e.jsx("span",{className:"text-gray-400",children:"â‚¬"}),e.jsx("span",{className:"text-5xl font-bold text-white",children:h.price})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i("paywall.per_6_weeks")}),e.jsx("p",{className:"text-gray-500 text-xs",children:i("paywall.monthly_equivalent").replace("{{price}}",h.monthlyEquivalent)})]}),e.jsx("ul",{className:"space-y-3 mb-6",children:h.features.map((v,S)=>e.jsxs("li",{className:`flex items-start gap-2 text-sm ${v.included?"text-gray-300":"text-gray-600"}`,children:[v.included?e.jsx(Fe,{className:`w-5 h-5 flex-shrink-0 ${v.highlight?"text-green-400":"text-gray-400"}`}):e.jsx(ke,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),e.jsxs("span",{children:[v.text,v.note&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",v.note,")"]})]})]},S))}),e.jsx("button",{onClick:v=>{v.stopPropagation(),f(h.tier)},disabled:n,className:`
                      w-full py-3 rounded-lg font-bold transition-all flex items-center justify-center gap-2
                      ${g?`bg-gradient-to-r ${h.color} text-white`:"bg-gray-700 text-gray-300 hover:bg-gray-600"}
                      ${n?"opacity-70 cursor-not-allowed":""}
                    `,children:n&&g?e.jsxs(e.Fragment,{children:[e.jsx(Pc,{className:"w-5 h-5 animate-spin"}),i("paywall.processing")]}):e.jsxs(e.Fragment,{children:[g&&e.jsx(Li,{className:"w-5 h-5"}),i(g?"paywall.pay_now":"paywall.select")]})})]},h.tier)})}),u&&e.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-300 text-sm text-center",children:u})}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6 text-gray-400 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Li,{className:"w-4 h-4"}),i("paywall.accepts_cards")]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:i("paywall.secure_payment")})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h4",{className:"text-white font-bold mb-4 text-center",children:i("paywall.why_different")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Yn,{className:"w-6 h-6 text-blue-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i("paywall.benefit.pain_title")}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.benefit.pain_desc")})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(De,{className:"w-6 h-6 text-green-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i("paywall.benefit.progressive_title")}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.benefit.progressive_desc")})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Zr,{className:"w-6 h-6 text-purple-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i("paywall.benefit.ai_title")}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.benefit.ai_desc")})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Rc,{className:"w-6 h-6 text-yellow-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i("paywall.benefit.no_commitment_title")}),e.jsx("p",{className:"text-sm text-gray-400",children:i("paywall.benefit.no_commitment_desc")})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsx("h4",{className:"text-white font-bold mb-4 text-center",children:i("paywall.comparison_title")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left text-gray-400 pb-2"}),e.jsx("th",{className:"text-center text-gray-400 pb-2",children:i("paywall.comparison.pdf_sheets")}),e.jsx("th",{className:"text-center text-gray-400 pb-2",children:i("paywall.comparison.generic_apps")}),e.jsx("th",{className:"text-center text-blue-400 pb-2 font-bold",children:"TrainSmart PRO"})]})}),e.jsxs("tbody",{className:"text-gray-300",children:[e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-3",children:i("paywall.comparison.custom_weights")}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center text-green-400",children:"âœ…"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-3",children:i("paywall.comparison.auto_progression")}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center text-green-400",children:"âœ…"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-3",children:i("paywall.comparison.pain_management")}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center text-green-400",children:"âœ…"})]}),e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("td",{className:"py-3",children:i("paywall.comparison.video_correction")}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsx("td",{className:"text-center",children:"âŒ"}),e.jsxs("td",{className:"text-center text-green-400",children:["âœ… ",i("paywall.comparison.12_videos")]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-bold",children:i("paywall.comparison.price_6_weeks")}),e.jsx("td",{className:"text-center",children:"â‚¬0-15"}),e.jsx("td",{className:"text-center",children:"â‚¬40-60"}),e.jsx("td",{className:"text-center text-blue-400 font-bold",children:"â‚¬24.90"})]})]})]})})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 rounded-lg p-6 mb-6 border border-blue-500/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-white font-bold text-lg mb-2",children:i("paywall.coach_title")}),e.jsx("p",{className:"text-gray-300 text-sm mb-4",children:i("paywall.coach_desc")}),e.jsx("button",{onClick:()=>{window.open("https://calendly.com/fitnessflow-coach","_blank")},className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-all inline-flex items-center gap-2",children:i("paywall.coach_button")})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:i("paywall.guarantee")}),e.jsx("p",{className:"text-gray-500 text-xs",children:i("paywall.no_auto_renewal")})]})]})]})})}const Uf=[{key:"post_workout",label:"Stessa sessione",sublabel:"Corsa dopo i pesi (15-20 min)",emoji:"ðŸ‹ï¸â€â™‚ï¸ðŸƒ"},{key:"separate_days",label:"Giorni separati",sublabel:"Corsa nei giorni di riposo",emoji:"ðŸ“…"}],Vf={sedentary:[{key:"build_base",label:"Costruire base aerobica",emoji:"ðŸŒ±"},{key:"weight_loss",label:"Perdere peso",emoji:"âš–ï¸"},{key:"health",label:"Migliorare la salute",emoji:"â¤ï¸"}],beginner:[{key:"build_base",label:"Costruire base aerobica",emoji:"ðŸŒ±"},{key:"run_5k",label:"Completare una 5K",emoji:"ðŸ…"},{key:"weight_loss",label:"Perdere peso",emoji:"âš–ï¸"},{key:"improve_endurance",label:"Migliorare resistenza",emoji:"ðŸ’ª"}],intermediate:[{key:"run_5k_time",label:"Migliorare tempo 5K",emoji:"â±ï¸"},{key:"run_10k",label:"Completare una 10K",emoji:"ðŸ…"},{key:"improve_endurance",label:"Migliorare resistenza",emoji:"ðŸ’ª"},{key:"weight_loss",label:"Perdere peso",emoji:"âš–ï¸"}],advanced:[{key:"run_10k_time",label:"Migliorare tempo 10K",emoji:"â±ï¸"},{key:"half_marathon",label:"Preparare mezza maratona",emoji:"ðŸ†"},{key:"speed_work",label:"Aumentare velocitÃ ",emoji:"âš¡"},{key:"improve_endurance",label:"Migliorare resistenza",emoji:"ðŸ’ª"}]},Kf={sedentary:{label:"Principiante assoluto",emoji:"ðŸŒ±"},beginner:{label:"Principiante",emoji:"ðŸƒ"},intermediate:{label:"Intermedio",emoji:"ðŸƒâ€â™‚ï¸"},advanced:{label:"Avanzato",emoji:"ðŸƒâ€â™€ï¸"}};function Yf(t,a,r){const s=t!==null&&a!==null?t*60+a:null;let i=0;s!==null&&(s>480?i=0:s>390?i=1:s>300?i=2:i=3);let o=0;r!==null&&(r>75?o=0:r>65?o=1:r>55?o=2:o=3);let l;if(s!==null&&r!==null)l=(i+o)/2;else if(s!==null)l=i;else if(r!==null)l=o;else return"sedentary";return l<.75?"sedentary":l<1.75?"beginner":l<2.5?"intermediate":"advanced"}function Zf({isOpen:t,onClose:a,onConfirm:r,userAge:s=30}){const[i,o]=m.useState("experience"),[l,n]=m.useState(null),[c,u]=m.useState(""),[d,p]=m.useState(""),[f,h]=m.useState(""),[x,g]=m.useState(null),[y,v]=m.useState(null),S=Math.round(208-.7*s),P=m.useMemo(()=>{if(l===!1)return"sedentary";const E=c?parseInt(c):null,U=d?parseInt(d):null,W=f?parseInt(f):null;return Yf(E,U,W)},[l,c,d,f]),N=Vf[P]||[],I=Kf[P],T=c&&d||f,M=()=>{if(x&&y){const E=c&&d?`${c}:${d.padStart(2,"0")}`:void 0;r({enabled:!0,level:P,goal:x,integration:y,restingHR:f?parseInt(f):void 0,currentPace:E,maxHR:S})}},D=()=>{o("experience"),n(null),u(""),p(""),h(""),g(null),v(null),a()};return t?e.jsx(Ne,{children:e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:D,children:e.jsxs(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:E=>E.stopPropagation(),className:"bg-slate-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-slate-800 border-b border-slate-700 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-900/50 rounded-full flex items-center justify-center",children:e.jsx(Zs,{className:"w-5 h-5 text-green-400"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Aggiungi Corsa"})]}),e.jsx("button",{onClick:D,className:"text-slate-400 hover:text-white",children:e.jsx(ke,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-4 space-y-6",children:[i==="experience"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Hai giÃ  esperienza con la corsa?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{n(!0),o("metrics")},className:"p-4 rounded-xl border-2 border-slate-700 hover:border-green-500 transition-all",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸƒ"}),e.jsx("div",{className:"font-semibold text-white",children:"SÃ¬, corro"}),e.jsx("div",{className:"text-xs text-slate-400",children:"So il mio passo o FC"})]}),e.jsxs("button",{onClick:()=>{n(!1),o("goal")},className:"p-4 rounded-xl border-2 border-slate-700 hover:border-amber-500 transition-all",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸš¶"}),e.jsx("div",{className:"font-semibold text-white",children:"No, sono nuovo"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Mai corso regolarmente"})]})]})]}),i==="metrics"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[e.jsx(kc,{className:"w-5 h-5 text-emerald-400"}),"I tuoi dati di corsa"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Inserisci almeno uno tra passo o FC"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-slate-300 flex items-center gap-2",children:[e.jsx(Wt,{className:"w-4 h-4 text-yellow-400"}),"Passo abituale (min:sec/km)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:c,onChange:E=>u(E.target.value),placeholder:"6",min:"3",max:"15",className:"w-20 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white text-center"}),e.jsx("span",{className:"text-white font-bold",children:":"}),e.jsx("input",{type:"number",value:d,onChange:E=>{(parseInt(E.target.value)<=59||E.target.value==="")&&p(E.target.value)},placeholder:"30",min:"0",max:"59",className:"w-20 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white text-center"}),e.jsx("span",{className:"text-slate-400",children:"/km"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm text-slate-300 flex items-center gap-2",children:[e.jsx(Yr,{className:"w-4 h-4 text-red-400"}),"FC a riposo (bpm)"]}),e.jsx("input",{type:"number",value:f,onChange:E=>h(E.target.value),placeholder:"es. 65",min:"40",max:"100",className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["FC max stimata: ",e.jsxs("span",{className:"text-emerald-400",children:[S," bpm"]})]})]}),T&&e.jsx("div",{className:"bg-emerald-900/30 rounded-xl p-3 border border-emerald-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:I.emoji}),e.jsx("div",{children:e.jsxs("div",{className:"font-semibold text-emerald-300",children:["Livello: ",I.label]})})]})}),e.jsx("button",{onClick:()=>o("goal"),disabled:!T,className:"w-full bg-emerald-600 text-white py-3 rounded-lg font-bold disabled:opacity-50",children:"Continua"})]}),i==="goal"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-emerald-900/30 rounded-xl p-3 border border-emerald-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:I.emoji}),e.jsxs("div",{className:"font-semibold text-emerald-300",children:["Livello: ",I.label]})]})}),e.jsx("h3",{className:"font-semibold text-white",children:"Qual Ã¨ il tuo obiettivo?"}),e.jsx("div",{className:"space-y-2",children:N.map(E=>e.jsxs("button",{onClick:()=>g(E.key),className:`w-full p-3 rounded-xl border-2 text-left transition-all flex items-center gap-3 ${x===E.key?"border-blue-500 bg-blue-900/30":"border-slate-700 hover:border-slate-500"}`,children:[e.jsx("span",{className:"text-xl",children:E.emoji}),e.jsx("span",{className:"font-medium text-white",children:E.label}),x===E.key&&e.jsx(Fe,{className:"w-5 h-5 text-blue-500 ml-auto"})]},E.key))}),e.jsx("button",{onClick:()=>o("integration"),disabled:!x,className:"w-full bg-emerald-600 text-white py-3 rounded-lg font-bold disabled:opacity-50",children:"Continua"})]}),i==="integration"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Come vuoi integrare la corsa?"}),e.jsx("div",{className:"space-y-2",children:Uf.map(E=>e.jsx("button",{onClick:()=>v(E.key),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${y===E.key?"border-emerald-500 bg-emerald-900/30":"border-slate-700 hover:border-slate-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:E.emoji}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white",children:E.label}),e.jsx("div",{className:"text-sm text-slate-400",children:E.sublabel})]}),y===E.key&&e.jsx(Fe,{className:"w-5 h-5 text-emerald-500 ml-auto"})]})},E.key))}),e.jsxs("button",{onClick:M,disabled:!y,className:"w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-lg font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(Xr,{className:"w-5 h-5"}),"Aggiungi Corsa al Programma"]})]}),i!=="experience"&&e.jsx("button",{onClick:()=>{i==="metrics"?o("experience"):i==="goal"?o(l?"metrics":"experience"):i==="integration"&&o("goal")},className:"w-full text-slate-400 hover:text-white py-2",children:"â† Indietro"})]})]})})}):null}function px(){var fa,rt,Rt,hr,gr,fs,Zt,Le,xs,bs,vs,mt,ys,ws,xa,Xt,fr,Ns,Ba,Fa,kt,Ss,Ct,$a,js,ba,qa,Et,Ha,_s,Wa,Ps,It,xr,br;const t=Mc(),{t:a}=ia(),r=sd(),{data:s,isLoading:i,error:o,refetch:l}=rd(),{data:n=[]}=id(),c=!!s,u=i?"syncing":o?"offline":"synced",{betaOverrides:d,fitnessLevelOverride:p}=so(),[f,h]=m.useState(!1),[x,g]=m.useState(!1),[y,v]=m.useState(!1),[S,P]=m.useState(!1),[N,I]=m.useState(!1),[T,M]=m.useState(!1),[D,E]=m.useState(null),[U,W]=m.useState(!1),[C,G]=m.useState(!1),[H,Y]=m.useState(null),[oe,X]=m.useState(!1),[ee,pe]=m.useState(null),[ie,ye]=m.useState(!1),[ue,Se]=m.useState(!1),[$e,ze]=m.useState("choose"),[oa,Oe]=m.useState(null),[Ge,ft]=m.useState({dumbbell:!1,barbell:!1,pullUpBar:!1,rings:!1,bands:!1,kettlebell:!1,bench:!1}),[q,lt]=m.useState({onboarding:null,quiz:null,screening:null}),[ls,ur]=m.useState(!1),[he,Ue]=m.useState(!1),[qe,Vt]=m.useState(null),[Pe,tt]=m.useState(!1),[Te,ct]=m.useState(!1),[Ae,Kt]=m.useState(null),[_t,la]=m.useState(!1),[xt,cs]=m.useState(!1),[ca,ds]=m.useState(!1),[Da,Ze]=m.useState(!1),[dt,ut]=m.useState(null);m.useEffect(()=>{za(),ma(),Xe(),ua(),da(),bt()},[]);async function da(){const{data:{user:j}}=await ne.auth.getUser();j!=null&&j.email&&Kt(j.email)}async function bt(){try{const{data:{user:j}}=await ne.auth.getUser();if(!j)return;const{count:B,error:A}=await ne.from("workout_logs").select("id",{count:"exact",head:!0}).eq("user_id",j.id).eq("completed",!0);if(A)throw A;const ae=new Date;ae.setDate(ae.getDate()-ae.getDay()),ae.setHours(0,0,0,0);const{count:Z,error:le}=await ne.from("workout_logs").select("id",{count:"exact",head:!0}).eq("user_id",j.id).eq("completed",!0).gte("workout_date",ae.toISOString());if(le)throw le;const{data:Q,error:me}=await ne.from("workout_logs").select("workout_date").eq("user_id",j.id).eq("completed",!0).order("workout_date",{ascending:!1}).limit(1).maybeSingle();if(me)throw me;ut({total:B||0,thisWeek:Z||0,lastWorkoutDate:(Q==null?void 0:Q.workout_date)||null})}catch(j){console.error("[Dashboard] Error loading sessions:",j),ut({total:0,thisWeek:0,lastWorkoutDate:null})}}const at=Ae==="dario.tripol@gmail.com";async function ua(){try{const{data:{user:j}}=await ne.auth.getUser();if(!j)return;const{data:B}=await ne.from("users").select("created_at, subscription_tier").eq("id",j.id).single();if(!B)return;const A=Math.floor((Date.now()-new Date(B.created_at).getTime())/(1e3*60*60*24)),ae=42;console.log("[Paywall] Days since signup:",A,"/",ae,"Tier:",B.subscription_tier),A>=ae&&B.subscription_tier==="free"&&(console.log("[Paywall] âœ… Trial ended after 6 weeks, triggering paywall modal"),ct(!0))}catch(j){console.error("[Paywall] Error checking trigger:",j)}}const xe=m.useMemo(()=>{if(!(s!=null&&s.start_date)||!(s!=null&&s.goal)||!(s!=null&&s.level))return null;const j=zf(s.start_date,s.goal,s.level);return console.log("[Dashboard] Retest schedule calculated:",j),j},[s==null?void 0:s.start_date,s==null?void 0:s.goal,s==null?void 0:s.level]);m.useEffect(()=>{if(!xe||!q.onboarding)return;const j=q.onboarding.lastScreeningCycle||0,B=xe.currentCycle;xe.phase==="retest"&&j<B&&!xt&&(console.log("[Dashboard] Showing cycle screening for cycle:",B),la(!0))},[xe,q.onboarding,xt]);async function ma(){try{console.log("ðŸ”„ Migrating localStorage to Supabase if needed..."),await nd(),console.log("âœ… Migration complete, React Query will handle data fetching")}catch(j){console.error("âŒ Error during migration:",j)}}const Re=m.useMemo(()=>{var V;if(!s)return{daysActive:0,totalVolume:0,weeklyVolume:0,progression:0,lastWorkoutDays:null};console.log("ðŸ“Š Calculating real analytics from program...");let j=0;if(s.start_date||s.created_at){const be=new Date(s.start_date||s.created_at),de=Math.abs(new Date().getTime()-be.getTime());j=Math.ceil(de/(1e3*60*60*24))}let B=0,A=0;if(s.weekly_split&&s.weekly_split.days)s.weekly_split.days.forEach(be=>{be.exercises.forEach(w=>{if(w.sets&&w.reps){const de=typeof w.reps=="string"?parseInt(w.reps.split("-")[0]):w.reps;B+=w.sets*de,A+=w.sets}})});else if(s.exercises){s.exercises.forEach(w=>{if(w.sets&&w.reps){const de=typeof w.reps=="string"?parseInt(w.reps.split("-")[0]):w.reps;B+=w.sets*de,A+=w.sets}});const be=s.frequency||3;B=B*be}const ae=Math.max(1,Math.ceil(j/7)),Z=B*ae;let le=0;if((V=q.screening)!=null&&V.patternBaselines&&s.exercises){const be=q.screening.patternBaselines;let w=0,de=0,fe=0;Object.values(be).forEach(ve=>{ve&&ve.reps&&(w+=ve.reps,fe++)}),s.exercises.forEach(ve=>{if(ve.baseline&&ve.reps){const Me=typeof ve.reps=="string"?parseInt(ve.reps.split("-")[0]):ve.reps;de+=Me}}),fe>0&&de>0&&(le=Math.round((de-w)/w*100))}let Q=null;if(s.last_accessed_at||s.updated_at){const be=new Date(s.last_accessed_at||s.updated_at);Q=Math.floor((new Date().getTime()-be.getTime())/(1e3*60*60*24))}const me={daysActive:j,totalVolume:Z,weeklyVolume:B,progression:Math.max(0,le),lastWorkoutDays:Q};return console.log("âœ… Analytics calculated:",me),me},[s,(fa=q.screening)==null?void 0:fa.patternBaselines]);function za(){const j=localStorage.getItem("onboarding_data"),B=localStorage.getItem("quiz_data"),A=localStorage.getItem("screening_data"),ae=localStorage.getItem("screening_pending");j&&lt(Z=>({...Z,onboarding:JSON.parse(j)})),B&&lt(Z=>({...Z,quiz:JSON.parse(B)})),A&&lt(Z=>({...Z,screening:JSON.parse(A)})),ae==="true"&&ds(!0),console.log("ðŸ“Š DATA STATUS:",{hasOnboarding:!!j,hasQuiz:!!B,hasScreening:!!A,screeningPending:ae==="true",screeningLevel:A?JSON.parse(A).level:null})}async function Xe(){try{const{data:j,error:B}=await od();if(console.log("ðŸ” Admin check result:",{isUserAdmin:j,error:B}),B){console.error("âŒ Admin check error:",B);return}j?(ur(!0),console.log("ðŸ›¡ï¸ User is admin - showing Admin Panel button")):console.log("â„¹ï¸ User is not admin (data returned false)")}catch(j){console.error("âŒ Admin check exception:",j)}}async function pa(){v(!0);try{console.log("ðŸ”„ STARTING DEEP RESET..."),console.log("1ï¸âƒ£ Clearing localStorage..."),["onboarding_data","quiz_data","screening_data","body_composition_data","assessment_results","currentProgram","programGenerated","generatedProgram","recovery_screening_data","recovery_program_data","tempUserId","userId","loopBreaker"].forEach(A=>{localStorage.removeItem(A),console.log(`  âœ… Removed: ${A}`)});const{data:{user:B}}=await ne.auth.getUser();if(B){console.log("2ï¸âƒ£ Cleaning Supabase for user:",B.id);const{error:A}=await ne.from("training_programs").delete().eq("user_id",B.id);A?console.error("Error deleting programs:",A):console.log("  âœ… Training programs deleted");const{error:ae}=await ne.from("assessments").delete().eq("user_id",B.id);ae?console.error("Error deleting assessments:",ae):console.log("  âœ… Assessments deleted");const{error:Z}=await ne.from("body_scans").delete().eq("user_id",B.id);Z||console.log("  âœ… Body scans deleted");const{error:le}=await ne.from("onboarding_data").delete().eq("user_id",B.id);le||console.log("  âœ… Onboarding data deleted")}else console.log("â„¹ï¸ No authenticated user, skipping Supabase cleanup");console.log("3ï¸âƒ£ Resetting UI state..."),r.clear(),lt({onboarding:null,quiz:null,screening:null}),console.log("âœ… DEEP RESET COMPLETE!"),alert(a("dashboard.reset.complete_message")),setTimeout(()=>{t("/slim-onboarding")},1500)}catch(j){console.error("âŒ Reset error:",j),alert(a("dashboard.reset.error_message"))}finally{v(!1),P(!1)}}async function Be(){v(!0);try{console.log("ðŸŽ¯ STARTING GOAL-ONLY RESET...");const{data:{user:j}}=await ne.auth.getUser();if(j){console.log("1ï¸âƒ£ Deleting current program...");const{error:B}=await ne.from("training_programs").delete().eq("user_id",j.id).eq("is_active",!0);B?console.error("Error deleting program:",B):console.log("  âœ… Active program deleted"),console.log("2ï¸âƒ£ Resetting goal in onboarding..."),localStorage.removeItem("currentProgram"),localStorage.removeItem("programGenerated"),localStorage.removeItem("generatedProgram"),r.invalidateQueries({queryKey:["program"]}),r.invalidateQueries({queryKey:["programs"]})}console.log("âœ… GOAL RESET COMPLETE!"),alert("Obiettivo resettato! Verrai reindirizzato per scegliere un nuovo obiettivo."),setTimeout(()=>{t("/slim-onboarding")},1e3)}catch(j){console.error("âŒ Goal reset error:",j),alert("Errore durante il reset dell'obiettivo")}finally{v(!1),P(!1)}}async function st(j){console.log(`ðŸ§ª QUICK TEST MODE: Setting up ${j} profile...`);const A={beginner:{quizScore:30,practicalScore:25,physicalScore:60},intermediate:{quizScore:60,practicalScore:55,physicalScore:70},advanced:{quizScore:90,practicalScore:85,physicalScore:80}}[j],ae=A.quizScore*.5+A.practicalScore*.3+A.physicalScore*.2,Z={personalInfo:{gender:"M",age:30,height:175,weight:75,bmi:24.5},trainingLocation:"home",goal:"muscle_gain",activityLevel:{weeklyFrequency:3,sessionDuration:60},equipment:{}},le={score:A.quizScore,level:j,completedAt:new Date().toISOString()},Q={beginner:{lower_push:{variantId:"air_squat",variantName:"Air Squat",difficulty:2,reps:10},horizontal_push:{variantId:"incline_pushup",variantName:"Incline Push-up",difficulty:3,reps:8},vertical_push:{variantId:"wall_pushup",variantName:"Wall Push-up",difficulty:2,reps:12},vertical_pull:{variantId:"inverted_row",variantName:"Inverted Row",difficulty:4,reps:6},lower_pull:{variantId:"glute_bridge",variantName:"Glute Bridge",difficulty:2,reps:15},core:{variantId:"plank",variantName:"Plank",difficulty:3,reps:30}},intermediate:{lower_push:{variantId:"pistol_assisted",variantName:"Pistol Assistito",difficulty:5,reps:8},horizontal_push:{variantId:"standard_pushup",variantName:"Push-up Standard",difficulty:5,reps:12},vertical_push:{variantId:"pike_pushup",variantName:"Pike Push-up",difficulty:6,reps:10},vertical_pull:{variantId:"pullup",variantName:"Pull-up",difficulty:7,reps:8},lower_pull:{variantId:"nordic_curl_assisted",variantName:"Nordic Curl Assistito",difficulty:6,reps:6},core:{variantId:"hanging_knee_raise",variantName:"Hanging Knee Raise",difficulty:6,reps:12}},advanced:{lower_push:{variantId:"pistol_squat",variantName:"Pistol Squat",difficulty:8,reps:12},horizontal_push:{variantId:"archer_pushup",variantName:"Archer Push-up",difficulty:8,reps:10},vertical_push:{variantId:"hspu",variantName:"Handstand Push-up",difficulty:9,reps:8},vertical_pull:{variantId:"pullup_weighted",variantName:"Pull-up Zavorrato",difficulty:9,reps:10},lower_pull:{variantId:"nordic_curl",variantName:"Nordic Curl",difficulty:9,reps:8},core:{variantId:"dragon_flag",variantName:"Dragon Flag",difficulty:10,reps:6}}},me={level:j,finalScore:ae.toFixed(1),practicalScore:A.practicalScore.toFixed(1),physicalScore:A.physicalScore.toFixed(1),patternBaselines:Q[j],completed:!0,timestamp:new Date().toISOString()};localStorage.setItem("onboarding_data",JSON.stringify(Z)),localStorage.setItem("quiz_data",JSON.stringify(le)),localStorage.setItem("screening_data",JSON.stringify(me)),console.log(`âœ… Test data created for ${j.toUpperCase()}`),alert(`âœ… Profilo di test ${j.toUpperCase()} creato!

Ora puoi generare un programma.`),za(),P(!1)}const Yt=m.useCallback(async()=>{var j,B,A,ae,Z,le;try{g(!0);const{onboarding:Q,quiz:me,screening:V}=q;if(!V||!V.level){alert("âš ï¸ Completa prima lo screening per determinare il tuo livello!"),t("/screening");return}const be=p||V.level,w=(Q==null?void 0:Q.goal)||"ipertrofia",de=w;console.group("ðŸŽ¯ PROGRAM GENERATION"),console.log("Level from Screening:",V.level),console.log("Level Override (Beta):",p),console.log("Final Level:",be),console.log("Screening Scores:",{final:V.finalScore,quiz:me==null?void 0:me.score,practical:V.practicalScore,physical:V.physicalScore}),console.log("Goal:",w,"â†’",de),console.groupEnd();const fe=ga(be,de,Q);console.log("ðŸ“¦ Generated program structure:",{name:fe.name,split:fe.split,hasWeeklySplit:!!fe.weeklySplit,weeklySplitType:typeof fe.weeklySplit,weeklySplitDays:((B=(j=fe.weeklySplit)==null?void 0:j.days)==null?void 0:B.length)||0,hasExercises:!!fe.exercises,exercisesCount:((A=fe.exercises)==null?void 0:A.length)||0,location:fe.location,frequency:fe.frequency}),console.log("ðŸ’¾ Saving program to Supabase...");const ve=await Na({name:fe.name,description:`Programma ${be} per ${de}`,level:be,goal:de,location:fe.location||"home",training_type:(Q==null?void 0:Q.trainingType)||"bodyweight",frequency:fe.frequency||3,split:fe.split,days_per_week:fe.frequency||3,weekly_split:fe.weeklySplit||{days:[]},exercises:fe.exercises||[],total_weeks:fe.totalWeeks||8,start_date:new Date().toISOString(),is_active:!0,status:"active",pain_areas:(Q==null?void 0:Q.painAreas)||[],pattern_baselines:(V==null?void 0:V.patternBaselines)||{},available_equipment:(Q==null?void 0:Q.equipment)||{},metadata:{screeningScores:{final:V.finalScore,quiz:me==null?void 0:me.score,practical:V.practicalScore,physical:V.physicalScore}}});if(ve.success){console.log("âœ… Program saved to Supabase:",(ae=ve.data)==null?void 0:ae.id),ve.fromCache||(console.log("ðŸ§¹ Clearing stale localStorage cache (using Supabase as source of truth)"),localStorage.removeItem("currentProgram")),console.log("ðŸ”„ Invalidating cache and waiting for refetch..."),await r.invalidateQueries({queryKey:Je.all});const Me=await l();console.log("âœ… Refetch complete, program data:",{hasData:!!Me.data,programId:(Z=Me.data)==null?void 0:Z.id,programName:(le=Me.data)==null?void 0:le.name}),Me.data?(alert(a("dashboard.generate.success_message").replace("{{level}}",be.toUpperCase()).replace("{{goal}}",de.toUpperCase())),window.scrollTo({top:0,behavior:"smooth"})):(console.error("âŒ CRITICAL: Refetch succeeded but no program data returned"),alert(a("dashboard.error.program_not_recovered")))}else console.warn("âš ï¸ Failed to save to Supabase, using localStorage:",ve.error),localStorage.setItem("currentProgram",JSON.stringify(fe)),alert(`${a("dashboard.error.saved_locally")}

${ve.error||a("dashboard.error.cloud_sync")}`)}catch(Q){console.error("âŒ Error:",Q),alert(a("dashboard.generate.error_message"))}finally{g(!1)}},[q,t,r,a]),Pt=m.useCallback(async()=>{var B,A,ae;if(!s||!q.screening||!((B=q.onboarding)!=null&&B.runningInterest)){alert("Errore: dati mancanti per rigenerare il programma");return}const j=q.onboarding.runningInterest;if(!j.enabled){alert("La corsa non Ã¨ abilitata nelle preferenze");return}g(!0),console.log("ðŸƒ Regenerating program with existing running prefs:",j);try{const Z=p||q.screening.level||"beginner",le=q.onboarding.goal||"ipertrofia",Q=ga(Z,le,q.onboarding),me=await Na({name:Q.name+" + Corsa",description:`Programma ${Z} per ${le} con corsa integrata`,level:Z,goal:le,location:q.onboarding.trainingLocation||"gym",training_type:q.onboarding.trainingType||"bodyweight",frequency:Q.frequency||3,split:Q.split,days_per_week:Q.frequency||3,weekly_split:Q.weeklySplit||{days:[]},exercises:Q.exercises||[],total_weeks:Q.totalWeeks||8,start_date:new Date().toISOString(),is_active:!0,status:"active",pain_areas:q.onboarding.painAreas||[],pattern_baselines:q.screening.patternBaselines||{},available_equipment:q.onboarding.equipment||{},metadata:{screeningScores:{final:q.screening.finalScore,quiz:(A=q.quiz)==null?void 0:A.score,practical:q.screening.practicalScore,physical:q.screening.physicalScore},runningRegenerated:!0,runningPrefs:j}});me.success?(console.log("âœ… Program regenerated with running:",(ae=me.data)==null?void 0:ae.id),localStorage.removeItem("currentProgram"),await r.invalidateQueries({queryKey:Je.all}),await l(),alert(`âœ… Programma rigenerato con la corsa!

Le sessioni di running sono ora integrate nel tuo programma.`),window.scrollTo({top:0,behavior:"smooth"})):(console.error("Failed to save:",me.error),alert("Errore nel salvataggio. Riprova."))}catch(Z){console.error("Error regenerating with running:",Z),alert("Errore durante la rigenerazione del programma.")}finally{g(!1)}},[s,q,p,r,l,Na]),us=m.useCallback(async j=>{var B,A;if(!s||!q.screening){alert("Errore: programma o screening non trovato");return}g(!0),console.log("ðŸƒ Adding running to existing program with prefs:",j);try{const Z={...q.onboarding||{},runningInterest:{enabled:!0,level:j.level,goal:j.goal,integration:j.integration,restingHR:j.restingHR,currentPace:j.currentPace,maxHR:j.maxHR}};localStorage.setItem("onboarding_data",JSON.stringify(Z)),lt(be=>({...be,onboarding:Z}));const le=p||q.screening.level||"beginner",Q=Z.goal||"ipertrofia",me=ga(le,Q,Z),V=await Na({name:me.name+" + Corsa",description:`Programma ${le} per ${Q} con corsa integrata`,level:le,goal:Q,location:Z.trainingLocation||"gym",training_type:Z.trainingType||"bodyweight",frequency:me.frequency||3,split:me.split,days_per_week:me.frequency||3,weekly_split:me.weeklySplit||{days:[]},exercises:me.exercises||[],total_weeks:me.totalWeeks||8,start_date:new Date().toISOString(),is_active:!0,status:"active",pain_areas:Z.painAreas||[],pattern_baselines:q.screening.patternBaselines||{},available_equipment:Z.equipment||{},metadata:{screeningScores:{final:q.screening.finalScore,quiz:(B=q.quiz)==null?void 0:B.score,practical:q.screening.practicalScore,physical:q.screening.physicalScore},runningAdded:!0,runningPrefs:j}});V.success?(console.log("âœ… Program with running saved:",(A=V.data)==null?void 0:A.id),localStorage.removeItem("currentProgram"),await r.invalidateQueries({queryKey:Je.all}),await l(),Ze(!1),alert(`âœ… Corsa aggiunta al programma!

Il tuo programma Ã¨ stato rigenerato con le sessioni di corsa.`),window.scrollTo({top:0,behavior:"smooth"})):(console.error("Failed to save:",V.error),alert("Errore nel salvataggio. Riprova."))}catch(ae){console.error("Error adding running:",ae),alert("Errore durante l'aggiunta della corsa.")}finally{g(!1)}},[s,q,p,r,l]),vt=m.useMemo(()=>{var j;return(j=s==null?void 0:s.weekly_split)!=null&&j.days?s.weekly_split.days.some(B=>B.runningSession):!1},[s]),ha=m.useMemo(()=>{var ae,Z,le;const j=[],B=q.onboarding;if(!B)return["onboarding"];console.log("[DASHBOARD] ðŸƒ Checking running interest:",{runningInterest:B.runningInterest,enabled:(ae=B.runningInterest)==null?void 0:ae.enabled,integration:(Z=B.runningInterest)==null?void 0:Z.integration,goal:(le=B.runningInterest)==null?void 0:le.goal});const A=B.runningInterest;return A==null?(console.log("[DASHBOARD] âš ï¸ runningInterest is undefined/null â†’ running_interest"),j.push("running_interest")):A.enabled===void 0?(console.log("[DASHBOARD] âš ï¸ runningInterest.enabled is undefined â†’ running_interest"),j.push("running_interest")):A.enabled===!0&&!A.goal?(console.log("[DASHBOARD] âš ï¸ enabled but no goal â†’ running_integration"),j.push("running_integration")):A.enabled===!0&&!A.integration&&(console.log("[DASHBOARD] âš ï¸ enabled but no integration â†’ running_integration"),j.push("running_integration")),console.log("[DASHBOARD] ðŸ“‹ Missing parts:",j),j},[q.onboarding]);function ga(j,B,A){var Rs,ks,Cs,va,Es,Ga,Ua,Va,Is,Ts,As;const ae=d.fitnessLevel||j,Z=d.goal||B,le=d.location||(A==null?void 0:A.trainingLocation)||"gym",Q=d.frequency||((Rs=A==null?void 0:A.activityLevel)==null?void 0:Rs.weeklyFrequency)||3,me=d.sessionDuration||((ks=A==null?void 0:A.activityLevel)==null?void 0:ks.sessionDuration),V=(A==null?void 0:A.trainingType)||"bodyweight",be=(A==null?void 0:A.equipment)||{},w=((Cs=A==null?void 0:A.personalInfo)==null?void 0:Cs.weight)||75,de=((va=q.screening)==null?void 0:va.patternBaselines)||{},fe=ph(de,w,ae),ve=(A==null?void 0:A.muscularFocus)||"",Me=(A==null?void 0:A.goals)||[Z],Tt=(A==null?void 0:A.sport)||"",Ce=(A==null?void 0:A.sportRole)||"",it=(A==null?void 0:A.legsGoalType)||void 0,He=((Es=A==null?void 0:A.personalInfo)==null?void 0:Es.gender)||"M";let Qe;if((Ga=A==null?void 0:A.running)!=null&&Ga.enabled)Qe=A.running,console.log("ðŸƒ Using complete RunningPreferences:",Qe);else if((Ua=A==null?void 0:A.runningInterest)!=null&&Ua.enabled){const ya={sedentary:{canRun5Min:!1,canRun10Min:!1,canRun20Min:!1,canRun30Min:!1},beginner:{canRun5Min:!0,canRun10Min:!0,canRun20Min:!1,canRun30Min:!1},intermediate:{canRun5Min:!0,canRun10Min:!0,canRun20Min:!0,canRun30Min:!1},advanced:{canRun5Min:!0,canRun10Min:!0,canRun20Min:!0,canRun30Min:!0}};Qe={enabled:!0,goal:{dimagrimento:"dimagrimento_cardio",resistenza:"resistenza_generale",prestazioni_sportive:"complemento_sport",sport_performance:"complemento_sport",corsa:"base_aerobica"}[Z]||"base_aerobica",integration:"separate_days",sessionsPerWeek:2,capacity:ya[A.runningInterest.level||"beginner"]},console.log("ðŸƒ Converted legacy runningInterest to runningPrefs:",Qe)}!(A!=null&&A.trainingLocation)&&!d.location&&console.warn("âš ï¸ trainingLocation missing in onboarding, defaulting to gym");const vr=d.painAreas||(A==null?void 0:A.painAreas)||[],At=Mm(vr);Object.values(d).some(ya=>ya!==null)&&console.log("ðŸ§ª BETA OVERRIDES APPLIED:",{level:d.fitnessLevel?`${j} â†’ ${ae}`:j,goal:d.goal?`${B} â†’ ${Z}`:B,location:d.location?`â†’ ${le}`:le,frequency:d.frequency?`â†’ ${Q}`:Q,painAreas:d.painAreas?At:"original"}),me&&console.log(`â±ï¸ Session duration: ${me} minutes`);const Ve=(Va=q.screening)==null?void 0:Va.quizScore,yt=(Is=q.screening)==null?void 0:Is.practicalScore,pt=(Ts=q.screening)==null?void 0:Ts.discrepancy;return pt&&(console.log(`ðŸ” [SCREENING SAFETY] Discrepancy: ${pt}`),console.log(`   Quiz: ${Ve}% | Practical: ${yt}%`)),{...Tm({level:ae,goal:Z,goals:Me,location:le,trainingType:V,frequency:Q,baselines:fe,painAreas:At,equipment:be,muscularFocus:ve,sessionDuration:me,sport:Tt,sportRole:Ce,legsGoalType:it,gender:He,runningPrefs:Qe,userAge:((As=A==null?void 0:A.personalInfo)==null?void 0:As.age)||30,quizScore:Ve,practicalScore:yt,discrepancyType:pt}),location:le,totalWeeks:8,createdAt:new Date().toISOString()}}function ms(j){var B;Oe(j),j==="home"?(ze("equipment"),(B=q.onboarding)!=null&&B.equipment&&ft(q.onboarding.equipment)):Oa(j,{})}async function Oa(j,B){var A,ae,Z,le,Q,me,V,be,w;try{Se(!0),console.group("ðŸ‹ï¸ LOCATION SWITCH"),console.log("Current location:",(A=q.onboarding)==null?void 0:A.trainingLocation),console.log("New location:",j),console.log("Equipment:",B);let de="bodyweight";j==="gym"?de="equipment":j==="home"&&(B.barbell||B.dumbbell?de="equipment":(B.pullUpBar||B.rings,de="bodyweight"));let fe=q.onboarding;(!fe||!fe.goal)&&(console.log("âš ï¸ Onboarding data missing from localStorage, using program data as fallback..."),s&&(fe={goal:s.goal,trainingLocation:s.location||"gym",trainingType:s.training_type||"equipment",painAreas:s.pain_areas||[],equipment:s.available_equipment||{}},console.log("âœ… Reconstructed onboarding from program:",fe)));const ve={...fe,trainingLocation:j,trainingType:de,equipment:j==="gym"?{barbell:!0,dumbbell:!0,machines:!0,pullUpBar:!0,bench:!0,cables:!0}:B};localStorage.setItem("onboarding_data",JSON.stringify(ve)),lt(pt=>({...pt,onboarding:ve})),console.log("âœ… Updated onboarding data:",ve);let Me=q.screening;(!Me||!Me.level)&&(console.log("âš ï¸ Screening data missing from localStorage, using program data as fallback..."),s&&(Me={level:s.level,patternBaselines:s.pattern_baselines||{},finalScore:((Z=(ae=s.metadata)==null?void 0:ae.screeningScores)==null?void 0:Z.final)||50,practicalScore:((Q=(le=s.metadata)==null?void 0:le.screeningScores)==null?void 0:Q.practical)||50,physicalScore:((V=(me=s.metadata)==null?void 0:me.screeningScores)==null?void 0:V.physical)||50,userId:s.user_id},console.log("âœ… Reconstructed screening from program:",Me)));const Tt={...Me,timestamp:new Date().toISOString()};localStorage.setItem("screening_data",JSON.stringify(Tt)),lt(pt=>({...pt,screening:Tt}));const{onboarding:Ce,quiz:it,screening:He}={onboarding:ve,quiz:q.quiz,screening:Tt};if(!He||!He.level){console.error("âŒ Screening data missing! Cannot switch location."),alert("Errore: dati di screening mancanti. Completa prima lo screening."),Se(!1),ye(!1),ze("choose"),Oe(null);return}const Qe=p||He.level,At=(Ce==null?void 0:Ce.goal)||"ipertrofia";console.log("ðŸŽ¯ Generating program with:",{level:Qe,goal:At,location:j,override:p});const Ve=ga(Qe,At,Ce),yt=await Na({name:Ve.name,description:`Programma ${Qe} per ${At} - ${j==="gym"?"Palestra":"Casa"}`,level:Qe,goal:At,location:j,training_type:ve.trainingType||"bodyweight",frequency:Ve.frequency||3,split:Ve.split,days_per_week:Ve.frequency||3,weekly_split:Ve.weeklySplit||{days:[]},exercises:Ve.exercises||[],total_weeks:Ve.totalWeeks||8,start_date:new Date().toISOString(),is_active:!0,status:"active",pain_areas:(Ce==null?void 0:Ce.painAreas)||[],pattern_baselines:(He==null?void 0:He.patternBaselines)||{},available_equipment:(Ce==null?void 0:Ce.equipment)||{},metadata:{screeningScores:{final:He.finalScore,quiz:it==null?void 0:it.score,practical:He.practicalScore,physical:He.physicalScore},locationSwitched:!0,previousLocation:(be=q.onboarding)==null?void 0:be.trainingLocation}});yt.success?(console.log("âœ… New program saved:",(w=yt.data)==null?void 0:w.id),localStorage.removeItem("currentProgram"),console.log("ðŸ”„ Invalidating cache and waiting for refetch..."),await r.invalidateQueries({queryKey:Je.all}),await l(),console.log("âœ… Refetch complete, program data is now available"),alert(`âœ… Location cambiata!

Nuovo programma per ${j==="gym"?"PALESTRA":"CASA"} generato con successo!`),window.scrollTo({top:0,behavior:"smooth"}),ye(!1),ze("choose"),Oe(null),console.groupEnd()):(console.warn("âš ï¸ Failed to save:",yt.error),localStorage.setItem("currentProgram",JSON.stringify(Ve)),alert(`${a("dashboard.error.saved_locally")}

${yt.error||a("dashboard.error.cloud_sync")}`),ye(!1),ze("choose"),Oe(null),console.groupEnd())}catch(de){console.error("âŒ Error switching location:",de),alert(a("dashboard.location_switch.error_message")),ye(!1),ze("choose"),Oe(null),console.groupEnd()}finally{Se(!1)}}const ge=m.useCallback(async()=>{try{console.log("ðŸšª Logging out..."),await ne.auth.signOut(),localStorage.clear(),t("/login")}catch(j){console.error("âŒ Error logging out:",j)}},[t]),ps=m.useCallback(async()=>{if(s!=null&&s.id)try{const{data:{user:j}}=await ne.auth.getUser();if(!j)return;const{data:B}=await ld(j.id,s.id);if(B&&B.length>0){const A=B[0];Vt(A),Ue(!0),console.log("[Dashboard] Found pending adjustment:",A)}}catch(j){console.error("[Dashboard] Error checking pending adjustments:",j)}},[s==null?void 0:s.id]),Ni=m.useCallback(async j=>{try{const B=await cd(j);if(B.success){console.log("[Dashboard] Deload applied successfully"),await r.invalidateQueries({queryKey:Je.all}),Ue(!1),Vt(null);const A=j.adjustment_type==="deload_week"?"Deload":j.adjustment_type==="decrease_volume"?"Riduzione volume":"Aumento volume";alert(`âœ… ${A} ${a("common.success").toLowerCase()}!

${a("dashboard.program.your_program_title").replace("âœ… ","")}`)}else throw new Error(B.error)}catch(B){console.error("[Dashboard] Error applying deload:",B),alert(a("dashboard.error.adjustment"))}},[r,a]);async function hs(){if(qe!=null&&qe.id)try{await md(qe.id),Ue(!1),Vt(null),console.log("[Dashboard] Deload rejected")}catch(j){console.error("[Dashboard] Error rejecting deload:",j)}}async function mr(){if(qe!=null&&qe.id)try{await pd(qe.id,7),Ue(!1),Vt(null),console.log("[Dashboard] Deload postponed for 7 days"),alert("Suggerimento rimandato di 7 giorni")}catch(j){console.error("[Dashboard] Error postponing deload:",j)}}async function gs(j){console.log("[Dashboard] Running session completed:",j);try{const{data:{user:B}}=await ne.auth.getUser();if(B&&s&&H){const{error:A}=await ne.from("workout_logs").insert({user_id:B.id,program_id:s.id,day_name:H.dayName||H.name||"Running",split_type:"running",session_rpe:j.rpe,session_duration_minutes:j.actualDuration,completed:j.completed,exercises_completed:1,total_exercises:1,notes:[j.notes,j.distance?`Distanza: ${j.distance} km`:null,j.avgHeartRate?`FC media: ${j.avgHeartRate} bpm`:null,j.feltEasy?"Sessione percepita facile":null].filter(Boolean).join(" | ")||null});A?(console.error("[Dashboard] Error saving running:",A),re.error("Errore nel salvataggio")):(re.success("Sessione running salvata!"),await r.invalidateQueries({queryKey:Je.all}))}}catch(B){console.error("[Dashboard] Error in handleRunningComplete:",B),re.error("Errore nel salvataggio")}G(!1),Y(null)}function pr(){G(!1),Y(null)}return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white p-4 md:p-8 relative overflow-hidden",children:[e.jsx(dd,{videoCount:9,opacity:.04,blur:3}),e.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-6 md:mb-8",children:[e.jsx(L.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-3xl md:text-5xl font-display font-bold bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent",children:(Rt=(rt=q.onboarding)==null?void 0:rt.anagrafica)!=null&&Rt.firstName?`Ciao, ${q.onboarding.anagrafica.firstName}!`:a("dashboard.title")}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 overflow-x-auto pb-2 md:pb-0 hide-scrollbar",children:[e.jsx(gd,{}),e.jsxs("div",{className:`flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5 md:py-2 rounded-lg text-xs md:text-sm whitespace-nowrap ${u==="synced"?"bg-emerald-500/10 text-emerald-400 border border-emerald-500/30":u==="syncing"?"bg-blue-500/10 text-blue-400 border border-blue-500/30":"bg-amber-500/10 text-amber-400 border border-amber-500/30"}`,children:[u==="synced"?e.jsx(Di,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}):u==="syncing"?e.jsx(Di,{className:"w-3.5 h-3.5 md:w-4 md:h-4 animate-pulse"}):e.jsx(Cc,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),e.jsx("span",{className:"font-medium hidden sm:inline",children:u==="synced"?"Sync":u==="syncing"?"...":"Offline"})]}),n.length>1&&e.jsxs(L.button,{whileTap:{scale:.95},onClick:()=>I(!N),className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-3 md:px-4 py-2 md:py-3 rounded-xl flex items-center gap-1.5 md:gap-2 shadow-lg shadow-blue-500/20 transition-all duration-300 whitespace-nowrap text-sm md:text-base",children:[e.jsx(Sr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Storico"})," (",n.length,")"]}),ls&&e.jsxs(L.button,{whileTap:{scale:.95},onClick:()=>t("/admin"),className:"bg-gradient-to-r from-purple-600 to-purple-700 text-white px-3 md:px-4 py-2 md:py-3 rounded-xl flex items-center gap-1.5 md:gap-2 shadow-lg shadow-purple-500/20 transition-all duration-300 whitespace-nowrap text-sm md:text-base",children:[e.jsx(Yn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Admin"})]}),e.jsxs(L.button,{whileTap:{scale:.95},onClick:ge,className:"bg-gradient-to-r from-slate-600 to-slate-700 text-white px-3 md:px-4 py-2 md:py-3 rounded-xl flex items-center gap-1.5 md:gap-2 shadow-lg shadow-slate-500/20 transition-all duration-300 whitespace-nowrap text-sm md:text-base",children:[e.jsx(Ec,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("nav.logout")})]}),at&&e.jsxs(L.button,{whileTap:{scale:.95},onClick:()=>P(!0),className:"bg-gradient-to-r from-red-600 to-red-700 text-white px-3 md:px-6 py-2 md:py-3 rounded-xl flex items-center gap-1.5 md:gap-2 shadow-lg shadow-red-500/20 transition-all duration-300 whitespace-nowrap text-sm md:text-base",children:[e.jsx(Un,{className:"w-4 h-4"}),"Reset"]})]})]}),ca&&e.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/50 rounded-xl p-4 md:p-5",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-500/30 flex items-center justify-center flex-shrink-0",children:e.jsx(Ic,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-200 text-lg",children:"Completa i test fisici"}),e.jsx("p",{className:"text-amber-200/80 text-sm mt-1",children:"Sei in palestra? Completa i test pratici per ottenere un programma personalizzato sui tuoi massimali reali."})]})]}),e.jsxs("div",{className:"flex gap-3 ml-13 md:ml-0",children:[e.jsx("button",{onClick:()=>{var B;const j=(B=q.onboarding)==null?void 0:B.screeningType;t(j==="thorough"?"/screening-full":"/screening")},className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:from-amber-600 hover:to-orange-600 transition-all shadow-lg shadow-amber-500/20",children:"Fai i test ora"}),e.jsx("button",{onClick:()=>{ds(!1)},className:"text-amber-300/70 hover:text-amber-200 text-sm font-medium",children:"Dopo"})]})]})}),e.jsxs("div",{className:"flex md:grid md:grid-cols-3 gap-3 md:gap-6 mb-6 md:mb-8 overflow-x-auto pb-2 md:pb-0 hide-scrollbar -mx-4 px-4 md:mx-0 md:px-0",children:[e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"min-w-[200px] md:min-w-0 flex-shrink-0 md:flex-shrink",children:e.jsxs(Dt,{className:"bg-slate-800/60 backdrop-blur-xl border-slate-700/50 shadow-2xl shadow-emerald-500/5 hover:shadow-emerald-500/10 transition-all duration-300 h-full",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-base md:text-lg font-display flex items-center gap-2",children:[q.onboarding?e.jsx(We,{className:"w-4 h-4 md:w-5 md:h-5 text-emerald-400"}):e.jsx(qt,{className:"w-4 h-4 md:w-5 md:h-5 text-amber-400"}),"Onboarding"]})}),e.jsx(Bt,{className:"p-3 md:p-6 pt-0",children:e.jsx("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:q.onboarding?e.jsxs(e.Fragment,{children:["Goal: ",e.jsx("span",{className:"text-emerald-400",children:q.onboarding.goal})]}):"Non completato"})})]})}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"min-w-[200px] md:min-w-0 flex-shrink-0 md:flex-shrink",children:e.jsxs(Dt,{className:"bg-slate-800/60 backdrop-blur-xl border-slate-700/50 shadow-2xl shadow-emerald-500/5 hover:shadow-emerald-500/10 transition-all duration-300 h-full",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-base md:text-lg font-display flex items-center gap-2",children:[dt&&dt.total>0?e.jsx(We,{className:"w-4 h-4 md:w-5 md:h-5 text-emerald-400"}):e.jsx(qt,{className:"w-4 h-4 md:w-5 md:h-5 text-amber-400"}),a("dashboard.sessions")||"Sessioni"]})}),e.jsx(Bt,{className:"p-3 md:p-6 pt-0",children:dt?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:[a("dashboard.total")||"Totale",": ",e.jsx("span",{className:"text-emerald-400 font-bold",children:dt.total})]}),dt.thisWeek>0&&e.jsxs("p",{className:"text-xs text-slate-500",children:[a("dashboard.thisWeek")||"Questa settimana",": ",e.jsx("span",{className:"text-emerald-400",children:dt.thisWeek})]}),dt.lastWorkoutDate&&e.jsx("p",{className:"text-xs text-slate-500",children:(()=>{const j=Math.floor((Date.now()-new Date(dt.lastWorkoutDate).getTime())/864e5);return j===0?"ðŸ”¥ Oggi":j===1?"Ieri":`${j}g fa`})()})]}):e.jsx("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:a("common.loading")||"Caricamento..."})})]})}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},className:"min-w-[200px] md:min-w-0 flex-shrink-0 md:flex-shrink",children:e.jsxs(Dt,{className:"bg-slate-800/60 backdrop-blur-xl border-slate-700/50 shadow-2xl shadow-emerald-500/5 hover:shadow-emerald-500/10 transition-all duration-300 h-full",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-base md:text-lg font-display flex items-center gap-2",children:[q.screening?e.jsx(We,{className:"w-4 h-4 md:w-5 md:h-5 text-emerald-400"}):e.jsx(qt,{className:"w-4 h-4 md:w-5 md:h-5 text-amber-400"}),"Screening"]})}),e.jsx(Bt,{className:"p-3 md:p-6 pt-0",children:e.jsx("p",{className:"text-xs md:text-sm text-slate-400 font-medium",children:q.screening?e.jsxs(e.Fragment,{children:["Level: ",e.jsx("span",{className:"text-emerald-400 font-bold",children:(hr=q.screening.level)==null?void 0:hr.toUpperCase()})]}):"Non completato"})})]})})]}),xe&&xe.phase==="deload"&&xe.deloadConfig&&!Pe&&c&&e.jsx(Hf,{daysUntilRetest:xe.daysUntilRetest,deloadConfig:xe.deloadConfig,nextRetestConfig:xe.nextConfig,currentCycle:xe.currentCycle,onDismiss:()=>tt(!0)}),xe&&(xe.phase==="retest"||xe.phase==="training")&&!Pe&&c&&e.jsx(qf,{schedule:xe,goal:(s==null?void 0:s.goal)||"ipertrofia",baselines:((gr=q.screening)==null?void 0:gr.patternBaselines)||{},onStartRetest:()=>{t("/screening",{state:{retestMode:!0,targetRM:xe.nextConfig.targetRM,cycle:xe.currentCycle+1}})},onDismiss:()=>tt(!0)}),xe&&_t&&!xt&&c&&e.jsx(Wf,{currentCycle:xe.currentCycle,currentWeight:((Zt=(fs=q.onboarding)==null?void 0:fs.personalInfo)==null?void 0:Zt.weight)||0,currentLocation:((Le=q.onboarding)==null?void 0:Le.trainingLocation)==="home"?"home":"gym",currentGoal:((xs=q.onboarding)==null?void 0:xs.goal)||"ipertrofia",onComplete:async j=>{var B,A,ae,Z;if(console.log("Cycle screening completed:",j),q.onboarding){const le={...q.onboarding,personalInfo:{...q.onboarding.personalInfo,weight:j.weight},painAreas:j.painAreas,trainingLocation:j.location,goal:j.goal};if(lt(Q=>({...Q,onboarding:le})),localStorage.setItem("onboarding_data",JSON.stringify(le)),j.locationChanged||j.goalChanged){console.log("ðŸ”„ Location or goal changed, regenerating program..."),console.log("  - Location changed:",j.locationChanged,"â†’",j.location),console.log("  - Goal changed:",j.goalChanged,"â†’",j.goal);try{const Q=q.screening;if(!Q){console.error("âŒ No screening data available");return}const me=p||Q.level||(Q.finalScore>=70?"intermediate":"beginner"),V=j.location,be=j.goal;console.log("ðŸŽ¯ Generating new program with:",{level:me,goal:be,location:V,override:p});const w=ga(me,be,{...le,trainingLocation:V,goal:be}),de=await Na({name:w.name,description:`Programma ${me} per ${be} - ${V==="gym"?"Palestra":"Casa"} (Ciclo ${(xe==null?void 0:xe.currentCycle)||1})`,level:me,goal:be,location:V,training_type:le.trainingType||"bodyweight",frequency:w.frequency||3,split:w.split,days_per_week:w.frequency||3,weekly_split:w.weeklySplit||{days:[]},exercises:w.exercises||[],total_weeks:w.totalWeeks||8,start_date:new Date().toISOString(),is_active:!0,status:"active",pain_areas:j.painAreas||[],pattern_baselines:(Q==null?void 0:Q.patternBaselines)||{},available_equipment:(le==null?void 0:le.equipment)||{},metadata:{screeningScores:{final:Q.finalScore,quiz:(B=q.quiz)==null?void 0:B.score,practical:Q.practicalScore,physical:Q.physicalScore},cycleScreening:!0,previousCycle:(xe==null?void 0:xe.currentCycle)||1,locationChanged:j.locationChanged,goalChanged:j.goalChanged,previousLocation:(A=q.onboarding)==null?void 0:A.trainingLocation,previousGoal:(ae=q.onboarding)==null?void 0:ae.goal}});if(de.success){console.log("âœ… New program saved after cycle screening:",(Z=de.data)==null?void 0:Z.id),localStorage.removeItem("currentProgram"),console.log("ðŸ”„ Invalidating cache and waiting for refetch..."),await r.invalidateQueries({queryKey:Je.all}),await l(),console.log("âœ… Refetch complete, new program is now active");const fe=V==="gym"?"PALESTRA":"CASA",ve=j.locationChanged&&j.goalChanged?`Location (${fe}) e obiettivo (${be}) aggiornati!`:j.locationChanged?`Location cambiata: ${fe}`:`Obiettivo aggiornato: ${be}`;alert(`âœ… Nuovo ciclo iniziato!

${ve}

Nuovo programma generato con successo!`),window.scrollTo({top:0,behavior:"smooth"})}else console.warn("âš ï¸ Failed to save new program:",de.error),localStorage.setItem("currentProgram",JSON.stringify(w)),alert(`Programma salvato localmente.

${de.error||"Errore di sincronizzazione cloud"}`)}catch(Q){console.error("Error regenerating program after cycle screening:",Q),alert("Errore durante la rigenerazione del programma. Riprova.")}}}la(!1),cs(!0)},onDismiss:()=>{la(!1),cs(!0)}}),c&&((s==null?void 0:s.user_id)||((bs=q.screening)==null?void 0:bs.userId))&&e.jsxs("div",{className:"space-y-4 mb-6 md:mb-8",children:[e.jsx(yf,{userId:(s==null?void 0:s.user_id)||((vs=q.screening)==null?void 0:vs.userId)||""}),e.jsx(Sf,{userId:(s==null?void 0:s.user_id)||((mt=q.screening)==null?void 0:mt.userId)||""}),e.jsx(kf,{userId:(s==null?void 0:s.user_id)||((ys=q.screening)==null?void 0:ys.userId)||"",userWeight:((ws=q.screening)==null?void 0:ws.weight)||75,userGender:((xa=q.screening)==null?void 0:xa.gender)==="female"?"F":"M"}),e.jsx(If,{userId:(s==null?void 0:s.user_id)||((Xt=q.screening)==null?void 0:Xt.userId)||""})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 md:gap-6 mb-6 md:mb-8",children:[e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.4},children:e.jsxs(Dt,{className:"bg-gradient-to-br from-emerald-900/40 to-emerald-800/20 backdrop-blur-xl border-emerald-700/50 shadow-2xl shadow-emerald-500/10 hover:shadow-emerald-500/20 transition-all duration-300",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-sm md:text-lg font-display flex items-center gap-2 text-emerald-300",children:[e.jsx(ea,{className:"w-4 h-4 md:w-5 md:h-5"}),"Giorni Attivi"]})}),e.jsxs(Bt,{className:"p-3 md:p-6 pt-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl md:text-4xl font-bold text-emerald-400",children:Re.daysActive}),e.jsx("span",{className:"text-xs md:text-sm text-emerald-300/60",children:a("onboarding.activity.days")})]}),e.jsx("p",{className:"text-[10px] md:text-xs text-emerald-300/50 mt-1 md:mt-2 line-clamp-1",children:Re.lastWorkoutDays!==null?`${a("dashboard.analytics.last_workout")}: ${Re.lastWorkoutDays===0?a("dashboard.analytics.today"):Re.lastWorkoutDays===1?a("dashboard.analytics.yesterday"):a("dashboard.analytics.days_ago").replace("{{days}}",String(Re.lastWorkoutDays))}`:a("dashboard.no_program_desc")})]})]})}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.5},children:e.jsxs(Dt,{className:"bg-gradient-to-br from-blue-900/40 to-blue-800/20 backdrop-blur-xl border-blue-700/50 shadow-2xl shadow-blue-500/10 hover:shadow-blue-500/20 transition-all duration-300",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-sm md:text-lg font-display flex items-center gap-2 text-blue-300",children:[e.jsx(et,{className:"w-4 h-4 md:w-5 md:h-5"}),a("dashboard.analytics.total_volume")]})}),e.jsxs(Bt,{className:"p-3 md:p-6 pt-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl md:text-4xl font-bold text-blue-400",children:Re.totalVolume>0?Re.totalVolume.toLocaleString():"0"}),e.jsx("span",{className:"text-xs md:text-sm text-blue-300/60",children:"reps"})]}),e.jsx("p",{className:"text-[10px] md:text-xs text-blue-300/50 mt-1 md:mt-2",children:a("dashboard.analytics.weekly").replace("{{volume}}",Re.weeklyVolume>0?Re.weeklyVolume.toLocaleString():"0")})]})]})}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.6},children:e.jsxs(Dt,{className:"bg-gradient-to-br from-purple-900/40 to-purple-800/20 backdrop-blur-xl border-purple-700/50 shadow-2xl shadow-purple-500/10 hover:shadow-purple-500/20 transition-all duration-300",children:[e.jsx(zt,{className:"pb-2 md:pb-3 p-3 md:p-6",children:e.jsxs(Ot,{className:"text-sm md:text-lg font-display flex items-center gap-2 text-purple-300",children:[e.jsx(Wt,{className:"w-4 h-4 md:w-5 md:h-5"}),"Progressione"]})}),e.jsxs(Bt,{className:"p-3 md:p-6 pt-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl md:text-4xl font-bold text-purple-400",children:Re.progression>0?`+${Re.progression}%`:"0%"}),e.jsx("span",{className:"text-xs md:text-sm text-purple-300/60",children:"vs baseline"})]}),e.jsx("div",{className:"mt-2 md:mt-3 h-1.5 md:h-2 bg-purple-900/30 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-400 rounded-full transition-all duration-500",style:{width:`${Math.min(100,Re.progression)}%`}})})]})]})})]}),e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:e.jsxs(Dt,{className:"bg-slate-800/60 backdrop-blur-xl border-slate-700/50 shadow-2xl shadow-emerald-500/5",children:[e.jsx(zt,{className:"p-4 md:p-6",children:e.jsx(Ot,{className:"text-xl md:text-3xl font-display font-bold",children:c?"âœ… Il Tuo Programma":"ðŸ“‹ Genera il Tuo Programma"})}),e.jsx(Bt,{className:"space-y-4 p-4 md:p-6 pt-0",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-700/50 backdrop-blur-sm rounded-xl md:rounded-2xl p-4 md:p-6 border border-slate-600/50",children:[e.jsxs("div",{className:"mb-3 md:mb-4",children:[e.jsx("h3",{className:"text-lg md:text-2xl font-display font-bold mb-2 md:mb-3 bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent",children:s.name}),e.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-3 text-xs md:text-sm",children:[e.jsxs("span",{className:"px-2 md:px-3 py-1 md:py-1.5 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 font-medium",children:["ðŸ“Š ",(Fa=s.level)==null?void 0:Fa.toUpperCase()]}),e.jsxs("span",{className:"px-2 md:px-3 py-1 md:py-1.5 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 font-medium",children:["ðŸŽ¯ ",s.goal]}),e.jsxs("span",{className:"px-2 md:px-3 py-1 md:py-1.5 rounded-full bg-slate-600/50 text-slate-300 border border-slate-500/30 font-medium",children:["ðŸ“ ",s.location]})]})]}),e.jsxs("div",{className:"mb-4 space-y-1",children:[e.jsxs("p",{className:"text-slate-300",children:["Split: ",e.jsx("span",{className:"font-display font-semibold text-white",children:s.split})]}),e.jsxs("p",{className:"text-slate-300",children:["Frequenza: ",e.jsxs("span",{className:"font-display font-semibold text-white",children:[s.frequency,"x/settimana"]})]})]}),ha.length>0&&e.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/50 rounded-xl p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-500/30 flex items-center justify-center flex-shrink-0",children:e.jsx(qt,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-amber-200",children:"Completa il tuo profilo"}),e.jsx("p",{className:"text-amber-200/70 text-sm",children:ha.includes("running_interest")?"Non ci hai ancora detto se vuoi integrare la corsa nel tuo allenamento":ha.includes("running_integration")?"Scegli come integrare la corsa: insieme ai pesi o in giorni separati":"Alcune informazioni mancano per ottimizzare il tuo programma"})]})]}),e.jsx("button",{onClick:()=>Ze(!0),className:"bg-gradient-to-r from-amber-500 to-orange-600 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:from-amber-600 hover:to-orange-700 transition-all shadow-lg shadow-amber-500/20 whitespace-nowrap",children:"Completa Ora"})]})}),!vt&&ha.length===0&&((Ss=(kt=q.onboarding)==null?void 0:kt.runningInterest)==null?void 0:Ss.enabled)===!1&&e.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/50 rounded-xl p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500/30 flex items-center justify-center flex-shrink-0",children:e.jsx(Zs,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-green-200",children:"Vuoi aggiungere la corsa?"}),e.jsx("p",{className:"text-green-200/70 text-sm",children:"Migliora resistenza e recupero con sessioni di running"})]})]}),e.jsx("button",{onClick:()=>Ze(!0),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:from-green-600 hover:to-emerald-700 transition-all shadow-lg shadow-green-500/20 whitespace-nowrap",children:"+ Aggiungi Corsa"})]})}),!vt&&ha.length===0&&(($a=(Ct=q.onboarding)==null?void 0:Ct.runningInterest)==null?void 0:$a.enabled)===!0&&e.jsx(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 bg-gradient-to-r from-teal-500/20 to-cyan-500/20 border border-teal-500/50 rounded-xl p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-teal-500/30 flex items-center justify-center flex-shrink-0",children:e.jsx(Zs,{className:"w-5 h-5 text-teal-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-teal-200",children:"Corsa non ancora integrata"}),e.jsxs("p",{className:"text-teal-200/70 text-sm",children:["Hai scelto di integrare la corsa (",((ba=(js=q.onboarding)==null?void 0:js.runningInterest)==null?void 0:ba.integration)==="post_workout"?"dopo i pesi":"giorni separati","), ma il programma attuale non la include"]})]})]}),e.jsx("button",{onClick:Pt,disabled:x,className:"bg-gradient-to-r from-teal-500 to-cyan-600 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:from-teal-600 hover:to-cyan-700 transition-all shadow-lg shadow-teal-500/20 whitespace-nowrap disabled:opacity-50",children:x?"Rigenerando...":"Rigenera con Corsa"})]})}),((Et=(qa=s.weekly_split)==null?void 0:qa.days)==null?void 0:Et.length)>0?e.jsxs("div",{children:[e.jsx("h4",{className:"font-display font-semibold text-lg mb-4",children:"Programma Settimanale:"}),e.jsx(bh,{weeklySplit:s.weekly_split,showDetails:!1})]}):e.jsxs("div",{children:[e.jsx("h4",{className:"font-display font-semibold text-lg mb-4",children:"Esercizi (basati sulle tue baseline):"}),e.jsx("ul",{className:"space-y-3",children:(Ha=s.exercises)==null?void 0:Ha.map((j,B)=>{const A=j.pattern==="corrective",ae=j.wasReplaced;return e.jsx(L.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:B*.05},whileHover:{scale:1.01},className:`rounded-xl p-4 border backdrop-blur-sm transition-all duration-200 ${A?"bg-blue-500/10 border-blue-500/30 hover:border-blue-500/50":ae?"bg-amber-500/10 border-amber-500/30 hover:border-amber-500/50":"bg-slate-800/50 border-slate-600/50 hover:border-emerald-500/30"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`font-mono font-bold text-lg ${A?"text-blue-400":ae?"text-amber-400":"text-emerald-400"}`,children:A?"ðŸ”§":ae?"âš ï¸":`${B+1}.`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`font-semibold text-base ${A?"text-blue-300":ae?"text-amber-300":"text-white"}`,children:[(j==null?void 0:j.name)||"Unknown Exercise",A&&e.jsx("span",{className:"text-xs ml-2 px-2 py-0.5 rounded-full bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"(Correttivo)"}),ae&&e.jsx("span",{className:"text-xs ml-2 px-2 py-0.5 rounded-full bg-amber-500/20 text-amber-400 border border-amber-500/30",children:"(Sostituito)"})]}),j.sets&&j.reps&&e.jsxs("p",{className:"text-sm text-slate-400 mt-2 font-medium",children:[e.jsxs("span",{className:"font-mono text-emerald-400",children:[j.sets," sets"]})," Ã— ",e.jsxs("span",{className:"font-mono text-emerald-400",children:[j.reps," reps"]}),j.weight&&e.jsxs("span",{className:"text-amber-400 font-mono font-bold",children:[" â€¢ ",j.weight]}),j.intensity&&e.jsxs("span",{className:"text-blue-400 font-mono",children:[" @ ",j.intensity]})," â€¢ ","Rest: ",e.jsx("span",{className:"font-mono",children:j.rest})]}),j.notes&&e.jsx("p",{className:"text-xs text-slate-500 mt-2 italic",children:j.notes})]})]})},B)})})]}),s.notes&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-600/50",children:e.jsx("p",{className:"text-sm text-slate-400 italic",children:s.notes})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 md:gap-4",children:[e.jsxs(L.button,{whileTap:{scale:.98},onClick:()=>{var B,A;const j=(A=(B=s.weekly_split)==null?void 0:B.days)==null?void 0:A[0];if(j){if(j.type==="running"&&j.runningSession&&(!j.exercises||j.exercises.length===0)){console.log("[Dashboard] Running day detected, showing RunningSessionView"),Y(j),G(!0);return}E(j),X(!0)}},className:"flex-1 bg-gradient-to-br from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white font-bold py-3 md:py-4 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 transition-all duration-300 text-sm md:text-base",children:[e.jsx(ea,{className:"w-5 h-5"}),a("dashboard.start_workout")," LIVE"]}),e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(L.button,{whileTap:{scale:.95},onClick:()=>{ze("choose"),Oe(null),ye(!0)},className:"flex-1 sm:flex-none px-3 md:px-6 bg-purple-600 hover:bg-purple-700 text-white py-3 md:py-4 rounded-xl border border-purple-500/50 transition-all duration-300 flex items-center justify-center gap-1.5 md:gap-2 text-sm md:text-base",children:["ðŸ‹ï¸",e.jsx("span",{className:"hidden sm:inline",children:"Cambia Programma"})]}),e.jsx(L.button,{whileTap:{scale:.95},onClick:async()=>{confirm("Vuoi rigenerare il programma?")&&(localStorage.removeItem("currentProgram"),r.setQueryData(Je.current((s==null?void 0:s.user_id)||""),null),await r.invalidateQueries({queryKey:Je.all}))},className:"flex-1 sm:flex-none px-3 md:px-6 bg-slate-700 hover:bg-slate-600 text-white py-3 md:py-4 rounded-xl border border-slate-600/50 transition-all duration-300 text-sm md:text-base",children:"Rigenera"})]})]})]}):e.jsxs(e.Fragment,{children:[q.screening&&e.jsxs("div",{className:"bg-slate-700/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-slate-600/50",children:[e.jsx("h3",{className:"font-display font-semibold text-base md:text-lg mb-2 md:mb-3",children:"Il tuo profilo:"}),e.jsxs("ul",{className:"text-xs md:text-sm text-slate-300 space-y-1.5 md:space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"â€¢ Livello:"}),e.jsx("span",{className:"px-2 md:px-3 py-0.5 md:py-1 rounded-full text-xs font-bold bg-emerald-500/10 text-emerald-400 border border-emerald-500/30",children:(fr=q.screening.level)==null?void 0:fr.toUpperCase()})]}),e.jsxs("li",{children:["â€¢ Goal: ",e.jsx("span",{className:"text-emerald-400 font-semibold",children:(Ns=q.onboarding)==null?void 0:Ns.goal})]}),e.jsxs("li",{children:["â€¢ Location: ",e.jsx("span",{className:"text-slate-200 font-semibold",children:(Ba=q.onboarding)==null?void 0:Ba.trainingLocation})]}),e.jsxs("li",{children:["â€¢ Score: ",e.jsxs("span",{className:"text-emerald-400 font-mono font-bold",children:[q.screening.finalScore,"%"]})]})]})]}),e.jsx(L.button,{whileTap:{scale:.98},onClick:Yt,disabled:x||!q.screening,className:"w-full bg-gradient-to-br from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold py-3 md:py-4 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 transition-all duration-300 disabled:shadow-none text-sm md:text-base",children:x?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(Wt,{className:"w-5 h-5"})}),"Generazione..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Genera Programma Personalizzato"}),e.jsx("span",{className:"sm:hidden",children:"Genera Programma"})]})}),!q.screening&&e.jsx("p",{className:"text-center text-slate-400 text-xs md:text-sm",children:"Completa prima lo screening per generare il programma"})]})})]})})]}),S&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-slate-800/90 backdrop-blur-xl rounded-2xl p-6 max-w-md w-full border border-slate-700/50 shadow-2xl",children:[e.jsx("h2",{className:"text-3xl font-display font-bold mb-6 text-white",children:a("dashboard.reset.modal_title")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-5 backdrop-blur-sm",children:[e.jsxs("h3",{className:"font-display font-semibold text-amber-400 mb-2 flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5"}),"Reset Obiettivo"]}),e.jsx("p",{className:"text-sm text-slate-300 mb-4",children:"Resetta solo il programma e l'obiettivo. Mantiene assessment, screening e quiz completati."}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Be,disabled:y,className:"w-full bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-amber-500/20 transition-all duration-300",children:y?"Resetting...":"Reset Solo Obiettivo"})]}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-5 backdrop-blur-sm",children:[e.jsxs("h3",{className:"font-display font-semibold text-red-400 mb-2 flex items-center gap-2",children:[e.jsx(Tc,{className:"w-5 h-5"}),a("dashboard.reset.deep_reset")]}),e.jsx("p",{className:"text-sm text-slate-300 mb-4",children:a("dashboard.reset.deep_reset_desc")}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:pa,disabled:y,className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-red-500/20 transition-all duration-300",children:a(y?"dashboard.reset.executing":"dashboard.reset.execute_deep")})]}),e.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-5 backdrop-blur-sm",children:[e.jsx("h3",{className:"font-display font-semibold text-emerald-400 mb-2",children:"ðŸ§ª Test Veloce"}),e.jsx("p",{className:"text-sm text-slate-300 mb-4",children:"Crea un profilo di test per provare i diversi livelli:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(L.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>st("beginner"),className:"bg-gradient-to-br from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white py-2 rounded-lg text-sm font-semibold shadow-md",children:"Fondamenta"}),e.jsx(L.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>st("intermediate"),className:"bg-gradient-to-br from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white py-2 rounded-lg text-sm font-semibold shadow-md",children:"Costruzione"}),e.jsx(L.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>st("advanced"),className:"bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white py-2 rounded-lg text-sm font-semibold shadow-md",children:"Padronanza"})]})]}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>P(!1),className:"w-full bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-xl border border-slate-600/50 transition-all duration-300",children:a("common.cancel")})]})]})}),N&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>I(!1),children:e.jsxs(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-slate-800/90 backdrop-blur-xl rounded-2xl p-6 max-w-4xl w-full border border-slate-700/50 shadow-2xl max-h-[80vh] overflow-y-auto",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-3xl font-display font-bold text-white flex items-center gap-3",children:[e.jsx(Sr,{className:"w-8 h-8 text-blue-400"}),"Storico Programmi"]}),e.jsx("button",{onClick:()=>I(!1),className:"text-slate-400 hover:text-white transition-colors",children:"âœ•"})]}),e.jsx("div",{className:"space-y-4",children:n.map((j,B)=>{var le;const A=j.is_active,ae=j.created_at?new Date(j.created_at).toLocaleDateString("it-IT"):"N/A",Z=j.start_date?new Date(j.start_date).toLocaleDateString("it-IT"):"N/A";return e.jsxs(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:B*.05},className:`p-5 rounded-xl border backdrop-blur-sm transition-all duration-200 ${A?"bg-emerald-500/10 border-emerald-500/30 hover:border-emerald-500/50":"bg-slate-700/50 border-slate-600/50 hover:border-slate-500/50"}`,children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:`text-xl font-display font-bold mb-2 ${A?"text-emerald-300":"text-white"}`,children:[j.name,A&&e.jsx("span",{className:"ml-3 text-xs px-2 py-1 rounded-full bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",children:"ATTIVO"})]}),j.description&&e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:j.description})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Livello:"}),e.jsx("p",{className:"font-semibold text-white",children:(le=j.level)==null?void 0:le.toUpperCase()})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Obiettivo:"}),e.jsx("p",{className:"font-semibold text-white",children:j.goal})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Frequenza:"}),e.jsxs("p",{className:"font-semibold text-white",children:[j.frequency,"x/settimana"]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Split:"}),e.jsx("p",{className:"font-semibold text-white",children:j.split})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-slate-400 mb-4",children:[e.jsxs("div",{children:["Creato: ",ae]}),e.jsxs("div",{children:["Inizio: ",Z]})]}),!A&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{if(confirm(`Vuoi impostare "${j.name}" come programma attivo?`)){const Q=await ud(j.id);Q.success?(await r.invalidateQueries({queryKey:Je.all}),alert("Programma attivato con successo!")):alert("Errore: "+Q.error)}},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors",children:"Attiva Programma"}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{I(!1)},className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors",children:"Chiudi"})]})]},j.id||B)})}),n.length===0&&e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(Sr,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"Nessun programma salvato"})]})]})}),ie&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>{ye(!1),ze("choose"),Oe(null)},children:e.jsx(L.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-slate-800/90 backdrop-blur-xl rounded-2xl p-6 max-w-2xl w-full border border-slate-700/50 shadow-2xl",onClick:j=>j.stopPropagation(),children:$e==="choose"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-display font-bold mb-6 text-white flex items-center gap-3",children:"ðŸ‹ï¸ Cambia Location di Allenamento"}),e.jsx("p",{className:"text-slate-300 mb-6",children:"Dove ti allenerai? Il programma verrÃ  rigenerato con esercizi adatti alla nuova location."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs(L.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>ms("gym"),disabled:ue,className:"bg-gradient-to-br from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white p-8 rounded-xl flex flex-col items-center gap-4 shadow-lg shadow-emerald-500/20 transition-all duration-300 disabled:opacity-50",children:[e.jsx("span",{className:"text-6xl",children:"ðŸ‹ï¸"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Palestra"}),e.jsx("p",{className:"text-sm text-emerald-200",children:"Accesso completo a bilancieri, manubri, macchine"})]})]}),e.jsxs(L.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>ms("home"),disabled:ue,className:"bg-gradient-to-br from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white p-8 rounded-xl flex flex-col items-center gap-4 shadow-lg shadow-blue-500/20 transition-all duration-300 disabled:opacity-50",children:[e.jsx("span",{className:"text-6xl",children:"ðŸ "}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Casa"}),e.jsx("p",{className:"text-sm text-blue-200",children:"Programma personalizzato per la tua attrezzatura"})]})]})]}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{ye(!1),ze("choose"),Oe(null)},className:"w-full bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-xl border border-slate-600/50 transition-all duration-300",children:a("common.cancel")})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-3xl font-display font-bold mb-4 text-white flex items-center gap-3",children:"ðŸ  Attrezzatura Disponibile a Casa"}),e.jsx("p",{className:"text-slate-300 mb-6",children:"Seleziona l'attrezzatura che hai disponibile. Il programma sarÃ  ottimizzato di conseguenza."}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[{key:"dumbbell",label:"Manubri",icon:"ðŸ‹ï¸"},{key:"barbell",label:"Bilanciere",icon:"âš¡"},{key:"pullUpBar",label:"Sbarra Trazioni",icon:"ðŸ”¥"},{key:"rings",label:"Anelli",icon:"â­•"},{key:"bands",label:"Elastici",icon:"ðŸŽ—ï¸"},{key:"kettlebell",label:"Kettlebell",icon:"ðŸŽ¯"},{key:"bench",label:"Panca",icon:"ðŸª‘"}].map(({key:j,label:B,icon:A})=>e.jsxs(L.label,{whileHover:{scale:1.02},className:`flex items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all duration-200 ${Ge[j]?"bg-emerald-500/20 border-emerald-500 text-emerald-300":"bg-slate-700/50 border-slate-600 text-slate-300 hover:border-slate-500"}`,children:[e.jsx("input",{type:"checkbox",checked:Ge[j],onChange:ae=>ft(Z=>({...Z,[j]:ae.target.checked})),className:"w-5 h-5 rounded accent-emerald-500"}),e.jsx("span",{className:"text-2xl",children:A}),e.jsx("span",{className:"font-semibold",children:B})]},j))}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-xl p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-blue-300",children:["ðŸ’¡ ",e.jsx("strong",{children:"Nessuna attrezzatura?"})," Nessun problema! Genereremo un programma calisthenics a corpo libero ottimizzato per te."]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>ze("choose"),disabled:ue,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-xl border border-slate-600/50 transition-all duration-300 disabled:opacity-50",children:"â† Indietro"}),e.jsx(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>Oa("home",Ge),disabled:ue,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 rounded-xl shadow-lg shadow-blue-500/30 transition-all duration-300 disabled:opacity-50",children:ue?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:"âš¡"}),"Generazione..."]}):"Genera Programma Casa"})]})]})})}),C&&(H==null?void 0:H.runningSession)&&e.jsx(_d,{session:H.runningSession,dayName:H.dayName||H.name||"Running",onComplete:gs,onCancel:pr}),oe&&e.jsx(kd,{onComplete:j=>{pe(j),X(!1),W(!0)},onSkip:()=>{pe({sleepHours:7,stressLevel:5,hasInjury:!1,injuryDetails:null,menstrualCycle:null,availableTime:45,isFemale:!1,timestamp:new Date().toISOString()}),X(!1),W(!0)}}),U&&D&&s&&e.jsx(A0,{open:U,onClose:()=>{W(!1),E(null),pe(null)},userId:((_s=q.screening)==null?void 0:_s.userId)||s.user_id||"",programId:s.id||"",dayName:D.name||"Day 1",exercises:D.exercises||[],recoveryData:ee||void 0,onWorkoutComplete:async()=>{console.log("âœ… Workout completato, refreshing program..."),await r.invalidateQueries({queryKey:Je.all}),W(!1),M(!0),setTimeout(()=>{ps()},1e3)}}),T&&D&&s&&e.jsx(p0,{open:T,onClose:()=>{M(!1),E(null)},userId:((Wa=q.screening)==null?void 0:Wa.userId)||"",programId:s.id||"",dayName:D.name||"Day 1",splitType:s.split||"Full Body",exercises:D.exercises||[],onWorkoutLogged:async()=>{console.log("âœ… Workout logged, refreshing program..."),await r.invalidateQueries({queryKey:Je.all}),M(!1),E(null)}}),qe&&e.jsx(Tf,{open:he,onClose:()=>{Ue(!1),Vt(null)},adjustment:qe,onAccept:Ni,onReject:hs,onPostpone:mr}),e.jsx(Gf,{open:Te,onClose:()=>ct(!1),onSelectPlan:j=>{console.log("[Paywall] Selected tier:",j),alert(`Piano ${j.toUpperCase()} selezionato!

Integrazione Stripe in arrivo...`)},userProgress:{workoutsCompleted:Re.daysActive,baselineImprovements:(Ps=q.screening)!=null&&Ps.patternBaselines?Object.keys(q.screening.patternBaselines).map(j=>`${j} baseline`):[],injuriesAvoided:((It=s==null?void 0:s.pain_areas)==null?void 0:It.length)||0}}),e.jsx(Zf,{isOpen:Da,onClose:()=>Ze(!1),onConfirm:us,userAge:(br=(xr=q.onboarding)==null?void 0:xr.personalInfo)==null?void 0:br.age})]})}export{px as default};
