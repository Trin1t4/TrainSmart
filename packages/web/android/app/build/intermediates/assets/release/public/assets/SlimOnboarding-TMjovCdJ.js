import{j as e,r as o,V as v,Y as T,a as j,C as V,U,c as Q,M as J,D as K,H as W,W as Y,k as X}from"./vendor-ui-B5xs3EUI.js";import{u as Z,a as n}from"./vendor-react-DLKD8xKB.js";import{u as ee,a as te,s as ae}from"./index-CsHuaFST.js";import{M as se,H as le}from"./HealthDataConsentModal-DEhPJl0c.js";import"./vendor-supabase-DF1H9KNm.js";const ie=[{value:"forza",label:"Forza",icon:"ðŸ’ª",desc:"Diventa piÃ¹ forte"},{value:"ipertrofia",label:"Massa",icon:"ðŸ‹ï¸",desc:"Costruisci muscoli"},{value:"tonificazione",label:"Tonificazione",icon:"âš¡",desc:"Definisci il fisico"},{value:"dimagrimento",label:"Dimagrire",icon:"ðŸ”¥",desc:"Perdi grasso"},{value:"resistenza",label:"Resistenza",icon:"ðŸƒ",desc:"Aumenta il fiato"},{value:"prestazioni_sportive",label:"Sport",icon:"ðŸŽ¯",desc:"Migliora nello sport"},{value:"benessere",label:"Benessere",icon:"ðŸ§˜",desc:"Stai meglio"}],ne=[{value:"neck",label:"Collo",icon:"ðŸ¦´"},{value:"shoulder",label:"Spalla",icon:"ðŸ’ª"},{value:"lower_back",label:"Lombare",icon:"â¬‡ï¸"},{value:"hip",label:"Anca",icon:"ðŸ¦´"},{value:"knee",label:"Ginocchio",icon:"ðŸ¦µ"},{value:"ankle",label:"Caviglia",icon:"ðŸ‘£"},{value:"wrist",label:"Polso",icon:"ðŸ¤š"},{value:"elbow",label:"Gomito",icon:"ðŸ’ª"}],re=[{key:"pullupBar",label:"Sbarra trazioni",icon:"ðŸ”©"},{key:"loopBands",label:"Elastici",icon:"ðŸ”—"},{key:"dumbbells",label:"Manubri",icon:"ðŸ‹ï¸"},{key:"kettlebell",label:"Kettlebell",icon:"ðŸ””"},{key:"bench",label:"Panca",icon:"ðŸ›‹ï¸"},{key:"rings",label:"Anelli",icon:"â­•"}];function be(){const N=Z(),{t:oe}=ee(),{user:r}=te(),[l,u]=n.useState(0),[y,w]=n.useState(!0),[S,d]=n.useState(!1),[C,k]=n.useState(!1),[b,h]=n.useState(!1),[a,A]=n.useState({name:"",gender:"M",age:30,weight:void 0,goal:"",location:"gym",frequency:3,painAreas:[],equipment:{}}),[g,c]=n.useState(!1),[m,x]=n.useState([]),[D,p]=n.useState(!1),i=t=>{A(s=>({...s,...t}))},z=()=>{l<2?u(t=>t+1):P()},I=()=>{l>0&&u(t=>t-1)},q=t=>{x(s=>s.includes(t)?s.filter(F=>F!==t):[...s,t])},E=()=>{const t=m.map(s=>({area:s,severity:"moderate"}));i({painAreas:t}),c(!1)},M=t=>{var s;i({equipment:{...a.equipment,[t]:!((s=a.equipment)!=null&&s[t])}})},P=async()=>{if(r){h(!0);try{const t={anagrafica:{firstName:a.name,lastName:"",birthDate:"",privacyAccepted:!0,termsAccepted:!0},personalInfo:{gender:a.gender,age:a.age,height:170,weight:a.weight||70,bmi:0},goal:a.goal,goals:[a.goal],trainingLocation:a.location,trainingType:a.location==="home"?"bodyweight":"equipment",frequency:a.frequency,painAreas:a.painAreas,equipment:a.equipment,screeningType:"light"},{error:s}=await ae.from("user_profiles").upsert({user_id:r.id,email:r.email,display_name:a.name,onboarding_data:t,onboarding_completed:!0,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(s)throw console.error("[SLIM_ONBOARDING] Error saving profile:",s),s;localStorage.setItem("onboarding_data",JSON.stringify(t)),console.log("[SLIM_ONBOARDING] Onboarding completato"),N("/optional-quizzes")}catch(t){console.error("[SLIM_ONBOARDING] Error:",t),alert("Errore durante il salvataggio. Riprova.")}finally{h(!1)}}},_=a.name.trim().length>=2&&a.age>0&&a.age>=14&&a.age<=100,O=a.goal!=="",$=a.frequency>=1&&a.frequency<=7,G=()=>{switch(l){case 0:return _;case 1:return O;case 2:return $;default:return!1}},H=()=>e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(U,{className:"w-8 h-8 text-emerald-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Chi sei?"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Iniziamo con le basi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Come ti chiami?"}),e.jsx("input",{type:"text",value:a.name,onChange:t=>i({name:t.target.value}),placeholder:"Il tuo nome",className:"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Genere"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"M",label:"Maschio",icon:"ðŸ‘¨"},{value:"F",label:"Femmina",icon:"ðŸ‘©"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>i({gender:t.value}),className:`p-4 rounded-lg border-2 transition-all ${a.gender===t.value?"border-emerald-500 bg-emerald-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx("div",{className:"text-3xl mb-1",children:t.icon}),e.jsx("div",{className:"font-semibold",children:t.label})]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"EtÃ "}),e.jsx("input",{type:"number",min:"14",max:"100",value:a.age||"",onChange:t=>{const s=t.target.value;i({age:s===""?0:parseInt(s)})},placeholder:"30",className:"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Peso ",e.jsx("span",{className:"text-slate-500",children:"(opzionale)"})]}),e.jsx("input",{type:"number",min:"30",max:"250",value:a.weight||"",onChange:t=>i({weight:t.target.value?parseInt(t.target.value):void 0}),placeholder:"kg",className:"w-full bg-slate-700 border border-slate-600 text-white rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"})]})]},"step1"),R=()=>e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Q,{className:"w-8 h-8 text-blue-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Qual Ã¨ il tuo obiettivo?"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Scegli il tuo focus principale"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ie.map(t=>e.jsxs("button",{type:"button",onClick:()=>i({goal:t.value}),className:`p-4 rounded-lg border-2 transition-all text-left ${a.goal===t.value?"border-blue-500 bg-blue-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:t.icon}),e.jsx("div",{className:"font-semibold",children:t.label}),e.jsx("div",{className:"text-xs text-slate-400 mt-1",children:t.desc})]},t.value))})]},"step2"),B=()=>e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(J,{className:"w-8 h-8 text-purple-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Dove e quanto?"}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Ultimi dettagli"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Dove ti alleni?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>{i({location:"gym"}),p(!1)},className:`p-4 rounded-lg border-2 transition-all ${a.location==="gym"?"border-purple-500 bg-purple-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx(K,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"font-semibold",children:"Palestra"})]}),e.jsxs("button",{type:"button",onClick:()=>{i({location:"home"}),p(!0)},className:`p-4 rounded-lg border-2 transition-all ${a.location==="home"?"border-purple-500 bg-purple-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx(W,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"font-semibold",children:"Casa"})]})]})]}),e.jsx(v,{children:D&&a.location==="home"&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Che attrezzatura hai?"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(t=>{var s;return e.jsxs("button",{type:"button",onClick:()=>M(t.key),className:`p-3 rounded-lg border text-center transition-all ${(s=a.equipment)!=null&&s[t.key]?"border-emerald-500 bg-emerald-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-400 hover:border-slate-500"}`,children:[e.jsx("div",{className:"text-xl",children:t.icon}),e.jsx("div",{className:"text-xs mt-1",children:t.label})]},t.key)})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Quante volte a settimana?"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-slate-400"}),e.jsx("div",{className:"flex gap-2 flex-1",children:[2,3,4,5,6].map(t=>e.jsx("button",{type:"button",onClick:()=>i({frequency:t}),className:`flex-1 py-3 rounded-lg font-bold transition-all ${a.frequency===t?"bg-emerald-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Hai dolori articolari?"}),g?e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Seleziona le zone dolenti (puoi selezionarne piÃ¹ di una)"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:ne.map(t=>e.jsxs("button",{type:"button",onClick:()=>q(t.value),className:`p-3 rounded-lg border text-center transition-all ${m.includes(t.value)?"border-amber-500 bg-amber-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-400 hover:border-slate-500"}`,children:[e.jsx("div",{className:"text-xl",children:t.icon}),e.jsx("div",{className:"text-xs mt-1",children:t.label})]},t.value))}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),x([])},className:"flex-1 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition",children:"Annulla"}),e.jsxs("button",{type:"button",onClick:E,className:"flex-1 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition font-semibold",children:["Conferma (",m.length,")"]})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>{x([]),i({painAreas:[]})},className:`p-4 rounded-lg border-2 transition-all ${a.painAreas.length===0&&!g?"border-emerald-500 bg-emerald-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx(j,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("div",{className:"font-semibold",children:"No, tutto ok"})]}),e.jsxs("button",{type:"button",onClick:()=>{C?c(!0):d(!0)},className:`p-4 rounded-lg border-2 transition-all ${a.painAreas.length>0?"border-amber-500 bg-amber-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"}`,children:[e.jsx(X,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("div",{className:"font-semibold",children:a.painAreas.length>0?`${a.painAreas.length} zona/e`:"SÃ¬, dimmi dove"})]})]})]})]},"step3");if(y)return e.jsx(se,{onAccept:()=>w(!1),language:"it"});const f=3,L=(l+1)/f*100;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 py-8 px-4",children:[e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Setup Rapido"}),e.jsxs("span",{className:"text-slate-400 text-sm",children:[l+1," di ",f]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx(o.div,{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600",initial:{width:0},animate:{width:`${L}%`},transition:{duration:.3}})})]}),e.jsx("div",{className:"bg-slate-800/50 backdrop-blur-lg rounded-2xl p-6 border border-slate-700",children:e.jsxs(v,{mode:"wait",children:[l===0&&H(),l===1&&R(),l===2&&B()]})}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[l>0&&e.jsxs("button",{onClick:I,className:"flex-1 bg-slate-700 text-white py-4 rounded-lg font-semibold text-lg hover:bg-slate-600 transition flex items-center justify-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Indietro"]}),e.jsx("button",{onClick:z,disabled:!G()||b,className:"flex-1 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-4 rounded-lg font-semibold text-lg shadow-lg shadow-emerald-500/20 hover:from-emerald-600 hover:to-emerald-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Salvataggio..."]}):l===2?e.jsxs(e.Fragment,{children:["Completa",e.jsx(j,{className:"w-5 h-5"})]}):e.jsxs(e.Fragment,{children:["Avanti",e.jsx(V,{className:"w-5 h-5"})]})})]}),e.jsxs("p",{className:"text-center text-slate-500 text-sm mt-4",children:["~",90-l*30," secondi rimanenti"]})]}),e.jsx(le,{isOpen:S,onAccept:()=>{k(!0),d(!1),c(!0)},onDecline:()=>{d(!1)},userId:(r==null?void 0:r.id)||"",language:"it",allowSkip:!0})]})}export{be as default};
