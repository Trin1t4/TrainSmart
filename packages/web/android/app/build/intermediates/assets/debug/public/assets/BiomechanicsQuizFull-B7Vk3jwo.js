import{j as e,B as O,S as Q,ad as D,O as z,M,D as T,ac as _,e as E,g as A,a as G,ae as R}from"./vendor-ui-B5xs3EUI.js";import{u as L,a as x}from"./vendor-react-DLKD8xKB.js";import"./index-CsHuaFST.js";import{D as B}from"./biomechanicsQuizDCSS-Bevqd9N4.js";import"./vendor-supabase-DF1H9KNm.js";const C=B,w=7;function y(l,s){const u=s.filter(r=>!l.askedQuestions.includes(r.id));if(u.length===0||l.answers.length>=w)return null;const a=l.answers.filter(r=>r.isOverconfident).length,g=l.answers.filter(r=>r.isTechniqueGap).length;if((a>=2||g>=2)&&l.answers.length>=4)return null;const i={technique:[],anatomy:[],programming:[],safety:[]};u.forEach(r=>{i[r.category]&&i[r.category].push(r)});const m=["technique","safety","programming","anatomy"];for(const r of m){const b=i[r];if(b.length>0){const j=l.answers.filter(p=>p.correct).length,n=(l.answers.length>0?j/l.answers.length:.5)>.7?"intermediate":"basic",h=b.filter(p=>p.difficulty===n);return h.length>0?h[Math.floor(Math.random()*h.length)]:b[Math.floor(Math.random()*b.length)]}}return u[Math.floor(Math.random()*u.length)]}function k(l){const s=l.answers.filter(m=>m.correct).length,u=l.answers.filter(m=>m.isOverconfident).length,a=l.answers.filter(m=>m.isTechniqueGap).length,g=l.answers.length,i=g>0?s/g:0;return u>=2?{level:"intermediate",label:"Costruzione",description:"Hai buone conoscenze, ma alcune credenze potrebbero essere più rigide di quanto la scienza supporti. Il tuo programma includerà indicazioni sfumate e flessibili."}:a>=2?{level:"beginner",label:"Fondamenta",description:"Ci sono alcuni concetti tecnici da approfondire. Il tuo programma includerà spiegazioni dettagliate e progressione graduale."}:i>=.8?{level:"advanced",label:"Padronanza",description:"Ottima comprensione dei principi dell'allenamento. Il programma sarà diretto e senza spiegazioni ridondanti."}:i>=.5?{level:"intermediate",label:"Costruzione",description:"Conosci le basi e sai muoverti bene. Il tuo programma sarà calibrato per farti progredire con intensità appropriate."}:{level:"beginner",label:"Fondamenta",description:"Ci concentreremo sull'insegnarti i fondamentali con molte spiegazioni e indicazioni."}}function J(){const l=L(),[s,u]=x.useState({currentQuestionIndex:0,answers:[],askedQuestions:[]}),[a,g]=x.useState(()=>y(s,C)),[i,m]=x.useState(null),[r,b]=x.useState(!1),[j,I]=x.useState(!1),[n,h]=x.useState(null);x.useMemo(()=>k(s),[s]);const p=x.useCallback(()=>{if(i===null||!a)return;const t=a.options.find(o=>o.id===i);if(!t)return;const c=t.isCorrect,d={questionId:a.id,selectedOptionId:i,correct:c,isTechniqueGap:t.isTechniqueGap,isOverconfident:t.isOverconfident};u({...s,answers:[...s.answers,d],askedQuestions:[...s.askedQuestions,a.id]}),b(!0)},[i,a,s]),$=x.useCallback(()=>{const t={...s,askedQuestions:[...s.askedQuestions,(a==null?void 0:a.id)||""]},c=y(t,C);if(!c){I(!0);return}g(c),m(null),b(!1)},[s,a]),q=x.useCallback(()=>{const t=k(s),c={};s.answers.forEach(o=>{c[o.questionId]=o.selectedOptionId});const d={level:t.level,levelLabel:t.label,totalQuestions:s.answers.length,correctAnswers:s.answers.filter(o=>o.correct).length,overconfidentCount:s.answers.filter(o=>o.isOverconfident).length,techniqueGapCount:s.answers.filter(o=>o.isTechniqueGap).length,answers:s.answers,completedAt:new Date().toISOString(),paradigm:"DCSS"};localStorage.setItem("quiz_data",JSON.stringify(d)),n==="gym"?l("/screening-full"):n==="know_maxes"?l("/screening-full",{state:{manualEntry:!0}}):(localStorage.setItem("screening_pending","true"),l("/dashboard"))},[s,l,n]);if(j){const t=k(s),c=s.answers.filter(d=>d.correct).length;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-lg rounded-2xl p-8 border border-slate-700 text-center",children:[e.jsxs("div",{className:`w-20 h-20 mx-auto mb-6 rounded-2xl flex items-center justify-center ${t.level==="advanced"?"bg-emerald-500/20 border-2 border-emerald-500":t.level==="intermediate"?"bg-blue-500/20 border-2 border-blue-500":"bg-amber-500/20 border-2 border-amber-500"}`,children:[t.level==="advanced"&&e.jsx(O,{className:"w-10 h-10 text-emerald-400"}),t.level==="intermediate"&&e.jsx(Q,{className:"w-10 h-10 text-blue-400"}),t.level==="beginner"&&e.jsx(D,{className:"w-10 h-10 text-amber-400"})]}),e.jsxs("h2",{className:"text-2xl font-bold text-white mb-2",children:["Il tuo livello: ",e.jsx("span",{className:t.level==="advanced"?"text-emerald-400":t.level==="intermediate"?"text-blue-400":"text-amber-400",children:t.label})]}),e.jsxs("div",{className:"flex justify-center gap-6 my-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:c}),e.jsx("div",{className:"text-sm text-slate-400",children:"Risposte corrette"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:s.answers.length}),e.jsx("div",{className:"text-sm text-slate-400",children:"Domande totali"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-white",children:s.score}),e.jsx("div",{className:"text-sm text-slate-400",children:"Punteggio"})]})]}),e.jsx("p",{className:"text-slate-300 mb-8 leading-relaxed",children:t.description}),s.answers.filter(d=>d.isOverconfident).length>0&&e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 mb-6 flex items-start gap-3",children:[e.jsx(z,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-amber-300 text-sm",children:"Alcune risposte indicano credenze che potrebbero essere più rigide di quanto la scienza supporti. Il tuo programma includerà indicazioni sfumate basate su evidenze attuali."})]}),s.answers.filter(d=>d.isTechniqueGap).length>0&&e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 mb-6 flex items-start gap-3",children:[e.jsx(z,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-blue-300 text-sm",children:"Ci sono alcuni concetti tecnici da approfondire. Il tuo programma includerà spiegazioni dettagliate e indicazioni educative."})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 mb-6 text-left",children:[e.jsxs("p",{className:"text-white font-semibold mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-emerald-400"}),"Sei in palestra adesso?"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>h("gym"),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${n==="gym"?"border-emerald-500 bg-emerald-500/20":"border-slate-600 hover:border-slate-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${n==="gym"?"bg-emerald-500/30":"bg-slate-600/50"}`,children:e.jsx(T,{className:`w-5 h-5 ${n==="gym"?"text-emerald-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${n==="gym"?"text-white":"text-slate-300"}`,children:"Si, faccio i test adesso"}),e.jsx("p",{className:"text-xs text-slate-400",children:"4 test pratici (~10 min)"})]})]})}),e.jsx("button",{onClick:()=>h("know_maxes"),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${n==="know_maxes"?"border-blue-500 bg-blue-500/20":"border-slate-600 hover:border-slate-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${n==="know_maxes"?"bg-blue-500/30":"bg-slate-600/50"}`,children:e.jsx(_,{className:`w-5 h-5 ${n==="know_maxes"?"text-blue-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${n==="know_maxes"?"text-white":"text-slate-300"}`,children:"No, ma conosco i miei massimali"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Inserisco i valori manualmente"})]})]})}),e.jsx("button",{onClick:()=>h("later"),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${n==="later"?"border-amber-500 bg-amber-500/20":"border-slate-600 hover:border-slate-500"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${n==="later"?"bg-amber-500/30":"bg-slate-600/50"}`,children:e.jsx(E,{className:`w-5 h-5 ${n==="later"?"text-amber-400":"text-slate-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${n==="later"?"text-white":"text-slate-300"}`,children:"Faro i test dopo"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Inizia con un programma base"})]})]})})]})]}),e.jsxs("button",{onClick:q,disabled:!n,className:"w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-4 rounded-xl font-semibold shadow-lg shadow-emerald-500/20 hover:from-emerald-600 hover:to-emerald-700 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:["Continua",e.jsx(A,{className:"w-5 h-5"})]})]})})})}if(!a)return null;const f=i?a.options.find(t=>t.id===i):null;a.options.find(t=>t.isCorrect);const S={technique:{bg:"bg-blue-500/20",text:"text-blue-300",label:"Tecnica"},anatomy:{bg:"bg-purple-500/20",text:"text-purple-300",label:"Anatomia"},programming:{bg:"bg-green-500/20",text:"text-green-300",label:"Programmazione"},safety:{bg:"bg-amber-500/20",text:"text-amber-300",label:"Sicurezza"}},v=S[a.category]||S.technique;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Quiz Biomeccanica"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded ${v.bg} ${v.text}`,children:v.label}),e.jsxs("span",{className:"text-slate-300",children:[s.answers.length+1," / max ",w]})]})]}),e.jsx("div",{className:"h-2 bg-slate-700 rounded-full",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600 transition-all rounded-full",style:{width:`${Math.min((s.answers.length+1)/w*100,100)}%`}})})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-lg rounded-2xl p-6 md:p-8 border border-slate-700",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-6",children:a.questionIt||a.question}),e.jsx("div",{className:"space-y-3 mb-6",children:a.options.map(t=>{const c=i===t.id,d=t.isCorrect,o=r&&c&&!d,N=r&&d;return e.jsx("button",{onClick:()=>!r&&m(t.id),disabled:r,className:`w-full p-4 rounded-lg border-2 text-left transition ${N?"border-green-500 bg-green-500/20 text-white":o?"border-red-500 bg-red-500/20 text-white":c?"border-emerald-500 bg-emerald-500/20 text-white":"border-slate-600 bg-slate-700/50 text-slate-300 hover:border-slate-500"} ${r?"cursor-not-allowed":"cursor-pointer"} ${(t.textIt||t.text).toLowerCase().includes("non")&&(t.textIt||t.text).toLowerCase().includes("so")?"italic text-slate-400":""}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${N?"border-green-500 bg-green-500":o?"border-red-500 bg-red-500":c?"border-emerald-500 bg-emerald-500":"border-slate-500"}`,children:[N&&e.jsx(G,{className:"w-4 h-4 text-white"}),o&&e.jsx(R,{className:"w-4 h-4 text-white"})]}),e.jsx("span",{className:"font-medium",children:t.textIt||t.text})]})},t.id)})}),r&&f&&e.jsxs("div",{className:`border rounded-lg p-4 mb-6 ${f.isCorrect?"bg-emerald-500/10 border-emerald-500":"bg-amber-500/10 border-amber-500"}`,children:[e.jsx("p",{className:`text-sm font-medium mb-2 ${f.isCorrect?"text-emerald-300":"text-amber-300"}`,children:f.isCorrect?"✓ Corretto!":"✗ Non esattamente"}),f.feedbackIt&&e.jsx("p",{className:"text-slate-400 text-sm mb-2 italic",children:f.feedbackIt}),e.jsx("p",{className:"text-slate-300",children:a.explanationIt||a.explanation}),a.reference&&e.jsxs("p",{className:"text-slate-500 text-xs mt-2",children:["Fonte: ",a.reference]})]}),r?e.jsx("button",{onClick:$,className:"w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-3 rounded-lg font-semibold shadow-lg shadow-emerald-500/20 hover:from-emerald-600 hover:to-emerald-700 transition",children:s.answers.length>=w-1||!y({...s,askedQuestions:[...s.askedQuestions,a.id]},C)?"Vedi Risultato →":"Prossima Domanda →"}):e.jsx("button",{onClick:p,disabled:i===null,className:"w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-emerald-500/20 hover:from-emerald-600 hover:to-emerald-700 transition",children:"Conferma Risposta"})]}),e.jsx("div",{className:"mt-4 text-center text-slate-500 text-sm",children:e.jsx("p",{children:'Le risposte sono sfumate - spesso "dipende" è la risposta giusta.'})})]})})}export{J as default};
