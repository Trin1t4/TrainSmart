import{s as t}from"./index-CsHuaFST.js";async function n(o){try{console.log("[VideoCorrectionService] Checking quota for user:",o);const{data:r,error:e}=await t.rpc("check_video_correction_quota",{p_user_id:o});if(e)throw console.error("[VideoCorrectionService] Quota check error:",e),e;return console.log("[VideoCorrectionService] Quota info:",r),r}catch(r){return console.error("[VideoCorrectionService] Failed to check quota:",r),null}}async function a(o){try{const{data:r,error:e}=await t.from("video_corrections").select("*").eq("id",o).single();if(e)throw e;return r}catch(r){return console.error("[VideoCorrectionService] Failed to fetch correction:",r),null}}async function s(o){try{const{error:r}=await t.from("video_corrections").update({viewed_at:new Date().toISOString()}).eq("id",o).is("viewed_at",null);if(r)throw r;return!0}catch(r){return console.error("[VideoCorrectionService] Failed to mark as viewed:",r),!1}}async function d(o,r=3600){try{const{data:e,error:i}=await t.storage.from("user-exercise-videos").createSignedUrl(o,r);if(i)throw i;return e.signedUrl}catch(e){return console.error("[VideoCorrectionService] Failed to get signed URL:",e),null}}export{d as a,n as c,a as g,s as m};
