import{j as e,T as g,P as _,aC as k,r as h,a as p,b as C,ap as V,ay as z}from"./vendor-ui-B5xs3EUI.js";import{a as l,k as A}from"./vendor-react-DLKD8xKB.js";import{g as S,a as R,m as E}from"./videoCorrectionService-hah9IU7_.js";import"./index-CsHuaFST.js";import"./vendor-supabase-DF1H9KNm.js";function P({correctionId:i,onClose:n}){const[a,u]=l.useState(null),[d,b]=l.useState(null),[j,m]=l.useState(!0);l.useEffect(()=>{N()},[i]);async function N(){m(!0);const s=await S(i);if(u(s),s!=null&&s.video_url){const t=await R(s.video_url);b(t),s.viewed_at||await E(i)}m(!1)}if(j)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Caricamento feedback..."})]})});if(!a||a.processing_status!=="completed")return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:(a==null?void 0:a.processing_status)==="processing"?"Analisi ancora in corso...":"Feedback non disponibile"})]})});const r=a.feedback_score||0,c=a.feedback_issues||[],o=a.feedback_corrections||[],x=a.feedback_warnings||[],y=s=>s>=8?"text-green-400":s>=6?"text-yellow-400":"text-red-400",f=s=>{const t={low:"bg-blue-900/50 text-blue-400 border-blue-700",medium:"bg-yellow-900/50 text-yellow-400 border-yellow-700",high:"bg-red-900/50 text-red-400 border-red-700"};return t[s]||t.low},v=s=>s.includes("increase")?e.jsx(C,{className:"w-5 h-5 text-green-400"}):s.includes("decrease")?e.jsx(V,{className:"w-5 h-5 text-red-400"}):e.jsx(z,{className:"w-5 h-5 text-yellow-400"});return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Analisi Video Completata"}),n&&e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors",children:"âœ•"})]}),e.jsx("p",{className:"text-gray-400",children:a.exercise_name})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Video Registrato"]}),d?e.jsx("video",{src:d,controls:!0,className:"w-full rounded-lg",playsInline:!0}):e.jsx("div",{className:"aspect-video bg-gray-800 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Video non disponibile"})})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 border border-gray-700 mt-6 text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm uppercase tracking-wider mb-2",children:"Punteggio Tecnica"}),e.jsxs("div",{className:`text-6xl font-bold ${y(r)} mb-2`,children:[r,"/10"]}),e.jsx("div",{className:"flex items-center justify-center gap-1 mb-3",children:[...Array(10)].map((s,t)=>e.jsx(k,{className:`w-5 h-5 ${t<r?"fill-yellow-400 text-yellow-400":"text-gray-600"}`},t))}),e.jsxs("p",{className:"text-gray-300",children:[r>=8&&"Ottima esecuzione! Solo piccoli affinamenti.",r>=6&&r<8&&"Buona forma, ma ci sono margini di miglioramento.",r>=4&&r<6&&"Forma moderata, riduci il carico e lavora sulla tecnica.",r<4&&"Forma compromessa, rivedi il pattern di movimento."]})]}),a.load_recommendation&&e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700 mt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[v(a.load_recommendation),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Raccomandazione Carico"}),e.jsxs("p",{className:"text-white font-medium",children:[a.load_recommendation==="increase_5_percent"&&"Aumenta del 5%",a.load_recommendation==="maintain"&&"Mantieni carico attuale",a.load_recommendation==="decrease_10_percent"&&"Riduci del 10%",a.load_recommendation==="decrease_20_percent"&&"Riduci del 20%"]})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[x.length>0&&e.jsxs("div",{className:"bg-red-900/20 border border-red-700 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-red-400 font-bold mb-3 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"âš ï¸ Avvisi Sicurezza"]}),e.jsx("ul",{className:"space-y-2",children:x.map((s,t)=>e.jsxs("li",{className:"text-red-300 text-sm",children:["â€¢ ",s]},t))})]}),c.length>0&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"text-white font-bold mb-4",children:"Errori Rilevati"}),e.jsx("div",{className:"space-y-3",children:c.map((s,t)=>e.jsxs(h.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:t*.1},className:`border rounded-lg p-3 ${f(s.severity)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("p",{className:"font-medium capitalize",children:s.name.replace(/_/g," ")}),e.jsx("span",{className:"text-xs uppercase px-2 py-1 rounded bg-black/20",children:s.severity})]}),e.jsx("p",{className:"text-sm opacity-90",children:s.description}),s.timestamp_seconds&&s.timestamp_seconds.length>0&&e.jsxs("p",{className:"text-xs opacity-70 mt-2",children:["Visibile a: ",s.timestamp_seconds.map(w=>`${w}s`).join(", ")]})]},t))})]}),o.length>0&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[e.jsxs("h3",{className:"text-white font-bold mb-4 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-green-400"}),"Come Correggere"]}),e.jsx("ul",{className:"space-y-3",children:o.map((s,t)=>e.jsxs(h.li,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:t*.1},className:"flex items-start gap-3 text-gray-300",children:[e.jsx("span",{className:"text-green-400 font-bold mt-0.5",children:"âœ“"}),e.jsx("span",{children:s})]},t))})]}),c.length===0&&o.length===0&&e.jsxs("div",{className:"bg-green-900/20 border border-green-700 rounded-lg p-6 text-center",children:[e.jsx(p,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-green-400 font-bold text-xl mb-2",children:"Esecuzione Perfetta! ðŸŽ‰"}),e.jsx("p",{className:"text-gray-300",children:"Non sono stati rilevati errori tecnici. Continua cosÃ¬!"})]})]})]}),e.jsxs("div",{className:"mt-8 flex gap-4 justify-center",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-gray-700 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors",children:"Analizza Altro Video"}),n&&e.jsx("button",{onClick:n,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:opacity-90 transition-opacity",children:"Torna al Workout"})]})]})})}function D(){const{correctionId:i}=A();return i?e.jsx(P,{correctionId:i}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Errore"}),e.jsx("p",{className:"text-gray-400",children:"ID correzione mancante"})]})})}export{D as default};
